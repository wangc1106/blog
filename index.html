<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="1osTo_gOe1SW9Hevqtz8vl8HfSgTO4DSMZ0DiMPMX6w">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wangc1106.github.io","root":"/blog/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":"ture"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Make more time">
<meta property="og:type" content="website">
<meta property="og:title" content="Banner&#39;s Blog">
<meta property="og:url" content="https://wangc1106.github.io/blog/index.html">
<meta property="og:site_name" content="Banner&#39;s Blog">
<meta property="og:description" content="Make more time">
<meta property="og:locale">
<meta property="article:author" content="Wang C">
<meta property="article:tag" content="Bioinformatics">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wangc1106.github.io/blog/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>Banner's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Banner's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Dream big work hard</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="https://wangc1106.github.io/" rel="section"><i class="user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/18/2022-03-19-CUT-Tag/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/18/2022-03-19-CUT-Tag/" class="post-title-link" itemprop="url">【CUT-Tag】【ATAC】</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-18 22:42:53" itemprop="dateCreated datePublished" datetime="2022-03-18T22:42:53+08:00">2022-03-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-19 21:53:05" itemprop="dateModified" datetime="2022-03-19T21:53:05+08:00">2022-03-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/18/2022-03-19-CUT-Tag/" class="post-meta-item leancloud_visitors" data-flag-title="【CUT-Tag】【ATAC】" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>3.8k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>3 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV11K4y147fN?from=search&amp;seid=6789892139579942949&amp;spm_id_from=333.337.0.0">嘉因生物</a></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/1.png" alt="1"></p>
<p><strong>测序数据量</strong></p>
<p>参考ChIP-seq 20M/40M（2000万reads）（对PE50约为 6/12G）</p>
<p><strong>CUT&amp;Tag-去除测序接头</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/2.png" alt="1"></p>
<p><strong>去接头软件</strong></p>
<p>Trimmomatic；Cutadapt；fastp</p>
<p><strong>参考序列比对</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/3.png" alt="1"></p>
<p><strong>数据过滤</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/4.png" alt="1"></p>
<p><strong>CUT&amp;Tag片段长度分布</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/5.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/6.png" alt="1"></p>
<p><strong>CUT&amp;Tag-结合位点检测（PeakCalling）</strong></p>
<p>MACS2 主流</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/7.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/8.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/9.png" alt="9"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/10.png" alt="1"></p>
<p>SEACR 结果没那么好</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/11.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/12.png" alt="1"></p>
<p><strong>CUT&amp;Tag-结合位点信号分布</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/13.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/14.png" alt="1"></p>
<p><strong>CUT&amp;Tag-Peaks 功能性区域注释</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/15.png" alt="1"></p>
<p><strong>CUT&amp;Tag-Motif Analysis</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/16.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/17.png" alt="1"></p>
<p><strong>CUT&amp;Tag-其他分析</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/18.png" alt="1"></p>
<p><strong>CUT&amp;Tag-联合RNA-seq分析</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/19.png" alt="1"></p>
<p>BETA 功能1，2。3用hommer更多</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/20.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/21.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/22.png" alt="1"></p>
<p>Activating/repressive function prediction</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/23.png" alt="1"></p>
<p>Target gene</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/24.png" alt="1"></p>
<p><strong>如何评估CUT&amp;Tag中IgG的作用</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/25.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/26.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/27.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/28.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/29.png" alt="1"></p>
<p>为何IgG信号和组蛋白信号同步出现？</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/30.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/31.png" alt="1"></p>
<p><strong>CUT&amp;Tag-Quality Control</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/32.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/33.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/34.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/35.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/36.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/37.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/38.png" alt="1"></p>
<p>组蛋白，转录起始激活marker，在起始TSS高；<strong>抑制</strong>的<strong>marker</strong>H3K36me3在<strong>genebody区域比较高</strong></p>
<p><strong>UCSC tools工具</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/39.png" alt="1"></p>
<p><strong>Cistrome：ChIP-seq在线分析工具</strong></p>
<p>提前查数据</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/40.png" alt="1"></p>
<p><strong>Motif数据库JASPAR</strong></p>
<p><strong>Motif工具MEME</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/41.png" alt="1"></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1py4y1a7L5/?spm_id_from=333.788.recommend_more_video.2">FraserGen</a></p>
<p>ATAC测序，Illumina PE150，测序数据量最终可用推荐：50M（开放区域），200M（TFfootprint）</p>
<p><strong>ATAC-seq项目展示 动物植物</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/42.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/43.png" alt="1"></p>
<p>注意trimmomatic 的NexteraPE-PE.fa;注意bowtie2 -X 最大插入片段长度设置1000/2000.</p>
<p><strong>插入片段长度统计</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/44.png" alt="1"></p>
<p><strong>-f 0x40 只统计reads1</strong>(统计一次indertsize)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Rscript plotInsertSize.R insertSize.txt insertSize.png</span></span><br><span class="line"><span class="comment">#plotInsertSize.R</span></span><br><span class="line">cmd=commandArgs(trailingOnly=<span class="literal">TRUE</span>);</span><br><span class="line">input=cmd[<span class="number">1</span>];</span><br><span class="line">output=cmd[<span class="number">2</span>];</span><br><span class="line">d=read.table(input);</span><br><span class="line">png(file=output);</span><br><span class="line">hist(d$V1,mian=<span class="string">&quot;&quot;</span>,ylab=<span class="string">&quot;readCount&quot;</span>,xlab=<span class="string">&quot;insertsize&quot;</span>,xaxt=<span class="string">&quot;n&quot;</span>,breaks=seq(<span class="number">0</span>,<span class="built_in">max</span>(d$V1,by=<span class="number">1</span>)));</span><br><span class="line">axis();</span><br><span class="line">dev.off;</span><br></pre></td></tr></table></figure>
<p><strong>Peak calling principle for atac</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/45.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/46.png" alt="1"></p>
<p>Shift -75 往5‘端移动；<strong>nomodel 不建立双峰模型</strong>；<strong>-SMPR对数据量标准化</strong></p>
<blockquote>
<p>单端测序时需要建立双峰模型推测DNA片段的长度。双端不需要</p>
<p>平移让Tn5切割断点处于reads正中心</p>
<p>-SMPR save signal per million reads</p>
</blockquote>
<p>BDG to BigWig【使用BDG转换的bigwig文件和bam转化bw，直接使用narrowpeak的区别是】</p>
<p>建议用bdg转换的bigwig文件，因为该文件做了平移shift和延伸extend</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/47.png" alt="1"></p>
<p><strong>Data Quality Assesment</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/48.png" alt="1"></p>
<p><strong>Data Visualization</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/49.png" alt="1"></p>
<p><strong>Multiple Replicates</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/50.png" alt="1"></p>
<p>IDR所有点代表有overlap，红点表示富集倍数有差异，黑点表示富集倍数一致。IDR在动物里算出的结果较好，植物由于实验问题效果没那么好（不推荐？），植物直接overlap-peak。</p>
<p><strong>Peak annotation</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/51.png" alt="1"></p>
<p><strong>Motif analysis</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/52.png" alt="1"></p>
<p><strong>个性化分析</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/53.png" alt="1"></p>
<p>TF网络需要多组数据不同处理条件下</p>
<p><strong>联合分析</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/54.png" alt="1"></p>
<p>表达程度越高信号越高。</p>
<p><strong>案例</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/55.png" alt="1"></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/56.png" alt="1"></p>
<p>H3K27me3 genebody</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/57.png" alt="1"></p>
<p>peak-to-gene link prediction【大样本量的ATAC和RNAseq关联分析】</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/58.png" alt="1"></p>
<hr>
<p><strong>CUT&amp;Tag</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/59.png" alt="1"></p>
<p>ChIP实验新方法：CUT&amp;RUN 和 CUT&amp;Tag 周期快；材料需求少；数据信噪比高</p>
<p><strong>C</strong>leavage <strong>U</strong>nder <strong>T</strong>argets and <strong>R</strong>elease <strong>U</strong>sing <strong>N</strong>uclease</p>
<p><strong>C</strong>leavage <strong>U</strong>nder <strong>T</strong>argets and <strong>Tag</strong>mentation</p>
<p><strong>原理介绍</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/60.png" alt="1"></p>
<p>蛋白磁珠吸附核膜，细胞绑定在磁珠上。细胞膜穿孔，pAG-MNase进入，primary Ab抗体加入。多余抗体多余pAG-MNase洗掉，<strong>pAG-MNase and primary Ab binding</strong>。加入钙离子激活，靶向位点切割，整个基因组少部分位置切割【背景噪音高低取决于抗体质量好坏】。只有切割的小片段从小孔出来(大部分背景遗留在核内)。CUT&amp;RUN用的pAG-MNase依然要补平加接头，替换为Protein-A-Tn5则变为CUT&amp;Tag，一天以内完成的&quot;ChIP&quot;实验。</p>
<p><strong>实验流程</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/61.png" alt="1"></p>
<p>文库片段分布和ATAC类似（Tn5，核小体）</p>
<p>IgG阴性对照帮助判断到底是ChIP峰还是ATAC峰(实验是否成功)。植物难度大，植物用原生质体。植物推荐做chip就行？动物冻存组织可尝试，植物冻存不推荐。CUT技术是针对少量细胞的。少量细胞可能数据量少。CUT&amp;Tag缺点是由于Tn5只做开放区域，若是异染色质H3K9，H3K39三甲基化这种marker做不了</p>
<p><strong>CUT&amp;Tag数据分析</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/62.png" alt="1"></p>
<p><strong>提升CUT&amp;Tag数据关键</strong></p>
<p>抗体质量：ChIP-grade；Western验证；抗体批次效应</p>
<p>细胞质量：活细胞比例&gt;95%(native chromatin )；细胞均一性</p>
<p><strong>MACS软件</strong></p>
<p>数据噪音评估</p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/63.png" alt="1"></p>
<p><strong>！！！Peak calling for ATAC</strong></p>
<p><img src="/blog/blog/2022/03/18/2022-03-19-CUT-Tag/64.png" alt="1"></p>
<p><font color="red"><strong>对于ATAC，一条DNA fragment代表两个酶切位点信息，转bed格式。如果用bam文件会默认丢掉reads2</strong></font></p>
<p><strong>Code</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#step1 去接头</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#step2 建立index</span></span><br><span class="line">ref.fa</span><br><span class="line">genes.gtf</span><br><span class="line">bowtie2 build</span><br><span class="line">samtools faidx ref.fa</span><br><span class="line"></span><br><span class="line"><span class="comment">#step3 比对</span></span><br><span class="line">bowtie2 -x index/ref -X 1000 -1 R1.fq -2 R2.fq -S .sam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step4 挑选可靠比对结果</span></span><br><span class="line">samtools view -b -f 2 -q 30 -0 pairs.bam .sam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step5 去除PCR重复</span></span><br><span class="line">samtools sort -o pairs.sorted.bam pairs.bam</span><br><span class="line">picard.jar MarkDuplicates</span><br><span class="line"></span><br><span class="line"><span class="comment">#step6 查看mito pt 污染</span></span><br><span class="line">samtools index pairs.sorted.dedup.bam</span><br><span class="line">samtools idxstats pairs.sorted.dedup.bam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step7 去除线粒体数据</span></span><br><span class="line">samtools view -h pairs.sorted.dedup.bam | grep -v <span class="string">&quot;chrM&quot;</span> | grep -v <span class="string">&quot;Pt&quot;</span> | samtools view -bS -o final.bam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step8 统计插入片段长度分布</span></span><br><span class="line">Rscript plotInsertSize final.bam final.insertsize</span><br><span class="line"></span><br><span class="line"><span class="comment">#step9 peak calling</span></span><br><span class="line">bedtools bamtobed -1 final.bam &gt; final.bam.bed</span><br><span class="line"></span><br><span class="line">macs2 callpeak -t final.bam.bed -n rep1 --<span class="built_in">shift</span> -100 --extsize 200 --nomodel -B --SPMR -g 2e</span><br><span class="line"></span><br><span class="line"><span class="comment">#step10 TSS富集</span></span><br><span class="line"><span class="comment">#BDG to BigWig</span></span><br><span class="line"><span class="comment">#UCSC utitlities</span></span><br><span class="line"><span class="comment">#对bdg文件排序</span></span><br><span class="line">bedSort treat.bdg treat.sort.bdg</span><br><span class="line"><span class="comment">#生成基因组各条序列长度信息，直接从bam文件得到</span></span><br><span class="line">samtools view -H final.bam | perl -ne <span class="string">&#x27;if(/SN:(\S+)\s+LN:(\d+)/)&#123;print &quot;$1\t$2\n&quot;&#125;&#x27;</span> &gt; chrome.sizes</span><br><span class="line"><span class="comment">#生成bigwig文件</span></span><br><span class="line">bedClip -truncate treat.sort.bdg chrome.sizes stdout | perl -ane <span class="string">&#x27;print if($F[1]&lt;$F[2])&#x27;</span> &gt; treat.bdegraph</span><br><span class="line">bedGraphToBigWig treat.bdegraph chrome.sizes treat.bw</span><br><span class="line"></span><br><span class="line">computeMatrix reference-point -S Rep1.bw Rep2.bw -R .gtf -a 3000 -b 3000 -p 1 -o matrix.gz</span><br><span class="line">plotHeatmap -m matrix.gz -o heatmap.png --colorMap Reds</span><br><span class="line"></span><br><span class="line"><span class="comment">#step11 peak重复性</span></span><br><span class="line">bedtools intersect -a .peak -b .peak | wc -l</span><br><span class="line">bedtools intersect -a .peak -b .peak -f 0.5 -F 0.5 | wc -l</span><br><span class="line">idr -s rep1.peak rep2.peak -o idr --plot</span><br><span class="line"></span><br><span class="line"><span class="comment">#step12 peak在基因上的分布</span></span><br><span class="line">Rscript PeakAnnotation.R .gtf rep1.peak Rep1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<p>IgG？</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/18/2022-03-18-annotation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/18/2022-03-18-annotation/" class="post-title-link" itemprop="url">Organelle assembly</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-18 14:23:16 / Modified: 14:25:05" itemprop="dateCreated datePublished" datetime="2022-03-18T14:23:16+08:00">2022-03-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/18/2022-03-18-annotation/" class="post-meta-item leancloud_visitors" data-flag-title="Organelle assembly" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>627</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>
<h1 id="structural-annotation"><a class="markdownIt-Anchor" href="#structural-annotation"></a> Structural annotation</h1>
<p>The genome structural annotation was performed using Maker-P【38】:</p>
<p>(1) SNAP and Augustus as ab initio gene predictors;</p>
<p>(2) Exonerate as experimental based predictor with 454 and Illumina RNASeq reads and protein sequences from different protein【39】datasets. RNAseq Illumina data was mapped using Tophat2. tRNAs were annotatedusing tRNAscan (<a target="_blank" rel="noopener" href="http://lowelab.ucsc.edu/tRNAscan-SE/">http://lowelab.ucsc.edu/tRNAscan-SE/</a>).</p>
<h1 id="functional-annotation"><a class="markdownIt-Anchor" href="#functional-annotation"></a> Functional annotation</h1>
<p>The gene functional annotation was performed by sequence homology search with different protein datasets using BlastP【40】 and protein domains search【41】using InterProScan . Functional annotations were integrated using AHRD(<a target="_blank" rel="noopener" href="https://github.com/groupschoof/AHRD">https://github.com/groupschoof/AHRD</a>). See Supplementary Note 1.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/18/2022-03-18-mito-chro/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/18/2022-03-18-mito-chro/" class="post-title-link" itemprop="url">Organelle assembly</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-18 13:35:37 / Modified: 21:51:27" itemprop="dateCreated datePublished" datetime="2022-03-18T13:35:37+08:00">2022-03-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/18/2022-03-18-mito-chro/" class="post-meta-item leancloud_visitors" data-flag-title="Organelle assembly" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>9.7k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>9 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <span id="more"></span>
<h1 id="mitochondrial-genome-assembly"><a class="markdownIt-Anchor" href="#mitochondrial-genome-assembly"></a> <strong>Mitochondrial Genome Assembly</strong></h1>
<h2 id="植物线粒体基因组-特点成因和后果"><a class="markdownIt-Anchor" href="#植物线粒体基因组-特点成因和后果"></a> <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/65471820#:~:text=%E6%A4%8D%E7%89%A9%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9A%84%E4%B8%BB%E8%A6%81%E7%89%B9%E7%82%B9%E6%98%AF%EF%BC%9A%20%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E5%92%8C%E7%BB%93%E6%9E%84%E5%8F%98%E5%BC%82%E5%B7%A8%E5%A4%A7%EF%BC%8C%E5%9F%BA%E5%9B%A0%E5%8D%B4%E6%9E%81%E5%BA%A6%E4%BF%9D%E5%AE%88%EF%BC%9B%E5%9F%BA%E5%9B%A0%E5%88%86%E5%B8%83%E9%9D%9E%E5%B8%B8%E7%A8%80%E7%96%8F%EF%BC%8C%E5%90%AB%E6%9C%89%E5%A4%A7%E9%87%8F%E9%9D%9E%E7%BC%96%E7%A0%81%E5%BA%8F%E5%88%97%EF%BC%9B%E5%AD%98%E5%9C%A8%E5%A4%A7%E9%87%8F%E7%9A%84RNA%E7%BC%96%E8%BE%91%E3%80%82,%E5%A4%A7%E9%83%A8%E5%88%86%E5%8A%A8%E7%89%A9%E7%9A%84%E7%8E%AF%E7%8A%B6%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9A%84%E5%A4%A7%E5%B0%8F%E7%BA%A615-17kb%EF%BC%8C%E4%B8%94%E7%BB%93%E6%9E%84%E7%9B%B8%E5%AF%B9%E4%BF%9D%E5%AE%88%EF%BC%8C%E5%9F%BA%E5%9B%A0%E6%8E%92%E5%88%97%E7%B4%A7%E5%87%91%EF%BC%8C%E8%BF%99%E4%BA%9B%E7%89%B9%E7%82%B9%E9%83%BD%E8%B7%9F%E6%A4%8D%E7%89%A9%E5%8F%B6%E7%BB%BF%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9B%B8%E4%BB%BF%EF%BC%8C%E6%A4%8D%E7%89%A9%E7%9A%84%E5%8F%B6%E7%BB%BF%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E5%9C%A8100-200kb%E4%B9%8B%E9%97%B4%E3%80%82%20%E7%84%B6%E8%80%8C%E6%A4%8D%E7%89%A9%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%8D%B4%E8%B7%9F%E5%89%8D%E4%B8%A4%E8%80%85%E6%9C%89%E7%9D%80%E8%BF%A5%E7%84%B6%E4%B8%8D%E5%90%8C%E7%9A%84%E7%89%B9%E6%80%A7%EF%BC%8C%E5%85%B6%E5%A4%A7%E5%B0%8F%E4%B8%80%E8%88%AC%E5%9C%A8200-750kb%E4%B9%8B%E9%97%B4%E3%80%82">植物线粒体基因组 特点，成因和后果</a></h2>
<p>植物线粒体基因组主要特点是：<strong>基因组大小和结构变异巨大，基因却极度保守；基因分布非常稀疏，含有大量非编码序列；存在大量的RNA编辑。</strong></p>
<ul>
<li>
<p>大部分<strong>动物环状线粒体基因组</strong>大小约<strong>15-17kb</strong>，且<strong>结构相对保守</strong>，<strong>基因排列紧凑</strong></p>
</li>
<li>
<p>动物线粒体跟<strong>植物叶绿体基因组相仿</strong>，<strong>植物叶绿体基因组</strong>大小在<strong>100-200kb之间</strong></p>
</li>
<li>
<p><strong>植物线粒体基因组</strong>却跟前两者迥然不同，大小在<strong>200-750kb</strong>之间。<strong>黄瓜</strong>线粒体基因组达<strong>1556kb</strong>。<strong>近缘</strong>物种间<strong>也差异巨大</strong>。如蝇子草属（<em>Silene</em>）中，夜花蝇子草（<em>S. noctiflora</em>）线粒体基因组<strong>6.728kb</strong>，而叉枝条蝇子草（<em>S. latifolia</em>）线粒体基因组<strong>253kb</strong>，<strong>同属</strong>植物差异30倍。即使<strong>同一物种</strong>，差异也显著。如白玉草（<em>S. vulgaris</em>），任何<strong>不同种群</strong>两两之间只有约一半的线粒体基因组序列相同。</p>
</li>
<li>
<p>植物线粒体<strong>基因组庞大</strong>，但<strong>编码基因却不多</strong>，排列稀疏。<strong>植物叶绿体基因组</strong>上约<strong>100个基因</strong>，但比叶绿体基因组大的<strong>拟南芥线粒体基因组</strong>，却只有约<strong>50多个基因</strong>，而人线粒体基因组37个基因。拟南芥<strong>线粒体基因数量</strong>不到人的<strong>两倍</strong>，其<strong>基因组大小</strong>却是<strong>22倍</strong>。植物线粒体基因组大部分是<strong>非编码序列</strong>，这些序列占到<strong>60%以上</strong>。这些非编码序列由<strong>重复片段、叶绿体基因组和和基因组转移而来</strong>的序列，甚至是<strong>基因水平转移</strong>获得的其它物种序列。如最<strong>古老的被子植物互叶梅</strong>（<em>Amborella trichopoda</em>）的线粒体基因组中，就有<strong>大量来自苔藓、绿藻和其它被子植物的序列片段</strong>（Rice, 2013）。</p>
</li>
<li>
<p>植物线粒体基因组<strong>结构变异巨大</strong>，线粒体<strong>基因</strong>却<strong>极度保守</strong>，在<strong>植物三套基因组中最保守演化速率最慢</strong>。黄瓜如此庞大线粒体基因组只比拟南芥多四个基因。由于植物线粒体基因<strong>非常保守，区分度不足</strong>，一般<strong>不选作系统学研究</strong>的<strong>分子标记</strong>。跟动物正好相反，<strong>动物的线粒体基因演化速率较快</strong>，所以在动物系统学研究中，是<strong>最常用的分子标记</strong>。</p>
</li>
<li>
<p><strong>是什么导致植物线粒体基因组如此庞大，如此多非编码序列？线粒体基因组基因保守原因是？目前理论是发生在线粒体非编码区和编码区的两套不同DNA修复机制。</strong></p>
</li>
<li>
<p>植物线粒体<strong>编码区</strong>进行的是<strong>碱基剪切修复</strong>（Base excision repair）和<strong>基因转换</strong>（gene conversion）介导的<strong>精确</strong>修复，而在非编码区进行的是<strong>非同源性末端连接</strong>（non-homologous end joining）和<strong>断裂诱导复制</strong>（Break-induced replication）介导的<strong>非精确</strong>修复（Christensen, 2013）</p>
</li>
</ul>
<p><img src="/blog/blog/2022/03/18/2022-03-18-mito-chro/1.png" alt="img"></p>
<ul>
<li>编码区精确修复导致线粒体基因变异稀少，演化速率非常慢。非编码区非精确修复，修复过程带来很多外来序列，使得非编码区非常包容，不断吸收积累非编码序列</li>
<li>后果。植物线粒体基因组中大量非编码序列，其中很多重复片段，导致植物线粒体基因组 易重组。叶绿体基因组在细胞内常以完整环状存在，植物线粒体会重组形成线状结构，甚至很多大小不一的环。黄瓜有1.6M+84k+45k线粒体基因组(大小环)。完整测出的mito 远小于chro</li>
</ul>
<h2 id="植物线粒体基因组测序"><a class="markdownIt-Anchor" href="#植物线粒体基因组测序"></a> 植物线粒体基因组测序</h2>
<p><a target="_blank" rel="noopener" href="http://www.genepioneer.com/display.php?id=353">http://www.genepioneer.com/display.php?id=353</a></p>
<ul>
<li>
<p>动物线粒体基因组较小，通常在10-39kb，而植物线粒体基因组大小在200-750kb。植物线粒体基因组主要特点是：基因组大小和结构变异巨大；基因却极度保守；基因分布非常稀疏；含有大量非编码序列；存在大量的RNA编辑</p>
</li>
<li>
<p>公司套路：二代+三代植物线粒体基因组测序</p>
<ul>
<li><strong>基因组注释</strong>进行<strong>基因序列组成分析</strong>来研究<strong>物种功能特征</strong></li>
<li><strong>比较基因组学</strong>研究物<strong>种间基因组结构变化</strong>探讨物<strong>种的环境适应性特征</strong></li>
<li><strong>群体基因组研究</strong>内容更广：<strong>物种起源、亲缘分类、系统发育、谱系地理</strong>等</li>
</ul>
</li>
<li>
<p>公司常规分析</p>
<ul>
<li>线粒体基因组结构注释</li>
<li>线粒体基因组图谱</li>
<li>RSCU分析</li>
<li>散在重复序列分析</li>
<li>碱基偏移分析</li>
</ul>
</li>
<li>
<p>公司高级分析</p>
<ul>
<li>KaKs分析</li>
<li>线粒体结构比较分析</li>
<li>进化树分析</li>
<li>序列同源及共线性分析</li>
<li>基因水平转移分析</li>
</ul>
</li>
<li>
<p>案例1</p>
<ul>
<li><a href="doi.org/10.1186/s12862-020-1582-1">紫衫线粒体基因组</a>：8个蛋白基因转移到核基因组。对紫衫线粒体基因组测序，得到全长<font color="blue"><strong>468,924bp</strong></font>线粒体基因组序列与<strong>其它4个裸子植物谱系</strong>的<strong>线粒体基因组</strong>比较。结果表明裸子植物线粒体基因组在<strong>大小、结构、基因和内含子含量、外源序列、突变率</strong>等方面与<strong>被子植物</strong>线粒体基因组<strong>存在差异</strong>。</li>
<li><a href="DOI%EF%BC%9A10.7717/peerj.3148">红柳线粒体全基因组序列的组装与比较分析</a> : 组装得到全长<font color="blue"><strong>644,437bp</strong></font>完整的红柳线粒体 (mt) 序列。编码<font color="blue"><strong>58个独特基因</strong></font>（32个蛋白编码基因、23个tRNA基因和3个rRNA基因）。通过对35种杨树的23个蛋白编码基因<strong>系统发育分析</strong>，证明<strong>红柳是杨树的姊妹</strong>。</li>
</ul>
</li>
</ul>
<h2 id="software-2019reviewdoi-1016288jyczz19-227"><a class="markdownIt-Anchor" href="#software-2019reviewdoi-1016288jyczz19-227"></a> [software-2019review](DOI: 10.16288/j.yczz.19-227)</h2>
<ul>
<li>特殊且容易获取的遗传标记，高突变速率(not plant)、无基因重组、高拷贝数和母系遗传等</li>
<li>进化生物学、群体遗传学等揭示物种的起源和扩散历史发挥作用。核基因和线粒体表现不一致的谱系关系，特别是具有复杂的群体历史的类群(如<strong>基因交流</strong>、<strong>遗传漂变</strong>、<strong>偏向性迁徙</strong>和<strong>祖先谱系分拣</strong>等)。</li>
<li>有参：近缘物种的线粒体基因组或部分片段作为参考序列，从研究类群全基因组数据中捕获线粒体reads。(1)基于线粒体<strong>整个</strong>基因组的拼装策略；(2)基于线粒体<strong>片段</strong>的拼装策略。使用比对工具(如BWA)将总reads映射(mapping)到线粒体参考序列，根据<strong>序列的相似性捕获</strong>线粒体reads，然后使用不同序列延长策略对捕获的线粒体reads序列延伸，直到延长到完整的线粒体基因组长度。<strong>MIA</strong>用现代人线粒体基因组作参考研究尼安德特人。</li>
<li>denovo：线粒体contig分拣</li>
</ul>
<table>
<thead>
<tr>
<th>软件名称</th>
<th>是否需要参考序列/ 参考序列类型</th>
<th>适用 物种</th>
<th>输入文件格式、 类型</th>
<th>变异 注释</th>
<th>结构可 视化</th>
<th>运行 环境</th>
<th>编程 语言</th>
</tr>
</thead>
<tbody>
<tr>
<td>MIA</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Fastq、SE reads和 PE reads</td>
<td>×</td>
<td>×</td>
<td>CUI</td>
<td>C/C++</td>
</tr>
<tr>
<td>MitoBamAnnotator</td>
<td>是/ rCRS</td>
<td>人</td>
<td>Bam</td>
<td>√</td>
<td>√</td>
<td>Web</td>
<td>Java</td>
</tr>
<tr>
<td>MitoSeek</td>
<td>是/rCRS和hg19</td>
<td>人</td>
<td>Bam</td>
<td>√</td>
<td>×</td>
<td>GUI</td>
<td>Perl</td>
</tr>
<tr>
<td>mtDNA- profiler</td>
<td>是/rCRS</td>
<td>人</td>
<td>Fasta</td>
<td>×</td>
<td>√</td>
<td>Web</td>
<td>Java</td>
</tr>
<tr>
<td>MITObim</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Bam</td>
<td>×</td>
<td>×</td>
<td>CUI</td>
<td>Perl</td>
</tr>
<tr>
<td>Mit-o-matic</td>
<td>是/rCRS</td>
<td>人</td>
<td>Fastq、SE reads和 PE reads</td>
<td>√</td>
<td>√</td>
<td>Web/GUI</td>
<td>Java</td>
</tr>
<tr>
<td>MToolBox</td>
<td>是/rCRS和RSRS</td>
<td>人</td>
<td>Fastq/Bam/Sam、 SE reads和PE reads</td>
<td>√</td>
<td>×</td>
<td>Web/CUI</td>
<td>Python</td>
</tr>
<tr>
<td>ARC</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Fastq、SE reads和 PE reads</td>
<td>×</td>
<td>×</td>
<td>Web/CUI</td>
<td>Python</td>
</tr>
<tr>
<td>Phy-Mer</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Fasta/fastq/Bam、 SE reads和PE reads</td>
<td>×</td>
<td>√</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td>mtDNA- Server</td>
<td>是/rCRS和RSRS</td>
<td>人</td>
<td>Fastq/Bam/VCF、 SE reads和PE reads</td>
<td>√</td>
<td>√</td>
<td>Web</td>
<td>Java</td>
</tr>
<tr>
<td>IOGA</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Fastq、SE reads和 PE reads</td>
<td>×</td>
<td>×</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td>NOVOPlasty</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Fastq/fasta、SE reads 和PE reads</td>
<td>×</td>
<td>×</td>
<td>Web/CUI</td>
<td>Perl</td>
</tr>
<tr>
<td>Norgal</td>
<td>否</td>
<td>任意 物种</td>
<td>Fastq、SE reads和 PE reads</td>
<td>×</td>
<td>×</td>
<td>CUI</td>
<td>Python/ Java</td>
</tr>
<tr>
<td>Organelle- PBA</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>PacBio reads</td>
<td>×</td>
<td>×</td>
<td>CUI</td>
<td>Perl</td>
</tr>
<tr>
<td>MitoSuite</td>
<td>是/rCRS, RSRS, hg19, GRCh37和38</td>
<td>人</td>
<td>Bam/Sam</td>
<td>√</td>
<td>√</td>
<td>GUI</td>
<td>Python</td>
</tr>
<tr>
<td>ORG.Asm</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Fastq、SE reads和 PE reads</td>
<td>×</td>
<td>×</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td>MitoZ</td>
<td>否</td>
<td>任意 物种</td>
<td>Fastq、SE reads和 PE reads</td>
<td>√</td>
<td>√</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td><strong>GetOrganelle</strong></td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>Fastq、SE reads和 PE reads</td>
<td>×</td>
<td>×</td>
<td><strong>CUI</strong></td>
<td>Python</td>
</tr>
<tr>
<td>Trimitomics</td>
<td>是/自定义参考序列</td>
<td>任意 物种</td>
<td>RNA-seq reads、 PE reads</td>
<td>×</td>
<td>×</td>
<td>Unknown</td>
<td>Unknown</td>
</tr>
</tbody>
</table>
<h2 id="软件getorganelle"><a class="markdownIt-Anchor" href="#软件getorganelle"></a> 软件GetOrganelle</h2>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/428949195">https://zhuanlan.zhihu.com/p/428949195</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle">https://github.com/Kinggerm/GetOrganelle</a></p>
<p>GetOrganelle是中科院昆植所金建军和郁文彬老师共同开发的<strong>质体组装软件</strong>，<strong>2020-Genome Biology</strong>。</p>
<h3 id="核心流程"><a class="markdownIt-Anchor" href="#核心流程"></a> 核心流程</h3>
<p>1）通过“种子”序列获得部分目标相关reads；</p>
<p>2）延伸reads获得所有目标相关reads；</p>
<p>3）对reads进行从头组装得到组装图形；</p>
<p>4）过滤组装图形；</p>
<p>5）识别细胞器组分并自动导出所有可能的细胞器基因组结构。</p>
<p><img src="/blog/blog/2022/03/18/2022-03-18-mito-chro/2.png" alt="flowchart"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n getorganelle</span><br><span class="line">conda activate getorganelle</span><br><span class="line">conda install getorganelle</span><br></pre></td></tr></table></figure>
<p><strong>下载参考序列库</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_config.py --add embplant_pt,embplant_mt</span><br><span class="line"><span class="comment">#embplant_pt(高等植物叶绿体)</span></span><br><span class="line"><span class="comment">#embplant_mt(高等植物线粒体)</span></span><br><span class="line"><span class="comment">#embplant_nr(高等植物核糖体 RNA)</span></span><br><span class="line"><span class="comment">#animal_mt (动物线粒体)</span></span><br><span class="line"><span class="comment">#fungus_mt (真菌线粒体)</span></span><br></pre></td></tr></table></figure>
<p>If connection keeps failing, please manually download the latest database from <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelleDB">GetOrganelleDB</a> and <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/Initialization#option-2-initialization-from-local-files">initialization from local files</a>.</p>
<p>The database will be located at <code>~/.GetOrganelle</code> by default, which can be changed via the command line parameter <code>--config-dir</code>, or via the shell environment variable <code>GETORG_PATH</code> (see more <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/Initialization">here</a>).</p>
<h3 id="参数"><a class="markdownIt-Anchor" href="#参数"></a> 参数</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-1 双端测序的R1</span><br><span class="line">-2 双端测序的R2</span><br><span class="line">-o 结果文件，结果输出保存的目录(文件夹)名称</span><br><span class="line">-F 数据库，设定要组装的基因组类型</span><br><span class="line">-s 参考序列</span><br><span class="line">-t 线程数</span><br><span class="line">-R 最大的一个扩充循环的数，一般默认15，提取基因 reads 的轮次(轮次越多,耗时越长)</span><br><span class="line">-k kmer的一个参数，调用SPAdes进行denovo组装的k-mer,数值必须是奇数, 最大值是127</span><br><span class="line">-w 提取叶绿体基因reads 时使用的长度比例或实际长度</span><br><span class="line"><span class="comment">#word-size：提取叶绿体基因reads 时，可以使用reads 长度的比例(ratio)，也可以设置实际长度的word-size。例如：如果使用ratio=0.6, 即 reads长度是150bp时，设置的word-size = 90bp，等同于设置 “-w 90”。</span></span><br></pre></td></tr></table></figure>
<h3 id="基本用法"><a class="markdownIt-Anchor" href="#基本用法"></a> 基本用法</h3>
<p><strong>Starting from reads</strong></p>
<p>The <font color="green"><strong>green workflow</strong></font> in the flowchart  shows the processes of <code>get_organelle_from_reads.py</code>.</p>
<ul>
<li>
<p><strong>Input data</strong></p>
<p>Currently, <code>get_organelle_from_reads.py</code> was written for <strong>illumina pair-end/single-end data</strong> (fastq or fastq.gz). We recommend using <strong>adapter-trimmed</strong> raw reads without quality control. Usually, <strong>&gt;1G</strong> per end is enough for <strong>plastome</strong> for most normal angiosperm samples, and <strong>&gt;5G</strong> per end is enough for <strong>mitochondria</strong> genome assembly. Since v1.6.2, <code>get_organelle_from_reads.py</code> will <strong>automatically estimate the read data it needs</strong>, without user assignment nor data reducing (see flags <code>--reduce-reads-for-coverage</code> and <code>--max-reads</code>).</p>
</li>
<li>
<p><strong>Main Options</strong></p>
<ul>
<li><code>-w</code> The value word size, like the kmer in assembly, is crucial to the <strong>feasibility and efficiency</strong> of this process. The <strong>best word size changes upon data and will be affected</strong> by read length, read quality, base coverage, organ DNA percent and other factors. By default, GetOrganelle would <strong>automatically estimate a proper word siz</strong>e based on the data characters. Although the automatically-estimated word size value does not ensure the best performance nor the best result, <font color="green">you do not need to adjust this value</font> (<code>-w</code>) if a complete/circular organelle genome assembly is produced, because the circular result generated by GetOrganelle is highly consistent under different options and seeds. The automatically estimated word size may be screwy in some animal mitogenome data due to inaccurate coverage estimation, for which you fine-tune it instead.</li>
<li><code>-k</code> The best kmer(s) depend on a wide variety of factors too. Although more kmer values add the time consuming, you are recommended to use a wide range of kmers to benefit from the power of SPAdes. Empirically, you should include <strong>at least</strong> including <strong>one small</strong> kmer (e.g. <code>21</code>) and <strong>one large</strong> kmer (<code>105</code>) for a successful organelle genome assembly.</li>
<li><code>-s</code> GetOrganelle takes the seed (fasta format; if this was not provided, the default is <code>GetOrganelleLib/SeedDatabase/*.fasta</code>) as probe, the script would recruit target reads in successive rounds (extending process). <strong>The default seed works for most samples</strong>, but using a complete organelle genome sequence of a <strong>related species as the seed would help the assembly</strong> in many cases (e.g. degraded DNA samples, fastly-evolving in animal/fungal samples; see more <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#how-to-assemble-a-target-organelle-genome-using-my-own-reference">here</a>).</li>
</ul>
</li>
<li>
<p><strong>Key Results</strong></p>
<p>The key output files include</p>
<ul>
<li><code>*.path_sequence.fasta</code>, each fasta file represents one type of genome structure</li>
<li><code>*.selected_graph.gfa</code>, the <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-only assembly graph</a></li>
<li><code>get_org.log.txt</code>, the log file</li>
<li><code>extended_K*.assembly_graph.fastg</code>, the raw assembly graph</li>
<li><code>extended_K*.assembly_graph.fastg.extend_embplant_pt-embplant_mt.fastg</code>, a simplified assembly graph</li>
<li><code>extended_K*.assembly_graph.fastg.extend_embplant_pt-embplant_mt.csv</code>, a tab-format contig label file for bandage visualization</li>
</ul>
<p>You may delete the files other than above if the resulting genome is complete (indicated in the log file and the name of the <code>*.fasta</code>). You are expected to obtain the complete organelle genome assembly for most animal/fungal mitogenomes and plant chloroplast genomes (see <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#why-does-getorganelle-generate-a-circular-genome-for-embplant_nrfungus_nr">here for nuclear ribosomal DNAs</a>) with the recommended recipes.</p>
<p>If GetOrganelle <strong>failed</strong> to <strong>generate the complete circular genome</strong> (produce <code>*scaffolds*path_sequence.fasta</code>), please follow <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#what-should-i-do-with-incomplete-resultbroken-assembly-graph">here</a> to <strong>adjust your parameters for a second run</strong>. You could also use the incomplete sequence to conduct downstream analysis.</p>
</li>
</ul>
<p>#植物2G左右数据，<strong>组装叶绿体基因组</strong>用</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o plastome_output -R 15 -k 21,45,65,85,105 -F embplant_pt</span><br></pre></td></tr></table></figure>
<p>#更快的方法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o plastome_output --fast -k 21,65,105 -w 0.68 -F embplant_pt</span><br></pre></td></tr></table></figure>
<p>#组装<strong>植物线粒体基因组</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o mitochondria_output -R 50 -k 21,45,65,85,105 -P 1000000 -F embplant_mt</span><br><span class="line"><span class="comment"># -P pre grouping value. default 20 0000</span></span><br><span class="line"><span class="comment"># 1. please use the 【FASTG file as the final output】 for downstream manual processing. until further updates, the FASTA output of plant mitochondria genome of numerous repeats may be error-prone</span></span><br><span class="line"><span class="comment"># 2. embplant_mt mode was not tested in the GetOrganelle paper due to the complexity of plant mitogenomes and the defects of short reads</span></span><br></pre></td></tr></table></figure>
<p>#组装<strong>植物核核糖体DNA</strong>片段</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o nr_output -R 10 -k 35,85,115 -F embplant_nr</span><br></pre></td></tr></table></figure>
<p>#组装真菌线粒体</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -R 10 -k 21,45,65,85,105 -F fungus_mt -o fungus_mt_out</span><br></pre></td></tr></table></figure>
<p>#组装动物线粒体</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -R 10 -k 21,45,65,85,105 -F animal_mt -o animal_mt_out</span><br></pre></td></tr></table></figure>
<p>得到的文件有complete代表拼接成环。</p>
<p><strong>GetOrganelle --assembly 开始</strong></p>
<p>The <font color="blue"><strong>blue workflow</strong></font> in the chat shows the processes of <code>get_organelle_from_assembly.py</code>.</p>
<ul>
<li>
<p><strong>Input data &amp; Main Options</strong></p>
<ul>
<li><code>-g</code> The input must be a FASTG or GFA formatted assembly graph file.</li>
<li>If you input an assembly graph assembled from total DNA sequencing using third-party a de novo assembler (e.g. Velvet), the assembly graph may includes a great amount of non-target contigs. You may want to use <code>--min-depth</code> and <code>--max-depth</code> to greatly reduce the computational burden for target extraction.</li>
<li>If you input an <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-equivalent assembly graph</a> (e.g. manually curated and exported using Bandage), you may use <code>--no-slim</code>.</li>
</ul>
</li>
<li>
<p><strong>Key Results</strong></p>
<p>The key output files include</p>
<ul>
<li><code>*.path_sequence.fasta</code>, one fasta file represents one type of genome structure</li>
<li><code>*.selected_graph.gfa</code>, the <a target="_blank" rel="noopener" href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-only assembly graph</a></li>
<li><code>get_org.log.txt</code>, the log file</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_organelle_from_assembly.py -g assembly_graph.fastg -F embplant_pt -o output-plastome</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-g      SPAdes组装得到的FASTG的assembly graph</span><br><span class="line">-F      设定要组装的基因组类型</span><br><span class="line">-o      结果输出保存的目录(文件夹)名称</span><br><span class="line">--min-depth  剔除graph中depth低于阈值的contigs</span><br><span class="line">--max-depth    剔除graph中depth高于阈值的contigs</span><br><span class="line">--min-depth 10 和“--max-depth10000”这两条命令是备选的，具体的depth需要可以自行设定。</span><br></pre></td></tr></table></figure>
<p><strong>GetOrganelle --graph.gfa开始</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gfa_to_fastg.py graph.gfa</span><br><span class="line">get_organelle_from_assembly.py -g graph.gfa.fastg -F embplant_pt -o output-plastome --no-slim</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-g     Bandage梳理后转换为fastg的graph*</span><br><span class="line">-F     设定要组装的基因组类群:embplant_pt(叶绿体),embplant_mt(线粒体)和embplant_nr(核糖体 RNA)</span><br><span class="line">-o     结果输出保存的目录(文件夹)名称</span><br></pre></td></tr></table></figure>
<blockquote>
<p>*，使用Bandage编辑后，可以“merge all possible nodes”，然后再输出的文件格式gfa图形文件，gfa文件可以用gfa_to_fastg.py做一下转换。虽然gfa也是图形文件，但是图形内容与fastg有差异些复杂图形会输出失败。</p>
</blockquote>
<h1 id="chloroplast-genome-assembly"><a class="markdownIt-Anchor" href="#chloroplast-genome-assembly"></a> Chloroplast Genome Assembly**</h1>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/" class="post-title-link" itemprop="url">HiFi-7-[HiFi+HiC-assembly-method]</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-16 09:44:47" itemprop="dateCreated datePublished" datetime="2022-03-16T09:44:47+08:00">2022-03-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-17 16:52:22" itemprop="dateModified" datetime="2022-03-17T16:52:22+08:00">2022-03-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/" class="post-meta-item leancloud_visitors" data-flag-title="HiFi-7-[HiFi+HiC-assembly-method]" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>20 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>辅助组装案例2</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/" class="post-title-link" itemprop="url">HiFi-6-[HiFi-HiC-assembly-method]</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-14 16:09:34" itemprop="dateCreated datePublished" datetime="2022-03-14T16:09:34+08:00">2022-03-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-15 22:19:04" itemprop="dateModified" datetime="2022-03-15T22:19:04+08:00">2022-03-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/" class="post-meta-item leancloud_visitors" data-flag-title="HiFi-6-[HiFi-HiC-assembly-method]" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>48k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>44 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>辅助组装案例</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/" class="post-title-link" itemprop="url">HiFi-5-[HiC-Pro]-[MCscan]-[ALLHiC]</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-09 15:39:23" itemprop="dateCreated datePublished" datetime="2022-03-09T15:39:23+08:00">2022-03-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-16 20:28:02" itemprop="dateModified" datetime="2022-03-16T20:28:02+08:00">2022-03-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/" class="post-meta-item leancloud_visitors" data-flag-title="HiFi-5-[HiC-Pro]-[MCscan]-[ALLHiC]" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>24k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>22 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>HiC-Pro将fq文件处理成互作allValidPairs，再转化成可视化hic文件(for juicer)</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/06/2022-03-06-Linux-grid/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/06/2022-03-06-Linux-grid/" class="post-title-link" itemprop="url">【Linux集群任务调度系统】【LSF/SGE/Slurm/PBS】【grid】</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-06 23:16:52" itemprop="dateCreated datePublished" datetime="2022-03-06T23:16:52+08:00">2022-03-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-07 21:39:18" itemprop="dateModified" datetime="2022-03-07T21:39:18+08:00">2022-03-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/06/2022-03-06-Linux-grid/" class="post-meta-item leancloud_visitors" data-flag-title="【Linux集群任务调度系统】【LSF/SGE/Slurm/PBS】【grid】" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>10 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>调度器主要是基于<strong>HPC场景</strong>的<strong>集群任务调度系统</strong>，英文<strong>Cluster Scheduler</strong>、<strong>Job Scheduler</strong>等。</p>
<p>市面主流调度器有四大流派：<font color="red"><strong>LSF   SGE   Slurm   PBS</strong></font></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/03/06/2022-03-06-Linux-grid/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/05/2022-03-02-HiFi-4-BUSCO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/05/2022-03-02-HiFi-4-BUSCO/" class="post-title-link" itemprop="url">HiFi-4-QC-BUSCO</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-05 20:45:15" itemprop="dateCreated datePublished" datetime="2022-03-05T20:45:15+08:00">2022-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-07 21:39:47" itemprop="dateModified" datetime="2022-03-07T21:39:47+08:00">2022-03-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/05/2022-03-02-HiFi-4-BUSCO/" class="post-meta-item leancloud_visitors" data-flag-title="HiFi-4-QC-BUSCO" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>11 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>BUSCO - <strong>B</strong>enchmarking <strong>U</strong>niversal <strong>S</strong>ingle-<strong>C</strong>opy <strong>O</strong>rthologs</p>
<p>普遍通用的单拷贝直系同源测试?</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/03/05/2022-03-02-HiFi-4-BUSCO/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/02/2022-03-02-paper-Petunia/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/02/2022-03-02-paper-Petunia/" class="post-title-link" itemprop="url">【paper】Insight into the evolution of the Solanaceae from the parental genomes of Petunia hybrida</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-02 19:46:05 / Modified: 19:54:46" itemprop="dateCreated datePublished" datetime="2022-03-02T19:46:05+08:00">2022-03-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/paper/" itemprop="url" rel="index"><span itemprop="name">paper</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/02/2022-03-02-paper-Petunia/" class="post-meta-item leancloud_visitors" data-flag-title="【paper】Insight into the evolution of the Solanaceae from the parental genomes of Petunia hybrida" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>1 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Solanaceae 茄科</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/03/02/2022-03-02-paper-Petunia/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://wangc1106.github.io/blog/2022/03/02/2022-03-02-HiFi-3-software/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/banner.png">
      <meta itemprop="name" content="Wang C">
      <meta itemprop="description" content="Make more time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Banner's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/03/02/2022-03-02-HiFi-3-software/" class="post-title-link" itemprop="url">HiFi-3-assemble-software</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-03-02 09:08:25" itemprop="dateCreated datePublished" datetime="2022-03-02T09:08:25+08:00">2022-03-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-06 23:12:39" itemprop="dateModified" datetime="2022-03-06T23:12:39+08:00">2022-03-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a>
                </span>
            </span>

          
            <span id="/blog/2022/03/02/2022-03-02-HiFi-3-software/" class="post-meta-item leancloud_visitors" data-flag-title="HiFi-3-assemble-software" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>20 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Hifiasm is a <font color="blue"><strong>fast haplotype-resolved de novo assembler</strong></font> for <font color="blue"><strong>PacBio HiFi reads(High Fidelity,high accuracy consensus reads)</strong></font>. HiCanu, Hifiasm, BUSCO, Peregrine, minimap2</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/03/02/2022-03-02-HiFi-3-software/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/4/">4</a><a class="extend next" rel="next" href="/blog/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wang C"
      src="/blog/images/banner.png">
  <p class="site-author-name" itemprop="name">Wang C</p>
  <div class="site-description" itemprop="description">Make more time</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives">
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wangc1106" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wangc1106" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wangchen116@126.com" title="E-Mail → mailto:wangchen116@126.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/blog/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fas fa-dna"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wang C</span>
</div>

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"UqIYufmNk2sE8MiBKKWc4Kja-gzGzoHsz","app_key":"iYpeWQcmNqpHwr2uVlnJYVji","server_url":null,"security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
      <div style="height: 200px">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5knf34gs07t&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"></script>
      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>




  




  
<script src="/blog/js/local-search.js"></script>













  

  

</body>
</html>
