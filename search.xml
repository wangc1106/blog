<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ã€CUT-Tagã€‘ã€ATAC-seqã€‘</title>
    <url>/blog/2022/03/18/2022-03-19-CUT-Tag/</url>
    <content><![CDATA[<p>CUT&amp;RUN CUT&amp;Tag ChIP-seq ATAC-seq</p>
<span id="more"></span>

<p><a href="https://www.bilibili.com/video/BV11K4y147fN?from=search&seid=6789892139579942949&spm_id_from=333.337.0.0">å˜‰å› ç”Ÿç‰©</a></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/1.png" alt="1"></p>
<p><strong>æµ‹åºæ•°æ®é‡</strong></p>
<p>å‚è€ƒChIP-seq 20M/40Mï¼ˆ2000ä¸‡readsï¼‰ï¼ˆå¯¹PE50çº¦ä¸º 6/12Gï¼‰</p>
<p><strong>CUT&amp;Tag-å»é™¤æµ‹åºæ¥å¤´</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/2.png" alt="1"></p>
<p><strong>å»æ¥å¤´è½¯ä»¶</strong></p>
<p>Trimmomaticï¼›Cutadaptï¼›fastp</p>
<p><strong>å‚è€ƒåºåˆ—æ¯”å¯¹</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/3.png" alt="1"></p>
<p><strong>æ•°æ®è¿‡æ»¤</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/4.png" alt="1"></p>
<p><strong>CUT&amp;Tagç‰‡æ®µé•¿åº¦åˆ†å¸ƒ</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/5.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/6.png" alt="1"></p>
<p><strong>CUT&amp;Tag-ç»“åˆä½ç‚¹æ£€æµ‹ï¼ˆPeakCallingï¼‰</strong></p>
<p>MACS2 ä¸»æµ</p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/7.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/8.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/9.png" alt="9"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/10.png" alt="1"></p>
<p>SEACR ç»“æœæ²¡é‚£ä¹ˆå¥½</p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/11.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/12.png" alt="1"></p>
<p><strong>CUT&amp;Tag-ç»“åˆä½ç‚¹ä¿¡å·åˆ†å¸ƒ</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/13.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/14.png" alt="1"></p>
<p><strong>CUT&amp;Tag-Peaks åŠŸèƒ½æ€§åŒºåŸŸæ³¨é‡Š</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/15.png" alt="1"></p>
<p><strong>CUT&amp;Tag-Motif Analysis</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/16.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/17.png" alt="1"></p>
<p><strong>CUT&amp;Tag-å…¶ä»–åˆ†æ</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/18.png" alt="1"></p>
<p><strong>CUT&amp;Tag-è”åˆRNA-seqåˆ†æ</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/19.png" alt="1"></p>
<p>BETA åŠŸèƒ½1ï¼Œ2ã€‚3ç”¨hommeræ›´å¤š</p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/20.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/21.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/22.png" alt="1"></p>
<p>Activating/repressive function prediction</p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/23.png" alt="1"></p>
<p>Target gene</p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/24.png" alt="1"></p>
<p><strong>å¦‚ä½•è¯„ä¼°CUT&amp;Tagä¸­IgGçš„ä½œç”¨</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/25.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/26.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/27.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/28.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/29.png" alt="1"></p>
<p>ä¸ºä½•IgGä¿¡å·å’Œç»„è›‹ç™½ä¿¡å·åŒæ­¥å‡ºç°ï¼Ÿ</p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/30.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/31.png" alt="1"></p>
<p><strong>CUT&amp;Tag-Quality Control</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/32.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/33.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/34.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/35.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/36.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/37.png" alt="1"></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/38.png" alt="1"></p>
<p>ç»„è›‹ç™½ï¼Œè½¬å½•èµ·å§‹æ¿€æ´»markerï¼Œåœ¨èµ·å§‹TSSé«˜ï¼›<strong>æŠ‘åˆ¶</strong>çš„<strong>marker</strong>H3K36me3åœ¨<strong>genebodyåŒºåŸŸæ¯”è¾ƒé«˜</strong></p>
<p><strong>UCSC toolså·¥å…·</strong></p>
<p><img src="/blog/2022/03/18/2022-03-19-CUT-Tag/39.png" alt="1"></p>
<p><strong>Cistromeï¼šChIP-seqåœ¨çº¿åˆ†æå·¥å…·</strong></p>
<p>æå‰æŸ¥æ•°æ® </p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/40.png" alt="1"></p>
<p><strong>Motifæ•°æ®åº“JASPAR</strong></p>
<p><strong>Motifå·¥å…·MEME</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/41.png" alt="1"></p>
<p><a href="https://www.bilibili.com/video/BV1py4y1a7L5/?spm_id_from=333.788.recommend_more_video.2">FraserGen</a></p>
<p>ATACæµ‹åºï¼ŒIllumina PE150ï¼Œæµ‹åºæ•°æ®é‡æœ€ç»ˆå¯ç”¨æ¨èï¼š50Mï¼ˆå¼€æ”¾åŒºåŸŸï¼‰ï¼Œ200Mï¼ˆTFfootprintï¼‰</p>
<p><strong>ATAC-seqé¡¹ç›®å±•ç¤º åŠ¨ç‰©æ¤ç‰©</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/42.png" alt="1"></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/43.png" alt="1"></p>
<p>æ³¨æ„trimmomatic çš„NexteraPE-PE.fa;æ³¨æ„bowtie2 -X æœ€å¤§æ’å…¥ç‰‡æ®µé•¿åº¦è®¾ç½®1000/2000.</p>
<p><strong>æ’å…¥ç‰‡æ®µé•¿åº¦ç»Ÿè®¡</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/44.png" alt="1"></p>
<p><strong>-f 0x40 åªç»Ÿè®¡reads1</strong>(ç»Ÿè®¡ä¸€æ¬¡indertsize)</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Rscript plotInsertSize.R insertSize.txt insertSize.png</span></span><br><span class="line"><span class="comment">#plotInsertSize.R</span></span><br><span class="line">cmd=commandArgs(trailingOnly=<span class="literal">TRUE</span>);</span><br><span class="line">input=cmd[<span class="number">1</span>];</span><br><span class="line">output=cmd[<span class="number">2</span>];</span><br><span class="line">d=read.table(input);</span><br><span class="line">png(file=output);</span><br><span class="line">hist(d$V1,mian=<span class="string">&quot;&quot;</span>,ylab=<span class="string">&quot;readCount&quot;</span>,xlab=<span class="string">&quot;insertsize&quot;</span>,xaxt=<span class="string">&quot;n&quot;</span>,breaks=seq(<span class="number">0</span>,<span class="built_in">max</span>(d$V1,by=<span class="number">1</span>)));</span><br><span class="line">axis();</span><br><span class="line">dev.off;</span><br></pre></td></tr></table></figure>

<p><strong>Peak calling principle for atac</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/45.png" alt="1"></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/46.png" alt="1"></p>
<p>Shift -75 å¾€5â€˜ç«¯ç§»åŠ¨ï¼›<strong>nomodel ä¸å»ºç«‹åŒå³°æ¨¡å‹</strong>ï¼›**-SMPRå¯¹æ•°æ®é‡æ ‡å‡†åŒ–**</p>
<blockquote>
<p>å•ç«¯æµ‹åºæ—¶éœ€è¦å»ºç«‹åŒå³°æ¨¡å‹æ¨æµ‹DNAç‰‡æ®µçš„é•¿åº¦ã€‚åŒç«¯ä¸éœ€è¦</p>
<p>å¹³ç§»è®©Tn5åˆ‡å‰²æ–­ç‚¹å¤„äºreadsæ­£ä¸­å¿ƒ</p>
<p>-SMPR save signal per million reads</p>
</blockquote>
<p>BDG to BigWigã€ä½¿ç”¨BDGè½¬æ¢çš„bigwigæ–‡ä»¶å’Œbamè½¬åŒ–bwï¼Œç›´æ¥ä½¿ç”¨narrowpeakçš„åŒºåˆ«æ˜¯ã€‘</p>
<p>å»ºè®®ç”¨bdgè½¬æ¢çš„bigwigæ–‡ä»¶ï¼Œå› ä¸ºè¯¥æ–‡ä»¶åšäº†å¹³ç§»shiftå’Œå»¶ä¼¸extend</p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/47.png" alt="1"></p>
<p><strong>Data Quality Assesment</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/48.png" alt="1"></p>
<p><strong>Data Visualization</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/49.png" alt="1"></p>
<p><strong>Multiple Replicates</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/50.png" alt="1"></p>
<p>IDRæ‰€æœ‰ç‚¹ä»£è¡¨æœ‰overlapï¼Œçº¢ç‚¹è¡¨ç¤ºå¯Œé›†å€æ•°æœ‰å·®å¼‚ï¼Œé»‘ç‚¹è¡¨ç¤ºå¯Œé›†å€æ•°ä¸€è‡´ã€‚IDRåœ¨åŠ¨ç‰©é‡Œç®—å‡ºçš„ç»“æœè¾ƒå¥½ï¼Œæ¤ç‰©ç”±äºå®éªŒé—®é¢˜æ•ˆæœæ²¡é‚£ä¹ˆå¥½ï¼ˆä¸æ¨èï¼Ÿï¼‰ï¼Œæ¤ç‰©ç›´æ¥overlap-peakã€‚</p>
<p><strong>Peak annotation</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/51.png" alt="1"></p>
<p><strong>Motif analysis</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/52.png" alt="1"></p>
<p><strong>ä¸ªæ€§åŒ–åˆ†æ</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/53.png" alt="1"></p>
<p>TFç½‘ç»œéœ€è¦å¤šç»„æ•°æ®ä¸åŒå¤„ç†æ¡ä»¶ä¸‹</p>
<p><strong>è”åˆåˆ†æ</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/54.png" alt="1"></p>
<p>è¡¨è¾¾ç¨‹åº¦è¶Šé«˜ä¿¡å·è¶Šé«˜ã€‚</p>
<p><strong>æ¡ˆä¾‹</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/55.png" alt="1"></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/56.png" alt="1"></p>
<p>H3K27me3 genebody</p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/57.png" alt="1"></p>
<p>peak-to-gene link predictionã€å¤§æ ·æœ¬é‡çš„ATACå’ŒRNAseqå…³è”åˆ†æã€‘</p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/58.png" alt="1"></p>
<hr>
<p><strong>CUT&amp;Tag</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/59.png" alt="1"></p>
<p>ChIPå®éªŒæ–°æ–¹æ³•ï¼šCUT&amp;RUN å’Œ CUT&amp;Tag å‘¨æœŸå¿«ï¼›ææ–™éœ€æ±‚å°‘ï¼›æ•°æ®ä¿¡å™ªæ¯”é«˜</p>
<p><strong>C</strong>leavage <strong>U</strong>nder <strong>T</strong>argets and <strong>R</strong>elease <strong>U</strong>sing <strong>N</strong>uclease</p>
<p><strong>C</strong>leavage <strong>U</strong>nder <strong>T</strong>argets and <strong>Tag</strong>mentation</p>
<p><strong>åŸç†ä»‹ç»</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/60.png" alt="1"></p>
<p>è›‹ç™½ç£ç å¸é™„æ ¸è†œï¼Œç»†èƒç»‘å®šåœ¨ç£ç ä¸Šã€‚ç»†èƒè†œç©¿å­”ï¼ŒpAG-MNaseè¿›å…¥ï¼Œprimary AbæŠ—ä½“åŠ å…¥ã€‚å¤šä½™æŠ—ä½“å¤šä½™pAG-MNaseæ´—æ‰ï¼Œ<strong>pAG-MNase and primary Ab binding</strong>ã€‚åŠ å…¥é’™ç¦»å­æ¿€æ´»ï¼Œé¶å‘ä½ç‚¹åˆ‡å‰²ï¼Œæ•´ä¸ªåŸºå› ç»„å°‘éƒ¨åˆ†ä½ç½®åˆ‡å‰²ã€èƒŒæ™¯å™ªéŸ³é«˜ä½å–å†³äºæŠ—ä½“è´¨é‡å¥½åã€‘ã€‚åªæœ‰åˆ‡å‰²çš„å°ç‰‡æ®µä»å°å­”å‡ºæ¥(å¤§éƒ¨åˆ†èƒŒæ™¯é—ç•™åœ¨æ ¸å†…)ã€‚CUT&amp;RUNç”¨çš„pAG-MNaseä¾ç„¶è¦è¡¥å¹³åŠ æ¥å¤´ï¼Œæ›¿æ¢ä¸ºProtein-A-Tn5åˆ™å˜ä¸ºCUT&amp;Tagï¼Œä¸€å¤©ä»¥å†…å®Œæˆçš„â€ChIPâ€å®éªŒã€‚</p>
<p><strong>å®éªŒæµç¨‹</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/61.png" alt="1"></p>
<p>æ–‡åº“ç‰‡æ®µåˆ†å¸ƒå’ŒATACç±»ä¼¼ï¼ˆTn5ï¼Œæ ¸å°ä½“ï¼‰</p>
<p>IgGé˜´æ€§å¯¹ç…§å¸®åŠ©åˆ¤æ–­åˆ°åº•æ˜¯ChIPå³°è¿˜æ˜¯ATACå³°(å®éªŒæ˜¯å¦æˆåŠŸ)ã€‚æ¤ç‰©éš¾åº¦å¤§ï¼Œæ¤ç‰©ç”¨åŸç”Ÿè´¨ä½“ã€‚æ¤ç‰©æ¨èåšchipå°±è¡Œï¼ŸåŠ¨ç‰©å†»å­˜ç»„ç»‡å¯å°è¯•ï¼Œæ¤ç‰©å†»å­˜ä¸æ¨èã€‚CUTæŠ€æœ¯æ˜¯é’ˆå¯¹å°‘é‡ç»†èƒçš„ã€‚å°‘é‡ç»†èƒå¯èƒ½æ•°æ®é‡å°‘ã€‚CUT&amp;Tagç¼ºç‚¹æ˜¯ç”±äºTn5åªåšå¼€æ”¾åŒºåŸŸï¼Œè‹¥æ˜¯å¼‚æŸ“è‰²è´¨H3K9ï¼ŒH3K39ä¸‰ç”²åŸºåŒ–è¿™ç§markeråšä¸äº†</p>
<p><strong>CUT&amp;Tagæ•°æ®åˆ†æ</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/62.png" alt="1"></p>
<p><strong>æå‡CUT&amp;Tagæ•°æ®å…³é”®</strong></p>
<p>æŠ—ä½“è´¨é‡ï¼šChIP-gradeï¼›WesternéªŒè¯ï¼›æŠ—ä½“æ‰¹æ¬¡æ•ˆåº”</p>
<p>ç»†èƒè´¨é‡ï¼šæ´»ç»†èƒæ¯”ä¾‹&gt;95%(native chromatin )ï¼›ç»†èƒå‡ä¸€æ€§</p>
<p><strong>MACSè½¯ä»¶</strong></p>
<p>æ•°æ®å™ªéŸ³è¯„ä¼°</p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/63.png" alt="1"></p>
<p><strong>ï¼ï¼ï¼Peak calling for ATAC</strong></p>
<p> <img src="/blog/2022/03/18/2022-03-19-CUT-Tag/64.png" alt="1"></p>
<p><font color="red"><strong>å¯¹äºATACï¼Œä¸€æ¡DNA fragmentä»£è¡¨ä¸¤ä¸ªé…¶åˆ‡ä½ç‚¹ä¿¡æ¯ï¼Œè½¬bedæ ¼å¼ã€‚å¦‚æœç”¨bamæ–‡ä»¶ä¼šé»˜è®¤ä¸¢æ‰reads2</strong></font></p>
<p><strong>Code</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#step1 å»æ¥å¤´</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#step2 å»ºç«‹index</span></span><br><span class="line">ref.fa</span><br><span class="line">genes.gtf</span><br><span class="line">bowtie2 build</span><br><span class="line">samtools faidx ref.fa</span><br><span class="line"></span><br><span class="line"><span class="comment">#step3 æ¯”å¯¹</span></span><br><span class="line">bowtie2 -x index/ref -X 1000 -1 R1.fq -2 R2.fq -S .sam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step4 æŒ‘é€‰å¯é æ¯”å¯¹ç»“æœ</span></span><br><span class="line">samtools view -b -f 2 -q 30 -0 pairs.bam .sam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step5 å»é™¤PCRé‡å¤</span></span><br><span class="line">samtools sort -o pairs.sorted.bam pairs.bam</span><br><span class="line">picard.jar MarkDuplicates</span><br><span class="line"></span><br><span class="line"><span class="comment">#step6 æŸ¥çœ‹mito pt æ±¡æŸ“</span></span><br><span class="line">samtools index pairs.sorted.dedup.bam</span><br><span class="line">samtools idxstats pairs.sorted.dedup.bam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step7 å»é™¤çº¿ç²’ä½“æ•°æ®</span></span><br><span class="line">samtools view -h pairs.sorted.dedup.bam | grep -v <span class="string">&quot;chrM&quot;</span> | grep -v <span class="string">&quot;Pt&quot;</span> | samtools view -bS -o final.bam</span><br><span class="line"></span><br><span class="line"><span class="comment">#step8 ç»Ÿè®¡æ’å…¥ç‰‡æ®µé•¿åº¦åˆ†å¸ƒ</span></span><br><span class="line">Rscript plotInsertSize final.bam final.insertsize</span><br><span class="line"></span><br><span class="line"><span class="comment">#step9 peak calling</span></span><br><span class="line">bedtools bamtobed -1 final.bam &gt; final.bam.bed</span><br><span class="line"></span><br><span class="line">macs2 callpeak -t final.bam.bed -n rep1 --<span class="built_in">shift</span> -100 --extsize 200 --nomodel -B --SPMR -g 2e</span><br><span class="line"></span><br><span class="line"><span class="comment">#step10 TSSå¯Œé›†</span></span><br><span class="line"><span class="comment">#BDG to BigWig</span></span><br><span class="line"><span class="comment">#UCSC utitlities</span></span><br><span class="line"><span class="comment">#å¯¹bdgæ–‡ä»¶æ’åº</span></span><br><span class="line">bedSort treat.bdg treat.sort.bdg</span><br><span class="line"><span class="comment">#ç”ŸæˆåŸºå› ç»„å„æ¡åºåˆ—é•¿åº¦ä¿¡æ¯ï¼Œç›´æ¥ä»bamæ–‡ä»¶å¾—åˆ°</span></span><br><span class="line">samtools view -H final.bam | perl -ne <span class="string">&#x27;if(/SN:(\S+)\s+LN:(\d+)/)&#123;print &quot;$1\t$2\n&quot;&#125;&#x27;</span> &gt; chrome.sizes</span><br><span class="line"><span class="comment">#ç”Ÿæˆbigwigæ–‡ä»¶</span></span><br><span class="line">bedClip -truncate treat.sort.bdg chrome.sizes stdout | perl -ane <span class="string">&#x27;print if($F[1]&lt;$F[2])&#x27;</span> &gt; treat.bdegraph</span><br><span class="line">bedGraphToBigWig treat.bdegraph chrome.sizes treat.bw</span><br><span class="line"></span><br><span class="line">computeMatrix reference-point -S Rep1.bw Rep2.bw -R .gtf -a 3000 -b 3000 -p 1 -o matrix.gz</span><br><span class="line">plotHeatmap -m matrix.gz -o heatmap.png --colorMap Reds</span><br><span class="line"></span><br><span class="line"><span class="comment">#step11 peaké‡å¤æ€§</span></span><br><span class="line">bedtools intersect -a .peak -b .peak | wc -l</span><br><span class="line">bedtools intersect -a .peak -b .peak -f 0.5 -F 0.5 | wc -l</span><br><span class="line">idr -s rep1.peak rep2.peak -o idr --plot</span><br><span class="line"></span><br><span class="line"><span class="comment">#step12 peakåœ¨åŸºå› ä¸Šçš„åˆ†å¸ƒ</span></span><br><span class="line">Rscript PeakAnnotation.R .gtf rep1.peak Rep1</span><br><span class="line"></span><br></pre></td></tr></table></figure>



















<hr>
<p>IgGï¼Ÿ</p>
]]></content>
      <categories>
        <category>technology</category>
      </categories>
      <tags>
        <tag>CUT-Tag</tag>
      </tags>
  </entry>
  <entry>
    <title>annotation</title>
    <url>/blog/2022/03/18/2022-03-18-annotation/</url>
    <content><![CDATA[<p>Structural annotation and functional annotation</p>
<span id="more"></span>

<h1 id="Structural-annotation"><a href="#Structural-annotation" class="headerlink" title="Structural annotation"></a>Structural annotation</h1><p>The genome structural annotation was performed using Maker-Pã€38ã€‘: </p>
<p>(1) SNAP and Augustus as ab initio gene predictors;</p>
<p> (2) Exonerate as experimental based predictor with 454 and Illumina RNASeq reads and protein sequences from different proteinã€39ã€‘datasets. RNAseq Illumina data was mapped using Tophat2. tRNAs were annotatedusing tRNAscan (<a href="http://lowelab.ucsc.edu/tRNAscan-SE/">http://lowelab.ucsc.edu/tRNAscan-SE/</a>).</p>
<h1 id="Functional-annotation"><a href="#Functional-annotation" class="headerlink" title="Functional annotation"></a>Functional annotation</h1><p>The gene functional annotation was performed by sequence homology search with different protein datasets using BlastPã€40ã€‘ and protein domains searchã€41ã€‘using InterProScan . Functional annotations were integrated using AHRD(<a href="https://github.com/groupschoof/AHRD">https://github.com/groupschoof/AHRD</a>). See Supplementary Note 1.</p>
]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>denovo-III</tag>
      </tags>
  </entry>
  <entry>
    <title>Organelle assembly</title>
    <url>/blog/2022/03/18/2022-03-18-mito-chro/</url>
    <content><![CDATA[<p>organelle assembly</p>
<span id="more"></span>

<h1 id="Mitochondrial-Genome-Assembly"><a href="#Mitochondrial-Genome-Assembly" class="headerlink" title="Mitochondrial Genome Assembly"></a><strong>Mitochondrial Genome Assembly</strong></h1><h2 id="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„-ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ"><a href="#æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„-ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ" class="headerlink" title="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ"></a><a href="https://www.zhihu.com/question/65471820#:~:text=%E6%A4%8D%E7%89%A9%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9A%84%E4%B8%BB%E8%A6%81%E7%89%B9%E7%82%B9%E6%98%AF%EF%BC%9A%20%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E5%92%8C%E7%BB%93%E6%9E%84%E5%8F%98%E5%BC%82%E5%B7%A8%E5%A4%A7%EF%BC%8C%E5%9F%BA%E5%9B%A0%E5%8D%B4%E6%9E%81%E5%BA%A6%E4%BF%9D%E5%AE%88%EF%BC%9B%E5%9F%BA%E5%9B%A0%E5%88%86%E5%B8%83%E9%9D%9E%E5%B8%B8%E7%A8%80%E7%96%8F%EF%BC%8C%E5%90%AB%E6%9C%89%E5%A4%A7%E9%87%8F%E9%9D%9E%E7%BC%96%E7%A0%81%E5%BA%8F%E5%88%97%EF%BC%9B%E5%AD%98%E5%9C%A8%E5%A4%A7%E9%87%8F%E7%9A%84RNA%E7%BC%96%E8%BE%91%E3%80%82,%E5%A4%A7%E9%83%A8%E5%88%86%E5%8A%A8%E7%89%A9%E7%9A%84%E7%8E%AF%E7%8A%B6%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9A%84%E5%A4%A7%E5%B0%8F%E7%BA%A615-17kb%EF%BC%8C%E4%B8%94%E7%BB%93%E6%9E%84%E7%9B%B8%E5%AF%B9%E4%BF%9D%E5%AE%88%EF%BC%8C%E5%9F%BA%E5%9B%A0%E6%8E%92%E5%88%97%E7%B4%A7%E5%87%91%EF%BC%8C%E8%BF%99%E4%BA%9B%E7%89%B9%E7%82%B9%E9%83%BD%E8%B7%9F%E6%A4%8D%E7%89%A9%E5%8F%B6%E7%BB%BF%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9B%B8%E4%BB%BF%EF%BC%8C%E6%A4%8D%E7%89%A9%E7%9A%84%E5%8F%B6%E7%BB%BF%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E5%9C%A8100-200kb%E4%B9%8B%E9%97%B4%E3%80%82%20%E7%84%B6%E8%80%8C%E6%A4%8D%E7%89%A9%E7%BA%BF%E7%B2%92%E4%BD%93%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%8D%B4%E8%B7%9F%E5%89%8D%E4%B8%A4%E8%80%85%E6%9C%89%E7%9D%80%E8%BF%A5%E7%84%B6%E4%B8%8D%E5%90%8C%E7%9A%84%E7%89%B9%E6%80%A7%EF%BC%8C%E5%85%B6%E5%A4%A7%E5%B0%8F%E4%B8%80%E8%88%AC%E5%9C%A8200-750kb%E4%B9%8B%E9%97%B4%E3%80%82">æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ ç‰¹ç‚¹ï¼Œæˆå› å’Œåæœ</a></h2><p>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼š<strong>åŸºå› ç»„å¤§å°å’Œç»“æ„å˜å¼‚å·¨å¤§ï¼ŒåŸºå› å´æåº¦ä¿å®ˆï¼›åŸºå› åˆ†å¸ƒéå¸¸ç¨€ç–ï¼Œå«æœ‰å¤§é‡éç¼–ç åºåˆ—ï¼›å­˜åœ¨å¤§é‡çš„RNAç¼–è¾‘ã€‚</strong></p>
<ul>
<li><p>å¤§éƒ¨åˆ†<strong>åŠ¨ç‰©ç¯çŠ¶çº¿ç²’ä½“åŸºå› ç»„</strong>å¤§å°çº¦<strong>15-17kb</strong>ï¼Œä¸”<strong>ç»“æ„ç›¸å¯¹ä¿å®ˆ</strong>ï¼Œ<strong>åŸºå› æ’åˆ—ç´§å‡‘</strong></p>
</li>
<li><p>åŠ¨ç‰©çº¿ç²’ä½“è·Ÿ<strong>æ¤ç‰©å¶ç»¿ä½“åŸºå› ç»„ç›¸ä»¿</strong>ï¼Œ<strong>æ¤ç‰©å¶ç»¿ä½“åŸºå› ç»„</strong>å¤§å°åœ¨<strong>100-200kbä¹‹é—´</strong></p>
</li>
<li><p><strong>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„</strong>å´è·Ÿå‰ä¸¤è€…è¿¥ç„¶ä¸åŒï¼Œå¤§å°åœ¨<strong>200-750kb</strong>ä¹‹é—´ã€‚<strong>é»„ç“œ</strong>çº¿ç²’ä½“åŸºå› ç»„è¾¾<strong>1556kb</strong>ã€‚<strong>è¿‘ç¼˜</strong>ç‰©ç§é—´<strong>ä¹Ÿå·®å¼‚å·¨å¤§</strong>ã€‚å¦‚è‡å­è‰å±ï¼ˆ<em>Silene</em>ï¼‰ä¸­ï¼Œå¤œèŠ±è‡å­è‰ï¼ˆ<em>S. noctiflora</em>ï¼‰çº¿ç²’ä½“åŸºå› ç»„<strong>6.728kb</strong>ï¼Œè€Œå‰ææ¡è‡å­è‰ï¼ˆ<em>S. latifolia</em>ï¼‰çº¿ç²’ä½“åŸºå› ç»„<strong>253kb</strong>ï¼Œ<strong>åŒå±</strong>æ¤ç‰©å·®å¼‚30å€ã€‚å³ä½¿<strong>åŒä¸€ç‰©ç§</strong>ï¼Œå·®å¼‚ä¹Ÿæ˜¾è‘—ã€‚å¦‚ç™½ç‰è‰ï¼ˆ<em>S. vulgaris</em>ï¼‰ï¼Œä»»ä½•<strong>ä¸åŒç§ç¾¤</strong>ä¸¤ä¸¤ä¹‹é—´åªæœ‰çº¦ä¸€åŠçš„çº¿ç²’ä½“åŸºå› ç»„åºåˆ—ç›¸åŒã€‚</p>
</li>
<li><p>æ¤ç‰©çº¿ç²’ä½“<strong>åŸºå› ç»„åºå¤§</strong>ï¼Œä½†<strong>ç¼–ç åŸºå› å´ä¸å¤š</strong>ï¼Œæ’åˆ—ç¨€ç–ã€‚<strong>æ¤ç‰©å¶ç»¿ä½“åŸºå› ç»„</strong>ä¸Šçº¦<strong>100ä¸ªåŸºå› </strong>ï¼Œä½†æ¯”å¶ç»¿ä½“åŸºå› ç»„å¤§çš„<strong>æ‹Ÿå—èŠ¥çº¿ç²’ä½“åŸºå› ç»„</strong>ï¼Œå´åªæœ‰çº¦<strong>50å¤šä¸ªåŸºå› </strong>ï¼Œè€Œäººçº¿ç²’ä½“åŸºå› ç»„37ä¸ªåŸºå› ã€‚æ‹Ÿå—èŠ¥<strong>çº¿ç²’ä½“åŸºå› æ•°é‡</strong>ä¸åˆ°äººçš„<strong>ä¸¤å€</strong>ï¼Œå…¶<strong>åŸºå› ç»„å¤§å°</strong>å´æ˜¯<strong>22å€</strong>ã€‚æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„å¤§éƒ¨åˆ†æ˜¯<strong>éç¼–ç åºåˆ—</strong>ï¼Œè¿™äº›åºåˆ—å åˆ°<strong>60%ä»¥ä¸Š</strong>ã€‚è¿™äº›éç¼–ç åºåˆ—ç”±<strong>é‡å¤ç‰‡æ®µã€å¶ç»¿ä½“åŸºå› ç»„å’Œå’ŒåŸºå› ç»„è½¬ç§»è€Œæ¥</strong>çš„åºåˆ—ï¼Œç”šè‡³æ˜¯<strong>åŸºå› æ°´å¹³è½¬ç§»</strong>è·å¾—çš„å…¶å®ƒç‰©ç§åºåˆ—ã€‚å¦‚æœ€<strong>å¤è€çš„è¢«å­æ¤ç‰©äº’å¶æ¢…</strong>ï¼ˆ<em>Amborella trichopoda</em>ï¼‰çš„çº¿ç²’ä½“åŸºå› ç»„ä¸­ï¼Œå°±æœ‰<strong>å¤§é‡æ¥è‡ªè‹”è—“ã€ç»¿è—»å’Œå…¶å®ƒè¢«å­æ¤ç‰©çš„åºåˆ—ç‰‡æ®µ</strong>ï¼ˆRice, 2013ï¼‰ã€‚</p>
</li>
<li><p>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„<strong>ç»“æ„å˜å¼‚å·¨å¤§</strong>ï¼Œçº¿ç²’ä½“<strong>åŸºå› </strong>å´<strong>æåº¦ä¿å®ˆ</strong>ï¼Œåœ¨<strong>æ¤ç‰©ä¸‰å¥—åŸºå› ç»„ä¸­æœ€ä¿å®ˆæ¼”åŒ–é€Ÿç‡æœ€æ…¢</strong>ã€‚é»„ç“œå¦‚æ­¤åºå¤§çº¿ç²’ä½“åŸºå› ç»„åªæ¯”æ‹Ÿå—èŠ¥å¤šå››ä¸ªåŸºå› ã€‚ç”±äºæ¤ç‰©çº¿ç²’ä½“åŸºå› <strong>éå¸¸ä¿å®ˆï¼ŒåŒºåˆ†åº¦ä¸è¶³</strong>ï¼Œä¸€èˆ¬<strong>ä¸é€‰ä½œç³»ç»Ÿå­¦ç ”ç©¶</strong>çš„<strong>åˆ†å­æ ‡è®°</strong>ã€‚è·ŸåŠ¨ç‰©æ­£å¥½ç›¸åï¼Œ<strong>åŠ¨ç‰©çš„çº¿ç²’ä½“åŸºå› æ¼”åŒ–é€Ÿç‡è¾ƒå¿«</strong>ï¼Œæ‰€ä»¥åœ¨åŠ¨ç‰©ç³»ç»Ÿå­¦ç ”ç©¶ä¸­ï¼Œæ˜¯<strong>æœ€å¸¸ç”¨çš„åˆ†å­æ ‡è®°</strong>ã€‚</p>
</li>
<li><p><strong>æ˜¯ä»€ä¹ˆå¯¼è‡´æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„å¦‚æ­¤åºå¤§ï¼Œå¦‚æ­¤å¤šéç¼–ç åºåˆ—ï¼Ÿçº¿ç²’ä½“åŸºå› ç»„åŸºå› ä¿å®ˆåŸå› æ˜¯ï¼Ÿç›®å‰ç†è®ºæ˜¯å‘ç”Ÿåœ¨çº¿ç²’ä½“éç¼–ç åŒºå’Œç¼–ç åŒºçš„ä¸¤å¥—ä¸åŒDNAä¿®å¤æœºåˆ¶ã€‚</strong></p>
</li>
<li><p>æ¤ç‰©çº¿ç²’ä½“<strong>ç¼–ç åŒº</strong>è¿›è¡Œçš„æ˜¯<strong>ç¢±åŸºå‰ªåˆ‡ä¿®å¤</strong>ï¼ˆBase excision repairï¼‰å’Œ<strong>åŸºå› è½¬æ¢</strong>ï¼ˆgene conversionï¼‰ä»‹å¯¼çš„<strong>ç²¾ç¡®</strong>ä¿®å¤ï¼Œè€Œåœ¨éç¼–ç åŒºè¿›è¡Œçš„æ˜¯<strong>éåŒæºæ€§æœ«ç«¯è¿æ¥</strong>ï¼ˆnon-homologous end joiningï¼‰å’Œ<strong>æ–­è£‚è¯±å¯¼å¤åˆ¶</strong>ï¼ˆBreak-induced replicationï¼‰ä»‹å¯¼çš„<strong>éç²¾ç¡®</strong>ä¿®å¤ï¼ˆChristensen, 2013ï¼‰</p>
</li>
</ul>
<p><img src="/blog/2022/03/18/2022-03-18-mito-chro/1.png" alt="img"></p>
<ul>
<li>ç¼–ç åŒºç²¾ç¡®ä¿®å¤å¯¼è‡´çº¿ç²’ä½“åŸºå› å˜å¼‚ç¨€å°‘ï¼Œæ¼”åŒ–é€Ÿç‡éå¸¸æ…¢ã€‚éç¼–ç åŒºéç²¾ç¡®ä¿®å¤ï¼Œä¿®å¤è¿‡ç¨‹å¸¦æ¥å¾ˆå¤šå¤–æ¥åºåˆ—ï¼Œä½¿å¾—éç¼–ç åŒºéå¸¸åŒ…å®¹ï¼Œä¸æ–­å¸æ”¶ç§¯ç´¯éç¼–ç åºåˆ—</li>
<li>åæœã€‚æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ä¸­å¤§é‡éç¼–ç åºåˆ—ï¼Œå…¶ä¸­å¾ˆå¤šé‡å¤ç‰‡æ®µï¼Œå¯¼è‡´æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ æ˜“é‡ç»„ã€‚å¶ç»¿ä½“åŸºå› ç»„åœ¨ç»†èƒå†…å¸¸ä»¥å®Œæ•´ç¯çŠ¶å­˜åœ¨ï¼Œæ¤ç‰©çº¿ç²’ä½“ä¼šé‡ç»„å½¢æˆçº¿çŠ¶ç»“æ„ï¼Œç”šè‡³å¾ˆå¤šå¤§å°ä¸ä¸€çš„ç¯ã€‚é»„ç“œæœ‰1.6M+84k+45kçº¿ç²’ä½“åŸºå› ç»„(å¤§å°ç¯)ã€‚å®Œæ•´æµ‹å‡ºçš„mito è¿œå°äºchro</li>
</ul>
<h2 id="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº"><a href="#æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº" class="headerlink" title="æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº"></a>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº</h2><p><a href="http://www.genepioneer.com/display.php?id=353">http://www.genepioneer.com/display.php?id=353</a></p>
<ul>
<li><p>åŠ¨ç‰©çº¿ç²’ä½“åŸºå› ç»„è¾ƒå°ï¼Œé€šå¸¸åœ¨10-39kbï¼Œè€Œæ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„å¤§å°åœ¨200-750kbã€‚æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šåŸºå› ç»„å¤§å°å’Œç»“æ„å˜å¼‚å·¨å¤§ï¼›åŸºå› å´æåº¦ä¿å®ˆï¼›åŸºå› åˆ†å¸ƒéå¸¸ç¨€ç–ï¼›å«æœ‰å¤§é‡éç¼–ç åºåˆ—ï¼›å­˜åœ¨å¤§é‡çš„RNAç¼–è¾‘</p>
</li>
<li><p>å…¬å¸å¥—è·¯ï¼šäºŒä»£+ä¸‰ä»£æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„æµ‹åº</p>
<ul>
<li><strong>åŸºå› ç»„æ³¨é‡Š</strong>è¿›è¡Œ<strong>åŸºå› åºåˆ—ç»„æˆåˆ†æ</strong>æ¥ç ”ç©¶<strong>ç‰©ç§åŠŸèƒ½ç‰¹å¾</strong></li>
<li><strong>æ¯”è¾ƒåŸºå› ç»„å­¦</strong>ç ”ç©¶ç‰©<strong>ç§é—´åŸºå› ç»„ç»“æ„å˜åŒ–</strong>æ¢è®¨ç‰©<strong>ç§çš„ç¯å¢ƒé€‚åº”æ€§ç‰¹å¾</strong></li>
<li><strong>ç¾¤ä½“åŸºå› ç»„ç ”ç©¶</strong>å†…å®¹æ›´å¹¿ï¼š<strong>ç‰©ç§èµ·æºã€äº²ç¼˜åˆ†ç±»ã€ç³»ç»Ÿå‘è‚²ã€è°±ç³»åœ°ç†</strong>ç­‰</li>
</ul>
</li>
<li><p>å…¬å¸å¸¸è§„åˆ†æ</p>
<ul>
<li>çº¿ç²’ä½“åŸºå› ç»„ç»“æ„æ³¨é‡Š</li>
<li>çº¿ç²’ä½“åŸºå› ç»„å›¾è°±</li>
<li>RSCUåˆ†æ</li>
<li>æ•£åœ¨é‡å¤åºåˆ—åˆ†æ</li>
<li>ç¢±åŸºåç§»åˆ†æ</li>
</ul>
</li>
<li><p>å…¬å¸é«˜çº§åˆ†æ</p>
<ul>
<li>KaKsåˆ†æ</li>
<li>çº¿ç²’ä½“ç»“æ„æ¯”è¾ƒåˆ†æ</li>
<li>è¿›åŒ–æ ‘åˆ†æ</li>
<li>åºåˆ—åŒæºåŠå…±çº¿æ€§åˆ†æ</li>
<li>åŸºå› æ°´å¹³è½¬ç§»åˆ†æ</li>
</ul>
</li>
<li><p>æ¡ˆä¾‹1</p>
<ul>
<li><a href="doi.org/10.1186/s12862-020-1582-1">ç´«è¡«çº¿ç²’ä½“åŸºå› ç»„</a>ï¼š8ä¸ªè›‹ç™½åŸºå› è½¬ç§»åˆ°æ ¸åŸºå› ç»„ã€‚å¯¹ç´«è¡«çº¿ç²’ä½“åŸºå› ç»„æµ‹åºï¼Œå¾—åˆ°å…¨é•¿<font color="blue"><strong>468,924bp</strong></font>çº¿ç²’ä½“åŸºå› ç»„åºåˆ—ä¸<strong>å…¶å®ƒ4ä¸ªè£¸å­æ¤ç‰©è°±ç³»</strong>çš„<strong>çº¿ç²’ä½“åŸºå› ç»„</strong>æ¯”è¾ƒã€‚ç»“æœè¡¨æ˜è£¸å­æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„åœ¨<strong>å¤§å°ã€ç»“æ„ã€åŸºå› å’Œå†…å«å­å«é‡ã€å¤–æºåºåˆ—ã€çªå˜ç‡</strong>ç­‰æ–¹é¢ä¸<strong>è¢«å­æ¤ç‰©</strong>çº¿ç²’ä½“åŸºå› ç»„<strong>å­˜åœ¨å·®å¼‚</strong>ã€‚</li>
<li><a href="DOI%EF%BC%9A10.7717/peerj.3148">çº¢æŸ³çº¿ç²’ä½“å…¨åŸºå› ç»„åºåˆ—çš„ç»„è£…ä¸æ¯”è¾ƒåˆ†æ</a> : ç»„è£…å¾—åˆ°å…¨é•¿<font color="blue"><strong>644,437bp</strong></font>å®Œæ•´çš„çº¢æŸ³çº¿ç²’ä½“ (mt) åºåˆ—ã€‚ç¼–ç <font color="blue"><strong>58ä¸ªç‹¬ç‰¹åŸºå› </strong></font>ï¼ˆ32ä¸ªè›‹ç™½ç¼–ç åŸºå› ã€23ä¸ªtRNAåŸºå› å’Œ3ä¸ªrRNAåŸºå› ï¼‰ã€‚é€šè¿‡å¯¹35ç§æ¨æ ‘çš„23ä¸ªè›‹ç™½ç¼–ç åŸºå› <strong>ç³»ç»Ÿå‘è‚²åˆ†æ</strong>ï¼Œè¯æ˜<strong>çº¢æŸ³æ˜¯æ¨æ ‘çš„å§Šå¦¹</strong>ã€‚</li>
</ul>
</li>
</ul>
<h2 id="software-2019review-DOI-10-16288-j-yczz-19-227"><a href="#software-2019review-DOI-10-16288-j-yczz-19-227" class="headerlink" title="[software-2019review](DOI: 10.16288/j.yczz.19-227)"></a>[software-2019review](DOI: 10.16288/j.yczz.19-227)</h2><ul>
<li>ç‰¹æ®Šä¸”å®¹æ˜“è·å–çš„é—ä¼ æ ‡è®°ï¼Œé«˜çªå˜é€Ÿç‡(not plant)ã€æ— åŸºå› é‡ç»„ã€é«˜æ‹·è´æ•°å’Œæ¯ç³»é—ä¼ ç­‰</li>
<li>è¿›åŒ–ç”Ÿç‰©å­¦ã€ç¾¤ä½“é—ä¼ å­¦ç­‰æ­ç¤ºç‰©ç§çš„èµ·æºå’Œæ‰©æ•£å†å²å‘æŒ¥ä½œç”¨ã€‚æ ¸åŸºå› å’Œçº¿ç²’ä½“è¡¨ç°ä¸ä¸€è‡´çš„è°±ç³»å…³ç³»ï¼Œç‰¹åˆ«æ˜¯å…·æœ‰å¤æ‚çš„ç¾¤ä½“å†å²çš„ç±»ç¾¤(å¦‚<strong>åŸºå› äº¤æµ</strong>ã€<strong>é—ä¼ æ¼‚å˜</strong>ã€<strong>åå‘æ€§è¿å¾™</strong>å’Œ<strong>ç¥–å…ˆè°±ç³»åˆ†æ‹£</strong>ç­‰)ã€‚</li>
<li>æœ‰å‚ï¼šè¿‘ç¼˜ç‰©ç§çš„çº¿ç²’ä½“åŸºå› ç»„æˆ–éƒ¨åˆ†ç‰‡æ®µä½œä¸ºå‚è€ƒåºåˆ—ï¼Œä»ç ”ç©¶ç±»ç¾¤å…¨åŸºå› ç»„æ•°æ®ä¸­æ•è·çº¿ç²’ä½“readsã€‚(1)åŸºäºçº¿ç²’ä½“<strong>æ•´ä¸ª</strong>åŸºå› ç»„çš„æ‹¼è£…ç­–ç•¥ï¼›(2)åŸºäºçº¿ç²’ä½“<strong>ç‰‡æ®µ</strong>çš„æ‹¼è£…ç­–ç•¥ã€‚ä½¿ç”¨æ¯”å¯¹å·¥å…·(å¦‚BWA)å°†æ€»readsæ˜ å°„(mapping)åˆ°çº¿ç²’ä½“å‚è€ƒåºåˆ—ï¼Œæ ¹æ®<strong>åºåˆ—çš„ç›¸ä¼¼æ€§æ•è·</strong>çº¿ç²’ä½“readsï¼Œç„¶åä½¿ç”¨ä¸åŒåºåˆ—å»¶é•¿ç­–ç•¥å¯¹æ•è·çš„çº¿ç²’ä½“readsåºåˆ—å»¶ä¼¸ï¼Œç›´åˆ°å»¶é•¿åˆ°å®Œæ•´çš„çº¿ç²’ä½“åŸºå› ç»„é•¿åº¦ã€‚<strong>MIA</strong>ç”¨ç°ä»£äººçº¿ç²’ä½“åŸºå› ç»„ä½œå‚è€ƒç ”ç©¶å°¼å®‰å¾·ç‰¹äººã€‚</li>
<li>denovoï¼šçº¿ç²’ä½“contigåˆ†æ‹£</li>
</ul>
<table>
<thead>
<tr>
<th>è½¯ä»¶åç§°</th>
<th>æ˜¯å¦éœ€è¦å‚è€ƒåºåˆ—/ å‚è€ƒåºåˆ—ç±»å‹</th>
<th>é€‚ç”¨ ç‰©ç§</th>
<th>è¾“å…¥æ–‡ä»¶æ ¼å¼ã€ ç±»å‹</th>
<th>å˜å¼‚ æ³¨é‡Š</th>
<th>ç»“æ„å¯ è§†åŒ–</th>
<th>è¿è¡Œ ç¯å¢ƒ</th>
<th>ç¼–ç¨‹ è¯­è¨€</th>
</tr>
</thead>
<tbody><tr>
<td>MIA</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>CUI</td>
<td>C/C++</td>
</tr>
<tr>
<td>MitoBamAnnotator</td>
<td>æ˜¯/ rCRS</td>
<td>äºº</td>
<td>Bam</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Web</td>
<td>Java</td>
</tr>
<tr>
<td>MitoSeek</td>
<td>æ˜¯/rCRSå’Œhg19</td>
<td>äºº</td>
<td>Bam</td>
<td>âˆš</td>
<td>Ã—</td>
<td>GUI</td>
<td>Perl</td>
</tr>
<tr>
<td>mtDNA- profiler</td>
<td>æ˜¯/rCRS</td>
<td>äºº</td>
<td>Fasta</td>
<td>Ã—</td>
<td>âˆš</td>
<td>Web</td>
<td>Java</td>
</tr>
<tr>
<td>MITObim</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Bam</td>
<td>Ã—</td>
<td>Ã—</td>
<td>CUI</td>
<td>Perl</td>
</tr>
<tr>
<td>Mit-o-matic</td>
<td>æ˜¯/rCRS</td>
<td>äºº</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Web/GUI</td>
<td>Java</td>
</tr>
<tr>
<td>MToolBox</td>
<td>æ˜¯/rCRSå’ŒRSRS</td>
<td>äºº</td>
<td>Fastq/Bam/Samã€ SE readså’ŒPE reads</td>
<td>âˆš</td>
<td>Ã—</td>
<td>Web/CUI</td>
<td>Python</td>
</tr>
<tr>
<td>ARC</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>Web/CUI</td>
<td>Python</td>
</tr>
<tr>
<td>Phy-Mer</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fasta/fastq/Bamã€ SE readså’ŒPE reads</td>
<td>Ã—</td>
<td>âˆš</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td>mtDNA- Server</td>
<td>æ˜¯/rCRSå’ŒRSRS</td>
<td>äºº</td>
<td>Fastq/Bam/VCFã€ SE readså’ŒPE reads</td>
<td>âˆš</td>
<td>âˆš</td>
<td>Web</td>
<td>Java</td>
</tr>
<tr>
<td>IOGA</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td>NOVOPlasty</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastq/fastaã€SE reads å’ŒPE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>Web/CUI</td>
<td>Perl</td>
</tr>
<tr>
<td>Norgal</td>
<td>å¦</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>CUI</td>
<td>Python/ Java</td>
</tr>
<tr>
<td>Organelle- PBA</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>PacBio reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>CUI</td>
<td>Perl</td>
</tr>
<tr>
<td>MitoSuite</td>
<td>æ˜¯/rCRS, RSRS, hg19, GRCh37å’Œ38</td>
<td>äºº</td>
<td>Bam/Sam</td>
<td>âˆš</td>
<td>âˆš</td>
<td>GUI</td>
<td>Python</td>
</tr>
<tr>
<td>ORG.Asm</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td>MitoZ</td>
<td>å¦</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>âˆš</td>
<td>âˆš</td>
<td>CUI</td>
<td>Python</td>
</tr>
<tr>
<td><strong>GetOrganelle</strong></td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>Fastqã€SE readså’Œ PE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td><strong>CUI</strong></td>
<td>Python</td>
</tr>
<tr>
<td>Trimitomics</td>
<td>æ˜¯/è‡ªå®šä¹‰å‚è€ƒåºåˆ—</td>
<td>ä»»æ„ ç‰©ç§</td>
<td>RNA-seq readsã€ PE reads</td>
<td>Ã—</td>
<td>Ã—</td>
<td>Unknown</td>
<td>Unknown</td>
</tr>
</tbody></table>
<h2 id="è½¯ä»¶GetOrganelle"><a href="#è½¯ä»¶GetOrganelle" class="headerlink" title="è½¯ä»¶GetOrganelle"></a>è½¯ä»¶GetOrganelle</h2><p><a href="https://zhuanlan.zhihu.com/p/428949195">https://zhuanlan.zhihu.com/p/428949195</a></p>
<p><a href="https://github.com/Kinggerm/GetOrganelle">https://github.com/Kinggerm/GetOrganelle</a></p>
<p>GetOrganelleæ˜¯ä¸­ç§‘é™¢æ˜†æ¤æ‰€é‡‘å»ºå†›å’Œéƒæ–‡å½¬è€å¸ˆå…±åŒå¼€å‘çš„<strong>è´¨ä½“ç»„è£…è½¯ä»¶</strong>ï¼Œ<strong>2020-Genome Biology</strong>ã€‚</p>
<h3 id="æ ¸å¿ƒæµç¨‹"><a href="#æ ¸å¿ƒæµç¨‹" class="headerlink" title="æ ¸å¿ƒæµç¨‹"></a>æ ¸å¿ƒæµç¨‹</h3><p>1ï¼‰é€šè¿‡â€œç§å­â€åºåˆ—è·å¾—éƒ¨åˆ†ç›®æ ‡ç›¸å…³readsï¼›</p>
<p>2ï¼‰å»¶ä¼¸readsè·å¾—æ‰€æœ‰ç›®æ ‡ç›¸å…³readsï¼›</p>
<p>3ï¼‰å¯¹readsè¿›è¡Œä»å¤´ç»„è£…å¾—åˆ°ç»„è£…å›¾å½¢ï¼›</p>
<p>4ï¼‰è¿‡æ»¤ç»„è£…å›¾å½¢ï¼›</p>
<p>5ï¼‰è¯†åˆ«ç»†èƒå™¨ç»„åˆ†å¹¶è‡ªåŠ¨å¯¼å‡ºæ‰€æœ‰å¯èƒ½çš„ç»†èƒå™¨åŸºå› ç»„ç»“æ„ã€‚</p>
<p><img src="/blog/2022/03/18/2022-03-18-mito-chro/2.png" alt="flowchart"></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda create -n getorganelle</span><br><span class="line">conda activate getorganelle</span><br><span class="line">conda install getorganelle</span><br></pre></td></tr></table></figure>

<p><strong>ä¸‹è½½å‚è€ƒåºåˆ—åº“</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_config.py --add embplant_pt,embplant_mt</span><br><span class="line"><span class="comment">#embplant_pt(é«˜ç­‰æ¤ç‰©å¶ç»¿ä½“)</span></span><br><span class="line"><span class="comment">#embplant_mt(é«˜ç­‰æ¤ç‰©çº¿ç²’ä½“)</span></span><br><span class="line"><span class="comment">#embplant_nr(é«˜ç­‰æ¤ç‰©æ ¸ç³–ä½“ RNA)</span></span><br><span class="line"><span class="comment">#animal_mt (åŠ¨ç‰©çº¿ç²’ä½“)</span></span><br><span class="line"><span class="comment">#fungus_mt (çœŸèŒçº¿ç²’ä½“)</span></span><br></pre></td></tr></table></figure>

<p>If connection keeps failing, please manually download the latest database from <a href="https://github.com/Kinggerm/GetOrganelleDB">GetOrganelleDB</a> and <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Initialization#option-2-initialization-from-local-files">initialization from local files</a>.</p>
<p>The database will be located at <code>~/.GetOrganelle</code> by default, which can be changed via the command line parameter <code>--config-dir</code>, or via the shell environment variable <code>GETORG_PATH</code> (see more <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Initialization">here</a>).</p>
<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-1 åŒç«¯æµ‹åºçš„R1</span><br><span class="line">-2 åŒç«¯æµ‹åºçš„R2</span><br><span class="line">-o ç»“æœæ–‡ä»¶ï¼Œç»“æœè¾“å‡ºä¿å­˜çš„ç›®å½•(æ–‡ä»¶å¤¹)åç§°</span><br><span class="line">-F æ•°æ®åº“ï¼Œè®¾å®šè¦ç»„è£…çš„åŸºå› ç»„ç±»å‹</span><br><span class="line">-s å‚è€ƒåºåˆ—</span><br><span class="line">-t çº¿ç¨‹æ•°</span><br><span class="line">-R æœ€å¤§çš„ä¸€ä¸ªæ‰©å……å¾ªç¯çš„æ•°ï¼Œä¸€èˆ¬é»˜è®¤15ï¼Œæå–åŸºå›  reads çš„è½®æ¬¡(è½®æ¬¡è¶Šå¤š,è€—æ—¶è¶Šé•¿)</span><br><span class="line">-k kmerçš„ä¸€ä¸ªå‚æ•°ï¼Œè°ƒç”¨SPAdesè¿›è¡Œdenovoç»„è£…çš„k-mer,æ•°å€¼å¿…é¡»æ˜¯å¥‡æ•°, æœ€å¤§å€¼æ˜¯127</span><br><span class="line">-w æå–å¶ç»¿ä½“åŸºå› reads æ—¶ä½¿ç”¨çš„é•¿åº¦æ¯”ä¾‹æˆ–å®é™…é•¿åº¦</span><br><span class="line"><span class="comment">#word-sizeï¼šæå–å¶ç»¿ä½“åŸºå› reads æ—¶ï¼Œå¯ä»¥ä½¿ç”¨reads é•¿åº¦çš„æ¯”ä¾‹(ratio)ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å®é™…é•¿åº¦çš„word-sizeã€‚ä¾‹å¦‚ï¼šå¦‚æœä½¿ç”¨ratio=0.6, å³ readsé•¿åº¦æ˜¯150bpæ—¶ï¼Œè®¾ç½®çš„word-size = 90bpï¼Œç­‰åŒäºè®¾ç½® â€œ-w 90â€ã€‚</span></span><br></pre></td></tr></table></figure>

<h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p><strong>Starting from reads</strong></p>
<p>The <font color="green"><strong>green workflow</strong></font> in the flowchart  shows the processes of <code>get_organelle_from_reads.py</code>.</p>
<ul>
<li><p><strong>Input data</strong></p>
<p>Currently, <code>get_organelle_from_reads.py</code> was written for <strong>illumina pair-end/single-end data</strong> (fastq or fastq.gz). We recommend using <strong>adapter-trimmed</strong> raw reads without quality control. Usually, <strong>&gt;1G</strong> per end is enough for <strong>plastome</strong> for most normal angiosperm samples, and <strong>&gt;5G</strong> per end is enough for <strong>mitochondria</strong> genome assembly. Since v1.6.2, <code>get_organelle_from_reads.py</code> will <strong>automatically estimate the read data it needs</strong>, without user assignment nor data reducing (see flags <code>--reduce-reads-for-coverage</code> and <code>--max-reads</code>).</p>
</li>
<li><p><strong>Main Options</strong></p>
<ul>
<li><code>-w</code> The value word size, like the kmer in assembly, is crucial to the <strong>feasibility and efficiency</strong> of this process. The <strong>best word size changes upon data and will be affected</strong> by read length, read quality, base coverage, organ DNA percent and other factors. By default, GetOrganelle would <strong>automatically estimate a proper word siz</strong>e based on the data characters. Although the automatically-estimated word size value does not ensure the best performance nor the best result, <font color="green">you do not need to adjust this value</font> (<code>-w</code>) if a complete/circular organelle genome assembly is produced, because the circular result generated by GetOrganelle is highly consistent under different options and seeds. The automatically estimated word size may be screwy in some animal mitogenome data due to inaccurate coverage estimation, for which you fine-tune it instead.</li>
<li><code>-k</code> The best kmer(s) depend on a wide variety of factors too. Although more kmer values add the time consuming, you are recommended to use a wide range of kmers to benefit from the power of SPAdes. Empirically, you should include <strong>at least</strong> including <strong>one small</strong> kmer (e.g. <code>21</code>) and <strong>one large</strong> kmer (<code>105</code>) for a successful organelle genome assembly.</li>
<li><code>-s</code> GetOrganelle takes the seed (fasta format; if this was not provided, the default is <code>GetOrganelleLib/SeedDatabase/*.fasta</code>) as probe, the script would recruit target reads in successive rounds (extending process). <strong>The default seed works for most samples</strong>, but using a complete organelle genome sequence of a <strong>related species as the seed would help the assembly</strong> in many cases (e.g. degraded DNA samples, fastly-evolving in animal/fungal samples; see more <a href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#how-to-assemble-a-target-organelle-genome-using-my-own-reference">here</a>).</li>
</ul>
</li>
<li><p><strong>Key Results</strong></p>
<p>The key output files include</p>
<ul>
<li><code>*.path_sequence.fasta</code>, each fasta file represents one type of genome structure</li>
<li><code>*.selected_graph.gfa</code>, the <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-only assembly graph</a></li>
<li><code>get_org.log.txt</code>, the log file</li>
<li><code>extended_K*.assembly_graph.fastg</code>, the raw assembly graph</li>
<li><code>extended_K*.assembly_graph.fastg.extend_embplant_pt-embplant_mt.fastg</code>, a simplified assembly graph</li>
<li><code>extended_K*.assembly_graph.fastg.extend_embplant_pt-embplant_mt.csv</code>, a tab-format contig label file for bandage visualization</li>
</ul>
<p>You may delete the files other than above if the resulting genome is complete (indicated in the log file and the name of the <code>*.fasta</code>). You are expected to obtain the complete organelle genome assembly for most animal/fungal mitogenomes and plant chloroplast genomes (see <a href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#why-does-getorganelle-generate-a-circular-genome-for-embplant_nrfungus_nr">here for nuclear ribosomal DNAs</a>) with the recommended recipes.</p>
<p>If GetOrganelle <strong>failed</strong> to <strong>generate the complete circular genome</strong> (produce <code>*scaffolds*path_sequence.fasta</code>), please follow <a href="https://github.com/Kinggerm/GetOrganelle/wiki/FAQ#what-should-i-do-with-incomplete-resultbroken-assembly-graph">here</a> to <strong>adjust your parameters for a second run</strong>. You could also use the incomplete sequence to conduct downstream analysis.</p>
</li>
</ul>
<p>#æ¤ç‰©2Gå·¦å³æ•°æ®ï¼Œ<strong>ç»„è£…å¶ç»¿ä½“åŸºå› ç»„</strong>ç”¨</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o plastome_output -R 15 -k 21,45,65,85,105 -F embplant_pt</span><br></pre></td></tr></table></figure>

<p>#æ›´å¿«çš„æ–¹æ³•</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o plastome_output --fast -k 21,65,105 -w 0.68 -F embplant_pt</span><br></pre></td></tr></table></figure>

<p>#ç»„è£…<strong>æ¤ç‰©çº¿ç²’ä½“åŸºå› ç»„</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o mitochondria_output -R 50 -k 21,45,65,85,105 -P 1000000 -F embplant_mt</span><br><span class="line"><span class="comment"># -P pre grouping value. default 20 0000</span></span><br><span class="line"><span class="comment"># 1. please use the ã€FASTG file as the final outputã€‘ for downstream manual processing. until further updates, the FASTA output of plant mitochondria genome of numerous repeats may be error-prone</span></span><br><span class="line"><span class="comment"># 2. embplant_mt mode was not tested in the GetOrganelle paper due to the complexity of plant mitogenomes and the defects of short reads</span></span><br></pre></td></tr></table></figure>

<p>#ç»„è£…<strong>æ¤ç‰©æ ¸æ ¸ç³–ä½“DNA</strong>ç‰‡æ®µ</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -o nr_output -R 10 -k 35,85,115 -F embplant_nr</span><br></pre></td></tr></table></figure>

<p>#ç»„è£…çœŸèŒçº¿ç²’ä½“</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -R 10 -k 21,45,65,85,105 -F fungus_mt -o fungus_mt_out</span><br></pre></td></tr></table></figure>

<p>#ç»„è£…åŠ¨ç‰©çº¿ç²’ä½“</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_from_reads.py -1 forward.fq -2 reverse.fq -R 10 -k 21,45,65,85,105 -F animal_mt -o animal_mt_out</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°çš„æ–‡ä»¶æœ‰completeä»£è¡¨æ‹¼æ¥æˆç¯ã€‚</p>
<p><strong>GetOrganelle â€“assembly å¼€å§‹</strong></p>
<p>The <font color="blue"><strong>blue workflow</strong></font> in the chat shows the processes of <code>get_organelle_from_assembly.py</code>.</p>
<ul>
<li><p><strong>Input data &amp; Main Options</strong></p>
<ul>
<li><code>-g</code> The input must be a FASTG or GFA formatted assembly graph file.</li>
<li>If you input an assembly graph assembled from total DNA sequencing using third-party a de novo assembler (e.g. Velvet), the assembly graph may includes a great amount of non-target contigs. You may want to use <code>--min-depth</code> and <code>--max-depth</code> to greatly reduce the computational burden for target extraction.</li>
<li>If you input an <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-equivalent assembly graph</a> (e.g. manually curated and exported using Bandage), you may use <code>--no-slim</code>.</li>
</ul>
</li>
<li><p><strong>Key Results</strong></p>
<p>The key output files include</p>
<ul>
<li><code>*.path_sequence.fasta</code>, one fasta file represents one type of genome structure</li>
<li><code>*.selected_graph.gfa</code>, the <a href="https://github.com/Kinggerm/GetOrganelle/wiki/Terminology">organelle-only assembly graph</a></li>
<li><code>get_org.log.txt</code>, the log file</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">get_organelle_from_assembly.py -g assembly_graph.fastg -F embplant_pt -o output-plastome</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-g      SPAdesç»„è£…å¾—åˆ°çš„FASTGçš„assembly graph</span><br><span class="line">-F      è®¾å®šè¦ç»„è£…çš„åŸºå› ç»„ç±»å‹</span><br><span class="line">-o      ç»“æœè¾“å‡ºä¿å­˜çš„ç›®å½•(æ–‡ä»¶å¤¹)åç§°</span><br><span class="line">--min-depth  å‰”é™¤graphä¸­depthä½äºé˜ˆå€¼çš„contigs</span><br><span class="line">--max-depth    å‰”é™¤graphä¸­depthé«˜äºé˜ˆå€¼çš„contigs</span><br><span class="line">--min-depth 10 å’Œâ€œ--max-depth10000â€è¿™ä¸¤æ¡å‘½ä»¤æ˜¯å¤‡é€‰çš„ï¼Œå…·ä½“çš„depthéœ€è¦å¯ä»¥è‡ªè¡Œè®¾å®šã€‚</span><br></pre></td></tr></table></figure>

<p><strong>GetOrganelle â€“graph.gfaå¼€å§‹</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">gfa_to_fastg.py graph.gfa</span><br><span class="line">get_organelle_from_assembly.py -g graph.gfa.fastg -F embplant_pt -o output-plastome --no-slim</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-g     Bandageæ¢³ç†åè½¬æ¢ä¸ºfastgçš„graph*</span><br><span class="line">-F     è®¾å®šè¦ç»„è£…çš„åŸºå› ç»„ç±»ç¾¤:embplant_pt(å¶ç»¿ä½“),embplant_mt(çº¿ç²’ä½“)å’Œembplant_nr(æ ¸ç³–ä½“ RNA)</span><br><span class="line">-o     ç»“æœè¾“å‡ºä¿å­˜çš„ç›®å½•(æ–‡ä»¶å¤¹)åç§°</span><br></pre></td></tr></table></figure>

<blockquote>
<p>*ï¼Œä½¿ç”¨Bandageç¼–è¾‘åï¼Œå¯ä»¥â€œmerge all possible nodesâ€ï¼Œç„¶åå†è¾“å‡ºçš„æ–‡ä»¶æ ¼å¼gfaå›¾å½¢æ–‡ä»¶ï¼Œgfaæ–‡ä»¶å¯ä»¥ç”¨gfa_to_fastg.pyåšä¸€ä¸‹è½¬æ¢ã€‚è™½ç„¶gfaä¹Ÿæ˜¯å›¾å½¢æ–‡ä»¶ï¼Œä½†æ˜¯å›¾å½¢å†…å®¹ä¸fastgæœ‰å·®å¼‚äº›å¤æ‚å›¾å½¢ä¼šè¾“å‡ºå¤±è´¥ã€‚</p>
</blockquote>
<h1 id="Chloroplast-Genome-Assembly"><a href="#Chloroplast-Genome-Assembly" class="headerlink" title="Chloroplast Genome Assembly**"></a>Chloroplast Genome Assembly**</h1>]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>denovo-III</tag>
      </tags>
  </entry>
  <entry>
    <title>HiFi-7-[HiFi+HiC-assembly-method]</title>
    <url>/blog/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/</url>
    <content><![CDATA[<p>è¾…åŠ©ç»„è£…æ¡ˆä¾‹2</p>
<span id="more"></span>

<p>searchï¼šHiFi Hi-C  <a href="https://pubmed.ncbi.nlm.nih.gov/?term=HiFi%20Hi-C&amp;page=2">https://pubmed.ncbi.nlm.nih.gov/?term=HiFi%20Hi-C&amp;page=2</a></p>
<h1 id="1-2021-09-äºšéº»çº¤ç»´"><a href="#1-2021-09-äºšéº»çº¤ç»´" class="headerlink" title="1. 2021.09 äºšéº»çº¤ç»´"></a>1. 2021.09 äºšéº»çº¤ç»´</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#">Front Genet.</a> 2021; 12: 735690.  cite1</p>
<p>Published online 2021 Sep 13. doi: <a href="https://dx.doi.org/10.3389%2Ffgene.2021.735690">10.3389/fgene.2021.735690</a></p>
<blockquote>
<p>Chromosome-Level Genome Assembly and Annotation of the Fiber Flax (<em>Linum usitatissimum</em>) Genome</p>
</blockquote>
<p><strong>Genome Assembly</strong></p>
<p>The HiFi long reads were assembled by <strong>Hifiasm</strong> v0.13-r308 with the <strong>default parameters</strong>. Then the <strong>HiFi reads were mapped back to the assembly</strong> to generate a <strong>coverage distribution plot</strong> using <strong>minimap2</strong> 2.17-r941. According to the <strong>covering depth</strong>, <strong>purge_dups</strong> v1.2.5 (Guan et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B22">2020</a>) was applied to <strong>remove redundant haplotigs</strong>. The <strong>Juicer v1.6</strong> (Durand et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B15">2016</a>) and <strong>3D-DNA</strong> v180922 (Dudchenko et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B13">2017</a>) pipelines were used to process the <strong>Hi-C data and scaffold the assembly</strong>. The results were polished using the <strong>Juicebox Assembly Tools</strong> v1.11.08 (Dudchenko et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B14">2018</a>). The CDC Bethune v2 assembly has made most use of the long continuity of optical maps. To further improve the accuracy of order and orient in our assembly, we integrated information from the <strong>Hi-C scaffolding</strong> and the CDC Bethune v2 assembly using the ALLMAPS pipeline (Tang et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B55">2015b</a>) implemented in jcvi utility libraries (Tang et al., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8473814/#B54">2015a</a>).</p>
<h1 id="2-2021-06-ç«ç‘°ğŸŒ¹"><a href="#2-2021-06-ç«ç‘°ğŸŒ¹" class="headerlink" title="2. 2021.06 ç«ç‘°ğŸŒ¹"></a>2. 2021.06 ç«ç‘°ğŸŒ¹</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#">Hortic Res.</a> 2021; 8: 141.  cite4</p>
<p>Published online 2021 Jun 18. doi: <a href="https://dx.doi.org/10.1038%2Fs41438-021-00594-z">10.1038/s41438-021-00594-z</a></p>
<blockquote>
<p>A chromosome-level genome assembly of rugged rose (<em>Rosa rugosa</em>) provides insights into its evolution, ecology, and floral characteristics</p>
</blockquote>
<p><strong>Genome assembly and quality evaluation</strong></p>
<p>Approximately 59.2â€‰Gb of raw HiFi sequencing reads was obtained from the rosa DNA library. We first used <strong>HiCanu</strong> v2.2.1 for preliminary assembly of the rosa genome. Then, <strong>Redundans</strong> v 0.14a<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR27">27</a> was performed to <strong>remove the redundant sequences</strong>. A total of 150.6â€‰Gb of <strong>Hi-C data</strong> were obtained to <strong>anchor</strong> the contig onto the chromosome. We <strong>aligned Hi-C</strong> reads to assembly by <strong>BWA</strong> v 0.7.17-r1188<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR28">28</a>. Next, the <strong>draft assembly genome</strong> was <strong>scaffolded with Hi-C reads by 3D-DNA</strong> v180114<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR29">29</a>. Then, <strong>Juicer</strong> was used to <strong>filter the sequence and cluster it</strong>, and the <strong>Juicerbox tool</strong><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8213826/#CR30">30</a> was applied to <strong>manually adjust chromosome construction</strong>. We finally <strong>anchored the scaffolds on seven chromosomes</strong>. In addition, the <strong>BUSCO</strong> v3.0.2pipeline was used to assess the completeness and accuracy of the <em>R. rugosa</em> genome with the embryophyte_odb10 dataset, which contains 1614 BUSCO gene sets.</p>
<h1 id="3-2022-02-é¦™è‡"><a href="#3-2022-02-é¦™è‡" class="headerlink" title="3. 2022.02 é¦™è‡"></a>3. 2022.02 é¦™è‡</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#">J Fungi (Basel).</a> 2022 Feb; 8(2): 167. </p>
<p>Published online 2022 Feb 9. doi: <a href="https://dx.doi.org/10.3390%2Fjof8020167">10.3390/jof8020167</a></p>
<blockquote>
<p>Haplotype-Resolved Genome Analyses Reveal Genetically Distinct Nuclei within a Commercial Cultivar of <em>Lentinula edodes</em></p>
</blockquote>
<p><strong>Genome Sequencing and Assembly</strong></p>
<p>SMRTbell libraries were sequenced on a PacBio Sequel II system, and consensus reads (HiFi reads) were generated using ccs software (<a href="https://github.com/pacificbiosci-ences/unanimity">https://github.com/pacificbiosci-ences/unanimity</a>, accessed on 22 December 2021) with the parameter â€œâ€“inPasses 3â€. We generated 8.65 Gb and 5.35 Gb PacBio HiFi reads of SP3 and SP30, respectively. These long (~15 kb) and highly accurate (&gt;99%) HiFi reads were assembled using <strong>HiCanu</strong> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#B18-jof-08-00167">18</a>] for both strains with <strong>default parameters</strong>.</p>
<p>The vegetative mycelia of SP3 and SP30 were also used to generate Hi-C DNA libraries at the Frasergen Enterprise (Wuhan, China). The Hi-C libraries were quantified and sequenced on the Illumina Nova-seq platform (San Diego, CA, USA). The chimeric fragments from the original cross-linked long-distance physical interactions were then isolated and processed into libraries. For anchored contigs, 34,909,404 and 31,267,524 clean <strong>reads</strong> were generated from the Hi-C library and were <strong>mapped</strong> to the SP3 and SP30 <strong>preliminary assembly</strong> using <strong>Juicer</strong> [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#B20-jof-08-00167">20</a>] with default parameters. Paired reads mapped to different contigs were used for the Hi-C associated scaffolding. Self-ligated, non-ligated, and other invalid reads were filtered out. We applied <strong>3D-DNA</strong> to <strong>order</strong> and <strong>orient</strong> the clustered contigs. Then, <strong>Juicer</strong> was used to filter the sequences and cluster them, and the <strong>Juicebox</strong> was applied to <strong>adjust chromosome construction manually</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8877449/#app1-jof-08-00167">Figure S2</a>). We finally <strong>anchored the scaffolds on ten chromosomes</strong>. In addition, the BUSCO v3.0.231 pipeline was used to assess the completeness and accuracy of the SP3 and SP30 genomes.</p>
<p><img src="/blog/2022/03/16/2022-03-16-HiFi-7-HiC-assembly2/1.png" alt="æˆªå±2022-03-16ä¸Šåˆ10.03.37"></p>
<h1 id="4-2021-04-benchmark"><a href="#4-2021-04-benchmark" class="headerlink" title="4 2021.04 benchmark"></a>4 2021.04 benchmark</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#">Mol Med Rep.</a> 2021 Apr; 23(4): 251. </p>
<p>Published online 2021 Feb 2. doi: <a href="https://dx.doi.org/10.3892%2Fmmr.2021.11890">10.3892/mmr.2021.11890</a></p>
<blockquote>
<p>Benchmarking of next and third generation sequencing technologies and their associated algorithms for <em>de novo</em> genome assembly</p>
</blockquote>
<p><strong>Genome assembly</strong> </p>
<p>In order to assess the hybrid assembly strategy, the present study chose to evaluate two pipelines, MaSuRCA (version 3.3.5) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b27-mmr-0-0-11890">27</a>,<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b28-mmr-0-0-11890">28</a>) and Wengan (version 0.1) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b29-mmr-0-0-11890">29</a>). MaSuRCA workflow offers three different assemblers, CABOG (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b30-mmr-0-0-11890">30</a>), SOAPdenovo (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b31-mmr-0-0-11890">31</a>) and Flye (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b32-mmr-0-0-11890">32</a>). The pipeline was tested using CABOG and Flye assemblers, which are designed for long-read assembly. Wengan pipeline is based on DiscovarDenovo assembler (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b33-mmr-0-0-11890">33</a>).</p>
<p>Canu (version 2.0) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b34-mmr-0-0-11890">34</a>) is a long-read assembler, designed to use long high-noise single-molecule sequencing data, such as Nanopore and PacBio reads. Its workflow is based on the Celera assembler (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b35-mmr-0-0-11890">35</a>) which was used in the Human Genome Project to produce the first draft of the human genome. <strong>Hifiasm</strong> (version 0.13) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b36-mmr-0-0-11890">36</a>) and <strong>HiCanu</strong> (Canu version 2.1.1) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b37-mmr-0-0-11890">37</a>) are long-read assemblers exclusively <strong>for HiFi reads.</strong> The <strong>main difference</strong> between HiFi assemblers and the ones mentioned previously, is that <strong>Hifiasm and HiCanu produce phased assemblies</strong>. A phased assembly is a <strong>haplotype-resolved assembly</strong>, where <strong>high complexity regions</strong>, such as <strong>genes</strong>, will be <strong>separated into two different alleles</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b36-mmr-0-0-11890">36</a>,<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b38-mmr-0-0-11890">38</a>). HiCanu is a modified version of Canu, adapted to take advantage of the characteristics of HiFi reads. <strong>Hifiasm</strong> produces <strong>two different files</strong> for the <strong>primary</strong> and <strong>alternative</strong> assembly, whereas <strong>HiCanu</strong> <strong>combines</strong> the <strong>primary and the alternative</strong> assembly in the <strong>same FASTA file</strong>.</p>
<p><strong>Scaffolding</strong> </p>
<p>In order to test the necessity of scaffolding, a scaffolder was used to improve the assembly <strong>continuity</strong> and <strong>completeness</strong>, as follows: <strong>Hi-C data are mapped</strong> to the <strong>primary assembly</strong> by <strong>Arima</strong> mapping pipeline (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b39-mmr-0-0-11890">39</a>), to produce a BAM file which is consequently converted to a BED file. <strong>SALSA</strong> (version 2.2) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7893683/#b40-mmr-0-0-11890">40</a>) uses this BED file which contains the mapping information of Hi-C reads on the assembly, <strong>to scaffold</strong> the primary assembly.</p>
<p><strong>Quality control metrics</strong></p>
<p>QUAST (version 5.0.2)</p>
<p><strong>Genome consistency plots</strong></p>
<p>JupiterPlot (version 1.0) </p>
<h1 id="5-2022-02-PJ-ç•ªèŒ„ğŸ…"><a href="#5-2022-02-PJ-ç•ªèŒ„ğŸ…" class="headerlink" title="5. 2022.02-PJ ç•ªèŒ„ğŸ…"></a>5. 2022.02-PJ ç•ªèŒ„ğŸ…</h1><blockquote>
<p>A chromosome scale tomato genome built from complementary PacBio and Nanopore sequences alone reveals extensive linkage drag during breeding</p>
</blockquote>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/35106855/">https://pubmed.ncbi.nlm.nih.gov/35106855/</a></p>
<p>PacBio HiFi reads were independently assembled using Hifiasm and Canu, with respective N50 values of 31.3 and 17â€‰Mbp (Tableâ€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-tbl-0002">2</a>). Both HiFi assemblies <strong>contained single contigs that spanned the full length of the SL4.0 reference chromosome 5</strong> (Figureâ€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#support-information-section">S1</a>). We checked for the completeness of the assembly of gene sequences by Benchmarking Universal Single Copy Orthologs (BUSCO) analysis which showed both assemblies were almost gene complete (both 98.4%), slightly improving upon the SL4.0 genome and comparable to the <em>S. pimpinellifolium</em> â€˜LA2093â€™ genome.</p>
<p><strong>Hifiasm</strong> v0.14.2 (Cheng etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0013">2021</a>) was used to assemble the HiFi reads with default settings. Canu v2.1.1 was used to assemble the HiFi reads in â€˜HiCanuâ€™ mode (Nurk etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0050">2020</a>) with an estimated genome size of 916â€‰Mbp based on kmer counting of the raw HiFi data using Jellyfish v2.2.6 (MarÃ§ais &amp; Kingsford,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0044">2011</a>).</p>
<p><strong>Quast</strong> v5.0.2 (Mikheenko etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0047">2018</a>) and GAAS v1.1.0 (<a href="https://github.com/NBISweden/GAAS">https://github.com/NBISweden/GAAS</a>) were used to <strong>calculate statistics on fasta files</strong>. BUSCO was calculated using BUSCO v5.2.1 (Seppey etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0068">2019</a>) depending on hmmsearch v3.1, and metaeuk v4.a0f584d was used with lineage datasets solanales (<a href="https://busco-data.ezlab.org/v5/data/lineages/solanales_odb10.2020-08-05.tar.gz">https://busco-data.ezlab.org/v5/data/lineages/solanales_odb10.2020-08-05.tar.gz</a>) and eudicots (<a href="https://busco-data.ezlab.org/v5/data/lineages/eudicots_odb10.2020-09-10.tar.gz">https://busco-data.ezlab.org/v5/data/lineages/eudicots_odb10.2020-09-10.tar.gz</a>) to obtain evolutionarily informed expectations of gene content. To assess the LAI, LTR retriever v2.9.0 (Ou etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0051">2018</a>) was run with default settings on the respective genome assemblies.</p>
<p>We ran one single round of <strong>Salsa</strong> v2.2 (Ghurye etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0026">2019</a>) with optional settings: <strong>-e DNASE -m yes -p yes</strong>.</p>
<p>A modified version of the <strong>convert.sh</strong> script was used to convert the Salsa2 output to a Hi-C file, which was used within a local installation of <strong>Juicebox</strong> (<a href="https://github.com/aidenlab/Juicebox">https://github.com/aidenlab/Juicebox</a>) v1.11.08 to generate a <strong>Hi-C contact plot.</strong></p>
<p>The MbTMV genome assembly was aligned to SL4.0 (Hosmani etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0030">2019</a>) using <strong>Minimap2</strong> v2.17 (Li,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0039">2018</a>) with default settings, followed by running RaGOO v1.11 (Alonge etâ€‰al.,â€‰<a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15690#tpj15690-bib-0003">2019</a>) with default options.</p>
<h1 id="6-2021-09-gpb-æ‹Ÿå—èŠ¥"><a href="#6-2021-09-gpb-æ‹Ÿå—èŠ¥" class="headerlink" title="6. 2021.09-gpb æ‹Ÿå—èŠ¥"></a>6. 2021.09-gpb æ‹Ÿå—èŠ¥</h1><blockquote>
<p>High-quality Arabidopsis thaliana Genome Assembly with Nanopore and HiFi Long Reads</p>
</blockquote>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/34487862/">https://pubmed.ncbi.nlm.nih.gov/34487862/</a></p>
<p><strong>HiFi sequencing and assembly</strong></p>
<p>Sequencing was performed on a PacBio Sequel II instrument with Sequencing Primer V2 and Sequel II Binding Kit 2.0 at the Genome Center of Grandomics. A total of 22.90 Gb of HiFi reads with âˆ¼157 Ã— coverage were generated, and N50 of the reads was 15,424 bp. HiFi reads were assembled using <strong>hifiasm</strong> v. 0.14-r312 [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0085">17]</a>with <strong>default parameters</strong>, and the <strong>gfatools</strong> (<a href="https://github.com/lh3/gfatools">https://github.com/lh3/gfatools</a>) was used to convert sequence graphs in the <strong>GFA to FASTA</strong> format.</p>
<p><strong>Hi-C sequencing and scaffolding</strong></p>
<p>Hi-C library was prepared from cross-linked chromatins of plant cells using a standard Hi-C protocol; the library was then sequenced using Illumina NovaSeq 6000. A total of 21.14 Gb of Hi-C reads with âˆ¼158 Ã— coverage were generated. The Hi-C sequencing data were used to <strong>anchor</strong> all contigs using <strong>Juicer</strong> v. 1.5 [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0220">44]</a>, <strong>followed by a 3D-DNA scaffolding pipeline</strong> [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0225">45]</a>. Scaffolds were then <strong>manually checked and refined</strong> with <strong>Juicebox</strong> v. 1.11.08 [<a href="https://www.sciencedirect.com/science/article/pii/S1672022921001741?via=ihub#b0230">46]</a>.</p>
<h1 id="7-2021-11-J-Hered-èŒ±è¸"><a href="#7-2021-11-J-Hered-èŒ±è¸" class="headerlink" title="7. 2021.11-J Hered èŒ±è¸"></a>7. 2021.11-J Hered èŒ±è¸</h1><p><strong>Nuclear Genome Assembly</strong></p>
<p>We assembled the genome of the big berry manzanita following a <strong>protocol</strong> adapted from <strong>Rhie et al</strong>. (2021) as part of the CCGP assembly efforts. The CCGP assembly protocol version 1.0 uses PacBio <strong>HiFi</strong> reads and <strong>Hi-C</strong> chromatin capture data for the generation of high-quality and highly contiguous nuclear genome assemblies. The output corresponding to a diploid assembly consists of <strong>two pseudo haplotypes</strong> (<strong>primary</strong> and <strong>alternate</strong>). The <strong>primary</strong> assembly is <strong>more complete</strong> and consists of <strong>longer phased blocks</strong>. The <strong>alternate</strong> consists of <strong>haplotigs</strong> (contigs of clones with the same haplotype) in <strong>heterozygous regions</strong> and is not as complete and more fragmented. Given the characteristics of the latter, it <strong>cannot be considered on its own</strong> but as <strong>a complement of the primary assembly</strong> (<a href="https://lh3.github.io/2021/04/17/concepts-in-phased-assemblies">https://lh3.github.io/2021/04/17/concepts-in-phased-assemblies</a>, <a href="https://www.ncbi.nlm.nih.gov/grc/help/definitions/">https://www.ncbi.nlm.nih.gov/grc/help/definitions/</a>).</p>
<p>To generate this assembly, we <strong>removed remnant adapter</strong> sequences from the PacBio HiFi dataset using <strong>HiFiAdapterFilt</strong> and assembled the initial set of contigs with the filtered PacBio reads using <strong>HiFiasm</strong> (see Table 1 for assembly pipeline and relevant software). Next, we <strong>identified sequences corresponding to haplotypic duplications and contig overlaps</strong> on the <strong>primary assembly</strong> with <strong>purge_dups</strong> [Version 1.0.1] (Guan et al. 2020) and transferred them to the alternate assembly. We a<strong>ligned the Hi-C data</strong> to both <strong>primary and alternate assemblies</strong> using the <strong>Arima Genomics Mapping Pipeline</strong> (<a href="https://github.com/ArimaGenomics/mapping_pipeline">https://github.com/ArimaGenomics/mapping_pipeline</a>) and <strong>scaffolded</strong> the genomes using <strong>SALSA</strong> [Version 2, options â€“e GATCGATC] (Ghurye et al. 2017; Ghurye et al. 2019). We <strong>closed the generated gaps</strong> in both <strong>assemblies</strong> using the PacBio <strong>HiFi</strong> reads and <strong>YAGCloser</strong> (<a href="https://github.com/merlyescalona/yagcloser">https://github.com/merlyescalona/yagcloser</a>). The <strong>primary assembly</strong> was <strong>manually curated</strong> by <strong>iteratively generating and analyzing</strong> Hi-C <strong>contact maps</strong>. To generate the contact maps, we <strong>aligned</strong> the <strong>Hi-C</strong> data against the corresponding reference with <strong>bwa</strong> mem, identified ligation junctions, and generated <strong>Hi-C pairs</strong> using <strong>pairtools</strong> [Version 0.3.0] (Goloborodko et al. 2018). We generated a multi-resolution <strong>Hi-C matrix</strong> in binary form with <strong>cooler</strong> [Version 0.8.10] (Abdennur and Mirny 2020) and balanced it with <strong>hicExplorer</strong> [Version 3.6] (RamÃ­rez et al. 2018). We used <strong>HiGlass</strong> [Version 2.1.11] (Kerpedjiev et al. 2018) and the <strong>PretextSuite</strong> (<a href="https://github.com/wtsi-hpag/PretextView">https://github.com/wtsi-hpag/PretextView</a>; <a href="https://github.com/wtsihpag/PretextMap">https://github.com/wtsihpag/PretextMap</a>; <a href="https://github.com/wtsi-hpag/PretextSnapshot">https://github.com/wtsi-hpag/PretextSnapshot</a>) to <strong>visualize the contact maps</strong>. Assemblies were then checked for contamination using the <strong>BlobToolKit Framework</strong> [Version 2.3.3] (Challis et al. 2020), and <strong>trimmed</strong> for remnants of sequence adaptors and <strong>mitochondrial</strong> contamination.</p>
<p>Table1 Assembly pipeline and software usage. Software citations are listed in the text</p>
<table>
<thead>
<tr>
<th>Assembly</th>
<th align="left">Software</th>
<th align="left">Version</th>
</tr>
</thead>
<tbody><tr>
<td>Filtering PacBio HiFi adapters</td>
<td align="left">HiFiAdapterFilt   <a href="https://github.com/sheinasim/HiFiAdapterFilt">https://github.com/sheinasim/HiFiAdapterFilt</a></td>
<td align="left">Commit 64d1c7b</td>
</tr>
<tr>
<td>K-mer counting</td>
<td align="left">Meryl</td>
<td align="left">1</td>
</tr>
<tr>
<td>Estimation of genome size and heterozygosity</td>
<td align="left"><font color="green"><strong>GenomeScope</strong> </font></td>
<td align="left">2</td>
</tr>
<tr>
<td><em>De novo</em> assembly (contiging)</td>
<td align="left"><font color="green"><strong>HiFiasm</strong> </font></td>
<td align="left">0.13-r308</td>
</tr>
<tr>
<td>Long read, genome-genome alignment</td>
<td align="left"><font color="green"><strong>minimap2</strong> </font></td>
<td align="left">2.16</td>
</tr>
<tr>
<td>Remove low-coverage, duplicated contigs</td>
<td align="left"><font color="green"><strong>purge_dups</strong></font></td>
<td align="left">1.0.1</td>
</tr>
<tr>
<td><strong>Scaffolding</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td>Hi-C mapping for SALSA</td>
<td align="left"><font color="green"><strong>Arima</strong></font> Genomics mapping pipeline   <a href="https://github.com/ArimaGenomics/mapping_pipeline">https://github.com/ArimaGenomics/mapping_pipeline</a></td>
<td align="left">2e74ea4</td>
</tr>
<tr>
<td>Hi-C Scaffolding</td>
<td align="left"><font color="green"><strong>SALSA</strong> </font></td>
<td align="left">2</td>
</tr>
<tr>
<td>Gap closing</td>
<td align="left">YAGCloser?   <a href="https://github.com/merlyescalona/yagcloser">https://github.com/merlyescalona/yagcloser</a></td>
<td align="left">20e2769</td>
</tr>
<tr>
<td><strong>Hi-C contact map generation</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td>Short-read alignment</td>
<td align="left">bwa</td>
<td align="left">0.7.17-r1188</td>
</tr>
<tr>
<td>SAM/BAM processing</td>
<td align="left">samtools</td>
<td align="left">1.11</td>
</tr>
<tr>
<td>SAM/BAM filtering</td>
<td align="left">pairtools</td>
<td align="left">0.3.0</td>
</tr>
<tr>
<td>Pairs indexing</td>
<td align="left">pairix</td>
<td align="left">0.3.7</td>
</tr>
<tr>
<td>Matrix generation</td>
<td align="left">Cooler</td>
<td align="left">0.8.10</td>
</tr>
<tr>
<td>Matrix balancing</td>
<td align="left">hicExplorer</td>
<td align="left">3.6</td>
</tr>
<tr>
<td>Contact map visualization</td>
<td align="left">HiGlass</td>
<td align="left">2.1.11</td>
</tr>
<tr>
<td></td>
<td align="left">PretextMap</td>
<td align="left">0.1.4</td>
</tr>
<tr>
<td></td>
<td align="left">PretextView</td>
<td align="left">0.1.5</td>
</tr>
<tr>
<td></td>
<td align="left">PretextSnapshot</td>
<td align="left">0.0.3</td>
</tr>
<tr>
<td><strong>Organelle assembly</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td>Sequence similarity search</td>
<td align="left"><font color="green">BLAST+ </font></td>
<td align="left">2.10</td>
</tr>
<tr>
<td>Long read alignment</td>
<td align="left"><font color="green">Pbmm2</font> (<a href="https://github.com/PacificBiosciences/pbmm2">https://github.com/PacificBiosciences/pbmm2</a>)</td>
<td align="left">1.4.0</td>
</tr>
<tr>
<td>Variant calling and consensus</td>
<td align="left">bcftools</td>
<td align="left">1.11-5</td>
</tr>
<tr>
<td>Extraction of sequences</td>
<td align="left">seqtk</td>
<td align="left">1.3-r115</td>
</tr>
<tr>
<td>Circular-aware long-read alignment</td>
<td align="left"><font color="green">racon </font></td>
<td align="left">1.4.19</td>
</tr>
<tr>
<td>Sequence polishing</td>
<td align="left">raptor</td>
<td align="left">0.20.3</td>
</tr>
<tr>
<td>Sequence alignment</td>
<td align="left">lastz</td>
<td align="left">1.04.08</td>
</tr>
<tr>
<td>Gene annotation</td>
<td align="left">MitoFinder</td>
<td align="left">1.4</td>
</tr>
<tr>
<td><strong>Genome quality assessment</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td>Basic assembly metrics</td>
<td align="left"><font color="green"><strong>QUAST</strong> </font></td>
<td align="left">5.0.2</td>
</tr>
<tr>
<td>Assembly completeness</td>
<td align="left"><font color="green"><strong>BUSCO</strong> </font></td>
<td align="left">5.0.0</td>
</tr>
<tr>
<td></td>
<td align="left">Merqury</td>
<td align="left">1</td>
</tr>
<tr>
<td><strong>Contamination screening</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td>General contamination screening</td>
<td align="left">BlobToolKit</td>
<td align="left">2.3.3</td>
</tr>
</tbody></table>
<p><strong>Mitochondrial Genome Assembly</strong></p>
<p>We identified <strong>a subset of mitochondrial reads from the PacBio HiFi</strong> dataset using <strong>BLAST+</strong>  by identifying regions of similarity between the reads and the mitochondrial <strong>(mito) database</strong> (NCBI). These mitochondrial reads were used as input in <strong>HiFiasm</strong> [Version 0.13-r308] to generate the <strong>mitochondrial</strong> <strong>assembly</strong>. Given the circularity of the mitochondrial genome, we carried out self-alignment of the sequence using <strong>lastz</strong> [Version 1.04.08] (Harris 2007) to <strong>manually identify and remove duplicated regions</strong>. We aligned the subset of mitochondrial reads to the assembly using <strong>raptor</strong> [Version 0.20.3-171e0f1] (<a href="https://github.com/isovic/raptor">https://github.com/isovic/raptor</a>) and <strong>polished</strong> it with <strong>racon</strong> [Version 1.14.] (<a href="https://github.com/isovic/racon">https://github.com/isovic/racon</a>). We searched for <strong>matches</strong> of the resulting <strong>mitochondrial assembly</strong> sequence in the nuclear genome assembly using <strong>BLAST+</strong> and <strong>filtered out scaffolds from the nuclear genome</strong> with a percentage of <strong>sequence identity &gt;99%</strong> and <strong>size smaller than the mitochondrial assembly sequence</strong>. From the <strong>subset of mitochondrial reads</strong> used for the assembly, we analyzed the <strong>BLAST</strong> output and <strong>the species of the closest mitochondrial sequence</strong> available in the NCBI GenBank database, <em>Vaccinium macrocarpon</em> (Accession number: <a href="https://www.ncbi.nlm.nih.gov/nuccore/NC_023338.1">NC_023338.1</a>). We used the mitochondrial assembly of <em>V. macrocarpon</em> as a <strong>guide</strong> for the <strong>mitochondrial gene annotation</strong> generated with <strong>MitoFinder</strong> [Version 1.4] (Allio et al. 2020).</p>
<p><strong>Chloroplast Genome Assembly</strong></p>
<p>We identified chloroplast reads from the PacBio HiFi dataset with BLAST+ using the plastids RefSeq genomes [v4.1] (Oâ€™Leary et al. 2016). From this subset, we analyzed the matches and identified the species of the closest chloroplast sequence available in the NCBI database as <em>Camellia taliensis</em> (NC_022264.1). Next, we found matches of the <em>C. taliensis</em> chloroplast genome sequence in the nuclear genome assembly with BLAST+ and filtered out scaffolds from the nuclear genome assembly with length smaller than the <em>C. taliensis</em> length, sequence identity &gt;90%, and <em>e</em>-value &lt;0.00001. We aligned the filtered scaffolds to the <em>C. taliensis</em> chloroplast genome with minimap2 (Li 2018) and generated a consensus sequence with bcftools (Li 2011). We manually curated the sequence using lastz. Finally, we polished the last assembly version using raptor and racon and annotated it using the web platform GeSeq (Tillich et al. 2017).</p>
<h1 id="8-2022-02-pj-æ¾³æ´²åšæœ-value"><a href="#8-2022-02-pj-æ¾³æ´²åšæœ-value" class="headerlink" title="8. 2022.02-pj æ¾³æ´²åšæœ value"></a>8. 2022.02-pj æ¾³æ´²åšæœ value</h1><blockquote>
<p> De novo chromosome level assembly of a plant genome from long read sequence data</p>
</blockquote>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/34784084/">https://pubmed.ncbi.nlm.nih.gov/34784084/</a></p>
<p>We now report the use of <strong>HiFiasm</strong> to assemble the genome of Macadamia jansenii, a genome that has been used as a model to test sequencing and assembly. This achieved <strong>almost complete chromosome level assembly</strong> from the sequence data alone <strong>without</strong> the need for <strong>higher level chromosome map information</strong>. <strong>Eight of the 14 chromosomes were represented by a single large contig</strong> (six with telomere repeats at both ends) and the <strong>other six assembled from two to four main contigs</strong>. The small number of chromosome breaks appears to be the result of <strong>highly repetitive regions</strong> including ribosomal genes that cannot be assembled by these approaches. </p>
<p>Table 1. HiFiasm contigs in different size categories and comparison of primary and haploid assemblies generated from HiFiasm genome assembler tool</p>
<table>
<thead>
<tr>
<th align="left">Number of contigs</th>
<th align="left">Assembly length (Mb)</th>
<th align="left">N50 (Mb)</th>
<th align="left">N75 (Mb)</th>
<th align="left">busco(%)</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="left">HiFiasm assembly</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td></td>
</tr>
<tr>
<td align="left">Total contigs</td>
<td align="left">779</td>
<td align="left">826</td>
<td align="left">46</td>
<td align="left">25</td>
<td>99.6</td>
</tr>
<tr>
<td align="left">Contigs &gt;40â€‰Mb</td>
<td align="left">10</td>
<td align="left">524</td>
<td align="left">50</td>
<td align="left">46</td>
<td>68.7</td>
</tr>
<tr>
<td align="left">Contigs &gt;10â€‰Mb</td>
<td align="left">19</td>
<td align="left">746</td>
<td align="left">48</td>
<td align="left">39</td>
<td>93.9</td>
</tr>
<tr>
<td align="left">Contigs &gt;1â€‰Mb</td>
<td align="left">30</td>
<td align="left">784</td>
<td align="left">46</td>
<td align="left">30</td>
<td>99.1</td>
</tr>
<tr>
<td align="left">Contigs &gt;100â€‰kb</td>
<td align="left">94</td>
<td align="left">805</td>
<td align="left">46</td>
<td align="left">27</td>
<td>99.0</td>
</tr>
<tr>
<td align="left">Between 100â€‰kb and 1â€‰Mb</td>
<td align="left">64</td>
<td align="left">20</td>
<td align="left">0.49</td>
<td align="left">0.22</td>
<td>0.20</td>
</tr>
<tr>
<td align="left">Between 10â€‰kb and 100â€‰kb</td>
<td align="left">685</td>
<td align="left">22</td>
<td align="left">0.032</td>
<td align="left">0.028</td>
<td>0.00</td>
</tr>
<tr>
<td align="left">Comparison of HiFiasm primary and haploid assemblies</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td></td>
</tr>
<tr>
<td align="left">Primary assembly</td>
<td align="left">779</td>
<td align="left">827</td>
<td align="left">46.1</td>
<td align="left">25</td>
<td>99.60</td>
</tr>
<tr>
<td align="left">Hap 1_assembly</td>
<td align="left">879</td>
<td align="left">816</td>
<td align="left">24.4</td>
<td align="left">8.9</td>
<td>98.80</td>
</tr>
<tr>
<td align="left">Hap 2_assembly</td>
<td align="left">363</td>
<td align="left">776</td>
<td align="left">14.3</td>
<td align="left">5.4</td>
<td>97.90</td>
</tr>
<tr>
<td align="left">Hap 1 &gt;1â€‰Mb</td>
<td align="left">96</td>
<td align="left">736</td>
<td align="left">16.4</td>
<td align="left">6.8</td>
<td>96.70</td>
</tr>
<tr>
<td align="left">Hap 2 &gt;1â€‰Mb</td>
<td align="left">72</td>
<td align="left">766</td>
<td align="left">24.5</td>
<td align="left">12.3</td>
<td>98.10</td>
</tr>
</tbody></table>
<p><strong>HiFiasm assembly</strong></p>
<p>For assembly, <strong>24 core</strong> processing units and <strong>120â€‰Gb of memory</strong> was employed. Default settings of the HiFiasm assembler were used to assemble heterozygous genomes with <strong>built-in duplication purging parameters</strong>. The HiFiasm output directory consists of two haploid (1 and 2), one primary contig and one alternate haplotig GFA graph files. Each halplotig and one primary contig GFA file was converted to FASTA format using the <strong>awk</strong> command.</p>
<p><strong>Analysis of assembly</strong></p>
<p>The primary HiFiasm assembly of <em>M. jansenii</em> included 779 contigs that were categorised into three subsets: (i) contigs &lt;1â€‰Mb size; (ii) contigs &lt;1â€‰Mb and more than 100â€‰kb size; and (iii) contigs &lt;100â€‰kb size. Along with the <strong>main primary and two haploid assemblies</strong>, all <strong>three</strong> sets of primary contig subsets were <strong>passed</strong> through analysis using <strong>quast</strong> (Gurevich etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0010">2013</a>), <strong>busco</strong> (SimÃ£o etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0028">2015</a>) and <strong>repeatmodeler</strong> (Humann etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0012">2019</a>). The <strong>telomere sequences</strong> in the HiFiasm <strong>contigs</strong> were identified using the <strong>bioserf platform</strong> (<a href="https://bioserf.org/">https://bioserf.org</a>) (Somanathan and Baysdorfer, <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0029">2018</a>). <strong>Ribosomal RNA</strong> and <strong>other protein coding genes</strong> at the <strong>terminal</strong> end of the HiFiasm contigs were identified using an <strong>ncbi blast search</strong> (<a href="https://blast.ncbi.nlm.nih.gov/">https://blast.ncbi.nlm.nih.gov</a>). Ribosomal RNA in the contigs was identified using <strong>Barrnap</strong> (<a href="https://github.com/tseemann/barrnap">https://github.com/tseemann/barrnap</a>) (Seemann, <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0023">2013</a>) with default settings for eukaryotes.</p>
<p><strong>Comparison with Hi-C assembly</strong></p>
<p>The HiFiasm contigs were compared with the <em>M. jansenii</em> 14 pseudo-molecules from the Hi-C assembly (Sharma etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0026">2021b</a>) using the online interactive D-Genies dotplot tool (Cabanettes and Klopp, <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0003">2018</a>) to <strong>compare two genomes using Minimap2</strong> and, for <strong>alignments</strong>, dotplot images were created after selecting the â€˜sort contigsâ€™ option, selecting the â€˜minimum identityâ€™ parameter at 0.75 and checking the â€˜strong precisionâ€™ tick box.</p>
<p><strong>Characterisation of organelle genomes content of HiFiasm contigs</strong></p>
<p>A reference <font color="red"><strong>mitochondrial</strong> genome, <strong>chloroplast</strong> genome and <strong>nuclear ribosomal RNA</strong> sequence</font> from this sample were assembled from <strong>Illumina raw reads</strong> (Murigneux etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0020">2020</a>) using the <strong>GetOrganelle toolkit</strong> (Jin etâ€‰al., <a href="https://onlinelibrary.wiley.com/doi/10.1111/tpj.15583#tpj15583-bib-0013">2020</a>) with default parameters. The <strong>HiFiasm contigs</strong> (779) were <strong>compared with</strong> the <strong>organellar and ribosomal sequences</strong> in dotplots.</p>
<h1 id="9-2021-04-Mol-Ecol-Resour-ç™¾é¦™æœ"><a href="#9-2021-04-Mol-Ecol-Resour-ç™¾é¦™æœ" class="headerlink" title="9. 2021.04-Mol Ecol Resour ç™¾é¦™æœ"></a>9. 2021.04-Mol Ecol Resour ç™¾é¦™æœ</h1><p><a href="https://onlinelibrary.wiley.com/doi/10.1111/1755-0998.13310">https://onlinelibrary.wiley.com/doi/10.1111/1755-0998.13310</a></p>
<blockquote>
<p>Chromosome-level reference genome assembly provides insights into aroma biosynthesis in passion fruit (Passiflora edulis)</p>
</blockquote>
<p>The assembled reference genome is 1.28 Gb size with a scaffold N50 of 126.4 Mb and 99.22% sequences anchored onto nine pseudochromosomes. ä»¥å¾€çš„æ ¸å‹åˆ†æè¡¨æ˜ç™¾é¦™æœæ˜¯ä¸€ç§äºŒå€ä½“ï¼Œ9å¯¹æŸ“è‰²ä½“</p>
<p><strong>Genome survey and assembly</strong><br>A total of 89.12 Gb of high-quality paired-end reads were obtained by <strong>Illumina</strong> genomic sequencing (~70.35X coverage, Table S1). The genome size, heterozygosity and repeat content were estimated based on k-mer distribution using <strong>21-mers</strong> extracted from the Illumina short reads. The estimated genome size was further validated using <strong>flow cytometr</strong>y. A total of 223.91 Gb raw PacBio subreads were filtered and corrected using pbccs pipeline with default parameters (<a href="https://github.com/PacificBiosciences/ccs">https://github.com/PacificBiosciences/ccs</a>). The resulted CCS reads were subjected to hifiasm for de novo assembly. We <font color="red"><strong>corrected</strong> the <strong>primary contigs</strong> by the <strong>Pilon</strong></font> (version1.18) (Utturkar, Klingeman, Hurt, &amp; Brown, 2017) program <strong>using 89.12 Gb (70.35Ã—) of Illumina paired-end reads</strong>. BWA (version0.7.10-r789) (Li, 2013) and SAMtools (version1.9) (Li et al., 2009) were used for reads alignment and SAM/BAM format conversion. <strong>BUSCO</strong> (version3.0) (Simao, Waterhouse, Ioannidis, Kriventseva, &amp; Zdobnov, 2015) program with embryophyta_odb10 database were used to assess the completeness of genome and gene annotation .</p>
<p><strong>Chromosome assembly using Hi-C</strong></p>
<p>Approximately 96.4 Gb of Hi-C data were generated. The raw data were filtered using perl script as implemented in the software <strong>LACHESIS</strong> (Burton et al., 2013). BWA software was used to <strong>map the Hi-C reads to the draft assembly</strong> and <strong>uniquely mapped reads were selected for furtheranalysis</strong>. We further applied our newly developed <strong>ALLHiC pipeline</strong> to link the contigs into <strong>nine pseudo-chromosomes</strong>. <strong>HiC-pro</strong> (version2.10.0) (Servant et al., 2015) program was used to <strong>calculate Hi-C mapping rate and evaluate the quality of Hi-C scaffolding</strong>.</p>
<h1 id="10-2021-10-MolEcolResour-ç‰¡è›ğŸ¦ª"><a href="#10-2021-10-MolEcolResour-ç‰¡è›ğŸ¦ª" class="headerlink" title="10. 2021-10-MolEcolResour ç‰¡è›ğŸ¦ª"></a>10. 2021-10-MolEcolResour ç‰¡è›ğŸ¦ª</h1><blockquote>
<p>Chromosome-level genome and population genomic analysis provide insights into the evolution and environmental adaptation of Jinjiang oyster Crassostrea ariakensis</p>
</blockquote>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/34800349/">https://pubmed.ncbi.nlm.nih.gov/34800349/</a></p>
<p>The C. ariakensis genome was 662.9 Mb with contig N50 length of 5.9 Mb using PacBio HiFi-CCS long reads, and 99.83% sequences were anchored onto 10 pseudochromosomes using Hi-C data.</p>
<h1 id="11-2021-10-Front-Genet-æ€èŒ…æ¾æ¯›è™«"><a href="#11-2021-10-Front-Genet-æ€èŒ…æ¾æ¯›è™«" class="headerlink" title="11. 2021.10-Front Genet æ€èŒ…æ¾æ¯›è™«"></a>11. 2021.10-Front Genet æ€èŒ…æ¾æ¯›è™«</h1><blockquote>
<p>Chromosome-Level Genome Assembly Reveals Significant Gene Expansion in the Toll and IMD Signaling Pathways of <em>Dendrolimus kikuchii</em></p>
</blockquote>
<p>forest pests</p>
<p>Overall, a final genome assembly of 705.51 Mb with contig and scaffold N50 values of 20.89 and 24.73 Mb, respectively, was obtained. Of these contigs, 95.89% had unique locations on 29 chromosomes.</p>
<p><strong>Genome Assembly and Polish</strong></p>
<p>After quality control of raw reads, the pass reads were used for <em>de novo</em> genome assembly of using an <strong>OLC (overlap layout-consensus)/string graph method</strong> with NextDenovo (v2.3.0) with reads_cutoff:1 k and seed_cutoff:30 k. Firstly, self-correction of the original subreads was finished by NextCorrect to obtain consistent sequences (CNS reads). Then, CNS reads were used to obtain preliminary assembly through NextGraph (default parameter). The ONT, CCS and Hi-C data were used to correct the preliminary assembly using Racon (v1.3.1, default, CCS data) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B66">Vaser et al., 2017</a>)and Nextpolish (v1.2.4, default, ONT and Hi-C data) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B24">Hu et al., 2020</a>). <strong>BlastN was used to check the genome contamination</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#s10">Supplementary information S2</a>).</p>
<p>Completeness of the genome assembly was assessed using <strong>BUSCO</strong> v4.0.5 (Benchmarking universal Single-Copy Orthologs) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B58">Simao et al., 2015</a>) and CEGMA (Core Eukaryotic Gene Mapping Approach) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B55">Parra et al., 2007</a>). <strong>To evaluate the accuracy of the assembly</strong>, all <strong>paired-end reads were mapped to the assembled</strong> genome using <strong>BWA</strong>  (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B39">Li and Durbin, 2010</a>) and the <strong>mapping rate</strong> and the genome coverage of sequencing reads were both assessed using SAMtools v0.1.1855 (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B40">Li et al., 2009</a>). In addition, the base accuracy of the assembly was calculated using bcftools (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B13">Danecek and Mccarthy, 2017</a>). Coverage of the expressed genes of the assembly was examined by aligning all the RNA-seq reads against the assembly using HISAT with default parameters. <strong>To ensure that mitochondrial sequences were not included in the assembly,</strong> the draft genome assembly was submitted to the <strong>NT library</strong> and matching sequences were eliminated.</p>
<p><strong>Genome Anchoring to Chromosome</strong></p>
<p>The read quality (370 million paired-end reads) was controlled using Hi-C-Pro. Firstly low-quality sequences (quality scores &lt;20), adaptor sequences, and sequences shorter than 30 bp were filtered out using <strong>fastp</strong> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B10">Chen et al., 2018</a>). Next, clean reads were mapped to the draft assembled sequence using <strong>bowtie2</strong> (v2.3.2) (-end-to-end â€“very-sensitive -L 30) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B37">Langmead and Salzberg, 2012</a>) to obtain the unique mapped paired-end reads. Invalid read pairs were filtered using <strong>HiC-Pro</strong> (v2.8.1) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8589036/#B57">Servant et al., 2015</a>). The scaffolds were further <strong>clustered, ordered, and oriented onto chromosomes</strong> by <strong>LACHESIS</strong> (<a href="https://github.com/shendurelab/LACHESIS">https://github.com/shendurelab/LACHESIS</a>), with parameters <strong>CLUSTER_MIN_RE_SITES = 100, CLUSTER_MAX_LINK_DENSITY = 2.5, CLUSTER NONINFORMATIVE RATIO = 1.4, ORDER MIN N RES IN TRUNK = 60, ORDER MIN N RES IN SHREDS = 60.</strong> Lastly, placement and orientation errors exhibiting obvious discrete chromatin interaction patterns were <strong>manually adjusted</strong>.</p>
<p><strong>Synteny</strong> of the <em>D. kikuchii</em> <strong>genome</strong> with the <em>D. punctatus</em> <strong>genomes</strong> was analyzed using <strong>Minimap2</strong> and <strong>dotPlotly</strong> to identify chromosome structural changes among the two species.</p>
]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>denovo-III</tag>
      </tags>
  </entry>
  <entry>
    <title>HiFi-6-[HiFi-HiC-assembly-method]</title>
    <url>/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/</url>
    <content><![CDATA[<p>è¾…åŠ©ç»„è£…æ¡ˆä¾‹</p>
<span id="more"></span>

<h1 id="1-2016-05-np-ç¢§å†¬èŒ„"><a href="#1-2016-05-np-ç¢§å†¬èŒ„" class="headerlink" title="1. 2016.05-np ç¢§å†¬èŒ„"></a>1. 2016.05-np ç¢§å†¬èŒ„</h1><p><strong>Insight into the evolution of the Solanaceae from the parental genomes of Petunia hybrida</strong></p>
<h2 id="Genome-sequencing-assembly-and-annotation"><a href="#Genome-sequencing-assembly-and-annotation" class="headerlink" title="Genome sequencing, assembly and annotation."></a>Genome sequencing, assembly and annotation.</h2><p>Plants were grown and DNA was extracted following the methods described at Supplementary Note 1.</p>
<p>Illumina libraries with 0.17-, 0.35-, 0.5-, 0.8-, 1-, 2-, 5-, 8- and 15-kb inserts were sequenced at BGI-Shenzghen and University of Illinois, Roy J. Carver Biotechnology. PacBio P. axillaris DNA library was sequenced with P4/C2 chemistry.</p>
<p>Illumina reads were processed using <strong>Fastq-mcf</strong> (<strong>quality filtering</strong>; <a href="https://code.google.com/p/eautils/wiki/FastqMcf">https://code.google.com/p/eautils/wiki/FastqMcf</a>), <strong>PRINSEQ</strong> (<strong>duplication filtering</strong>; http:// prinseq.sourceforge.net/) and <strong>Musket</strong> (<strong>error correction</strong>; <a href="http://musket.sourceforge/">http://musket.sourceforge</a>. net/). <strong>Pacbio reads</strong> were processed using the <strong>SMRT Analysis pipeline</strong> (v.2.0.1; <a href="https://github.com/PacificBiosciences/SMRT-Analysis">https://github.com/PacificBiosciences/SMRT-Analysis</a>).</p>
<p>Both genomes were assembled with <strong>SOAPdenovo</strong> with different k-mer sizes. For both genomes, <strong>k-mer = 79</strong> showed the best statistics. Gaps between contigs were completed using <strong>GapCloser</strong> . Additionally for P. axillaris, <strong>PacBio reads</strong> were integrated in <strong>four different steps</strong>: (1) <strong>Rescaffolding</strong> of the <strong>Illumina contigs</strong> using the <strong>PacBio reads</strong> and the <strong>AHA assembler</strong>; (2) <strong>Gap filling</strong> using <strong>PBJelly</strong>; (3) <strong>Rescaffolding</strong> using the Illumina <strong>pair data</strong> and <strong>SSPACE</strong>; (4) Last round of <strong>gap filling</strong> using <strong>PBJelly</strong> . </p>
<p><strong>Genome size estimation</strong> was performed through the k-mers abundance distribution (<strong>k-mer = 31</strong>). <strong>Heterozygosity</strong> was <strong>estimated</strong> mapping the Illumina reads to the assemblies using <strong>Bowtie2</strong>, calling SNPs using <strong>FreeBayes</strong> and  annotating the SNPs using <strong>SnpEff</strong> .</p>
<p>The genome structural annotation was performed using <strong>Maker-P</strong>: (1) <strong>SNAP</strong> and <strong>Augustus</strong> as ab initio gene predictors; (2) Exonerate as experimental based predictor with 454 and Illumina RNASeq reads and protein sequences from different protein datasets. RNAseq Illumina data was mapped using <strong>Tophat2</strong> . tRNAs were annotated using <strong>tRNAscan</strong> (<a href="http://lowelab.ucsc.edu/tRNAscan-SE/">http://lowelab.ucsc.edu/tRNAscan-SE/</a>).</p>
<p>The <strong>gene functional annotation</strong> was performed by <strong>sequence homology search</strong> with different protein datasets using <strong>BlastP</strong> and protein domains search using <strong>InterProScan</strong> . Functional annotations were integrated using <strong>AHRD</strong> (<a href="https://github.com/groupschoof/AHRD">https://github.com/groupschoof/AHRD</a>). See Supplementary Note 1.</p>
<h2 id="Repetitive-elements-analysis"><a href="#Repetitive-elements-analysis" class="headerlink" title="Repetitive elements analysis"></a>Repetitive elements analysis</h2><p>Repeat annotation was performed using RepeatModeler (v1.0.8; <a href="http://www.repeatmasker.org/RepeatModeler.html">http://www.repeatmasker.org/RepeatModeler.html</a>), RepeatMasker (v4.0.5; <a href="http://www.repeatmasker.org/">http://www.repeatmasker.org</a>) with the repeat database Repbase (release 20140131; <a href="http://www.girinst.org/repbase/">http://www.girinst.org/repbase/</a>) and Geneious (v7.1.4; <a href="http://www.geneious.com/">http://www.geneious.com</a>). Identification of PVCV-like and EPRV elements was performed using BlastN and TBlastN . The identified sequences were aligned with ClustalW (MEGA5 package;<a href="http://www.megasoftware.net/">http://www.megasoftware.net/</a>) and then manually curated. RepeatExplorer (<a href="http://www.repeatexplorer.org/">http://www.repeatexplorer.org/</a>) and other methods were used to extend the analysis to unassembled repeats. Fluorescent in situ hybridization was performed in root tips from young P. axillaris and P. inflata plants for 5S rDNA and three PVCV viral probes following the procedure described in Supplementary Note 2.</p>
<p>The detection of dTph1 loci in P. hybrida W138 was performed through a BLAST40 search of the P. axillaris and P. inflata dTph1 elements including the 500 bp of flanking sequence against the TFS W138 collection. Polymorphisms found in the genomic flanking regions were used to identify the species of origin. dTph1 elements were identified in a P. axillaris population using a modification of the methodology described in Supplementary Note 3.</p>
<p>##Whole-genome duplication, tandem duplications and gene family analysis</p>
<p>Whole-genome collinear analysis was performed using SynMap and microsynteny analysis were performed using GEvo in the comparative genomics platform, CoGe .See Supplementary Note 5.</p>
<p>The gene family analysis included Solanum lycopersicum, S. tuberosum, Nicotiana benthamiana and Arabidopsis thaliana protein sets using BlastP (v2.2.27) on an all-versus-all comparison and grouping the genes into families with OrthoMCL, v2.0.8. See Supplementary Note 4.</p>
<h2 id="Gene-data-mining"><a href="#Gene-data-mining" class="headerlink" title="Gene data mining"></a>Gene data mining</h2><p>The specific identification of genes for P. axillaris and P. inflata genomes for colour and scent, root-specific pathways, self-incompatibility and circadian clock was performed through a BlastN/BlastP sequence homology search. Blast GUI, JBrowser (<a href="http://jbrowse.org/">http://jbrowse.org/</a>) and WebApollo (<a href="http://genomearchitect/">http://genomearchitect</a>. org/) were installed in a server to search and manually curate the gene structures of the identified genes. See Supplementary Notes 7, 8 and 10â€“12.</p>
<h1 id="2-2017-04-ng-å±±ç¾ŠğŸ"><a href="#2-2017-04-ng-å±±ç¾ŠğŸ" class="headerlink" title="2. 2017.04-ng å±±ç¾ŠğŸ"></a>2. 2017.04-ng å±±ç¾ŠğŸ</h1><p>Published in final edited form as:Nat Genet. 2017 April ; 49(4): 643â€“650. doi:10.1038/ng.3802.</p>
<p><strong>Single-molecule sequencing and chromatin conformation capture enable</strong> <strong>de novo</strong> <strong>reference assembly of the domestic goat genome</strong></p>
<p>â€‹        é¦–æ¬¡åœ¨äººä¹‹å¤–çš„ç‰©ç§ä¸­ç›´æ¥de novoç»„è£…å‡ºæŸ“è‰²ä½“æ°´å¹³çš„åŸºå› ç»„ã€‚åˆ©ç”¨<font color="blue"><strong>Pacbio+BioNano+Hi-C+Illumina</strong> å¤šå±‚çº§</font>çš„ç­–ç•¥ï¼Œç»„è£…äº†ä¸€åªå±±ç¾Š(Capra hircus)çš„åŸºå› ç»„ï¼Œè·å¾—<font color="blue"><strong>31</strong>ä¸ª<strong>scaffold</strong>ï¼Œ<strong>663</strong>ä¸ª<strong>gap</strong>åŒºï¼Œscaffold <strong>N50</strong> æƒŠäººåœ°è¾¾åˆ°<strong>87M</strong>ï¼Œå‡ ä¹<strong>one scaffold one chromosome</strong></font>ï¼Œå¹¶ä¸”æˆåŠŸåœ°ç»„è£…å‡º<font color="blue"><strong>å…ç–«åŸºå› åŒº</strong>å’Œ<strong>å¤§éƒ¨åˆ†é‡å¤åºåˆ—å®¶æ—</strong></font>ã€‚</p>
<p>â€‹        <font color="red">äººçš„GRCh38ç‰ˆæœ¬æœ‰<strong>24</strong>ä¸ª<strong>scaffold</strong>ï¼Œ<strong>169</strong>ä¸ª<strong>unplacedscaffold</strong>ï¼Œ<strong>832ä¸ªgap</strong>åŒº</font>ã€‚</p>
<p>â€‹        ä»<strong>96å¤´</strong>å±±ç¾Š(<strong>6ä¸ªå“ç§</strong>)ä¸­ï¼Œåˆ©ç”¨Illuminaçš„ Caprine53K <font color="blue"><strong>SNP èŠ¯ç‰‡ç­›é€‰</strong></font>å‡º<font color="blue"><strong>åŸºå› å‹çº¯å’Œåº¦æœ€é«˜</strong></font>çš„ä¸ªä½“ç”¨æ¥<font color="blue"><strong>ç»„è£…</strong></font>(San Clemente breed)ã€‚</p>
<h2 id="data"><a href="#data" class="headerlink" title="data"></a>data</h2><ol>
<li><p>Pacbioæ•°æ®</p>
<p>ä¸€å…±äº§ç”Ÿ465ä¸ªSMRT cellçš„æ•°æ®ã€‚å…¶ä¸­ä½¿ç”¨P5-C3è¯•å‰‚çš„311ä¸ªcell;ä½¿ç”¨P4-C2è¯•å‰‚çš„142ä¸ªcellï¼ŒXL-C2è¯•å‰‚çš„12ä¸ªcellã€‚æ•°æ®é‡194Gï¼Œè¦†ç›–æ·±åº¦è¾¾<strong>69X</strong>ï¼Œ<strong>subread</strong>çš„<strong>å¹³å‡</strong>é•¿åº¦ä¸º<strong>5,110bp</strong>ã€‚</p>
</li>
<li><p>BioNano æ•°æ®</p>
<p>ç”±äºé‡‡æ ·æ‰€ç”¨å±±ç¾Šæ„å¤–æ­»äº¡ï¼Œå…¶DNAä¸èƒ½æ»¡è¶³Irsy optical mapping æµ‹åºéœ€æ±‚ï¼Œåªå¥½ç”¨å…¶<strong>é›„æ€§åä»£</strong>é‡‡æ ·ã€‚Optical mapä¸€å…±äº§ç”Ÿ256Gbæ•°æ®ï¼Œè¦†ç›–<strong>98 X</strong>ã€‚</p>
</li>
<li><p>Hi-Cæ•°æ®</p>
<p>é‡‡æ ·åŠ¨ç‰©æ˜¯æœ€åˆé‚£åªå±±ç¾Šã€‚Hi-Cå»ºåº“ï¼Œåºåˆ—ç”¨ç‰©ç†æ–¹æ³•æ‰“æ–­æˆ300-500bpé•¿åº¦ï¼ŒPE101æµ‹åºï¼Œäº§ç”Ÿ<strong>115M reads</strong>çš„æ•°æ®é‡ã€‚</p>
</li>
<li><p>Illumina æ•°æ®</p>
<p>é‡‡æ ·æœ€åˆé‚£åªå±±ç¾Šï¼ŒPE251å»ºåº“æµ‹åºï¼Œè·å¾—<strong>23X</strong>çš„æ•°æ®è¦†ç›–ï¼Œç”¨æ¥åšæœ€åçš„<font color="red"><strong>é”™è¯¯æ ¡æ­£</strong></font></p>
</li>
</ol>
<h2 id="ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ"><a href="#ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ" class="headerlink" title="ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ"></a><strong>ç»„è£…ç­–ç•¥åŠç»„è£…ç»“æœ</strong></h2><ul>
<li><p>å…ˆç”¨Pacbioçš„ long-read æ•°æ®æ„å»ºcontigï¼Œ ä½¿ç”¨<font color="blue"><strong>Celera Assembler</strong> PacBio corrected Reads æµç¨‹</font>ç»„è£…ã€‚è·å¾—<font color="blue"><strong>3,074</strong>ä¸ªcontig(2.63G)ï¼Œ<strong>N50 4.159M</strong>b</font>ã€‚</p>
</li>
<li><p>æ¥ä¸‹æ¥é‡‡ç”¨<font color="blue"><strong>Irys optical mapping</strong>æ•°æ®æ„å»º<strong>scaffold</strong></font>ï¼Œä½¿ç”¨è½¯ä»¶ä¸º<font color="blue"><strong>IrysView</strong></font>. äº§ç”Ÿ<font color="blue"><strong>842</strong>ä¸ªscaffoldï¼Œscaffold N50ä¸º<strong>13.4M</strong>bï¼Œcontig N50ä¸º10.858Mï¼Œæœ€é•¿scaffoldä¸º66.728Mb</font>ã€‚ åˆ©ç”¨<font color="red"><strong>radiation hybrid(RH) mapæ¯”è¾ƒ</strong>å‘ç°</font>ï¼Œ<font color="blue">PacBio-Irys è”åˆ</font>çš„æ–¹æ³•å·²ç»<font color="blue">å®Œæ•´ç»„è£…å‡º<strong>20å·æŸ“è‰²ä½“</strong></font>ã€‚</p>
</li>
<li><p>æ¥ä¸‹æ¥ç”¨Hi-Cæ•°æ®ï¼Œè°ƒç”¨ç”¨<font color="red"><strong>Lachesisè½¯ä»¶åŒ…</strong></font>ï¼Œç»“åˆPacBio-Irysçš„ç»“æœï¼Œå³æ•´åˆçš„PacBio-Irys-PGA (PBIP)æ–¹æ³•ï¼Œè·å¾—è¾ƒå®Œç¾çš„ç»„è£…ç»“æœã€‚<font color="blue">Scaffold N50</font> è¾¾åˆ°æƒŠäººçš„<font color="blue"><strong>87.347Mb</strong></font>(è¿œè¶…ä»Šå¹´å°–å»é²ˆï¼Œå¤§çŒ©çŒ©N50 20Mbçš„é«˜èµ·ç‚¹)ï¼Œæ€»å…±è·å¾—<font color="blue"><strong>31æ¡</strong>scaffold</font>ï¼Œ(<font color="red">31,261æ¡&lt;50kbpçš„**degenerate scaffold**ä¸è®¡å…¥</font> )ã€‚</p>
</li>
<li><p>æœ€ååˆ©ç”¨Illuminaæ•°æ®åš<font color="red"><strong>ä¸€è‡´æ€§æ ¡æ­£</strong>å’Œæœ€åçš„<strong>è¡¥æ´</strong></font>ï¼Œæœ€åä½¿å¾—contigçš„æ•°ç›®ä¸‹é™åˆ°680æ¡ï¼Œäº§ç”Ÿçš„gapæ•°ç›®ä¸º663ä¸ªã€‚</p>
</li>
<li><p>åˆ©ç”¨Kraken v0.10.5 <font color="red">å»é™¤æœ‰<strong>ç—…æ¯’å’Œç»†èŒæ±¡æŸ“</strong>çš„åºåˆ—</font>ï¼Œå»æ‰æœ‰NCBI vectoræ±¡æŸ“çš„åºåˆ—ã€‚è·å¾—æœ€ç»ˆçš„åŸºå› ç»„ ç‰ˆæœ¬<strong>ARS1</strong>ã€‚</p>
</li>
</ul>
<h2 id="ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ"><a href="#ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ" class="headerlink" title="ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ"></a><strong>ç»„è£…è¯„ä¼°åŠæ¯”è¾ƒåˆ†æ</strong></h2><p>ç”±äºå±±ç¾Šä¹‹å‰å·²ç»äº§ç”Ÿè¿‡ä¸¤ä¸ªåŸºå› ç»„ç‰ˆæœ¬<strong>CHIR_1.0ã€CHIR_2.0</strong>ï¼Œå¯ä»¥ç”¨æ¥åšæ¯”è¾ƒ åˆ†æï¼Œå¹¶ä¸”æœ‰RH mappingæ•°æ®ç”¨æ¥è¯„ä¼°ã€æ ¡æ­£ARS1çš„ç»„è£…ç‰ˆæœ¬ã€‚ <strong>é€šè¿‡å„ç§å‚æ•°æ¯”è¾ƒå‘ç°ï¼ŒARS1å‡ä¼˜äºCHIR_2.0ç‰ˆæœ¬ã€‚</strong></p>
<p>1ã€é€šè¿‡æ¯”å¯¹å‘ç°ï¼ŒCHIR_2.0 æ¯”CHIR_1.0æœ‰æ›´å°‘çš„putative deletion(2,735 vs 1 0,256)å’Œduplication(115 vs 290)ã€‚è€Œ2.0ç‰ˆæœ¬ç›¸è¾ƒ1.0æœ‰æ›´å¤šçš„inversion(215 v s 4)ã€‚é€šè¿‡æ¯”è¾ƒï¼Œå‘ç°ARS1ç‰ˆæœ¬æœ‰å¤§å¹…åº¦åœ°æå‡ï¼Œè¾ƒ2.0ç‰ˆæœ¬å°‘4å€çš„deletionï¼Œ å°‘50å€inversionã€‚</p>
<p>2ã€CHIR_2.0èƒ½å¡«è¡¥CHIR_1.0 94.6%çš„gapï¼Œè€Œå‰©ä¸‹çš„é‚£äº›gapé€šè¿‡åˆ†æARS1å¾—çŸ¥ï¼Œæ˜¯CHIR_1.0çš„ç»„è£…é”™è¯¯ï¼Œè€ŒRHæ•°æ®ä¹Ÿæ”¯æŒäº†è¿™ä¸€è®ºæ–­ã€‚ 3ã€BUSCOæ˜¯åˆ©ç”¨å•æ‹·è´orthologæ¥è¯„ä¼°ç»„è£…çš„å¯é æ€§ï¼Œå’ŒCHIR_2.0ç›¸æ¯”ï¼ŒARS1æœ‰æ›´é«˜çš„BUSCO scoreã€‚</p>
<p>4ã€å±±ç¾Š52k SNP èŠ¯ç‰‡ä¸­ï¼Œæœ‰1,723ä¸ªSNPæ¢é’ˆç›®å‰åªèƒ½å®šä½åœ¨CHIR_2.0ç»„è£…ç‰ˆæœ¬ ä¸­çš„unplaced contigsä¸Šã€‚è€ŒARS1ç‰ˆæœ¬èƒ½æŠŠå…¶ä¸­çš„90%(1,552/1,723)ä»¥ä¸Šçš„S NPæ¢é’ˆå®šä½åœ¨æŸ“è‰²ä½“ä¸Šã€‚å¦å¤–å‘ç°æœ‰26ä¸ªlow call-rate çš„SNPmarkeråœ¨ARS1ç»„è£…ç‰ˆæœ¬ä¸Šå®šä½æ¯”è¾ƒæ¨¡æ£±ä¸¤å¯ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆè¿™äº›makeråœ¨èŠ¯ç‰‡ä¸Šæœ‰è¾ƒå·®çš„call -rate. </p>
<p>5ã€é€šè¿‡æ¯”è¾ƒå‘ç°ï¼ŒCHIR_2.0ç‰ˆæœ¬ä¸­çš„3,495ä¸ªå†…å«å­æˆ–å¤–æ˜¾å­æœ‰gapçš„åŸºå› ï¼Œåœ¨ARS1ä¸­éƒ½å¾—åˆ°è¡¥å…¨ã€‚åŒæ—¶ä¹Ÿç¡®è®¤1,926ä¸ªé¢„æµ‹çš„å¤–æ˜¾å­åœ¨CHIR_1.0æˆ–è€…2.0ä¸­æœ‰gapï¼Œ ä½†åœ¨ARS1ä¸­å¾—åˆ°ä¿®å¤ã€‚ </p>
<p>6ã€ç”±äºå…ç–«åŸºå› åŒºé«˜åº¦å¤šæ€æ€§å’Œé‡å¤æ€§ï¼Œç”¨äºŒä»£æµ‹åºæ•°æ®å¾ˆéš¾ç»„è£…èµ·æ¥ï¼Œä½†æ˜¯é€šè¿‡ åˆ†æå‘ç°ï¼ŒARS1ç‰ˆæœ¬å°±å¾ˆå¥½åœ°æŠŠLRCå’ŒNKCåŸºå› (å…ç–«åŠŸèƒ½ç›¸å…³åŸºå› )å®šä½åœ¨ä¸€ä¸ªç‹¬ç«‹çš„å¸¸æŸ“è‰²ä½“scaffoldä¸Šã€‚ </p>
<p>7ã€é€šè¿‡å’Œä¸€ä»£ã€äºŒä»£ç»„è£…ç­–ç•¥ç›¸æ¯”ï¼ŒARS1ç‰ˆæœ¬åœ¨é‡å¤åºåˆ—çš„ç»„è£…ä¸Šè·å¾—äº†æå¤§è¿›æ­¥ã€‚å¯¹æŸäº›å¼‚æŸ“è‰²ä½“æˆ–å¼‚æŸ“è‰²è´¨çš„åŒºåŸŸä¹Ÿè·å¾—äº†è¾ƒå¥½çš„ç»„è£…è¦†ç›–ã€‚æ¯”å¦‚ï¼Œåœ¨6æ¡å¸¸ æŸ“è‰²ä½“ä¸Šç»„è£…å‡º&gt;5kbpçš„ç«¯ç²’åºåˆ—ã€‚é€šè¿‡åˆ†æå‘ç°ï¼Œ 15æ¡æŸ“è‰²ä½“scaffoldï¼Œåœ¨ç€ä¸ç²’åŒºåŸŸç»„è£…å‡ºå¤§äº2kbpé•¿åº¦çš„é‡å¤åŒºï¼Œè€Œå…¶ä¸­çš„7æ¡ï¼Œæ›´æ˜¯è£…å‡ºæ¥8kbpä»¥ä¸Šçš„é‡å¤åŒºã€‚æ›´ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œ19å·å’Œ23å·æŸ“è‰²ä½“éƒ½ç»„è£…å‡ºé«˜åº¦é‡å¤çš„ç€ä¸ç²’å’Œç«¯ç²’åŒºåŸŸï¼Œ è´¯é€šäº†æœ‰ç»“æ„æ€§å¼‚æŸ“è‰²è´¨åŒºçš„æŸ“è‰²ä½“ã€‚ </p>
<p>8ã€åœ¨ARS1ç‰ˆæœ¬ä¸­é‰´å®šå‡ºå¤§äº12kbpçš„é‡å¤æ¨¡å¼åºåˆ—å¤šè¾¾105æ¡ã€‚å¯¹äºé‡å¤åºåˆ—å®¶ æ—çš„é‰´å®šï¼Œåœ¨ARS1ä¸­è·å¾—çš„æ¥è¿‘å…¨é•¿çš„BovB LINE åºåˆ—æ¯”CHIR_2.0å¤š60%ä»¥ä¸Šã€‚ åœ¨CHIR_2.0ç‰ˆæœ¬é‡Œï¼Œè¢«ARS1æˆåŠŸè¡¥å…¨çš„gapä¸­çš„43.6%ä¸BovBé‡å¤åºåˆ—ä¸€è‡´(é•¿ åº¦å¤§äº3.5kbp)ï¼Œå³æ„å‘³ç€äºŒä»£æµ‹åºçš„gapåŒºå¤§å¤šéƒ½æ˜¯é‡å¤åºåˆ—ï¼Œç”¨ä¸‰ä»£å°±èƒ½è¾ƒå®¹æ˜“æµ‹é€šã€‚ </p>
<p>9ã€å…³äºæ€§æŸ“è‰²ä½“çš„åˆ†æã€‚é€šè¿‡æ¯”å¯¹å‘ç°ï¼Œä¸¤ä¸ªä¸åŒçš„scaffoldæ¯”å¯¹åˆ°XæŸ“è‰²ä½“çš„ä¸åŒä½†è¿ç»­çš„åŒºåŸŸï¼Œå é¢„æœŸXæŸ“è‰²ä½“å¤§å°(150Mb)çš„86%å·¦å³ã€‚é€šè¿‡å’Œè‡ªå·±çš„ã€è·¨ç‰©ç§ç‰›çš„YæŸ“è‰²ä½“æ¯”å¯¹ï¼Œæœ€ç»ˆç¡®å®šå‡º10MbåŒºåŸŸçš„åºåˆ—ï¼Œå YæŸ“è‰²ä½“é¢„ä¼°å¤§å°çš„50% å·¦å³ã€‚é€šè¿‡æ¯”å¯¹ç‰›å’Œç¾Šçš„YæŸ“è‰²ä½“ä¸Šçš„åŸºå› ï¼Œå‘ç°åœ¨ç›®å‰çš„scaffoldä¸­èƒ½æ‰¾åˆ°16%ï¼Œ è€Œåœ¨å…ˆå‰è¿‡æ»¤æ‰çš„degenerate contigä¸­èƒ½æ‰¾åˆ°84%çš„åŸºå› ã€‚è€ƒè™‘åˆ°YæŸ“è‰²ä½“çš„å¼‚æŸ“ è‰²è´¨å±æ€§åŠX,YæŸ“è‰²ä½“çš„æ‹Ÿå¸¸æŸ“è‰²åŒºåŸŸç»å¸¸å‘ç°äº¤æ¢ï¼Œå®åœ¨å¤ªè¿‡å¤æ‚ï¼Œè¶…å‡ºç›®å‰çš„ç»„è£…å’Œè®¤çŸ¥æ°´å¹³ï¼Œè¡¨ç¤ºå®åœ¨æ— èƒ½ä¸ºåŠ›ã€‚</p>
<p>10ã€åˆ©ç”¨ä¹‹å‰RH mapping dataï¼Œå¯¹ç»„è£…çš„å¤§éƒ¨åˆ†ç¯èŠ‚è¿›è¡Œäº†æ ¡æ­£åŠè¯„ä¼°ã€‚æ¯”å¦‚å¤šæ¬¡è¾…åŠ©è§£å†³scaffold conflictçš„é—®é¢˜ã€‚</p>
<h2 id="åŸºå› ç»„æ³¨é‡Š"><a href="#åŸºå› ç»„æ³¨é‡Š" class="headerlink" title="åŸºå› ç»„æ³¨é‡Š"></a><strong>åŸºå› ç»„æ³¨é‡Š</strong></h2><p>å¤šç§æ–¹æ³•ç»“åˆæ³¨é‡ŠåŸºå› é›†ã€‚<br>1.<strong>RNA-seqçš„æ–¹æ³•:</strong> 6ä¸ªç»„ç»‡(å¤§å¤šå’Œè„‘ç»„ç»‡ç›¸å…³)RNA-seqæµ‹åºã€13ä¸ªSRAä¸‹è½½ æ•°æ®ï¼Œåˆ©ç”¨stringtieã€cufflinkså’ŒTrinity(åŸºäºæ— å‚ç»„è£…)ã€‚æœ€åç”¨PASAè½¯ä»¶æ•´åˆåœ¨ä¸€èµ·;</p>
<p>2.<strong>ç”¨exonerateå’Œtblastn è½¯ä»¶</strong>æ¯”å¯¹åˆ°å‡ ä¸ªè¿‘ç¼˜ç‰©ç§çš„EnsemblåŸºå› é›†ä¸Šï¼Œè·å¾—åŒ æºé¢„æµ‹åŸºå› é›†;</p>
<p>3.<strong>ç”¨Braker1åšAb initio é¢„æµ‹</strong>;</p>
<p>4.<strong>CHIR_1.0 ç‰ˆæœ¬çš„æ³¨é‡ŠåŸºå› é›†</strong>; æœ€åç”¨<strong>EVM+PASA</strong>æŠŠä»¥ä¸Š4ç§æ•°æ®æ•´åˆæˆä¸€ä¸ªæœ€ç»ˆçš„åŸºå› é›†(è®¾ç½®çš„æƒé‡ä¸ºRNAseq &gt; cDNA/protein &gt; ab initio gene predictions)ã€‚</p>
<h2 id="å¯ç¤ºå½•"><a href="#å¯ç¤ºå½•" class="headerlink" title="å¯ç¤ºå½•"></a><strong>å¯ç¤ºå½•</strong></h2><p>1ã€Pacbio RSIIæ˜¯ä¸€ä¸ªè¾ƒä¸ºç†æƒ³ç»„è£…å¹³å°ï¼Œäº§ç”Ÿå¹³å‡14Kbpå·¦å³çš„è¯»é•¿ï¼Œæœ€é«˜åˆ°60 Kbpï¼Œå¯ä»¥ç»„è£…å‡ºè¾ƒä¸ºç†æƒ³çš„åŸºå› ç»„ç‰ˆæœ¬ã€‚ç”±äºä¸‰ä»£çš„é•¿è¯»é•¿ä¼˜åŠ¿ï¼ŒåŒæ—¶å¯ä»¥è¾ƒå¥½åœ°ç»„è£…å‡ºåŸºå› ç»„ä¸­å¤§éƒ¨åˆ†é«˜åº¦é‡å¤åŒº(ä¸»è¦é›†ä¸­åœ¨ç€ä¸ç²’å’Œç«¯ç²’åŒºåŸŸ);</p>
<p>2ã€BioNano çš„Irys optical mapping æ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„ï¼Œæˆæœ¬æ¯”è¾ƒé€‚ä¸­çš„æ„å»ºscaffoldçš„å¹³å°ã€‚å’ŒHi-Cæ¯”ä¼˜åŠ¿åœ¨äºå®šä½é”™è¯¯è¾ƒå°‘ï¼Œç¼ºç‚¹æ˜¯å¯¹N50çš„æé«˜å¹¶ä¸æ˜¯ç‰¹åˆ«æ˜¾è‘—ï¼Œä¸€èˆ¬åœ¨2å€å·¦å³ã€‚å¦‚æœæ­£åé“¾çš„Nt.BsqIé…¶åˆ‡ä½ç‚¹ç¦»å¾—æ¯”è¾ƒè¿‘ï¼Œå¸¸å¸¸å¯¼è‡´åŒé“¾ æ–­è£‚ï¼Œé™åˆ¶äº†Optical Map scaffoldçš„å¤§å°ã€‚æ‰€ä»¥ï¼ŒBioNanoå¯¹è¾ƒé•¿çš„scaffoldæ•ˆæœæ¯”è¾ƒå¥½ã€‚ç”±äºOptical mapå’Œpacbioäº§ç”Ÿçš„é”™è¯¯ç‰¹å¾å¹¶ä¸ä¸€æ ·ï¼Œä¸¤è€…ç»“åˆï¼Œå¯ä»¥ ç›¸äº’æ ¡æ­£ï¼Œè·å¾—è¾ƒå¥½çš„ç»„è£…æŒ‡æ ‡;</p>
<p>3ã€Hi-Cæ˜¯ç›®å‰éå¸¸ç«çˆ†çš„ä¸€ä¸ªæŠ€æœ¯ï¼Œåœ¨å¤šä¸ªé¢†åŸŸéƒ½æœ‰å¾ˆå¥½çš„åº”ç”¨ã€‚åœ¨ç»„è£…æ–¹é¢ï¼Œ å®ƒèƒ½è·å¾—æŸ“è‰²ä½“çº§åˆ«çš„scaffoldï¼Œä½†æ˜¯ä¹Ÿå®¹æ˜“è·å¾—è¾ƒé«˜çš„contigå®šå‘é”™è¯¯ã€‚è¿™ä¹Ÿæ˜¯ ä¸ºä»€ä¹ˆæ–‡ç« ä¸­ï¼Œå…ˆç”¨optical mappingï¼Œåç”¨Hi-Cåšscaffoldingçš„é‡è¦åŸå› ä¹‹ä¸€ã€‚ ä½œè€…å»ºè®®åœ¨ä»¥åçš„å®éªŒä¸­ï¼Œå¯ä»¥é€‰æ‹©è¾ƒçŸ­çš„è¯†åˆ«ä½ç‚¹çš„é™åˆ¶å†…åˆ‡é…¶(æˆ–è€…DNase Hi -C)æ¥æé«˜Hi-Cäº¤è”çš„å¯†åº¦ï¼Œé™ä½å®šå‘é”™è¯¯ã€‚</p>
<p>4ã€åˆ©ç”¨åŒæ ·çš„æ–¹æ³•å’Œå¹³å°ï¼Œåšç±»ä¼¼çš„åŸºå› ç»„é¡¹ç›®ï¼Œç”¨Pacbioå¹³å°å’Œscaffoldingå¹³ å°ï¼Œç›®å‰å¤§çº¦èŠ±è´¹åœ¨$100,000ä¸Šä¸‹,è€Œä¸€èˆ¬çš„çŸ­readså¹³å°æµ‹åºåŠ scaffolding å¹³å°ï¼Œåªéœ€è¦å…¶ä¸‰åˆ†ä¹‹ä¸€çš„ä»·æ ¼ã€‚ä½†æ˜¯ç”¨Pacbioå¹³å°å´è·å¾—äº†é«˜è´¨é‡çš„ã€è¿ç»­æ€§å¥½çš„åŸºå› ç»„åºåˆ—ã€‚ç›®å‰Pacbio æ–°ä¸€ä»£çš„sequelå¹³å°å·²ç»æ¨å‡ºï¼Œå•ä¸ªcellçš„äº§é‡æ¯”RSIIæ é«˜7å€ä»¥ä¸Šï¼Œæµ‹åºæˆæœ¬å°†ä¼šå¾—åˆ°å¤§å¹…åº¦é™ä½ï¼Œç›¸ä¿¡ä¼šæˆä¸ºæœªæ¥åŸºå› ç»„ç ”ç©¶çš„ä¸»æµå·¥å…·ä¹‹ä¸€ã€‚</p>
<p>5ã€æœ¬æ–‡çš„ç ”ç©¶ç­–ç•¥ç¡®å®ä¼šå¯è¿ªåæ¥çš„ç ”ç©¶è€…ï¼Œä¸ºde novoç»„è£…æ ‘ç«‹æ–°æ ‡æ†ã€‚Pacbio æµ‹åºæŠ€æœ¯è”åˆå¤šç§scaffolding å¹³å°(æ¯”å¦‚BioNanoã€Hi-Cï¼Œmating-pairedlibr aryï¼Œ10X genomics)çš„ä½¿ç”¨ï¼Œ ä¼šå¼•é¢†de novo ç»„è£…è¿›å…¥ near finished genome æˆ–è€…finished genomeçš„æ–°æ—¶ä»£ã€‚</p>
<p>6ã€ä½†æ˜¯ï¼Œå°½ç®¡åšäº†å¾ˆå¤šåŠªåŠ›ï¼ŒARS1ä»ç„¶æ˜¯ä¸€ä¸ªå•ä½“å‹æ··åˆå‹çš„ç»„è£…ç‰ˆæœ¬ã€‚åœ¨æœªæ¥ï¼Œå¯ä»¥åˆ©ç”¨single moleculeå’ŒHi-CæŠ€æœ¯è·å¾—å•ä½“å‹åˆ†æœŸ(haplotype phasing) çš„å‚è€ƒåŸºå› ç»„ã€‚å¯¹äºç»„æˆå‹å¼‚æŸ“è‰²è´¨åŒºï¼Œå°¤å…¶æ˜¯ç€ä¸ç²’å’Œç«¯ç²’éƒ¨åˆ†ï¼Œä»ç„¶æ˜¯ç»„è£…çš„ç›²åŒºï¼Œå³ä½¿åœ¨äººçš„åŸºå› ç»„ä¸­è¿™äº›åŒºåŸŸä¹Ÿæ²¡æœ‰è¢«å®Œæ•´ç»„è£…å‡ºæ¥ã€‚</p>
<h1 id="3-2020-09-cell-å¤§è±†æ³›åŸºå› ç»„"><a href="#3-2020-09-cell-å¤§è±†æ³›åŸºå› ç»„" class="headerlink" title="3. 2020.09-cell å¤§è±†æ³›åŸºå› ç»„"></a>3. 2020.09-cell å¤§è±†æ³›åŸºå› ç»„</h1><p>Pan-Genome of Wild and Cultivated Soybeans</p>
<p>Soybean is one of the most important vegetable oil and protein feed crops. To capture the entire genomic diversity, it is needed to construct a complete high-quality pan-genome from diverse soybean accessions. In this study, we performed individual de novo genome assemblies for <strong>26 representative soybeans</strong> that were selected from <strong>2,898 deeply sequenced accessions</strong>. Using these assembled genomes together with <strong>three previously reported genomes</strong>, we constructed a <strong>graph-based genome</strong> and performed pan-genome analysis, which identified <strong>numerous genetic variations that cannot be detected by direct mapping of short sequence reads onto a single reference genome</strong>. The <strong>structural variations</strong> from the 2,898 accessions that were <strong>genotyped</strong> based on the graph-based genome and the <strong>RNA-seq data</strong> from the representative 26 accessions helped to <strong>link genetic variations to candidate genes</strong> that are responsible for important traits. This pan-genome resource will promote evolutionary and functional genomics studies in soybean.</p>
<h2 id="SNP-Calling-and-Phylogenetic-Analyses"><a href="#SNP-Calling-and-Phylogenetic-Analyses" class="headerlink" title="SNP Calling and Phylogenetic Analyses"></a>SNP Calling and Phylogenetic Analyses</h2><h2 id="Genome-Assembly"><a href="#Genome-Assembly" class="headerlink" title="Genome Assembly"></a>Genome Assembly</h2><p><em>De novo</em> assembly was conducted referring to a <font color="blue"><strong>reported pipeline</strong></font> (Du and Liang, 2019; Shen et al., 2019). In brief, <font color="red"><strong>Canu</strong></font> (Koren et al., 2017) v1.7.1 was used to assemble PacBio subreads to PacBio contigs, after which <font color="red"><strong>HiSeq</strong></font> reads were used for <font color="red"><strong>error correction</strong></font>. <strong>Bio-nano optical maps</strong> were assembled into consensus physical maps by <strong>BioNano Solve</strong> v3.0.1 (<a href="https://bionanogenomics.com/">https://bionanogenomics.com/</a>, Solve_06082017Rel). Then <font color="red"><strong>HERA</strong></font> (Du and Liang, 2019) was used to combine PacBio contigs and Bionano based physical maps to <font color="blue"><strong>PacBio-BioNano hybrid scaffolds</strong></font>. To <font color="red"><strong>anchor</strong></font> hybrid scaffolds <font color="blue">into <strong>chromosomes</strong></font>, the <font color="blue"><strong>Hi-C</strong></font> sequencing data were <font color="red"><strong>aligned into scaffolds</strong></font> by <font color="red"><strong>Juicer</strong></font> (Durand et al., 2016) v1.5 and <font color="red"><strong>3D-DNA</strong></font> (Dudchenko et al., 2017).</p>
<h2 id="Repeat-Analysis-and-Gene-Annotation"><a href="#Repeat-Analysis-and-Gene-Annotation" class="headerlink" title="Repeat Analysis and Gene Annotation"></a>Repeat Analysis and Gene Annotation</h2><h2 id="Synteny-Analysis"><a href="#Synteny-Analysis" class="headerlink" title="Synteny Analysis"></a>Synteny Analysis</h2><p>Structural Variation Identification</p>
<p>Genetic Variation Analysis</p>
<p>Gene and miRNA Expression</p>
<p>Core and Dispensable Gene Family Clustering</p>
<p>CHS gene unit identification</p>
<p>Gene Fusion Event Identification</p>
<p>QUANTIFICATION AND STATISTICAL ANALYSIS</p>
<h1 id="4-2019-nc-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1"><a href="#4-2019-nc-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1" class="headerlink" title="4. 2019-nc å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1"></a>4. 2019-nc å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ1</h1><p>HERA</p>
<h1 id="5-2019-09-scienceChina-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2"><a href="#5-2019-09-scienceChina-å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2" class="headerlink" title="5. 2019.09-scienceChina å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2"></a>5. 2019.09-scienceChina å¤§è±†æ³›åŸºå› ç»„-ç»„è£…å‚è€ƒ2</h1><p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/1.png" alt="1"></p>
<p>For genome assembly, we sequenced additional 40 Gb SMRT reads from 5 cells for this update. Therefore, a total of <strong>120Ã— PacBio reads</strong>, <strong>365Ã— Bionano optical maps</strong> marked by BssSI, <strong>275Ã— Bionano optical maps</strong> marked by BspQI, <strong>45Ã— HiSeq</strong> reads and <strong>125Ã—</strong> chromosome conformation capture sequencing (<strong>Hi-C</strong>) reads were used for the new genome assembly (Figure 1A). To make best of the sequencing data, we also <font color="red"><strong>adopted a new genome assembly pipeline</strong> by <strong>adding HERA</strong></font> (Du and Liang, 2018) to improve the sequence contiguity and reduce errors by accurately assembling the repetitive genome regions (Figure 1A). Briefly, <font color="blue">the whole assembly process <strong>differed from</strong> previous pipeline</font> at </p>
<p>(1) using <font color="red"><strong>CANU</strong></font> (v1.7.1) to replace Smrtmake for assembling PacBio subreads to PacBio contigs; </p>
<p>(2) using <font color="red"><strong>HERA</strong></font> to generate longer contigs; </p>
<p>(3) using <font color="red"><strong>Juicer and 3D-DNA to replace HiC-Pro and LACHESIS</strong></font> to anchor the hybrid scaffolds into chromosomes with Hi-C reads.</p>
<h1 id="6-2020-05-nc-åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿"><a href="#6-2020-05-nc-åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿" class="headerlink" title="6. 2020.05-nc åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿"></a>6. 2020.05-nc åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿</h1><p>HiFiåŠ©åŠ›åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿åŸºå› ç»„ç»„è£…ï¼ŒNC</p>
<blockquote>
<p>Allele-aware chromosome-level genome assembly and efficient transgene-free genome editing for the autotetraploid cultivated alfalfa</p>
</blockquote>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨Canué»˜è®¤å‚æ•°ï¼Œåˆ©ç”¨CCS clean readsç»„è£…contigsã€‚ç»„è£…å¾—åˆ°çš„Contig N50å€¼ä¸º459kbï¼Œæ€»é•¿åº¦ä¸º3.15GBã€‚</p>
<blockquote>
<p>We assembled contigs from CCS clean reads using Canu, with default parameters. The N50 values of the contig sets were 459 kb, with total lengths 3154 Mb.</p>
</blockquote>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨HiC-Proå°†Hi-C readsä¸contigs è¿›è¡Œæ¯”å¯¹ï¼Œäº§ç”Ÿæ¯”å¯¹BAMæ–‡ä»¶ã€‚</p>
<blockquote>
<p>Hi-C reads were aligned to contigs using <a href="https://pubmed.ncbi.nlm.nih.gov/26619908/">HiC-Pro(2015)</a>, yielding an alignment BAM file.</p>
</blockquote>
<p>ï¼ˆ3ï¼‰ä½¿ç”¨æ³¨é‡Šçš„è’ºè—œè‹œè“¿è›‹ç™½ä½œä¸ºå‚è€ƒï¼Œå®Œå…¨åŸºäºåŒæºçš„ç­–ç•¥æ³¨é‡Šcontigsã€‚å¯¹138,729ä¸ªåŒæºåŸºå› è¿›è¡Œäº†ç»“æ„æ³¨é‡Šã€‚ç”¨MCscanç”¨äºé‰´å®šcontigså’Œå‚è€ƒåŸºå› ç»„ä¹‹é—´çš„å…±çº¿æ€§ã€‚æ˜¾ç¤ºç´«èŠ±è‹œè“¿å’Œè’ºè—œè‹œè“¿ä¹‹é—´çš„é«˜å…±çº¿æ€§ã€‚ã€ä¸‹è½½çˆ¶æ¯æœ¬petunia refã€‘</p>
<blockquote>
<p>Contigs were annotated with a <font color="red"><strong>solely homology-based strategy</strong></font>, using annotated Medicago truncatula proteins as references. 138,729 homologous genes were structurally annotated. <font color="red"><strong>MCscan</strong> in <strong>Jcvi</strong></font> (<a href="https://zenodo.org/record/31631#.XpkUyTOeask">https://zenodo.org/record/31631#.XpkUyTOeask</a>) was used to identify <font color="red"><strong>synteny blocks</strong></font> between <strong>contigs and the reference</strong> genome. <font color="red"><strong>Contigs syntenic</strong> to M. truncatula were <strong>stacked and aligned</strong> to M. truncatula chromosomes</font>. The syntenic contigs are summarized in Supplementary Table 4.</p>
</blockquote>
<p>ï¼ˆ4ï¼‰ä½¿ç”¨å†…éƒ¨è„šæœ¬å¤„ç†BAMæ–‡ä»¶ï¼Œå»é™¤ç­‰ä½åŸºå› contigsä¹‹é—´çš„linksã€‚ä½¿ç”¨ALLHiCè½¯ä»¶ï¼Œ<font color="red">æå–ã€èšç±»å’Œé‡æ’Contigs</font> (Contigs syntenicä¸è’ºè—œè‹œè“¿æŸ“è‰²ä½“ä¸€è‡´)ï¼Œå¾—åˆ°åŸå§‹çš„scaffoldsã€‚</p>
<blockquote>
<p>An <strong>in-house script</strong> was used to <font color="red">prune the BAM</font> file and <font color="red">discard links between allelic contigs</font>. Contigs syntenic to one chromosome of M. truncatula, e.g., chr1, were extracted, sub-clustered and reordered using <font color="red">ALLHiC</font>, yielding a raw scaffold set.</p>
</blockquote>
<p>ï¼ˆ5ï¼‰<a href="https://pubmed.ncbi.nlm.nih.gov/27467250/">Juicebox</a>ç”¨äºä»¥å›¾å½¢å’Œäº¤äº’æ–¹å¼å¾®è°ƒç»„è£…çš„scaffoldsã€‚å‰ªè£äº†40ä¸ªæ€»é•¿åº¦è¾¾1800Mbçš„scaffolds ã€‚</p>
<blockquote>
<p>Juicebox45 was used for fine-tuning assembled scaffolds in a graphic and inter-active fashion. Forty scaffolds with a total length of 1800 Mb were cropped (Supplementary Table 5).</p>
</blockquote>
<p>ï¼ˆ6ï¼‰ åŸºäºç»„è£…çš„scaffoldï¼Œé€šè¿‡Hi-Cæ•°æ®ï¼Œæ¯ä¸ªunplaced contigè¢«åˆ†é…åˆ°äº’ä½œæœ€å¼ºçš„é‚£äº›contig clusteré‡Œã€‚</p>
<blockquote>
<p>Based on this scaffold assembly, each unplaced contig was assigned to the contig cluster, to which the contig was most connected by Hi-C data.</p>
</blockquote>
<p>ï¼ˆ7ï¼‰ä½¿ç”¨ALLHiCå¯¹é‚£äº›contig clusterså†æ¬¡è¿›è¡Œé‡æ’å’Œæ„å»ºscaffoldã€‚</p>
<blockquote>
<p>Those contig clusters were reordered and scaffolded using ALLHiC. </p>
</blockquote>
<p>ï¼ˆ8ï¼‰ä½¿ç”¨Juiceboxå¯¹scaffoldsè¿›è¡Œå¾®è°ƒï¼Œå¹¶ä»scaffoldsä¸Šå»é™¤ä¸ä¸€è‡´çš„contigsï¼Œäº§ç”Ÿæœ€ç»ˆçš„æŸ“è‰²ä½“åŸºå› ç»„ï¼Œå…¶åŒ…å«32æ¡æŸ“è‰²ä½“(8ä¸ªåŒæºç»„ï¼Œæ¯ä¸ªç»„ä¸­æœ‰4ä¸ªç­‰ä½åŸºå› æŸ“è‰²ä½“)ï¼Œæ€»é•¿åº¦ä¸º2738Mbï¼Œå’Œ419MbæœªæŒ‚è½½åˆ°æŸ“è‰²ä½“æ°´å¹³çš„åºåˆ—ã€‚</p>
<blockquote>
<p>Using Juicebox, scaffolds were fine-tuned and discordant contigs were removed from scaffolds, and the final chromosome assembly was generated, containing 32 chromosomes with a total length of 2738 Mb (Supplementary Table 6).</p>
</blockquote>
<h1 id="7-2021-11-gb-æ¤°å­ğŸ¥¥"><a href="#7-2021-11-gb-æ¤°å­ğŸ¥¥" class="headerlink" title="7. 2021.11-gb æ¤°å­ğŸ¥¥"></a>7. 2021.11-gb æ¤°å­ğŸ¥¥</h1><p>High-quality reference genome sequences of two coconut cultivars provide insights into evolution of monocot chromosomes and differentiation of fiber content and plant height</p>
<p>è¯¥ç ”ç©¶ç»˜åˆ¶ä¸¤ä¸ªå‚è€ƒçº§åˆ«æ¤°å­åŸºå› ç»„ã€‚æ­ç¤ºå•å­å¶æ¤ç‰©æŸ“è‰²ä½“çš„è¿›åŒ–è¿‡ç¨‹å’Œæ¤°å­æŸ“è‰²ä½“çš„å½¢æˆè¿‡ç¨‹ï¼Œåˆ†æé«˜çŸ®ä¸¤ç§æ¤°å­è€ç›ï¼Œæ ªé«˜ï¼Œçº¤ç»´å’Œè„‚è´¨å«é‡ç­‰å…³é”®æ€§çŠ¶çš„é—ä¼ å·®å¼‚ï¼ŒåŒæ—¶å‘ç°æ¤°å­è¿›åŒ–è¿‡ç¨‹ä¸­çº¦åœ¨400ä¸‡å¹´å‰è‡ªç„¶å‘ç”Ÿçš„ç»¿è‰²é©å‘½ã€‚é«˜æ¤°å­2.39GçŸ®æ¤°å­2.40Gã€‚åŸºäºæ¤°å­ï¼Œç´«èï¼Œè èç­‰åŸºå› ç»„çš„å…±çº¿æ€§å…³ç³»ï¼Œé‡æ–°æ„å»ºäº†å«æœ‰10æ¡æŸ“è‰²ä½“çš„å¤å•å­å¶æ¤ç‰©åŸºå› ç»„æ ¸å‹ï¼Œå¹¶å¯¹åŸºå› ç»„æ ¸å‹çš„è¿›åŒ–è·¯çº¿è¿›è¡Œæ¨æ–­ã€‚è¿›ä¸€æ­¥åˆ©ç”¨å¶é—´è·è¡¨å‹è¿›è¡Œå…¨åŸºå› ç»„å…³è”åˆ†æï¼Œé‰´å®šå‡º12å·æŸ“è‰²ä½“ä¸ŠGA20oxåŸºå› ä¸æ¤°å­æ ªé«˜æ˜¾è‘—ç›¸å…³ï¼Œå¹¶å­˜åœ¨æ‹·è´æ•°å˜å¼‚ï¼›æ•´åˆå¤šç§æ‰‹æ®µéªŒè¯HA20oxä»¥åŠèµ¤éœ‰ç´ ä»£è°¢é€”å¾„åœ¨é«˜çŸ®ç§çš„å·®å¼‚å¹¶å¯¼è‡´æ ªé«˜å·®å¼‚ã€‚400ä¸‡å¹´å‰ï¼Œç»¿è‰²é©å‘½ã€‚</p>
<h2 id="Hi-C-based-genome-assembly"><a href="#Hi-C-based-genome-assembly" class="headerlink" title="Hi-C-based genome assembly"></a>Hi-C-based genome assembly</h2><p>Both Cn. tall and Cn. dwarf genomes were assembled de novo using SMARTdenovo (<a href="https://github.com/ruanjue/smartdenovo">https://github.com/ruanjue/smartdenovo</a>) [-k 19 -J 3000] based on <font color="red"><strong>Nanopore long reads</strong></font> <strong>corrected</strong> with <font color="red"><strong>NextDenovo</strong></font> (<a href="https://github.com/Nextomics/NextDenovo">https://github.com/Nextomics/NextDenovo</a>). Raw contigs were <font color="blue"><strong>polished</strong></font> using <font color="blue"><strong>Nanopore long reads</strong></font> and <font color="blue"><strong>Illumina short reads</strong></font> with <font color="red"><strong>Next-Polish</strong></font> (v1.2.2) [49]. Then polished contigs were <font color="blue"><strong>anchored</strong></font> into chromosomes by using <font color="red"><strong>HiC-Pro (v2.11.1)</strong></font> [50] and <font color="red"><strong>LACHESIS</strong></font>[51]. Finally, the assembled genomes were <font color="blue"><strong>manual correction</strong></font> with <font color="red"><strong>Juicebox</strong></font> (v1.11.08).</p>
<p>To assess the quality of assembled genomes, raw Illumina <font color="blue"><strong>paired-end</strong> reads and <strong>RNA-seq</strong></font> reads from multiple tissues were <font color="blue"><strong>mapping</strong></font> to the genomes using <font color="red"><strong>BWA (v0.7.17-r1188)</strong></font> [52] and <font color="red"><strong>HISAT2 (v2.1.0)</strong></font> [53], respectively. In addition, Benchmarking Universal Single-Copy Orthologs (<font color="red"><strong>BUSCO</strong></font>) was also used to assess the genome completeness base on Embryophyta Plant database (odb10) [54].</p>
<h1 id="8-2021-11-nc-é‡‘ç²Ÿå…°åŸºå› ç»„"><a href="#8-2021-11-nc-é‡‘ç²Ÿå…°åŸºå› ç»„" class="headerlink" title="8. 2021.11-nc é‡‘ç²Ÿå…°åŸºå› ç»„"></a>8. 2021.11-nc é‡‘ç²Ÿå…°åŸºå› ç»„</h1><p>å¡«è¡¥æ ¸å¿ƒè¢«å­æ¤ç‰©æœ€åä¸»è¦åˆ†æ”¯-é‡‘ç²Ÿå…°ç›®çš„åŸºå› ç»„ä¿¡æ¯ï¼Œæä¾›è¢«å­æ¤ç‰©æ—©æœŸæ¼”åŒ–è¯æ®ã€‚åˆ˜å»ºå…¨å›¢é˜Ÿè‡´åŠ›äºè§£æç±»ç¾¤æ¼”åŒ–ï¼Œæ¢ç©¶ä¸åŒç‰©ç§é—´åˆ†åŒ–é€‚åº”é—ä¼ æœºåˆ¶ã€‚</p>
<p>è¢«å­æ¤ç‰©ï¼ˆAngiosperms or flowering plantsï¼‰æ˜¯åœ°çƒä¸Šåˆ†å¸ƒèŒƒå›´æœ€å¹¿ã€å¤šæ ·åŒ–æœ€é«˜ã€é€‚åº”æ€§æœ€å¼ºçš„é™†ç”Ÿæ¤ç‰©ç±»ç¾¤ï¼Œæå¤§åœ°å½±å“äº†å…¶ä»–ç”Ÿç‰©ç±»ç¾¤çš„æ¼”åŒ–è¿›ç¨‹ï¼Œç„¶è€Œï¼Œç”±äºè¢«å­æ¤ç‰©åœ¨æ—©æœŸç»å†äº†å¿«é€Ÿçš„è¾å°„è¿›åŒ–ï¼Œå…¶å†…éƒ¨æ¼”åŒ–å…³ç³»è¿Ÿè¿Ÿæœªè¢«è§£å†³ï¼Œè¿™ä¸€é—®é¢˜ä¹Ÿè¢«ç§°ä¸ºè¾¾å°”æ–‡çš„â€œæ¼äººä¹‹è°œâ€ã€‚ç»è¿‡å‰äººé•¿æ—¶æœŸçš„åŠªåŠ›ï¼Œç›®å‰è¢«å­æ¤ç‰©è¢«åˆ’åˆ†ä¸ºï¼šæ— æ²¹æ¨Ÿç›®ã€ç¡è²ç›®ã€æœ¨å…°è—¤ç›®å’Œæ ¸å¿ƒè¢«å­æ¤ç‰©ï¼ˆMesangiospermaeï¼‰ã€‚æ— æ²¹æ¨Ÿç›®ã€ç¡è²ç›®ã€æœ¨å…°è—¤ç›®å…±åŒè¢«ç§°ä¸ºANA gradeï¼Œæ˜¯è¢«å­æ¤ç‰©çš„åŸºéƒ¨ç±»ç¾¤ï¼Œç³»ç»Ÿå‘è‚²å…³ç³»ç›¸å¯¹ç¨³å®šï¼Œè€Œæ ¸å¿ƒè¢«å­æ¤ç‰©åŒ…å«äº†~99.95%çš„è¢«å­æ¤ç‰©ï¼Œåˆå¯è¢«åˆ’åˆ†ä¸º5å¤§ç±»ç¾¤ï¼šåŒå­å¶ã€å•å­å¶ã€æœ¨å…°ç±»ã€é‡‘é±¼è—»ç›®å’Œé‡‘ç²Ÿå…°ç›®ï¼Œå®ƒä»¬ä¹‹é—´çš„æ¼”åŒ–å…³ç³»ä¸€ç›´å­˜åœ¨äº‰è®®ã€‚è¿‘å¹´æ¥ï¼Œéšç€å„ç±»ç¾¤ä»£è¡¨ç‰©ç§å…¨åŸºå› ç»„æµ‹åºç›¸ç»§å®Œæˆï¼Œå…¶å„è‡ªçš„è¿›åŒ–å†ç¨‹å‡æœ‰äº†åšå®è€Œå¯é çš„è¯æ®ï¼Œåˆ˜å»ºå…¨å›¢é˜Ÿåœ¨2020å¹´é¦–æ¬¡æŠ¥é“äº†é‡‘é±¼è—»å’ŒèŠ¡å®çš„åŸºå› ç»„ï¼Œè¯æ˜äº†æ ¸å¿ƒè¢«å­æ¤ç‰©å†…éƒ¨å­˜åœ¨å¹¿æ³›çš„ä¸å®Œå…¨è°±ç³»åˆ†é€‰å’Œæ‚äº¤äº‹ä»¶æ˜¯å¯¼è‡´æ ‘å½¢å†²çªçš„ä¸»è¦åŸå› ã€‚ä½†æ˜¯é‡‘ç²Ÿå…°ç›®ä¸€ç›´æœªæœ‰åŸºå› ç»„æŠ¥é“ï¼Œå…¶æ¼”åŒ–å†ç¨‹ä»¥åŠæ•´ä¸ªæ ¸å¿ƒè¢«å­æ¤ç‰©çš„æ¼”åŒ–è¿‡ç¨‹è¿˜æœ‰å¾…æ·±å…¥åˆ†æã€‚ä¸ºæ­¤è¯¥å›¢é˜Ÿå†æ¬¡åˆ©ç”¨Nanoporeã€Illuminaå’ŒHi-CæŠ€æœ¯ï¼Œæ„å»ºäº†ç¬¬ä¸€ä¸ªé‡‘ç²Ÿå…°ç›®æ¤ç‰©ï¼ˆå››å·é‡‘ç²Ÿå…°ï¼Œ<em>Chloranthus sessilifolius</em>ï¼‰çš„é«˜è´¨é‡æŸ“è‰²ä½“çº§åˆ«åŸºå› ç»„ï¼ŒContig N50é«˜è¾¾53.74 Mbï¼ˆå›¾1ï¼‰ï¼Œä½¿ç”¨å¤šç§åˆ†ææ–¹æ³•å¯¹ä¸Šè¿°é—®é¢˜è¿›è¡Œäº†æ·±å…¥çš„é˜è¿°ã€‚</p>
<p>é€šè¿‡ä½¿ç”¨å¤šç§ç³»ç»Ÿå‘è‚²åŸºå› ç»„å­¦åˆ†æï¼ŒåŒ…æ‹¬å•æ‹·è´åŸºå› ã€ä½æ‹·è´åŸºå› å’Œå…±çº¿æ€§åŸºå› æ•°æ®é›†ï¼Œè¿›è¡Œäº†ä¸²è”æ ‘å’Œæº¯ç¥–æ ‘çš„æ„å»ºï¼ŒåŒæ—¶è¯„ä¼°äº†é•¿æå¸å¼•ã€ç‰©ç§é€‰æ‹©å’ŒåŒæºèšç±»æ–¹æ³•ç­‰çš„å½±å“ï¼Œä½¿ç”¨å¤šå¥—æ•°æ®é›†åˆå’Œå¤šç§åˆ†ææ–¹æ³•ï¼Œè·å¾—äº†é«˜å¯ä¿¡åº¦çš„æ‹“æ‰‘ç»“æ„ï¼Œå³é‡‘ç²Ÿå…°ç›®å’Œæœ¨å…°ç±»å…·æœ‰æœ€è¿‘çš„äº²ç¼˜å…³ç³»ï¼Œä¸”ä»–ä»¬ä¸€èµ·ä¸é‡‘é±¼è—»ç›®+åŒå­å¶æ¤ç‰©æ„æˆå§Šå¦¹å…³ç³»ï¼Œè€Œå•å­å¶æ¤ç‰©æ˜¯å…¶å®ƒæ‰€æœ‰æ ¸å¿ƒè¢«å­æ¤ç‰©çš„å§Šå¦¹æï¼ˆå›¾2ï¼‰ã€‚</p>
<p>åŒæ—¶ï¼Œä½œè€…ä¹Ÿå‘ç°äº†å¤§é‡çš„åŸºå› æ ‘æˆ–å¶ç»¿ä½“æ ‘ä¸ç‰©ç§æ ‘ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› æ­¤ç€é‡è¯„ä¼°äº†ä¸å®Œå…¨è°±ç³»åˆ†é€‰ï¼ˆILSï¼‰å’Œæ‚äº¤äº‹ä»¶å¯¹æ­¤å†²çªçš„è´¡çŒ®ã€‚é€šè¿‡PhyloNetworksåˆ†æé‰´å®šåˆ°äº†ä¸‰æ¬¡å¯èƒ½çš„æ‚äº¤äº‹ä»¶ï¼Œå¯ä»¥è§£æéƒ¨åˆ†çš„æ ‘å½¢å†²çªã€‚ç„¶è€Œå€¼å¾—æ³¨æ„çš„æ˜¯äº”å¤§ç±»ç¾¤ä¹‹é—´çš„åˆ†åŒ–æ—¶é—´ä»…æœ‰23ä¸ªç™¾ä¸‡å¹´ï¼ˆ158~135 Myaï¼‰ï¼Œå¦‚æ­¤çŸ­çš„åˆ†åŒ–æ—¶é—´ï¼ŒILSå¯èƒ½å‘æŒ¥äº†æ›´ä¸ºä¸»è¦çš„ä½œç”¨ã€‚ä½¿ç”¨thetaå‚æ•°å¯¹æ¯ä¸ªå†…éƒ¨åˆ†æ”¯å‘ç”ŸILSçš„æ¦‚ç‡è¿›è¡Œè¯„ä¼°å‘ç°ï¼Œé™¤äº†æœ¨å…°ç±»å’Œé‡‘ç²Ÿå…°ç›®çš„å§Šå¦¹å…³ç³»è¾ƒä¸ºç¨³å®šå¤–ï¼Œå…¶ä»–ç±»ç¾¤é—´éƒ½å…·æœ‰è¾ƒé«˜çš„thetaå€¼ï¼Œè€Œé‡‘é±¼è—»ç›®+åŒå­å¶çš„ç¥–å…ˆåˆ†æå…·æœ‰è¾ƒé«˜çš„tehtaå€¼ï¼Œå‡è¡¨æ˜äº†ILSåœ¨æ ¸å¿ƒè¢«å­æ¤ç‰©å†…éƒ¨çš„æ¼”åŒ–ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ï¼ˆå›¾3 aå’Œbï¼‰ã€‚åŸºäºPhyabseå’ŒDendroPyè¿›è¡Œæ ‘å½¢æ¨¡æ‹Ÿè¡¨æ˜ï¼Œå½“å­˜åœ¨ILSæ—¶æ¨¡æ‹Ÿçš„æ ‘å½¢å’ŒçœŸå®æ ‘å½¢å…·æœ‰é«˜åº¦ä¸€è‡´æ€§ï¼ˆR2ï¼0.99ï¼‰ï¼Œè€Œä¸å­˜åœ¨ILSçš„æ¨¡æ‹Ÿæ ‘å½¢ä¸çœŸå®æ ‘å½¢åˆ™å…·æœ‰è¾ƒä½çš„ç›¸å…³æ€§ï¼Œè¿›ä¸€æ­¥è¡¨æ˜äº†ILSåœ¨æ ¸å¿ƒè¢«å­æ¤ç‰©çš„å¿«é€Ÿè¾å°„ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ï¼ˆå›¾3 c-fï¼‰ã€‚è¿›ä¸€æ­¥å¯¹æ ‘å½¢å¼‚è´¨æ€§è¿›è¡ŒåŒºåˆ†è¡¨æ˜ï¼ŒILSå¯åŸºæœ¬è§£é‡Šé‡‘é±¼è—»ç›®+åŒå­å¶çš„ç¥–å…ˆæä¸Šçš„æ ‘å½¢å†²çªï¼Œä¹Ÿå°±æ˜¯é‡‘é±¼è—»ç›®+åŒå­å¶ã€æœ¨å…°ç±»+é‡‘ç²Ÿå…°å’Œå•å­å¶ä¹‹é—´çš„å†²çªï¼Œè€Œå…¶ä»–æ ¸å¿ƒè¢«å­æ¤ç‰©ç±»ç¾¤é—´çš„å†²çªè¿˜æœ‰å…¶ä»–å› ç´ ï¼ˆä¾‹å¦‚æ‚äº¤ï¼‰çš„å‚ä¸ã€‚</p>
<p>æ­¤å¤–ï¼Œæœ¬ç ”ç©¶è¿˜é‰´å®šäº†å››å·é‡‘ç²Ÿå…°ç‹¬æœ‰çš„ä¸€æ¬¡WGDäº‹ä»¶ï¼ŒåŒæ—¶5å¤§æ ¸å¿ƒè¢«å­æ¤ç‰©åˆ†æçš„åŠ å€äº‹ä»¶éƒ½ä¸å…±äº«ï¼›é‰´å®šäº†èŠ±å‘è‚²ç›¸å…³çš„åŸºå› å®¶æ—ï¼Œè§£æäº†å…¶ç‰¹æœ‰èŠ±å™¨å®˜çš„å¯èƒ½å½¢æˆåŸå› ï¼›é‰´å®šäº†èœç±»åˆæˆå’Œæœ¨è´¨éƒ¨å½¢æˆç›¸å…³çš„åŸºå› å®¶æ—ï¼Œä¸ºä»Šåç ”ç©¶å…¶ç®€å•æœ¨è´¨éƒ¨å½¢æˆå’Œèœç±»ç‰©ç§åˆæˆé€šè·¯æ¼”åŒ–æä¾›äº†åŸºç¡€ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ç ”ç©¶æŠ¥é“äº†é«˜è´¨é‡çš„å››å·é‡‘ç²Ÿå…°åŸºå› ç»„ï¼Œå¡«è¡¥äº†æ ¸å¿ƒè¢«å­æ¤ç‰©é‡‘ç²Ÿå…°ç›®çš„åŸºå› ç»„ä¿¡æ¯ï¼Œå¹¶é€šè¿‡å¤šç§åˆ†æç­–ç•¥å’Œæ–¹æ³•ï¼Œæ·±å…¥çš„æ­ç¤ºäº†æ ¸å¿ƒè¢«å­æ¤ç‰©é—´çš„å¤æ‚æ¼”åŒ–å†ç¨‹ï¼Œè¯¥æˆæœå¯¹äºæ—©æœŸè¢«å­æ¤ç‰©çš„èµ·æºã€è¾å°„è¿›åŒ–ä»¥åŠé€‚åº”æ€§æ¼”åŒ–æä¾›æ•°æ®æ”¯æ’‘å’Œç†è®ºåŸºç¡€ã€‚</p>
<h2 id="Genome-size-estimate-and-assembly"><a href="#Genome-size-estimate-and-assembly" class="headerlink" title="Genome size estimate and assembly."></a>Genome size estimate and assembly.</h2><p>To estimate the genome size of C. sessilifolius, we surveyed 150 bp paired-end reads, computed 21 bp K-mer frequencies using <font color="red"><strong>Jellyfish</strong></font>, and exported the resulting histogram into <font color="red">findGSE</font>. <font color="red"><strong>Nextdenovo</strong></font> (https:// github.com/Nextomics/Nextdenovo) was selected for <font color="blue"><strong>correcting reads</strong></font> with para- meters â€œread_cutoff=2k, seed_cutoff=30k, blocksize=1.5gâ€ and then <font color="red"><strong>Smartdenovo</strong></font> (<a href="https://github.com/ruanjue/smartdenovo">https://github.com/ruanjue/smartdenovo</a>) for <font color="blue"><strong>de novo assembly</strong></font> with parameters â€œwtpre -J 3,000; wtzmo-k 21 -z 10 -Z 16 -U -1 -m 0.1 -A 1000; wtclp -d 3 -k 300 -m 0.1 -FT; wtlay -w 300 -s 200 -m 0.1 -r 0.95 -c 1â€. <font color="blue">The preliminary contigs were further <strong>polished</strong> by aligning the Illumina <strong>short</strong> <strong>reads</strong> to the contigs</font> using <font color="red"><strong>Nextpolish</strong></font>. After four rounds of successive iterative correction, the final genome sequence was obtained. The GC content and sequencing coverage analyses were applied to evaluate the presence of contamination. The quality of the genome assembly was also assessed using <font color="red"><strong>BUSCO</strong></font> (Benchmarking Universal Single-Copy Orthologs) with the embry- ophyta_odb10 database. The clean <font color="blue">Hi-C</font> data were mapped to contig sequences by <font color="red"><strong>Bowtie2</strong></font> and 354 Mb valid interaction pairs were extracted. Based on those chromatin interactions, <font color="red"><strong>LACHESIS</strong></font> was employed to <font color="blue"><strong>cluster</strong>, <strong>order</strong>, and <strong>orient</strong> the <strong>contigs</strong> into <strong>pseudo-chromosomes</strong></font>.</p>
<h1 id="9-2022-01-gb-æ²¹èŒ¶"><a href="#9-2022-01-gb-æ²¹èŒ¶" class="headerlink" title="9. 2022.01-gb æ²¹èŒ¶"></a>9. 2022.01-gb æ²¹èŒ¶</h1><blockquote>
<p>The genome of oil-Camellia and population genomics analysis provide insights into seed oil domestication</p>
</blockquote>
<p>æ²¹èŒ¶æ˜¯æˆ‘å›½ä¼ ç»Ÿæœ¨æœ¬æ²¹æ–™æ ‘ç§ï¼Œå…·æœ‰2300ä½™å¹´æ ½åŸ¹é£Ÿç”¨å†å²ã€‚è‡ªä¸Šä¸–çºªèµ·ï¼Œç»è¿‡å››ä»£ç§‘æŠ€å·¥ä½œè€…è‰°è‹¦åŠªåŠ›ï¼Œæˆ‘å›½æ²¹èŒ¶ä¸»æ ½è‰¯ç§è¡ç”Ÿå‡ºæ•°ç™¾ä¸ªå“ç§ã€‚ä½†å—åˆ¶äº<font color="blue">å¤šå€æ€§ã€é•¿æ—¶æ•ˆ</font>ç‰¹æ€§ï¼Œæ²¹èŒ¶è‚²ç§å·¥ä½œæ•ˆç‡ä¸é«˜ã€‚</p>
<p>2022å¹´1æœˆ10æ—¥ï¼Œä¸­å›½æ—ä¸šç§‘å­¦ç ”ç©¶é™¢äºšçƒ­å¸¦æ—ä¸šç ”ç©¶æ‰€ï¼ˆäºšæ—æ‰€ï¼‰ç ”ç©¶å‘˜<strong>å§šå°åå›¢é˜Ÿ</strong>å’Œ<strong>æ®·æ’ç¦å›¢é˜Ÿ</strong>åœ¨<strong>ã€ŠåŸºå› ç»„ç”Ÿç‰©å­¦ã€‹ï¼ˆGenome Biologyï¼‰</strong>å‘è¡¨æœ€æ–°è®ºæ–‡ã€‚</p>
<p>è¯¥ç ”ç©¶æˆåŠŸç»„è£…å…¨çƒé¦–ä¸ªæŸ“è‰²ä½“çº§åˆ«é«˜è´¨é‡æ²¹èŒ¶åŸºå› ç»„ï¼Œæ­ç¤º<font color="red">æ²¹èŒ¶ç‰©ç§<strong>è¿›åŒ–å†å²</strong>åŠå…¶<strong>ç§å­å«é«˜æ²¹è„‚</strong>ã€<strong>é«˜ä¸é¥±å’Œè„‚è‚ªé…¸</strong>çš„<strong>é©¯åŒ–æœºåˆ¶</strong></font>ï¼Œå»ºç«‹äº†æ²¹è„‚æ€§çŠ¶æ—©æœŸé€‰æ‹©æŠ€æœ¯ä½“ç³»ï¼Œä¸ºåŠ å¿«è‰¯ç§é€‰è‚²æ•ˆç‡ã€ä¿éšœæˆ‘å›½ç²®æ²¹å®‰å…¨å¥ å®šäº†åŸºç¡€ã€‚</p>
<h2 id="æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢"><a href="#æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢" class="headerlink" title="æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢"></a>æŠ±å­æ€€èƒçš„æ²¹èŒ¶è‰¯ç§è‚²ç§ç¼“æ…¢</h2><p>è‰¯ç§æ˜¯å†œä¸šç”Ÿäº§çš„â€œèŠ¯ç‰‡â€ã€‚ä½œä¸ºæˆ‘å›½å››å¤§æ²¹æ–™ä½œç‰©ä¹‹ä¸€ï¼Œæ²¹èŒ¶æ˜¯å†œæ°‘å¢æ”¶ã€ç²®æ²¹å®‰å…¨ã€ç”Ÿæ€å»ºè®¾çš„â€œé‡è¦æ³•å®â€ã€‚æˆ‘å›½æ²¹èŒ¶è‚²ç§å†ç»äº†é€‰æ‹©è‚²ç§å’Œå®šå‘æ‚äº¤è‚²ç§é˜¶æ®µï¼Œä¸»æ ½è‰¯ç§ç”±å®¶ç³»å“ç§ã€å†œå®¶å“ç§èµ°å‘æ— æ€§ç³»è‰¯ç§ï¼Œè¡ç”Ÿå‡ºæ•°ç™¾ä¸ªå“ç§ï¼Œæ„æˆäº†æˆ‘å›½æ²¹èŒ¶äº§ä¸šçš„å‘å±•åŸºç¡€ã€‚</p>
<p>ä½†ç”±äºæ²¹èŒ¶ç»“å®ä¹‹å‰è¦ç»å†æ¼«é•¿çš„ç«¥æœŸï¼Œè€Œä¸”ä»<font color="blue">å¼€èŠ±åˆ°æœå®æˆç†Ÿéœ€è¦æ•´æ•´1å¹´æ—¶é—´</font>ï¼Œä¿—ç§°â€˜æŠ±å­æ€€èƒâ€™ï¼Œå¯¼è‡´æ²¹èŒ¶è‚²ç§å¹´é™é•¿ï¼Œæ–°å“ç§é€‰è‚²ç¼“æ…¢ï¼Œè‰¯ç§é€‰è‚²é€Ÿåº¦æ— æ³•æ»¡è¶³äº§ä¸šå‘å±•çš„éœ€æ±‚ï¼Œå·²æˆä¸ºé˜»ç¢æ²¹èŒ¶äº§ä¸šå‘å±•çš„é‡è¦å› ç´ ã€‚</p>
<p>æˆ‘å›½é•¿æœŸé¢ä¸´é£Ÿç”¨æ²¹ä¾›éœ€å‹åŠ›ï¼Œå¯¹å¤–ä¾å­˜åº¦é«˜è¾¾60%ã€‚æ²¹èŒ¶èƒ½å¤Ÿåˆ©ç”¨æˆ‘å›½äºšçƒ­å¸¦åŒºåŸŸçš„å®œæ—å±±åœ°ç§æ¤ï¼Œä¸ä¸ç²®äº‰åœ°ï¼Œæ˜¯ä¿éšœæˆ‘å›½ç²®æ²¹å®‰å…¨ã€å®ç°ä¹¡æ‘æŒ¯å…´çš„é‡è¦æŠ“æ‰‹ã€‚</p>
<p>æ²¹èŒ¶æ³›æŒ‡å±±èŒ¶ç§‘å±±èŒ¶å±æ¤ç‰©ä¸­æ²¹è„‚å«é‡é«˜ï¼Œå…·æœ‰ä¸€å®šæ ½åŸ¹é¢ç§¯çš„ï¼Œæœ‰ç»æµæ ½åŸ¹ä»·å€¼çš„ç‰©ç§çš„æ€»ç§°ï¼Œæ˜¯æˆ‘å›½ä¸»æ¨çš„é‡è¦æœ¨æœ¬æ²¹æ–™æ ‘ç§ã€‚æˆ‘å›½ç°æœ‰æ²¹èŒ¶ç§æ¤é¢ç§¯7000ä¸‡äº©ï¼Œä»¥æ™®é€šæ²¹èŒ¶ï¼ˆCamellia oleiferaï¼‰ä¸ºä¸»ï¼Œå¹´æ€»äº§å€¼1200äº¿å…ƒå·¦å³ã€‚</p>
<p>æ²¹èŒ¶ç±½æ²¹ä¸­ä¸é¥±å’Œè„‚è‚ªé…¸è¾¾90%ä»¥ä¸Šï¼Œå…¶ä¸­ä»¥å•ä¸é¥±å’Œè„‚è‚ªé…¸æ²¹é…¸ä¸ºä¸»ï¼Œå¯Œå«è§’é²¨çƒ¯ã€ç»´ç”Ÿç´ Eã€ç”¾é†‡ã€å¤šé…šç­‰åŠŸèƒ½æˆåˆ†ï¼Œå…·æœ‰æé«˜çš„ä¿å¥ä»·å€¼ï¼Œè¢«èª‰ä¸ºâ€œæ¶²ä½“é»„é‡‘â€ã€‚</p>
<p>ç„¶è€Œç ”ç©¶å‘ç°, æ²¹èŒ¶åŸºå› ç»„å…·æœ‰<font color="red"><strong>æ‚åˆç‡é«˜ã€é‡å¤åºåˆ—å æ¯”å¤§</strong>çš„ç‰¹ç‚¹ï¼Œå…¶æ‚åˆç‡è¾¾åˆ°äº†<strong>2.52%</strong></font>ï¼Œè¿œé«˜äºå¤§éƒ¨åˆ†å·²æµ‹åºçš„ç‰©ç§ï¼Œè¿™ä¸ºåŸºå› ç»„ç»„è£…å¸¦æ¥äº†å·¨å¤§æŒ‘æˆ˜ã€‚</p>
<h2 id="æŸ“è‰²ä½“çº§åˆ«ç»„è£…"><a href="#æŸ“è‰²ä½“çº§åˆ«ç»„è£…" class="headerlink" title="æŸ“è‰²ä½“çº§åˆ«ç»„è£…"></a>æŸ“è‰²ä½“çº§åˆ«ç»„è£…</h2><p>ç»è¿‡å››å¹´å¤šçš„åŠªåŠ›ï¼Œè¯¥å›¢é˜Ÿè·å¾—å¤§å°ä¸º<font color="red">2.95 GBï¼ŒContig N50ä¸º<strong>1.002 MB</strong></font>çš„äºŒå€ä½“æ²¹èŒ¶ï¼ˆCONï¼‰çš„åŸºå› ç»„å›¾è°±ï¼Œå¹¶å°†åŸºå› ç»„<font color="red">é”šå®šåˆ°15æ¡æŸ“è‰²ä½“</font>ï¼Œé”šå®šç‡è¾¾åˆ°<font color="red">91.33%</font>ï¼Œè·å¾—äº†è´¨é‡ä¼˜è‰¯çš„æ²¹èŒ¶åŸºå› ç»„å›¾è°±ã€‚</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/2.png" alt="æ²¹èŒ¶åŸºå› ç»„å›¾è°±åŠå…¶è¿›åŒ–"></p>
<p>åŒæ—¶ï¼Œåˆ©ç”¨æ§åˆ¶æ‚äº¤çš„ç¾¤ä½“å»ºç«‹<font color="red"><strong>é«˜å¯†åº¦çš„é—ä¼ æ ‡è®°è¿é”å›¾è°±</strong></font>ï¼Œå¯¹<font color="red">åŸºå› ç»„<strong>å›¾è°±ç»„è£…</strong>è¿›è¡Œè¿›ä¸€æ­¥<strong>æ ¡æ­£</strong></font>ï¼Œä¸ºæœªæ¥é‡è¦æ€§çŠ¶çš„åŸºå› å®šä½æä¾›æ”¯æ’‘ã€‚</p>
<p>æ²¹èŒ¶ç‰©ç§èµ·æºä¸åˆ†å¸ƒä¸»è¦é›†ä¸­åœ¨æˆ‘å›½å—æ–¹äºšçƒ­å¸¦åœ°åŒºã€‚é€šè¿‡å¯¹æ²¹èŒ¶åŸºå› ç»„çš„æ¯”è¾ƒåˆ†æï¼Œå‘ç°æ²¹èŒ¶åŸºå› ç»„å…±å‘ç”Ÿ<font color="red"><strong>ä¸¤æ¬¡å…¨åŸºå› ç»„å¤åˆ¶</strong>äº‹ä»¶</font>ï¼šç¬¬ä¸€æ¬¡ä¸ºå¤è€çš„<font color="red">Î³å¤åˆ¶</font>ï¼Œç¬¬äºŒæ¬¡å‘ç”Ÿåœ¨<font color="red"><strong>å±±èŒ¶å±ä¸çŒ•çŒ´æ¡ƒå±</strong>åˆ†åŒ–å‰ä¸ä¹…</font>ã€‚</p>
<p>è€Œå±±èŒ¶å±å½¢æˆä¹‹åå¹¶æ²¡æœ‰å‘ç”Ÿç‰¹æ®Šçš„å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶ã€‚é€šè¿‡å±±èŒ¶â€”çŒ•çŒ´æ¡ƒã€å±±èŒ¶â€”æŸ¿ã€æŸ¿â€”çŒ•çŒ´æ¡ƒ<font color="red"><strong>å±é—´åŒæºçªå˜ç‡çš„æ¯”è¾ƒ</strong></font>å°è¯è¿™ä¸€è§‚ç‚¹ã€‚</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/3.png" alt="æ²¹èŒ¶åŸºå› ç»„é‡å¤åºåˆ—åˆ†æ"></p>
<p>å±±èŒ¶å±åŒ…æ‹¬200å¤šä¸ªç‰©ç§ï¼ŒåŒ…æ‹¬ä»¥<strong>æ™®é€šæ²¹èŒ¶</strong>ä¸ºä»£è¡¨çš„æ²¹èŒ¶ç»„ã€ä»¥<strong>èŒ¶</strong>ä¸ºä»£è¡¨çš„èŒ¶ç»„å’Œä»¥<strong>å±±èŒ¶èŠ±</strong>ä¸ºä»£è¡¨çš„å±±èŒ¶ç»„ç­‰ã€‚ç³»ç»Ÿå‘è‚²å’Œåˆ†å­é’Ÿæ ‡å®šåˆ†æå‘ç°ï¼Œ<strong>æ²¹èŒ¶å’ŒèŒ¶çš„åˆ†åŒ–</strong>å‘ç”Ÿåœ¨å¤§çº¦17.3ç™¾ä¸‡å¹´å‰ã€‚</p>
<p>åœ¨é•¿æœŸæ ½åŸ¹é©¯åŒ–ä¸­ï¼ŒåŒºåˆ«äºä»¥å¶ç”¨ä¸ºç›®çš„çš„èŒ¶å’Œä»¥è§‚èµä¸ºç›®çš„çš„å±±èŒ¶ï¼Œæ²¹èŒ¶åœ¨äººå·¥é€‰æ‹©ä½œç”¨ä¸‹è¿›åŒ–æˆä»¥ç§å­æ²¹è„‚ä¸ºä¸»è¦æ ½åŸ¹ç›®çš„çš„æœ¨æœ¬æ²¹æ–™æ ‘ç§ï¼Œä½¿å¾—æ²¹èŒ¶æˆä¸ºç ”ç©¶æ¤ç‰©ç§å­<font color="red"><strong>æ²¹è„‚æ€§çŠ¶é©¯åŒ–</strong></font>çš„ç»ä½³ææ–™ã€‚</p>
<p>ä¸ºè¿›ä¸€æ­¥æ­ç¤ºæ²¹èŒ¶æ²¹è„‚æ€§çŠ¶é©¯åŒ–çš„åˆ†å­æœºåˆ¶ï¼Œè¯¥å›¢é˜Ÿåˆ©ç”¨å…¨å›½åˆ†å¸ƒåŒºå†…çš„<font color="red">221ä¸ªä»£è¡¨å“ç§</font>å¼€å±•<font color="red"><strong>ç¾¤ä½“è½¬å½•ç»„æµ‹åºå’Œå…³è”åˆ†æ</strong></font>ã€‚ç»“æœå‘ç°åœ¨é•¿æœŸ<strong>é©¯åŒ–</strong>è¿‡ç¨‹ä¸­ï¼Œæ²¹èŒ¶æœå®é€æ¸<strong>å¢å¤§</strong>ï¼Œç§ä»æ²¹è„‚å«é‡æ˜¾è‘—<strong>æé«˜</strong>ï¼Œæ²¹è„‚å“è´¨ä¸æ–­<strong>ä¼˜åŒ–</strong>ï¼Œå½¢æˆäº†ç›®å‰ä¸»æ ½çš„æœå¤§ã€å«æ²¹ç‡é«˜ã€æ²¹è„‚å“è´¨ä¼˜è‰¯çš„æ ½åŸ¹ç±»å‹ã€‚</p>
<p>è¿›ä¸€æ­¥åˆ†æå‘ç°é©¯åŒ–è¿‡ç¨‹ä¸­ï¼Œæ²¹èŒ¶åŸºå› ç»„ä¸­<font color="red"><strong>æ²¹è„‚ä»£è°¢é€šè·¯</strong>ä¸­çš„å¤šä¸ª<strong>åŸºå› </strong>å—åˆ°äº†<strong>æ˜¾è‘—çš„äººå·¥é€‰æ‹©</strong></font>ã€‚æ­¤å¤–ï¼Œ<font color="red">èƒè¿«åº”ç­”ã€æ¿€ç´ ç”Ÿç‰©åˆæˆ</font>ç­‰é€šè·¯ä¹Ÿå—åˆ°æ˜¾è‘—é€‰æ‹©ã€‚</p>
<p>ä¸ºäº†æŒ–æ˜é«˜åº¦å¯ä¿¡çš„æ²¹è„‚ä»£è°¢å…³é”®åŸºå› ï¼Œè”åˆé‡‡ç”¨<font color="red"><strong>åŸºå› ç»„é—ä¼ å˜å¼‚ã€åŸºå› è¡¨è¾¾æ°´å¹³å’Œè¡¨å‹æ€§çŠ¶å˜å¼‚å…³è”åˆ†æ</strong></font>ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œåœ¨<font color="red">ç­›é€‰å‡ºçš„<strong>21ä¸ªå€™é€‰</strong>åŸºå› </font>ä¸­ï¼Œæœ‰<font color="red"><strong>14ä¸ª</strong></font>å±äºæ²¹è„‚åˆæˆå’Œåˆ†è§£ä»£è°¢é€šè·¯åŸºå› ã€‚</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/4.png" alt="æ²¹èŒ¶å“ç§ç¾¤ä½“å…³è”åˆ†æå‘æ˜æ²¹è„‚äº§é‡ä¸å“è´¨çš„è°ƒæ§åŸºå› "></p>
<p>å…¶ä¸­ï¼Œæ²¹è„‚ä»£è°¢é€šè·¯ä¸­çš„8ä¸ªåŸºå› å’Œæ¤ç‰©æ¿€ç´ ç›¸å…³è½¬å½•å› å­IAA26åœ¨é•¿æœŸ<strong>æ ½åŸ¹é©¯åŒ–</strong>è¿‡ç¨‹ä¸­<strong>å½¢æˆ</strong><font color="red"><strong>æ˜¾è‘—</strong>çš„<strong>å•æ ¸è‹·é…¸å¤šæ€æ€§</strong>å’Œ<strong>è¡¨è¾¾æ°´å¹³å·®å¼‚</strong></font>ã€‚â€œè¿™8ä¸ªåŸºå› æ—¢åŒ…æ‹¬<font color="red">æ²¹è„‚åˆæˆ</font>åŸºå› ï¼Œä¹Ÿæœ‰<font color="red">æ²¹è„‚åˆ†è§£ä»£è°¢</font>åŸºå› ï¼Œè¿™è¡¨æ˜æ²¹èŒ¶<font color="red"><strong>æ²¹è„‚æ€§çŠ¶</strong></font>æ˜¯ç”±å‚ä¸åˆæˆå’Œåˆ†è§£çš„<font color="red"><strong>ä¸¤ç±»åŸºå› ååŒè°ƒæ§</strong></font>çš„ç»“æœã€‚</p>
<h2 id="Genome-sequencing-de-novo-assembly-and-annotation"><a href="#Genome-sequencing-de-novo-assembly-and-annotation" class="headerlink" title="Genome sequencing, de novo assembly, and annotation"></a>Genome sequencing, de novo assembly, and annotation</h2><p>The genomic DNA of CON was prepared by using the young <strong>leaves</strong>. Ten 20 kb de novo SMRTbell libraries were constructed according to the standard manufacturerâ€™s protocol and used for <font color="red">SMRT PacBio</font> genome sequencing. A total of 27,876,348 reads (total size of <strong>320 G</strong>) were generated and used for initial assembly by the <font color="red"><strong>Falcon</strong></font> (v0.3.0) pipeline. The <font color="red"><strong>HaploMerger2</strong></font> (v20180603) program (default parameters) was used to <strong>reduce the redundancy</strong>, and <font color="red"><strong>Arrow program</strong></font> with default parameters was used to <strong>correct</strong> the sequencing <strong>errors</strong>. Further, a total of <font color="red">210 G</font> clean data generated by the <strong>Illumina</strong> Nova- Seq6000 platform was used to <font color="red">correct</font> the PacBio reads.</p>
<p>To circumvent the high heterozygosity of the CON genome, a <font color="red"><strong>hybrid assembly of strategy</strong></font> was used to construct the high-quality reference genome. The details of the <font color="red"><strong>BioNano, 10X Genomics, and Hi-C</strong></font> sequencing procedures were described in the Additional File 3: Method S1; and the hybrid assembly approach was described in <strong>Additional File 2</strong>: Fig. S3. Finally, to construct a chromosome-scale reference genome, the Hi-C chromosomal interaction was created using HiC-pro [38] software (v2.5.0) (<strong>Additional File 2</strong>: Fig. S4). </p>
<p>The <font color="red">repetitive elements</font> in the CON genome, including tandem repeats and interspersed repeats, were identified. Tandem repeats were discovered by <font color="red"><strong>Tandem Repeats Finder</strong></font> v4.07b. Interspersed repeats in the genome were identified using an integration of <strong>independent homology searching and de novo predictions</strong> (See details in Additional File 3: Method S2). Non-coding RNA genes (ncRNA) were annotated in this study (see details in Additional File 3: Method S2) and the results were shown in Additional File 1: Table S4.</p>
<p>We <font color="red">annotated</font> the assembled genome through combining three different approaches: <font color="red"><strong>ab initio prediction, homology-based prediction,</strong> and <strong>transcriptome alignment</strong></font>. To ob- tain the transcriptome data, the total RNA of seven different tissues from CON was se- quenced using the Illumina NovaSeq platform. The transcripts homolog prediction was performed initially by MAKER (v2.31.10); Augustus (v3.3.1) and SNAP (v2006-07-28) were used for de novo prediction. Finally, both homolog and de novo prediction results were integrated using MAKER and resulted in the final gene models (Additional File 1: Table S5; see details in Additional File 3: Method S2)</p>
<p><font color="red"><strong>Functional annotation</strong></font> was achieved by comparing predicted proteins against public databases, including NCBI non-redundant protein sequences database (Nr), SwissProt (201709) [39], eggNOG [39], KEGG (v84) [40], Interpro (v5.16-55.0) [41], and GO [42] using Blast (v2.2.3) [43].</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/5.png" alt="5"></p>
<p>PacBio+illumina : Falcon+Arrow+BWA+Pilon+HaploMerger-&gt;contigs</p>
<p>scaffold+HiC : <font color="red"><strong>JUICER+3D-DNA</strong></font></p>
<h1 id="10-2022-01-HorticRes-ç”˜èŠ"><a href="#10-2022-01-HorticRes-ç”˜èŠ" class="headerlink" title="10. 2022.01-HorticRes ç”˜èŠ"></a>10. 2022.01-HorticRes ç”˜èŠ</h1><p><strong>The</strong> <em><strong>chrysanthemum lavandulifolium</strong></em> <strong>genome and the molecular mechanism underlying diverse capitulum types</strong></p>
<p><strong>èŠèŠ±</strong>(<em>Chrysanthemum Ã—morifolium</em> Ramat.)æ˜¯ä¸–ç•Œè‘—åçš„è§‚èµæ¤ç‰©ï¼Œå…·æœ‰åƒå§¿ç™¾æ€çš„èŠ±å‹ã€‚å®é™…èŠèŠ±çš„èŠ±æ˜¯æŒ‡ç”±<font color="red"><strong>å¤–å›´çš„èˆŒçŠ¶èŠ±</strong></font>å’Œ<font color="red"><strong>ç›˜å¿ƒçš„ç®¡çŠ¶èŠ±</strong></font>å…±åŒæ„æˆçš„<font color="red"><strong>å¤´çŠ¶èŠ±åº</strong></font>ã€‚å…¶èŠ±å‹ç”±å¤´çŠ¶èŠ±åºä¸ŠèˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±çš„å½¢æ€å’Œç›¸å¯¹æ•°é‡å†³å®šã€‚è§£æåŒä¸€å¤´çŠ¶èŠ±åºä¸ŠèˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±åˆ†åŒ–çš„åˆ†å­è°ƒæ§æœºåˆ¶ä¸ä»…å¯ä»¥ä¸ºé˜æ˜èŠèŠ±å¤æ‚çš„å¤´çŠ¶èŠ±åºå½¢æ€å¥ å®šåŸºç¡€ï¼Œä¹Ÿå°†ä¸ºèŠç§‘æ¤ç‰©å¤´çŠ¶èŠ±åºå‘è‚²æä¾›æ–°è§è§£ã€‚ä½†ç›®å‰å…³äºèŠèŠ±èŠ±å‹çš„ç ”ç©¶å—åˆ°å…¶å¤æ‚é—ä¼ èƒŒæ™¯çš„é™åˆ¶ï¼Œå¯¼è‡´æ— æ³•å……åˆ†åˆ©ç”¨èŠèŠ±ä¸°å¯Œçš„åŸºå› èµ„æºè¿›è¡ŒèŠ±å‹å®šå‘è‚²ç§ã€‚å› æ­¤ï¼Œè·å¾—é«˜è´¨é‡çš„èŠèŠ±åŠå…¶è¿‘ç¼˜ç§çš„åŸºå› ç»„ä¿¡æ¯å¹¶åœ¨æ­¤åŸºç¡€ä¸Š<font color="red">ç ”ç©¶<strong>å¤´çŠ¶èŠ±åºå‘è‚²</strong>çš„<strong>åˆ†å­è°ƒæ§æœºåˆ¶</strong></font>æ˜¾å¾—å°¤ä¸ºå¿…è¦ã€‚</p>
<p>è¿‘æ—¥ï¼Œ<em><strong>Horticulture Research</strong></em>åœ¨çº¿å‘è¡¨äº†<strong>åŒ—äº¬æ—ä¸šå¤§å­¦æˆ´æ€å…°å›¢é˜Ÿ</strong>é¢˜ä¸º<em><strong>The Chrysanthemum lavandulifolium genome and the molecular mechanism underlying diverse capitulum types</strong></em> çš„ç ”ç©¶è®ºæ–‡ã€‚è¯¥è®ºæ–‡å®Œæˆ<font color="red"><strong>èŠèŠ±è¿‘ç¼˜é‡ç”Ÿç§</strong>ä¹‹ä¸€<strong>ç”˜èŠ</strong></font>(C. lavandulifolium)çš„å…¨åŸºå› æµ‹åºå·¥ä½œï¼Œè·å¾—äº†æŸ“è‰²ä½“æ°´å¹³ä¸Šçš„é«˜è´¨é‡ç”˜èŠå‚è€ƒåŸºå› ç»„ï¼Œç»“åˆ<font color="red"><strong>3ç§ä¸åŒç±»å‹èŠç§‘æ¤ç‰©å¤´çŠ¶èŠ±åº</strong>çš„<strong>è½¬å½•ç»„æ•°æ®</strong></font>åˆæ­¥è§£æäº†å¤´çŠ¶èŠ±åºå‘è‚²çš„<strong>åˆ†å­è°ƒæ§æœºåˆ¶</strong>ï¼Œä¸ºå®ç°äººå·¥è°ƒæ§èŠèŠ±èŠ±å‹å¥ å®šäº†åšå®çš„åˆ†å­ç†è®ºåŸºç¡€ã€‚</p>
<p>ç”˜èŠä¸ºèŠå±æ¤ç‰©ä¸­çš„<strong>äºŒå€ä½“ç‰©ç§</strong>ï¼Œé‡‡ç”¨<strong>Illumina + Pacbio + Hi-C</strong>æµ‹åºæŠ€æœ¯å¯¹å…¶è¿›è¡Œå…¨åŸºå› æµ‹åºï¼Œè·å¾—äº†2.60 Gbçš„æŸ“è‰²ä½“æ°´å¹³çš„å‚è€ƒåŸºå› ç»„ã€‚å…¶ä¸­<font color="red">94.46%çš„åºåˆ—é”šå®šåˆ°<strong>9æ¡æŸ“è‰²ä½“</strong>ä¸Š</font>ã€‚ç”˜èŠåŸºå› ç»„ä¸­é‡å¤åºåˆ—å åŸºå› ç»„çš„67.69%ï¼Œ<em>Cypsy</em>å’Œ<em>Copia</em>çš„å æ¯”åˆ†åˆ«ä¸º37.92%å’Œ29.06%ï¼Œæ’å…¥æ—¶é—´åœ¨1.25ç™¾ä¸‡å¹´å‰ã€‚<font color="red"><strong>æ¯”è¾ƒåŸºå› ç»„åˆ†æ</strong></font>ç»“æœè¡¨æ˜ï¼Œç”˜èŠç»å†äº†<font color="red"><strong>ä¸¤æ¬¡å…¨åŸºå› ç»„å¤åˆ¶(WGD)äº‹ä»¶</strong></font>ï¼Œå…¶ä¸­<font color="red"><strong>æœ€è¿‘ä¸€æ¬¡</strong>æ˜¯æ‰€æœ‰<strong>èŠç§‘æ¤ç‰©å…±æœ‰</strong></font>ï¼Œè€Œ<font color="red"><strong>è¾ƒæ—©ä¸€æ¬¡</strong>æ˜¯æ ¸å¿ƒåŒå­å¶æ¤ç‰©å…±æœ‰çš„<strong>Î³äº‹ä»¶</strong></font>ï¼Œ**ç”˜èŠè‡ªèº«æ²¡æœ‰å‘ç”ŸWGDï¼Œå…¶åŸºå› ç»„æ¼”åŒ–çš„åŠ¨åŠ›æ¥æºä¸»è¦æ˜¯<font color="red">ä¸²è”é‡å¤äº‹ä»¶</font>**ã€‚</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/6.png" alt="overview and genome evolution"></p>
<p>åŸºäº<font color="blue">ç”˜èŠå¤´çŠ¶èŠ±åºå‘è‚²çš„6ä¸ªé‡è¦æ—¶æœŸ</font>å’Œ<font color="blue">å…¶ä»–èŠç§‘æ¤ç‰©ä¸åŒç±»å‹å¤´çŠ¶èŠ±åºå‘è‚²å…³é”®æ—¶æœŸ</font>çš„<font color="red">è½¬å½•ç»„</font>æœ‰å‚åˆ†æå‘ç°ï¼ŒMADS-boxã€TCPã€NACå’ŒLOBåŸºå› å®¶æ—<font color="red">å¯èƒ½å‚ä¸<strong>ç®¡çŠ¶èŠ±å’ŒèˆŒçŠ¶èŠ±çš„åˆ†åŒ–</strong></font>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<em>NAM</em>å’Œ<em>LOB30</em>é«˜è¡¨è¾¾äºèˆŒç®¡å…¼å¤‡å‹çš„å¤´çŠ¶èŠ±åºä¸­ï¼Œè€Œåœ¨å…¨èˆŒå‹å’Œå…¨ç®¡å‹çš„å¤´çŠ¶èŠ±åºä¸­è¡¨è¾¾é‡ç›¸å¯¹è¾ƒä½ï¼Œè¿™è¡¨æ˜å…¶å¯èƒ½æ˜¯å‚ä¸ä¸¤ç±»å°èŠ±åˆ†åŒ–çš„å…³é”®åŸºå› ã€‚ç»“åˆå…³é”®åŸºå› åœ¨å…¨èˆŒå‹ã€å…¨ç®¡å‹ä»¥åŠèˆŒç®¡å…¼å¤‡å‹çš„å¤´çŠ¶èŠ±åºä¸­çš„è¡¨è¾¾æ¨¡å¼å’Œè›‹ç™½äº’ä½œæ¨¡å¼ï¼Œåˆæ­¥æ¨æµ‹å¹¶æ„å»ºäº†ä¸åŒç±»å‹å¤´çŠ¶èŠ±åºå‘è‚²å¯èƒ½çš„è°ƒæ§æœºåˆ¶ã€‚åœ¨å…¨ç®¡å‹å¤´çŠ¶èŠ±åºä¸­ï¼Œ<em>CUC2</em>ä¸<em>LFY</em>å’Œ<em>AG</em><font color="red"><strong>å…±åŒè°ƒæ§</strong>ç®¡çŠ¶èŠ±åŸåŸºçš„èµ·å§‹</font>ã€‚è€ŒCUC2å’ŒCUC3çš„<font color="red"><strong>äº’ä½œåŠååŒè¡¨è¾¾</strong>åˆ™ä¼š<strong>ä¿ƒè¿›</strong>å…¨èˆŒå‹å¤´çŠ¶èŠ±åºä¸­èˆŒçŠ¶èŠ±åŸåŸºçš„èµ·å§‹</font>ã€‚åœ¨èˆŒç®¡å…¼å¤‡å‹çš„å¤´çŠ¶èŠ±åºä¸­ï¼Œ<em>NAM</em>å’Œ<em>LOB30</em>çš„è¡¨è¾¾åˆ™å‚ä¸<font color="red"><strong>è°ƒæ§</strong>èˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±åŸåŸºçš„åˆ†åŒ–</font>ã€‚LOB30å¯ä»¥ä¸LFY, TFL1, CUC2, CUC3å’ŒNAMäº’ä½œï¼Œè¡¨æ˜å…¶åœ¨åŸºå› è°ƒæ§ç½‘ç»œä¸­çš„æ ¸å¿ƒä½ç½®ã€‚æ€»ä¹‹ï¼Œ<em>NAM</em>å’Œ<em>LOB</em>ä¸ä»…å¯ä»¥ä¸èŠ±åºåˆ†ç”Ÿç»„ç»‡ç›¸å…³åŸºå› å¦‚<em>LFY</em> ç­‰äº’ä½œï¼Œä¹Ÿå¯ä»¥ä¸ä¸¤ç±»å°èŠ±èº«ä»½å†³å®šåŸºå› å¦‚<em>CYC2</em>-<em>LIKE</em>ç­‰åŸºå› äº’ä½œï¼Œè¿™è¡¨æ˜<em><strong>NAM</strong></em><strong>å’ŒLOB30åœ¨å¤´çŠ¶èŠ±åºä¸ŠèˆŒçŠ¶èŠ±å’Œç®¡çŠ¶èŠ±åŸåŸºåˆ†åŒ–è°ƒæ§ä¸­çš„å…³é”®è§’è‰²</strong>ã€‚</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/7.png" alt="The expression patterns of NAM/CUC and LOB30 homologous genes in ten asteraceae species"></p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/8.png" alt="the probable gene regulation mechanism in the development of different capitula types"></p>
<p><strong>é«˜è´¨é‡ç”˜èŠå‚è€ƒåŸºå› ç»„çš„è·å¾—ä¸ä»…å¯ä»¥ä¸ºæ ½åŸ¹èŠèŠ±åŸºå› ç»„çš„ç ´è¯‘æä¾›æœ‰æ•ˆçš„å‚è€ƒï¼Œæ›´ä¸ºè§£æèŠèŠ±ä¹ƒè‡³èŠç§‘æ¤ç‰©å¤šæ ·çš„ç”Ÿç‰©å­¦æ€§çŠ¶æä¾›ä¸°å¯Œçš„åŸºå› èµ„æºã€‚</strong></p>
<p>åŒ—äº¬æ—ä¸šå¤§å­¦æˆ´æ€å…°è¯¾é¢˜ç»„ä¸€ç›´è‡´åŠ›äºèŠèŠ±ç ”ç©¶ï¼ŒåŸºäº<font color="blue">æ¤ç‰©ç³»ç»Ÿå­¦ç ”ç©¶æ–¹æ³•</font>å¯¹<font color="blue">èŠå±æ¤ç‰©ç§é—´<strong>äº²ç¼˜å…³ç³»</strong>å’ŒèŠèŠ±<strong>å“ç§èµ·æº</strong></font>è¿›è¡Œæ¢ç´¢ï¼Œåœ¨<font color="red"><strong>ç§è´¨èµ„æºè¯„ä»·ï¼ŒèŠ±è‰²ã€èŠ±å‹ã€å¼€èŠ±æœŸ</strong>å’Œ<strong>æŠ—é€†æ€§</strong>ç­‰è§‚èµæ€§çŠ¶å½¢æˆçš„<strong>åˆ†å­æœºç†</strong></font>ï¼ŒèŠèŠ±<font color="blue">ä¼˜å¼‚ç§è´¨åˆ›åˆ¶</font>ä»¥åŠ<font color="blue">äº§ä¸šåŒ–æ ½åŸ¹æŠ€æœ¯</font>ç­‰å¼€å±•å…¨é¢ç ”ç©¶ï¼Œå–å¾—äº†ä¸€ç³»åˆ—é‡è¦çªç ´æ€§è¿›å±•å’Œç ”ç©¶æˆæœã€‚</p>
<p>2.6Gï¼šscaffold Num 178ï¼›scaN50 300Mï¼›N90 212Mï¼›Longest 322M</p>
<h2 id="Genome-assembly-and-quality-assessment"><a href="#Genome-assembly-and-quality-assessment" class="headerlink" title="Genome assembly and quality assessment"></a><strong>Genome assembly and quality assessment</strong></h2><p>For the <font color="blue">PacBio RSII</font> platform data, <font color="blue">longer subreads were <strong>selected</strong></font> by the <font color="blue">error correction module</font> of <font color="red"><strong>canu v1.5</strong></font> [35]. <font color="blue">Raw overlapping subreads were <strong>detected</strong></font> through the highly sensitive overlap detection program <font color="red"><strong>MHAP v2.1</strong></font> [36], and the <font color="blue">error correction of these data was <strong>carried</strong></font> out by the <font color="red"><strong>Falcon</strong></font> sense method v0.40 (â€œcorrect- edErrorRate = 0.025â€) [37]. The error-corrected subreads were used to <font color="blue">generate a <strong>draft assembly</strong></font> in <font color="red"><strong>WTDBG v2.5</strong></font> (<a href="https://github.com/ruanjue/wtdbg">https://github.com/ruanjue/wtdbg</a>). <font color="blue"><strong>Iterative polishing</strong></font> by <font color="red"><strong>Pilon v1.22</strong></font> [38] was achieved by <font color="blue"><strong>aligning</strong></font> adapter-trimmed and paired-end <font color="blue">Illumina <strong>reads</strong> to the <strong>PacBio draft genome</strong></font>. <font color="red"><strong>Clean nanopore data</strong></font> were acquired via sequencing on the PromethION platform, and these data were <font color="blue">corrected with the same method</font> described above. The draft genome assembled by <font color="red"><strong>WTDBG v2.5</strong></font> (https:// github.com/ruanjue/wtdbg) was <font color="blue"><strong>corrected</strong> three times</font> by <font color="red"><strong>Racon v1.3.3</strong></font> [39] by aligning adapter-trimmed and paired-end Illumina reads to the <font color="blue"><strong>Nanopore draft genome</strong></font>. Then, the <font color="blue">PacBio draft genome as a <strong>query input</strong></font> was <font color="blue"><strong>aligned against</strong> the <strong>Nanopore draft genome</strong></font> using <font color="red"><strong>MUMmer v4.0.0</strong></font> [40]. The PacBio draft genome and Nanopore <font color="blue"><strong>draft genome</strong></font> were then <font color="blue"><strong>merged</strong></font> using <font color="red"><strong>quickmerge v0.3.0</strong></font> [21]. This <font color="blue"><strong>merged draft genome</strong></font> was <font color="blue"><strong>polished</strong></font> by <font color="red"><strong>Racon v1.3.3</strong></font> [39] and <font color="red"><strong>Pilon v1.22</strong></font> [38]. The <font color="blue">mapping depth</font> was obtained by <font color="blue"><strong>aligning</strong> corrected Nanopore sequencing data</font> to the merged assembly by <font color="red"><strong>minimap2 v2.17</strong></font> [41] with default parameters. Then, <font color="red"><strong>purge haplotigs v1.0.4</strong></font> [22] was used to <font color="blue"><strong>eliminate</strong> redundancy according to the <strong>coverage depth</strong></font> and obtain the <font color="blue"><strong>purged haplotig genome</strong></font>. Ultimately, a <em>C. lavandulifolium</em> genome with a total length of <strong>3.10 G</strong>b was obtained. The second-generation sequencing data, core gene completeness and BUSCOs were evaluated to verify the accuracy of the genome assembly.</p>
<h2 id="Hi-C-sequencing-and-assistant-assembly"><a href="#Hi-C-sequencing-and-assistant-assembly" class="headerlink" title="Hi-C sequencing and assistant assembly"></a><strong>Hi-C sequencing and assistant assembly</strong></h2><p>Hi-C is a technology derived from chromosome conformation capture technology that utilizes high- throughput sequencing data and is mainly used to assist in genome assembly. We constructed Hi-C fragment libraries with insert sizes of 300â€“700 bp, as illustrated in Rao et al. [42], and sequenced them using the Illumina platform [42]. <font color="blue"><strong>Before</strong> <strong>chromosome assembly</strong>, we first performed a <strong>preassembly</strong> for the <strong>error correction of scaffolds</strong>, which required <strong>splitting the scaffolds into segments of 50 kb</strong>, on average</font>. Then, the Hi-C data were <font color="blue">mapped</font> to these segments using <font color="red"><strong>BWA</strong></font> aligner v0.7.10-r789 [43]. We <font color="red"><strong>retained</strong> the <strong>uniquely mapped</strong> data</font> to assemble the genome using <font color="red"><strong>LACHESIS</strong></font> [44] with the following <font color="green"><strong>parameters</strong>: CLUSTER_MIN_RE_SITES = 80; CLUSTER_MAX_LINK_DENSITY = 2; CLUSTER_NONINFORMATIVE_RATIO = 2; ORDER_MIN_N_RES_IN_TRUN = 16; ORDER_MIN_N_RES_IN_SHREDS = 16</font>. To further address the redundant sequences, we manually checked any two segments that showed inconsistent connections with the raw scaffold. The detailed workflow schema for the assembly pipeline of the chromosome-scale <em>C. lavandulifolium</em> genome is shown in Supplementary Figure 24.</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/9.png" alt="9"></p>
<h1 id="11-2022-01-HorticRes-ç²‰è‘›"><a href="#11-2022-01-HorticRes-ç²‰è‘›" class="headerlink" title="11. 2022.01-HorticRes ç²‰è‘›"></a>11. 2022.01-HorticRes ç²‰è‘›</h1><p><em><strong>Chromosomal-level genome and multi-omics dataset of Pueraria lobata var. thomsonii provide new insights into legume family and the isoflavone and puerarin biosynthesis pathways</strong></em> </p>
<p>ç²‰è‘›åŸºå› ç»„åŠå¤šç»„å­¦åˆ†æä¸º<font color="red">è‘›æ ¹ç´ </font>ç­‰åŠŸæ•ˆæˆåˆ†çš„ç”Ÿç‰©åˆæˆç ”ç©¶æä¾›æ–°è§è§£</p>
<p>å¹¿è¥¿å£®æ—è‡ªæ²»åŒºå†œä¸šç§‘å­¦é™¢ç»æµä½œç‰©ç ”ç©¶æ‰€ä¸¥åå…µå›¢é˜Ÿã€‚è¯¥ç ”ç©¶åˆ©ç”¨<strong>PacBio</strong>ã€<strong>Illumina</strong>æµ‹åºä»¥åŠ<strong>Hi-C</strong>æŠ€æœ¯æµ‹åºç»„è£…ï¼Œ<strong>è·å¾—äº†é¦–ä¸ª<font color="red">è±†ç§‘è‘›å±è¯é£ŸåŒæºæ¤ç‰©ç²‰è‘›</font>æŸ“è‰²ä½“çº§åˆ«çš„åŸºå› ç»„</strong>ï¼Œæ ‡å¿—ç€ç²‰è‘›ç ”ç©¶è¿ˆå…¥åŸºå› ç»„æ—¶ä»£ï¼Œå¼€å¯äº†<font color="blue">è‘›å±<strong>è¿›åŒ–</strong>ã€é‡è‘›<strong>é©¯åŒ–</strong>ã€ç²‰è‘›<strong>å“ç§æ”¹è‰¯</strong></font>ä¹‹æ—…ï¼ŒåŠ©åŠ›å¹¿è¥¿ç‰¹è‰²ä¼˜åŠ¿ç²‰è‘›äº§ä¸šé«˜è´¨é‡å‘å±•ã€‚</p>
<p>é‰´äºç²‰è‘›<font color="blue">æ‚åˆåº¦è¾ƒé«˜</font>ï¼Œç ”ç©¶è€…é€‰ç”¨äº†PacBioå’ŒHi-Cæµ‹åºï¼Œæ„å»ºçš„ç²‰è‘›åŸºå› ç»„å¤§å°ä¸º<strong>1.38Gb</strong>ï¼Œ<font color="blue">Contig N50=598kb</font>ï¼Œå¹¶å°†<font color="blue">99.3%çš„åºåˆ—<strong>é”šå®š</strong>åˆ°11æ¡æŸ“è‰²ä½“ä¸Š</font>ï¼ŒBUSCOè¯„ä¼°<font color="blue">92.9%</font>ã€‚é€šè¿‡æ³¨é‡Šï¼Œå…±è·å¾—45270ä¸ªè›‹ç™½ç¼–ç åŸºå› ï¼Œå…¶ä¸­<font color="blue"><strong>94.4%çš„åŸºå› </strong>å¯ä»¥å¾—åˆ°<strong>åŠŸèƒ½æ³¨é‡Š</strong></font>ï¼ŒåŸºå› ç»„ä¸­<font color="blue">é‡å¤åºåˆ—</font>å æ¯”ä¸º62.7%ã€‚å°†ç²‰è‘›<font color="red">ä¸<strong>16ä¸ªè¿‘ç¼˜ç‰©ç§</strong>(åŒ…å«5ä¸ªè±†ç§‘æ¤ç‰©)è¿›è¡Œ<strong>æ¯”è¾ƒåŸºå› ç»„</strong>åˆ†æ</font>ï¼Œç»“æœè¡¨æ˜6ä¸ªè±†ç§‘æ¤ç‰©å…±æœ‰åŸºå› å®¶æ—ä¸º11204ä¸ªï¼Œç²‰è‘›åŸºå› ç»„ä¸­<font color="blue"><strong>æ˜¾è‘—æ‰©å¼ çš„4743ä¸ªåŸºå› å®¶æ—</strong>ä¸»è¦å¯Œé›†åœ¨ä¸<strong>ç±»é»„é…®ã€ç”Ÿç‰©ç¢±ã€ç”¾é†‡å’Œèœç±»</strong>ç­‰ç”Ÿç‰©åˆæˆç›¸å…³çš„é€šè·¯</font>ï¼›ç²‰è‘›<font color="red"><strong>ç‰¹æœ‰</strong>åŸºå› å®¶æ—</font>ä¸º2373ä¸ªï¼Œä¸»è¦<font color="blue">å¯Œé›†åœ¨ä¸<strong>èœç±»</strong>ç”Ÿç‰©åˆæˆç›¸å…³çš„é€šè·¯</font>ï¼›ç²‰è‘›åŸºå› ç»„ä¸­å—åˆ°<font color="blue"><strong>æ˜¾è‘—æ­£é€‰æ‹©</strong>çš„åŸºå› </font>å…±æœ‰34ä¸ªï¼Œå¯Œé›†åœ¨<font color="blue"><strong>æ˜¼å¤œèŠ‚å¾‹ã€åŒæºé‡ç»„ã€æ·€ç²‰ä»£è°¢å’Œè”—ç³–ä»£è°¢</strong></font>ç­‰é€”å¾„ã€‚</p>
<p><font color="red"><strong>ç³»ç»Ÿè¿›åŒ–åˆ†æ</strong></font>è¡¨æ˜ï¼Œç²‰è‘›<strong>ä¸å¤§è±†äº²ç¼˜å…³ç³»æœ€è¿‘</strong>ï¼Œä¸¤è€…åœ¨20.1ä¸ªç™¾ä¸‡å¹´å‰äº§ç”Ÿåˆ†åŒ–ã€‚é€šè¿‡<font color="red"><strong>Ks</strong>å’Œ<strong>4DTVåˆ†æ</strong></font>ï¼Œ<strong>ç²‰è‘›å…±ç»å†ä¸¤æ¬¡WGDäº‹ä»¶</strong>ï¼Œä¸€æ¬¡WGDäº‹ä»¶æ˜¯<font color="blue">å¤§è±†ä¸ç²‰è‘›<strong>å…±æœ‰</strong></font>ï¼Œå‘ç”Ÿåœ¨44.5ä¸ªç™¾ä¸‡å¹´å‰ï¼›å¦ä¸€æ¬¡WGDäº‹ä»¶æ˜¯åœ¨ç²‰è‘›ä¸å¤§è±†åˆ†åŒ–åï¼Œ<font color="blue">ç²‰è‘›<strong>ç‹¬è‡ª</strong>ç»å†</font>ï¼Œå‘ç”Ÿæ—¶é—´å¤§è‡´åœ¨4.8ä¸ªç™¾ä¸‡å¹´å‰ã€‚</p>
<p>é€šè¿‡å¯¹é«˜è‘›æ ¹ç´ ZG-19å’Œä½è‘›æ ¹ç´ ZG-39è¿›è¡Œ<font color="red"><strong>è½¬å½•ç»„</strong>å’Œ<strong>ä»£è°¢ç»„</strong>åˆ†æ</font>ï¼Œç ”ç©¶è€…æ£€æµ‹åˆ°äº†614ç§225ç§å·®å¼‚ä»£è°¢ç‰©(DMs)ï¼Œ1814ä¸ªå·®å¼‚è¡¨è¾¾åŸºå› (DEG)ï¼ŒDMså’ŒDEGçš„ä¸°å¯ŒåŠŸèƒ½ç±»åˆ«<strong>é‡å </strong>ï¼Œè¿™è¯´æ˜å®ƒä»¬éƒ½æ˜¯ä¸<font color="blue">ç±»é»„é…®ã€å¼‚é»„é…®å’ŒABCè½¬è¿ç›¸å…³çš„åŸºå› æˆ–ä»£è°¢ç‰©</font>ã€‚è¿›ä¸€æ­¥åˆ†æä»£è°¢ç‰©ä¸åŸºå› è¡¨è¾¾çš„ç›¸å…³ç³»æ•°ï¼Œç»“æœè¡¨æ˜ä»£è°¢ç‰©å’ŒåŸºå› å¯¹åœ¨æ ·æœ¬ä¸­é«˜åº¦ç›¸å…³ï¼Œ60%çš„æ˜¾è‘—ç›¸å…³æ€§æ¶‰åŠä¸Šè°ƒçš„ä»£è°¢ç‰©å’Œä¸‹è°ƒæˆ–ä¸å˜çš„åŸºå› ï¼Œåœ¨15%çš„æ˜¾è‘—ç›¸å…³æ€§ä¸­ï¼Œä»£è°¢ç‰©å’ŒåŸºå› è¡¨è¾¾çš„å˜åŒ–æ–¹å‘ç›¸åŒã€‚æ­¤å¤–ï¼Œç ”ç©¶è€…åœ¨å¼‚é»„é…®ç”Ÿç‰©åˆæˆé€”å¾„ä¸­å‘ç°äº†å¤§é‡çš„DMså’ŒDEGã€‚<strong>è¿™å……åˆ†è§£æäº†ç²‰è‘›ä¸­å¼‚é»„é…®çš„ç”Ÿç‰©åˆæˆé€”å¾„ã€‚</strong></p>
<p>é€šè¿‡<font color="red"><strong>åŒæºåŸºå› æœç´¢</strong></font>ï¼Œç ”ç©¶è€…å‘ç°<font color="blue">ç¼–ç <strong>è‘›æ ¹ç´ åˆæˆé€”å¾„</strong>ä¸­å…³é”®é…¶çš„9ä¸ªåŸºå› å®¶æ—</font>åœ¨ç²‰è‘›ä¸­éƒ½æœ‰æ‰€<font color="blue">æ‰©å¼ </font>ï¼›é€šè¿‡åˆ†æç³–åŸºè½¬ç§»é…¶å®¶æ—ä¸­å‚¬åŒ–ç³–åŸºåŒ–ä¿®é¥°çš„åŸºå› ï¼Œå…±é‰´å®šå‡º104ä¸ªGTåŸºå› ï¼Œæœ‰13ä¸ªåŸºå› ä¸8-C-è‘¡è„ç³–åŸºè½¬ç§»é…¶(8-C-GT)åŒæºï¼Œå…¶ä¸­6ä¸ªä¸å…ˆå‰ç ”ç©¶çš„å‚¬åŒ–å¤§è±†è‹·å…ƒC-ç³–åŸºåŒ–ä¸ºè‘›æ ¹ç´ çš„PIUGT43åŸºå› åŒæºï¼›ç¼–ç å¤§è±†å¼‚é»„é…®åˆé…¶(IFS)çš„åŸºå› (CHR11G3854.1)å‚¬åŒ–ç€è‘›æ ¹ç´ åˆæˆçš„ä¸­é—´ä»£è°¢ç‰©å¤§è±†è‹·å…ƒçš„åˆæˆï¼Œè¢«é‰´å®šä¸ºä¸è‘›æ ¹ç´ çš„åˆæˆé€”å¾„é«˜åº¦ç›¸å…³ã€‚æ€»ä¹‹ï¼Œä¸Šè¿°åˆ†æ<strong>åˆæ­¥è§£æäº†ç²‰è‘›ä¸­è‘›æ ¹ç´ çš„ç”Ÿç‰©åˆæˆé€”å¾„ã€‚</strong></p>
<p><strong>ç»¼ä¸Šï¼Œè¯¥ç ”ç©¶é€šè¿‡æ„å»ºé«˜è´¨é‡çš„ç²‰è‘›åŸºå› ç»„è§£æäº†ç²‰è‘›åŸºå› ç»„çš„<font color="red">è¿›åŒ–ç‰¹å¾</font>ï¼›é€šè¿‡å¤šç»„å­¦åˆ†ææ·±å…¥è§£æäº†ç²‰è‘›ä¸­<font color="red">é‡è¦æ¬¡ç”Ÿä»£è°¢ç‰©å¼‚é»„é…®ã€è‘›æ ¹ç´ ç­‰ç”Ÿç‰©åˆæˆé€”å¾„</font>ï¼Œä»è€Œä¸ºç²‰è‘›çš„èµ„æºåˆ©ç”¨ã€é—ä¼ è‚²ç§ç­‰ç ”ç©¶æä¾›äº†æ–°è§è§£ã€‚</strong></p>
<p><strong>ä¸¥åå…µç ”ç©¶å‘˜å›¢é˜Ÿåœ¨è‘›æ ¹ä¸Šçš„ç ”ç©¶è¿›å±•ï¼š</strong></p>
<p><strong>ä¸¥åå…µ</strong>å›¢é˜Ÿè¿‘å¹´<strong>åœ¨å…¨çƒè‘›æ ¹èµ„æºæ”¶é›†ä¸é‰´å®šè¯„ä»·ã€è‘›å±èµ„æºåˆ†ç±»ã€è‘›æ ¹<font color="red">åŸºå› ç»„ä¸åˆ†å­ç”Ÿç‰©å­¦</font>ã€ç²‰è‘›å’Œé‡è‘›å“ç§é€‰è‚²ã€å¥åº·ç§è‹—ç”Ÿäº§ã€é«˜äº§é«˜æ•ˆæ ½åŸ¹ç­‰æ–¹é¢å–å¾—äº†ä¸€ç³»åˆ—çš„æˆæœ</strong>ã€‚å›¢é˜Ÿç›®å‰å¹¿æ³›æ”¶é›†å…¨çƒè‘›å±ç§è´¨èµ„æº419ä»½ï¼ŒåŒ…æ‹¬é‡è‘›ã€ç²‰è‘›ã€è‘›éº»å§†ã€å¤§èŠ±è‘›ã€æ³°è‘›ã€è‹¦è‘›ã€çº¢è‘›ã€é¡»å¼¥è‘›ã€é£Ÿç”¨è‘›ç­‰ï¼›é€šè¿‡å¼€å‘<strong>è‘›SSRåˆ†å­æ ‡è®°</strong>ï¼Œæ„å»ºäº†å¹¿è¥¿è‘›æ ¸å¿ƒç§è´¨åº“ï¼›é€šè¿‡<strong>å¹¿æ³›é¶å‘ä»£è°¢ç»„</strong>è§£æè‘›å±è‘›ç§é‡è‘›ã€ç²‰è‘›å’Œè‘›éº»å§†ç­‰3ä¸ªå˜ç§å—æ ¹ä¸­å½±å“<strong>é£Ÿç”¨å“è´¨å’Œè¯ç”¨å“è´¨</strong>çš„<strong>ä»£è°¢å·®å¼‚</strong>ï¼›ç»“åˆè¡¨å‹é‰´å®šé€šè¿‡å¶ç»¿ä½“åŸºå› ç»„ç ”ç©¶ï¼Œæ­ç¤ºäº†è‘›åŠå…¶<strong>è¿‘ç¼˜ç§ä¹‹é—´çš„ç³»ç»Ÿå‘è‚²å…³ç³»</strong>ï¼›æŒ–æ˜äº†è°ƒæ§<strong>è‘›æ ¹ç´ åˆæˆä»£è°¢ç›¸å…³çš„ç»“æ„åŸºå› å’Œè½¬å½•å› å­</strong>ï¼Œå¹¶æ­£åœ¨å¼€å±•ç›¸å…³åŸºå› åŠŸèƒ½éªŒè¯å·¥ä½œï¼›é€‰è‚²å‡ºé€‚åˆå¼€å‘è‘›èŠ±èŒ¶ã€é«˜è‘›æ ¹ç´ ç²‰è‘›ã€æ— æ¸£ç²‰è‘›ã€è¯ç”¨é‡è‘›ç­‰ç³»åˆ—è‘›æ ¹æ–°å“ç§ï¼Œå¹¶é€æ­¥å»ºç«‹é…å¥—ç§è‹—ç¹è‚²å’Œé«˜æ•ˆæ ½åŸ¹æŠ€æœ¯ã€‚</p>
<p>1.37Gï¼šcontig Num 5145ï¼›conN50 593kbï¼›</p>
<h2 id="Genome-survey"><a href="#Genome-survey" class="headerlink" title="Genome survey"></a>Genome survey</h2><p>Short reads produced by the Illumina 6000 platform were <font color="blue">quality-filtered</font> by <font color="red"><strong>HTQC</strong></font> [23] (version v1.92.310) using the following method. Adaptors were firstly removed from the sequencing reads, and read pairs with any one end having an average quality &lt;20 were discarded. Ends of reads were trimmed if average quality was &lt;20 in the sliding window size of 5 bp, and read pairs with <font color="red">any end <strong>shorter than 75 bp</strong> were removed</font>. The quality-filtered reads were used for estimation of genome size. The <strong>17-mer</strong> occurrence distribution of sequencing reads was generated from short libraries with <font color="red"><strong>Jellyfish</strong></font> [24] (v2).</p>
<h2 id="Genome-assembly"><a href="#Genome-assembly" class="headerlink" title="Genome assembly"></a>Genome assembly</h2><p>Subreads generated with the above long-read third-generation sequencing were used for genome assembly of <em>P. lobata</em>. The draft assembly of the genome was made using <font color="red"><strong>Falcon (v0.3.0)</strong></font> [25]. To <font color="blue"><strong>correct</strong> errors</font> in the primary assembly, <font color="red"><strong>Racon</strong></font> (v1.44) tools were used to <font color="blue"><strong>polish</strong></font> the genome [26]. <font color="blue">Illumina-derived <strong>short reads</strong></font> were used to <font color="blue"><strong>correct</strong></font> any <font color="blue"><strong>remaining errors</strong></font> by <font color="red"><strong>NextPolish (v1.1.0)</strong></font> [27].</p>
<p><font color="blue">To scaffold the contigs</font>, 425 011 698 clean-read pairs were sequenced from the Hi-C library. <font color="red"><strong>Fastp</strong></font> (0.19.5) [28] was used to filter Hi-C data, including <font color="blue"><strong>removing adaptors</strong> and l<strong>ow-quality</strong> reads</font>. <font color="red"><strong>HiC-Pro</strong></font> Proto was used to obtain effective reads [29]. After filtering, <font color="blue">6%ã€?ã€‘ of high-quality and effective Hi-C data was retained</font>. The <font color="blue">resulting <strong>effective reads</strong></font> were <strong>mapped</strong> to the <strong>assembled and polished</strong> <em>P. thomsonii</em> <strong>genome</strong> using <font color="red"><strong>BWA</strong></font> (bwa-0.7.17) [30] with default parameters. <font color="red"><strong>ALL-HiC</strong></font> software was used to <font color="blue"><strong>anchor</strong> scaffolds to chromosomes</font> to obtain the chromosome-level <em>P. thomsonii</em> assembly.</p>
<h1 id="12-2022-03-ng-å››å€ä½“åœŸè±†"><a href="#12-2022-03-ng-å››å€ä½“åœŸè±†" class="headerlink" title="12. 2022.03-ng å››å€ä½“åœŸè±†"></a>12. 2022.03-ng å››å€ä½“åœŸè±†</h1><blockquote>
<p>Chromosome-scale and haplotype-resolved genome assembly of a tetraploid potato cultivar</p>
</blockquote>
<p>##<strong>Genome size estimation.</strong> </p>
<p>After <strong>trimming</strong> off 10Ã— genomics <font color="blue"><strong>barcodes and hexamers</strong></font> from the 370.3-Gb reads combined from the 10Ã— single-cell CNV libraries and single-molecule libraries, <em>k</em>-mer counting (<em>k</em> = 21) was performed with <font color="red"><strong>Jellyfish</strong></font> (v.2.2.10). The <em>k</em>-mer histogram was provided to <font color="red"><strong>findGSE</strong></font> (v.1.0)39 to estimate the haploid/tetraploid genome size of â€˜Otavaâ€™ under the <font color="blue">heterozygous mode</font> (with â€˜exp_hom = 200â€™; Extended Data Fig. 1).</p>
<p>##<strong>Initial tetraploid genome assembly, polishing and purging.</strong> </p>
<p>The initial assembly of the tetraploid genome was performed using <font color="red"><strong>hifiasm (v.0.7)</strong></font> with <strong>default settings</strong> with the 102 Gb raw PacBio HiFi reads of â€˜Otavaâ€™, where the output consisting of <font color="red"><strong>unitigs</strong> (locally haplotype-resolved contigs)</font> was selected for <strong>further processing</strong>. </p>
<p>Then the <font color="blue">short reads</font> from the two 10Ã— single-cell CNV libraries were <font color="blue"><strong>aligned</strong> to the assembly</font> using <font color="red"><strong>bowtie2 (v.2.2.8)</strong></font>. These <font color="blue">alignments were used to <strong>polish</strong> the <strong>assembly</strong></font> with <font color="red"><strong>pilon (v.1.22)</strong></font> with <font color="green"><strong>options</strong> of <strong>â€“fixbases â€“changes â€“diploid â€“mindepth 0.8</strong></font>. </p>
<p>Further, <font color="blue"><strong>short</strong> reads</font> of the two 10Ã— single-cell CNV libraries, additional 10Ã— single-molecule libraries <strong>and</strong> PacBio <font color="blue"><strong>HiFi</strong> reads</font> were <font color="blue"><strong>all aligned</strong> to the <strong>polished assembly</strong></font> (using <font color="red"><strong>bowtie2</strong></font> and <font color="red"><strong>minimap2</strong></font> (v.2.17-r491) respectively). Among <font color="blue">17,153 raw contigs, <strong>9,041 contigs</strong></font> which were <font color="blue">longer than <strong>50 kb</strong></font> and with an <font color="blue">average sequencing depth over <strong>80Ã—</strong> were <strong>kept</strong></font>. </p>
<p><font color="blue">HiFi reads were <strong>re-aligned</strong> to the purged assembly and contigs covered less than 3Ã— were <strong>removed</strong></font>. </p>
<p>The HiFi reads-based <font color="red"><strong>purging process</strong></font> was repeated for <font color="blue"><strong>five rounds</strong></font> to get an initial assembly of <font color="blue">6,366 contigs</font> for subsequent analysis (Supplementary Fig. 1).</p>
<p>##<strong>Haplotype-specific PacBio HiFi read separation and haplotype assembly.</strong></p>
<p>HiFi reads were <font color="blue">classified into 48 groups</font> on the basis of alignments to the 50-kb coverage markers using customized code. Specifically, to assign a read to a marker, at least 500 bp of the read had to be aligned to the marker (reads aligning two neighboring markers were assigned to the marker with a larger overlapping size). Reads overlapping non-haplotig marker were randomly assigned to one of the marker-associated groups.</p>
<p><font color="red"><strong>Each set</strong> of HiFi reads</font> was independently assembled using <font color="red"><strong>hifiasm</strong></font> (v.0.7) with default settings. The resulting contigs were first polished with <font color="red">short reads using <strong>pilon</strong></font> with <font color="green"><strong>â€“fix bases â€“changes â€“diploid â€“mindepth 0.8</strong></font> and then with <font color="red">HiFi reads using <strong>racon</strong></font> (v.1.4.10)46 with<font color="green"> <strong>-u â€“no-trimming</strong></font>.</p>
<p>##<strong>Evaluation of haplotyping accuracy.</strong> </p>
<p>For <font color="blue">each haplotype assembly</font> and the sequencing data of the parental genomes, <em>k</em>-mers (<em>k</em> = 21) were counted using <font color="red"><strong>KMC</strong></font>. Specifically, <em>k</em>-mers found in â€˜Heraâ€™ but not in â€˜Stieglitzâ€™ (with a coverage<br>of 6â€“12), as well as <em>k</em>-mers found in â€˜Stieglitzâ€™ but not in â€˜Heraâ€™ (with a coverage of 5â€“11) were selected using kmc_tools simple. For each haplotype, the sets of assembled <em>k</em>-mers were intersected with the two sets of parental-specific <em>k</em>-mers (using kmc_tools simple with subfunction intersect), which revealed <strong><em>k</em>-mers common with either of the parental genomes</strong>. </p>
<p>As a haplotype can only be inherited from one of the parents, it is expected to find parental-specific *k-*mers only of one parent. The overall haplotyping precision was determined as the total number of correctly phased <em>k</em>-mers divided by the total number of <em>k</em>-mers investigated in the <font color="red"><strong>48 haplotype assemblies</strong></font>. Note, this was done <font color="rblueed">before and after contig <strong>polishing</strong></font>, where we observed the same haplotyping accuracy.</p>
<p>##<strong>Haplotype-specific contig scaffolding using group-specific Hi-C reads.</strong> </p>
<p><font color="blue">Each haplotype-specific contig-level assembly</font> was indexed with <font color="red"><strong>bwa index</strong></font> (with -a bwtsw) (v.0.7.15-r1140) and <font color="red"><strong>samtools faidx</strong></font>. The haplotype-specific Hi-C read pairs were aligned using <font color="red"><strong>bwa aln</strong> and <strong>bwa sampe</strong></font>. Aligned reads (in pairs) were <strong>converted into BAM</strong> files using samtools view with options of <font color="green">-b -F12</font>. The BAM files were filtered with <font color="red"><strong>filterBAM_forHiC.pl</strong></font> (from ALLHiC package, v.0.9.13) to <font color="blue"><strong>remove nonuniquely mapped reads</strong></font>. Then BAM files were converted to bed files using <font color="red"><strong>bamToBed</strong></font> (from bedtools package) and <font color="blue"><strong>sorted</strong> by read name</font>. The <strong>bed files</strong> were provided to <font color="red"><em><strong>SALSA2</strong></em></font> (run with <font color="green">-s 100000000 -m yes -i 10 -e DNASE</font>). Potential chimeric contigs were broken at the chimeric sites given by SALSA2 output file of input_breaks, leading to a <font color="blue"><strong>new set</strong> of contigs for each of the 48 original groups</font>.</p>
<p>For <font color="blue">each new group of contigs</font>, the above process of <font color="red"><strong>contig indexing, Hi-C read alignment</strong> and <strong>BAM filtering</strong></font> was repeated. Then, for each haplotype, <font color="red"><strong>ALLHiC_ partition</strong></font> was run with <font color="green">-e GATC -k 1 -m 25</font>; <font color="red"><strong>allhic extract</strong></font> was run with <font color="green">â€“RE GATC</font>; allhic optimize and <font color="red"><strong>ALLHiC_build</strong></font> were run with <font color="green">default settings</font>; the chromosome contact map was visualized with <font color="red"><strong>ALLHiC_plot</strong></font> at <font color="green">1-Mb</font> resolution, where obvious mis-placement/orientation of large contigs were visually identified and manually corrected (Extended Data Fig. 3).</p>
<h1 id="13-2022-03-ng-å…­å€ä½“å°éº¦"><a href="#13-2022-03-ng-å…­å€ä½“å°éº¦" class="headerlink" title="13. 2022.03-ng å…­å€ä½“å°éº¦"></a>13. 2022.03-ng å…­å€ä½“å°éº¦</h1><blockquote>
<p>Long-read genome sequencing of bread wheat facilitates disease resistance gene cloning</p>
</blockquote>
<table>
<thead>
<tr>
<th>Genomic feature</th>
<th>Value</th>
</tr>
</thead>
<tbody><tr>
<td><em><strong>Length of HiFi assembly</strong></em></td>
<td>14.66 Gb</td>
</tr>
<tr>
<td>Number of contigs</td>
<td>5,055</td>
</tr>
<tr>
<td>Length of contig N50</td>
<td>30.22 Mb</td>
</tr>
<tr>
<td>Length of contig N90</td>
<td>5.5 Mb</td>
</tr>
<tr>
<td><strong><em>Length of hybrid assembly</em>a</strong></td>
<td>14.68 Gb</td>
</tr>
<tr>
<td><em><strong>Length of hybrid scaffolds</strong></em></td>
<td>14.46 Gb</td>
</tr>
<tr>
<td>Number of hybrid scaffolds</td>
<td>324</td>
</tr>
<tr>
<td>Length of hybrid scaffold N50</td>
<td>204.26 Mb</td>
</tr>
<tr>
<td>Gap size</td>
<td>18.8 Mb (0.13%)</td>
</tr>
<tr>
<td><em><strong>Length of pseudomolecule assembly</strong></em></td>
<td>14.68 Gb</td>
</tr>
<tr>
<td><em><strong>Total length of anchored pseudomolecules</strong></em></td>
<td>14.45 Gb</td>
</tr>
<tr>
<td>Number of anchored hybrid scaffolds or contigs</td>
<td>717</td>
</tr>
<tr>
<td>Gap size</td>
<td>11.6 Mb (0.08%)</td>
</tr>
<tr>
<td>Number of high-confidence genes</td>
<td>110,383</td>
</tr>
<tr>
<td><em><strong>Total length of unanchored chromosome</strong></em></td>
<td>224.01 Mb</td>
</tr>
<tr>
<td>Number of unanchored hybrid scaffolds or contigs</td>
<td>3,910</td>
</tr>
<tr>
<td>Gap size</td>
<td>8.1 Mb (3.6%)</td>
</tr>
<tr>
<td>Number of high-confidence genes</td>
<td>6,455</td>
</tr>
<tr>
<td><em><strong>BUSCO</strong></em></td>
<td></td>
</tr>
<tr>
<td>Complete</td>
<td>99.4%</td>
</tr>
<tr>
<td>Duplicated</td>
<td>96.3%</td>
</tr>
<tr>
<td>Fragmented</td>
<td>0.1%</td>
</tr>
<tr>
<td>Missing</td>
<td>0.5%</td>
</tr>
</tbody></table>
<h2 id="Genome-assembly-and-validation"><a href="#Genome-assembly-and-validation" class="headerlink" title="Genome assembly and validation."></a><strong>Genome assembly and validation.</strong></h2><p>The PacBio HiFi reads were assembled using <font color="red"><strong>hifiasm12 (v.0.11)</strong></font> with <font color="green">default parameters</font>. Hybrid scaffolding incorporating the PacBio contigs and the <font color="blue">optical map</font> was performed using the <font color="red"><strong>hybridScaffold pipeline</strong></font> (Bionano Solve 3.6) with default parameters. For the pseudomolecule construction, the Omni-C reads were incorporated using <font color="red"><strong>Juicer tools (v.1.6)</strong></font> and <font color="red"><strong>3D-DNA (v.180114)</strong></font>. </p>
<p>In brief, the preprocessing of the Omni-C reads was performed with juicer.sh (parameter: -s none). The â€˜merged_nodups.txtâ€™ output file corresponding to the Hi-C contacts with duplicates removed was subsequently used with run-asm-pipeline.sh (parameter: -r 0) as input to produce the â€˜.hicâ€™ and â€˜.assemblyâ€™ files. These files were uploaded into Juicebox (v.1.11.08) to visualize the Hi-C map and for manual curation. </p>
<p>As a final step, the script <font color="red"><strong>run-asm-pipeline-post-review.sh</strong></font> (default parameters) was used to save the final Hi-C contact map and to output the final Kariega assembly (21 pseudomolecules and 1 unanchored pseudochromosome). To <font color="blue"><strong>validate</strong> the genome assembly</font>, we remapped the optical map onto the pseudomolecule using the <font color="red"><strong>hybridScaffold pipeline</strong></font> (Bionano Solve 3.6), and the final pseudomolecules were compared with the recent bread wheat assemblies of Chinese Spring (IWGSC RefSeq v.2.1) and the assemblies of the 10+ Wheat Genomes Project using <font color="red"><strong>MashMap</strong></font> (v.2.0; parameter: -s 300000â€“pi 98).</p>
<h1 id="14-2019-10-äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘"><a href="#14-2019-10-äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘" class="headerlink" title="14.  2019.10 äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨ ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘"></a>14.  2019.10 äºŒå€ä½“å·´ç‰¹åˆ©ç‰¹æ¢¨ ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…1ã€‘</h1><blockquote>
<p>Pseudo-chromosomeâ€“length genome assembly of a double haploid â€œBartlettâ€ pear (<em>Pyrus communis</em> L.)</p>
</blockquote>
<p><strong>Genome assembly and scaffolding</strong></p>
<p>The genome assembly workflow began with <em>de novo</em> assembly of contigs from the PacBio long reads using 2 tools, <font color="red"><strong>Canu</strong></font> (version 1.5) and <font color="red"><strong>Falcon</strong></font> (version 0.5). For each assembler the most important assembly parameters were systematically varied (Supplementary Methods), as defined by the tool developers, and by consideration of assembly theory (e.g., overlap length, overlap identity for overlap layout consensus assembly). <font color="blue"><strong>Optimal settings</strong> were <strong>selected</strong></font> by <strong>comparison of assembly statistics</strong> (total size assembled and contig N50) and by <strong>alignment of Illumina PE</strong> data to the assembly with <font color="red"><strong>bowtie2</strong></font> (using the â€œvery fastâ€ pre-set). For <font color="blue">all PacBio assemblies</font> the consensus step was performed by running <font color="red"><strong>Quiverçº é”™</strong></font> (Genomic Consensus version 2.3.3) (with default parameters) on <font color="blue">raw PacBio contigs</font> and using the full 63Ã— of PacBio data.</p>
<p>Assembled contigs were further joined into scaffolds using a combination of <strong>BioNano optical mapping</strong> data, <strong>Hi-C</strong> chromatin conformation capture data, and <strong>genetic maps.</strong> The best <font color="blue">assemblies from Canu and Falcon</font> were <font color="blue">independently combined with</font> BioNano optical mapping data using the <font color="red">IrysView</font> software to develop the Canu + BioNano (CB) and Falcon + BioNano (FB) assemblies, respectively. The BioNano scaffolding process identified conflicts between the assembled contigs and the optical map, indicating some degree of misassembly in both Canu and Falcon results.</p>
<p><strong>Assembly polishing</strong></p>
<p><font color="red"><strong>Pilon</strong></font> (version1.21) [31] was <font color="blue">run iteratively</font> on the assembly, with <font color="blue">Illumina sequence realigned to the polished assembly</font> at each iteration and then <font color="blue">alignments passed to Pilon to call the next consensus</font>. Alignments for Pilon were produced using <font color="red"><strong>BWA mem</strong></font> (v0.7.17) with default settings. <em>k</em>-mer spectrum comparisons were made using the <em>k</em>-mer analysis toolkit (<font color="red"><strong>KAT</strong></font>) (version 2.3.4) [13] (KAT comp) at a <em>k</em>-mer size of 32, and <font color="blue">the metric used to assess each iteration was the number of <strong>k-mers shared between</strong> the <strong>assembly</strong> and the <strong>Illumina</strong> reads</font>. </p>
<p>In a second consensus phase, <font color="blue">RNA-Seq</font> reads were aligned as single end (SE), to the genome using <font color="red"><strong>Hisat</strong></font> (version 2.1.0)  with default parameters. This time the effectiveness of consensus calling was <font color="blue">assessed by analysis of <strong>full-length alignments</strong> of assembled RNA-Seq transcripts</font>. All transcripts designated as â€œcompleteâ€ by Evigene  were aligned to the genome with BLAT  (version 3.4, with [34] minimum match identity 90%). Alignments were filtered to <strong>retain only full-length alignments</strong> (i.e., from query start to query end). </p>
<p>Finally, the number of gaps in the alignments (query gaps + target gaps) was used as a metric with the rationale that this serves as a proxy for the number of indels in alignments of assembled messenger RNA sequence.</p>
<p><strong>Scaffold clustering and genome anchoring using Hi-C</strong></p>
<p>Hi-C reads were aligned to the polished scaffolds in CB with <font color="red"><strong>Bowtie2</strong></font> (version 2.3.3.1) . Each of the paired reads was aligned independently; then these SE alignments were subsequently merged as recommended by the LACHESIS developers. Based on the alignments, <font color="red">CB scaffolds were <strong>arranged</strong> into <strong>17 ordered</strong> and <strong>oriented</strong> <strong>clusters</strong> using the <strong>LACHESIS</strong> software</font>. As an <font color="blue">internal check</font>, the process was completed on <font color="blue">2 different random 95% sub-samplings of the Hi-C data</font>, as well as on the full data set. The clusters produced by <strong>all 3</strong> of these LACHESIS runs were <font color="blue">identical</font>. <font color="blue">LACHESIS produces groups of scaffolds</font> that are ordered and oriented relative to each other. These scaffold groupings were <font color="blue">compared with the genetic map</font> and the <strong>consistency</strong> of these sources of information was <strong>assessed</strong>. <font color="blue">The SNP probe mapping </font>at the scaffold <strong>validation step</strong> was compared with the clusters produced by LACHESIS.</p>
<p><strong>Illumina assembly</strong></p>
<p>The Illumina data were also assembled on their own, using the de Bruijn graphâ€“based assembler <font color="red"><strong>SOAPdenovo2</strong></font> (version 2.04). <font color="blue"><strong>This assembly</strong></font> was <font color="blue"><strong>used in various ways</strong></font> during the course of the pear genome project (for further scaffold validation, for training the <em>ab initio</em> gene predictors, etc.). <font color="red"><strong>ã€å€Ÿé‰´ã€‘The Illumina data were assembled twice</strong></font>. The <font color="red">first pass</font> contigs were screened using the Kraken software and an index built from the entire RefSeq database. <font color="red">Reads aligning to contaminant contigs were <strong>removed</strong></font> and the remaining data were assembled again.</p>
<h1 id="15-2021-05-nbt-äºº-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘"><a href="#15-2021-05-nbt-äºº-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘" class="headerlink" title="15.  2021.05-nbt äºº ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘"></a>15.  2021.05-nbt äºº ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…2ã€‘</h1><blockquote>
<p>Chromosome-scale, haplotype-resolved assembly of human genomes</p>
</blockquote>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/10.png" alt="10"></p>
<p>outline of the phased assembly algorithm, <font color="red"><strong>DipAsm</strong></font></p>
<p>Assemble HiFi reads into unphased contigs using <font color="red"><strong>Peregrine</strong></font> (1);</p>
<p> <font color="blue"><strong>group</strong> and <strong>order</strong></font> contigs into scaffolds with <font color="blue"><strong>Hi-C</strong> data</font> using <font color="blue"><strong>Hirise/3D-DNA</strong></font> (3D de novo assembly) (2);</p>
<p> <font color="blue"><strong>map HiFi reads</strong> to scaffolds</font> and <font color="blue"><strong>call heterozygous SNPs</strong></font> using <font color="red"><strong>DeepVariant</strong></font> (3);</p>
<p> <font color="blue"><strong>phase</strong></font> heterozygous SNP calls with both HiFi and Hi-C data using <font color="red"><strong>WhatsHap plus HapCUT2</strong></font> (4);</p>
<p> partition reads based on their phase using <font color="red"><strong>WhatsHap</strong></font> (5);</p>
<p> assemble partitioned reads into <font color="blue"><strong>phased contigs</strong></font> using <font color="red"><strong>Peregrine</strong></font> (6).</p>
<p><strong>Phased sequence assembly.</strong> </p>
<p>We ran <font color="red"><strong>Peregrine v.0.1.5.2</strong></font> with the following command line: â€˜peregrine asm reads.lst 24 24 24 24 24 24 24 24 24 â€“with-consensus â€“shimmer-r 3 â€“best_n_ovlp 8â€“output asmâ€™, where file â€˜reads. lstâ€™ gives the list of input read files and directory â€˜asmâ€™ holds the output assembly. </p>
<p>We <font color="blue"><strong>mapped Hi-C reads to contigs</strong></font> with <font color="red"><strong>BWA-MEM</strong></font> v.0.7.17 and <font color="blue"><strong>scaffolded</strong></font> the Peregrine contigs with <font color="red"><strong>juicer v.1.5</strong></font> and <font color="red"><strong>3D-DNA v.180922</strong></font>. We preprocessed data with <font color="green"><strong>â€˜juicer.sh -d juicer -p chrom.sizes -y cut-sites.txt -z contigs.fa -Dâ€™</strong></font>, where file <strong>â€˜cut-sites.txtâ€™</strong> was <strong>generated</strong> using the <strong>generate_site_positions_Arima. py</strong> script, which <strong>outputs merged_nodups.txt</strong>. The scaffolds were produced with <font color="green"><strong>â€˜run-asm-pipeline.sh -m haploid contigs.fa merged_nodups.txtâ€™</strong></font>. </p>
<p>We then called small variants using DeepVariant v.0.8.0 with the pretrained PacBio model. </p>
<p>We mapped Hi-C reads to the scaffolds and ran HapCUT2 v.1.1 over heterozygous SNP sites to obtain sparse phasing at the chromosome scale. The resulting haplotypes were then combined with PacBio HiFi data using WhatsHap v.0.18, with default parameters, to generate fine-scale, chromosome-long phasing. </p>
<p>We partitioned HiFi reads based on the phases of SNPs residing on these reads, and ran Peregrine again for reads on the same haplotype from the same scaffold. This provided the final phased assembly.</p>
<h1 id="16-2018-11-ng-åŒæºå¤šå€ä½“ç”˜è”—-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘"><a href="#16-2018-11-ng-åŒæºå¤šå€ä½“ç”˜è”—-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘" class="headerlink" title="16.  2018.11-ng åŒæºå¤šå€ä½“ç”˜è”— ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘"></a>16.  2018.11-ng åŒæºå¤šå€ä½“ç”˜è”— ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…3ã€‘</h1><blockquote>
<p>Allele-defined genome of theautopolyploid sugarcane <em>Saccharum spontaneum</em> L.</p>
</blockquote>
<p><strong>ææ–™</strong></p>
<p>æ ½åŸ¹ç”˜è”—çš„<font color="blue">å•å€å‹ä¸ªä½“</font><em>S.spontaneum</em>â€œAP85-441â€(1n = 4x = 32) è¿›è¡ŒåŸºå› ç»„<em>denovo</em>æµ‹åºç ”ç©¶ã€‚<br>64ä»½ç”˜è”—ï¼ˆ<em>Saccharum spontaneum</em>ï¼‰ç¾¤ä½“ææ–™è¿›è¡Œ<font color="blue">é—ä¼ å¤šæ ·æ€§ç ”ç©¶</font>ã€‚</p>
<p><strong>æ–¹æ³•</strong></p>
<p>äºŒä»£280-bpå’Œ500-bp(PE) å°ç‰‡æ®µæ–‡åº“ï¼ˆIllumina HiSeq 2500ï¼‰<br>BACæ–‡åº“ï¼ˆIllumina HiSeq 2500ï¼ŒPE250ï¼‰ï¼›ä¸‰ä»£å¤§ç‰‡æ®µæ–‡åº“~20kb SMRTbellTMï¼ˆ<font color="blue">PacbioRSII</font>ï¼‰<br>Hi-Cæ–‡åº“ï¼ˆ<font color="blue">HindIIIé…¶åˆ‡</font>ï¼‰ï¼Œ500-700bpå°ç‰‡æ®µæ–‡åº“ï¼ˆHiSeqX tenï¼ŒPE150ï¼‰</p>
<p><strong>ä¸»è¦ç»“æœ</strong>ï¼š</p>
<p><strong>ç”˜è”—åŸºå› ç»„denovo</strong><br>åˆ©ç”¨BACæ–‡åº“è¿›è¡ŒäºŒä»£æµ‹åºï¼ŒALLPATH-LG,SPAdes å’ŒSOAPdenovo2è¿›è¡Œåˆæ­¥ç»„è£…ï¼Œè¿›ä¸€æ­¥åˆ©ç”¨<font color="blue">87X ä¸‰ä»£PacBioæ•°æ®è¿›è¡Œ<strong>çº é”™</strong></font>ï¼Œ<font color="red"><strong>CANU</strong></font>ç»„è£…ï¼Œç»„è£…åŸºå› ç»„3.13Gï¼Œ<font color="blue">contigN50=45 kb</font>ï¼ˆæµå¼è¯„ä¼°åŸºå› ç»„å¤§å°ï¼š3.36Gï¼‰ï¼›é€šè¿‡Hi-CæŸ“è‰²ä½“æŒ‚è½½æŠ€æœ¯ï¼Œé’ˆå¯¹<font color="red"><strong>å¤šå€ä½“æŸ“è‰²æŒ‚è½½æœ€æ–°ç®—æ³•ALLHIC</strong></font>ï¼Œè¿›ä¸€æ­¥å°†contigæ°´å¹³æå‡è‡³æŸ“è‰²ä½“æ°´å¹³ï¼Œ<strong>æŒ‚è½½ç‡è¾¾åˆ°93%<strong>ï¼›é€šè¿‡BUSCOå’ŒäºŒä»£æ•°æ®å›æ¯”è¯„ä¼°åŸºå› ç»„å®Œæ•´æ€§é«˜è¾¾</strong>97.3%<strong>ã€‚å†é€šè¿‡<font color="red"><strong>MAKER</strong></font>å¯¹åŒæºå¤šå€ä½“ç”˜è”—<font color="blue">ç‰¹å¼‚ç­‰ä½åŸºå› è¿›è¡Œ</font></strong>æ‰‹åŠ¨æ³¨é‡Š</strong>ï¼Œä»¥è·å¾—é«˜è´¨é‡çš„ç”˜è”—åŸºå› ç»„</p>
<p>**åŸºç¡€æŸ“è‰²ä½“æ•°ç›®çš„å‡å°‘ *<em>ç¦¾æœ¬ç§‘æŸ“è‰²ä½“æ•°è¿›åŒ–ï¼ˆé«˜ç²±n= 10åˆ°ç”˜è”—n= 8ï¼‰<br>AP85-441åŸºå› ç»„çš„ç»„è£…æ˜¾ç¤ºäº†</em>S.spontaneum*çš„æŸ“è‰²ä½“æ•°ç›®ä»10é™åˆ°8ï¼Œè€Œè¿™ä¸é¢‘ç¹å¤åˆ¶çš„å¤å¤åˆ¶æŸ“è‰²ä½“å¯¹ç›¸å…³ï¼Œé€šè¿‡ä¸é«˜ç²±çš„èšç±»æ¯”å¯¹ï¼Œå‘ç°é«˜ç²±ç¥–å…ˆ5æŸ“è‰²ä½“å’Œ8å·æŸ“è‰²ä½“åŒæºç‰©ç»å†äº†æŸ“è‰²ä½“è£‚å˜ï¼ˆå›¾2ï¼‰ã€‚SbChr05ï¼ˆA12ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“æ–­è£‚åˆ†ä¸ºä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼Œå³C5Sï¼ˆA12Sï¼‰å’ŒC5Lï¼ˆA12Lï¼‰ï¼Œåˆ†åˆ«è½¬ç§»åˆ°SbChr06ï¼ˆA2ï¼‰å’ŒSbChr07ï¼ˆA5ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“ï¼›SbChr8ï¼ˆA11ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“æ–­è£‚ä¸ºä¸¤ä¸ªä¸»è¦çš„éƒ¨åˆ†ï¼Œå³C8Sï¼ˆA11Sï¼‰å’ŒC8Lï¼ˆA11Lï¼‰ï¼Œåˆ†åˆ«è½¬ç§»åˆ°SbChr09ï¼ˆA6ï¼‰å’ŒSbChr02ï¼ˆA7+ A9ï¼‰çš„ç¥–å…ˆæŸ“è‰²ä½“ä¸­ã€‚SbChr8å’ŒSsChr5ä¹‹é—´åŠSbChr5å’ŒSsChr7ä¹‹é—´è¿‘ä¹åŒæºçš„çŸ­ç‰‡æ®µæ˜¯åœ¨é«˜ç²±ä¸ç”˜è”—åˆ†åŒ–å‰ï¼Œé«˜ç²±SSAå½¢æˆäº13.4MYAåŒæºåŸºå› çš„æ®‹ç•™ç‰©ï¼ŒåŒæ—¶å‘ç°ï¼ŒS5ä¸­è¾ƒå°çš„SSAåŒºåŸŸå’ŒS8ä¸­SSAçš„è¾ƒå¤§åŒºåŸŸåœ¨é‡æ’çš„AP85-441åŸºå› ç»„ä¸­ä¹Ÿæ˜¯ä¿å®ˆçš„ã€‚</p>
<p><strong>S.spontaneumçš„å¤šå€ä½“åŒ–åˆ†æ</strong><br>è¿›ä¸€æ­¥ç ”ç©¶å‘ç°äº†ç”˜è”—ï¼ˆ<em>Saccharum spontaneum</em> L.ï¼‰æŸ“è‰²ä½“ç”±é«˜ç²±ï¼ˆ<em>Sorghum</em>ï¼‰æ¼”å˜è¿›åŒ–è¿‡ç¨‹ä¸­ç»å†äº†æŸ“è‰²ä½“æ–­è£‚ä¸èåˆåï¼Œå‘ç”Ÿäº†ä¸¤æ¬¡WGDäº‹ä»¶ï¼ˆå›¾3ï¼‰ï¼›å¯¹ç”˜è”—çš„åŸºå› ç»„çš„å¤šå€åŒ–ç ”ç©¶ä¸­å‘ç°ï¼Œé€šè¿‡ä¸¤æ¬¡å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯¼è‡´äº†ç”˜è”—æŸ“è‰²ä½“çš„è‡ªå‘åŠ å€è¿‡ç¨‹ï¼›å¯¹åŒæºå¤šå€ä½“ç”˜è”—çš„ç‰¹å¼‚ç­‰ä½åŸºå› çš„é‰´å®šä½œä¸ºæœ¬ç ”ç©¶çš„å¦ä¸€äº®ç‚¹ï¼Œæ–‡ç« åœ¨é‰´å®šç­‰ä½åŸºå› çš„åŒæ—¶ï¼Œè¿›ä¸€æ­¥åˆ†æç ”ç©¶äº†ç­‰ä½åŸºå› çš„è¡¨è¾¾æ¨¡å¼ï¼Œç»“æœå‘ç°ä¸åŒå•å€å‹è¡¨è¾¾æ¨¡å¼ç›¸ä¼¼ï¼Œå¹¶æ— æ˜æ˜¾å·®å¼‚ï¼›å¯¹ç”˜è”—C4å…‰åˆä½œç”¨çš„ç ”ç©¶ä¸­é‰´å®šäº†24ä¸ªåŸºå› ï¼Œ7ç§å…³é”®é…¶å‚ä¸NADP-MEC4é€”å¾„ï¼›åœ¨ç”˜è”—ä¸­è”—ç³–å¯¹çš„ç§¯ç´¯çš„ç ”ç©¶ä¸­å‘ç°ä¸é«˜ç²±ç›¸æ¯”ç”˜è”—ä¸­çš„æ¶²æ³¡è†œç³–è½¬è¿è›‹ç™½ï¼ˆTSTsï¼Œä¸€ç§è”—ç³–è½¬è¿è›‹ç™½ï¼‰å‘ç”Ÿäº†åŸºå› å®¶æ—çš„æ‰©å¼ ï¼Œæ‰€ä»¥æ¨æµ‹TSTså‚ä¸è”—ç³–åœ¨æ¶²æ³¡ä¸­çš„ç§¯ç´¯ï¼›<em>S.spontaneum</em>ä¸ºç°ä»£æ ½åŸ¹ç”˜è”—æä¾›äº†æŠ—ç—…æ€§åŸºå› ï¼Œåœ¨å¯¹å…¶ç ”ç©¶ä¸­å‘ç°ï¼Œç”˜è”—ä¸­çš„80ï¼…çš„NBSç¼–ç åŸºå› ä½äºå››ä¸ªé‡æ’æŸ“è‰²ä½“ï¼ˆSs02ï¼ŒSs05ï¼ŒSs06å’ŒSs07ï¼‰ä¸Šï¼Œå…¶ä¸­51ï¼…ä½äºé‡æ’åŒºåŸŸã€‚</p>
<p><strong>S.spontaneumçš„èµ·æºä¸é—ä¼ å¤šæ ·æ€§åˆ†æ</strong><br>é€šè¿‡å¯¹64ä»½ç”˜è”—ï¼ˆ<em>Saccharum spontaneum</em>ï¼‰ç¾¤ä½“ææ–™é—ä¼ å¤šæ ·æ€§ç ”ç©¶ï¼Œå‘ç°å…¶å…·æœ‰å¹¿æ³›çš„è‡ªç„¶éƒ¨åˆ†èŒƒå›´ï¼ŒéåŠäºšæ´²ï¼Œå°åº¦æ¬¡å¤§é™†ï¼Œåœ°ä¸­æµ·å’Œéæ´²ï¼Œä¸”è‡ªç„¶ç§ç¾¤å…·æœ‰å¹¿æ³›çš„è¡¨å‹ï¼Œé—ä¼ å’Œå€æ€§æ°´å¹³å¤šæ ·æ€§ï¼ˆå›¾4ï¼‰ã€‚ç ”ç©¶å‘ç°ï¼Œä¸é«˜ç²±ç›¸æ¯”å…·æœ‰å¤§è§„æ¨¡æŸ“è‰²ä½“é‡æ’çš„<em>S. spontaneum</em>åŒºåŸŸå…·æœ‰æ¯”éé‡æ’åŒºåŸŸæ›´é«˜çš„é—ä¼ å¤šæ ·æ€§ï¼Œå¹¶ä¸”å¯èƒ½ç»å†äº†æ›´å¼ºçš„å¹³è¡¡é€‰æ‹©ã€‚è™½ç„¶å‡ æ¡å•ç‹¬çš„æŸ“è‰²ä½“æ²¡æœ‰æ˜¾ç¤ºå‡ºæ˜¾è‘—å·®å¼‚ï¼Œä½†æ˜¯æ¯”è¾ƒæ‰€æœ‰æŸ“è‰²ä½“ä¸Šçš„å¹³å‡å€¼æ˜¾ç¤ºé‡æ’åŒºåŸŸä¸­çš„æ ¸è‹·é…¸å¤šæ ·æ€§ï¼ˆ0.00025Â±0.00003ï¼‰è¿œé«˜äºéé‡æ’åŒºåŸŸä¸­çš„æ ¸è‹·é…¸å¤šæ ·æ€§ï¼ˆ0.00021Â±0.00001ï¼‰ï¼ŒæŸ“è‰²ä½“é‡æ’åŒºåŸŸçš„Tajimaâ€™s Dï¼ˆ-0.659Â±0.052ï¼‰è¿œè¿œé«˜äºéé‡æ’åŒºï¼ˆ-0.720Â±0.011ï¼‰ï¼Œé‡æ’åŒºçš„SNPå¯†åº¦(360.27Â±48.41) é«˜äºéé‡æ’åŒºåŸŸï¼ˆ297.46Â±12.65, P=0.001798ï¼‰ï¼›æ­¤å¤–ï¼ŒGOå¯Œé›†æ˜¾ç¤ºï¼ŒæŸ“è‰²ä½“éé‡æ’åŒºä¸»è¦å¯Œé›†åˆ°ä¸åŸºæœ¬ç”Ÿå‘½å‘¨æœŸï¼Œå…‰åˆä½œç”¨ï¼Œå‘¼å¸ä½œç”¨å’ŒATPåˆæˆçš„é€šè·¯ä¸Šã€‚é‡æ’åŒºä¸»è¦å¯Œé›†åœ¨GOç”Ÿç‰©åˆæˆå’Œä»£è°¢ï¼Œè·¨è†œè½¬è¿å’Œç¦»å­ç»“åˆé€šè·¯ä¸Šã€‚</p>
<p><em>S. spontaneum</em>é‡æ’åŒºå…·æœ‰é«˜åº¦çš„é—ä¼ å¤šæ ·æ€§å°†æ›´é€‚åº”ç¯å¢ƒå‹åŠ›ï¼Œä¾‹å¦‚å¯¹å„ç§éç”Ÿç‰©èƒè¿«ï¼ˆå¹²æ—±ï¼Œç›åº¦ï¼Œç¢±æ€§ï¼Œé‡‘å±ç¦»å­ç­‰ï¼‰çš„ååº”ï¼Œè¿™äº›å—åˆ°æ¬¡ç”Ÿç»†èƒç”Ÿç‰©åˆæˆå’Œä»£è°¢ï¼Œè·¨è†œè½¬è¿å’Œç¦»å­ç»“åˆçš„æ§åˆ¶çš„åŸºå› åœ¨è¿™äº›åŒºåŸŸå¯ä»¥æ£€æµ‹åˆ°ã€‚åœ¨å¤šå€åŒ–äº‹ä»¶åï¼Œé‡æ’åŒºåŸŸç»å†äº†æ›´å¼ºçš„å¹³è¡¡é€‰æ‹©ã€‚</p>
<p><strong>è®¨è®º</strong></p>
<p>æœ¬ç ”ç©¶åˆ©ç”¨å¤æ‚åŸºå› ç»„Hi-Cå»ºåº“æµ‹åºæŠ€æœ¯ï¼Œå¹¶ç»“åˆALLHiCç®—æ³•æˆåŠŸç»„è£…äº†é«˜å¤æ‚åŒæºå¤šå€ä½“ç”˜è”—åŸºå› ç»„AP85-441ï¼Œé«˜è´¨é‡çš„ç”˜è”—åŸºå› ç»„çš„è·å¾—ï¼Œä¸ºåç»­ç ”ç©¶å…¶è”—ç³–å«é‡ï¼ŒæŠ—æ€§ç­‰æ€§çŠ¶åŠå†œä¸šè‚²ç§åŸºç¡€å¥ å®šäº†åŸºç¡€ã€‚</p>
<p><strong>Genome assembly overview.</strong> </p>
<p>The sugarcane AP85-441 contig-level assembly incorporated sequencing data from a mixture of sequencing technologies (Supplementary Fig. 1), including BAC pools sequenced with Illumina HiSeq 2500 and whole-genome shotgun sequencing with PacBio RS II as well as Hi-C reads, followed by Illumina short reads polishing. Each BAC pool was independently assembled using <font color="red">ALLPATHS-LG, SPAdes and SOAPdenovo2</font>, and best results were retained. For PacBio assembly, <font color="red"><strong>Canu v1.511</strong></font> was used, as it is capable<br>of avoiding collapsed repetitive regions and haplotypes. Self-correction was performed with parameter corOutCoverage = 100, which allowed us to correct all of the input PacBio reads. The corrected reads, along with BAC-assembled contigs, were imported to the assembly step. <font color="blue">Chromosomal assembly</font> was constructed based on proximity-guided assembly using our newly developed program, <font color="red"><strong>ALLHIC</strong>, which is designed for <strong>polyploid</strong> genome scaffolding</font> (see Supplementary Note for details).</p>
<p><img src="/blog/2022/03/14/2022-03-14-HiFi-6-HiC-assembly/11.png" alt="11"></p>
<h1 id="17-2019-08-np-ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘"><a href="#17-2019-08-np-ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘" class="headerlink" title="17.  2019.08-np ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘"></a>17.  2019.08-np ALLHiCã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…4ã€‘</h1><blockquote>
<p>Assembly of allele-aware, chromosomal-scale autopolyploid genomes based on Hi-C data</p>
</blockquote>
<p><strong>existing approaches are mostly designed for diploid genomes and often with the aim of reconstructing a haploid representation, thereby having limited power to reconstruct chromosomes for autopolyploid genomes. We developed a novel algorithm (ALLHiC) that is capable of building allele-aware, chromosomal-scale assembly for <font color="red">auto-polyploid genomes</font> using Hi-C paired-end reads with innovative â€˜pruneâ€™ and â€˜optimizeâ€™ steps. Application on simulated data showed that ALLHiC can phase allelic contigs and substantially improve ordering and orientation when compared to other mainstream Hi-C assemblers</strong></p>
<h1 id="18-2020-05-nc-ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘"><a href="#18-2020-05-nc-ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘" class="headerlink" title="18. 2020.05-nc ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘"></a>18. 2020.05-nc ç´«èŠ±è‹œè“¿åŒæºå››å€ä½“-06ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…5ã€‘</h1><h1 id="19-2020-10-ng-äºŒå€ä½“åœŸè±†-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘"><a href="#19-2020-10-ng-äºŒå€ä½“åœŸè±†-ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘" class="headerlink" title="19. 2020.10-ng äºŒå€ä½“åœŸè±† ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘"></a>19. 2020.10-ng äºŒå€ä½“åœŸè±† ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…6ã€‘</h1><blockquote>
<p>Haplotype-resolved genome analyses of a heterozygous diploid potato</p>
</blockquote>
<p>ref of 12: Hi-C-genetic-maps-for-<font color="red">correction</font></p>
<p>é©¬é“ƒè–¯(Solanum tuberosum L.)æ˜¯å…¨çƒé‡è¦çš„å—èŒä½œç‰©ã€‚äººä»¬æ­£åœ¨åŠªåŠ›å°†è¿™ç§ä½œç‰©ä»æ— æ€§ç¹æ®–çš„å››å€ä½“è½¬åŒ–ä¸ºç§å­ç¹æ®–çš„ã€è‡ªäº¤ç³»ä¸ºåŸºç¡€çš„æ‚äº¤ä½œç‰©ï¼Œä½†è¿™ä¸€è¿‡ç¨‹éœ€è¦å¯¹é©¬é“ƒè–¯åŸºå› ç»„æœ‰æ›´å¥½çš„äº†è§£ã€‚</p>
<p><strong>Genome assembly and phasing using PacBio CCS reads.</strong> </p>
<p>A total of 29 Gb CCS reads were assembled using <font color="red"><strong>Canu</strong></font> (v1.91) with the <font color="green"><strong>parameter</strong> â€“pacbio-hifi</font>.<br>Canu <font color="blue">generated <strong>two</strong> assemblies</font> composed of contigs and unitigs (Supplementary Table 4), and the <font color="blue"><strong>unitig</strong> assembly consisted of the <strong>contigs that split at any alternative paths</strong> in the assembly graph</font>. The contig assembly had longer continuity but more chimeric fragmentsåµŒåˆä½“ç‰‡æ®µ as revealed in the genetic mapping analysis. To avoid the mis-joining of two haplotypes, <font color="red"><strong>the unitig assembly</strong></font> rather than the contig assembly was chosen for the <font color="red"><strong>subsequent analysis</strong></font>. The unitigs were then <font color="blue"><strong>polished</strong> iteratively using <strong>two rounds</strong></font> of <font color="red"><strong>Pilon</strong></font> with ~150 Gb of WGS <strong>Illumina</strong> data, generating the genome <strong>draft RHgv2</strong>.</p>
<p>Similarly, the sequenced reads of RH selfing progenyåä»£ were mapped to unitigs of RHgv2 to perform <font color="blue"><strong>genetic grouping</strong></font>. Because the unitigs were relatively long (N50 = 2 Mb), windows with a size of 200 kb rather than the whole unitig were used. If the adjacent windows of one unitig showed contrary read distribution, the unitig was defined as chimeric and broken between windows; 40 chimeric unitigs with a total length of 95 Mb were broken. In total, <font color="blue">1.31 Gb of 1.53 Gb sequences were assigned to 24 linkage groups</font>.</p>
<p>After merging, 141 Mb sequences and 5,252 annotated genes of RHgv1 were added to the RHgv2, yielding a 1.67 Gb genome draft with 1.54 Gb sequences assigned to 24 groups, termed RHgv3 (Supplementary Table 6). The sequences from the RHgv1 and RHgv2 assemblies were named as ontctg* and unitig* in the AGP file, respectively (Supplementary Data 3).</p>
<p><strong>Construction of pseudochromosomes.</strong> </p>
<p>As no approach generated satisfactory results on the RH genome, we introduced the group information derived from the genetic mapping to assist the Hi-C application on chromosome-level assembly. The process was performed on RHgv3 including three steps as follows:</p>
<ol>
<li><font color="blue"><strong>Align</strong></font>. The 24 previously determined groups were divided into <font color="blue"><strong>two haplotypes</strong> to <strong>generate</strong> <strong>two</strong> <strong>pseudohaploid genome drafts</strong></font>. The 132 Mb sequences that could not be assigned to any group were added to two pseudohaploid genomes. Total <font color="blue">Hi-C reads were <strong>aligned</strong> to <strong>each</strong> pseudohaploid genome using <strong>HiC-Pro</strong> to calculate the <strong>contact frequency</strong></font>. This step <font color="blue">yielded <strong>two bam files</strong> for the two pseudohaploid genomes</font>.</li>
<li><font color="blue"><strong>Rescue</strong></font>. Using the <font color="blue">bam file as input</font>, the <em>rescue</em> function in <font color="red"><strong>ALLHiC</strong></font> was applied to assign unplaced sequences to known groups. Because the 132 Mb <strong>unplaced sequences</strong> were <strong>added</strong> to two pseudohaploid genomes and <strong>processed twice</strong>, the rescued <strong>results were redundant</strong>. For every <strong>unplaced sequence</strong>, we <strong>considered its best Hi-C signal density</strong> to decide the group to which it belonged. After this step, the sequence content of 24 groups was updated with an <strong>extra 75.6 Mb</strong> sequences assigned to proper groups.</li>
<li><font color="blue"><strong>Optimize and build</strong></font>. For each pseudohaploid genome, using <font color="red">the bam file and the updated group file as input</font>, the <font color="red"><strong><em>optimize</em> function in ALLHiC</strong></font> decidedthe <strong>order</strong> and <strong>orientation</strong> of scaffolds for each group; thus, the <font color="red"><strong><em>build</em> function</strong></font> generated fasta sequences on that basis. By performing this step, we identified the pseudochromosomes for 24 groups. The order and orientation of scaffolds on chromosomes are provided in Supplementary Data 3.</li>
</ol>
<h1 id="20-2021-12-gb-ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘"><a href="#20-2021-12-gb-ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘" class="headerlink" title="20. 2021.12-gb ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘"></a>20. 2021.12-gb ææ ‘ã€å››å€ä½“åœŸè±†å‚è€ƒhicç»„è£…7ã€‘</h1><blockquote>
<p>Gamete binning: chromosome-level and haplotype-resolved genome assembly enabled by high-throughput single-cell sequencing of gamete genomes</p>
</blockquote>
<p>ref of 12: Hi-C-genetic-maps-for-correction</p>
<p>ä¸€ç§åŸºäºå•å€ä½“é…å­å•ç»†èƒæµ‹åºçš„æ–¹æ³•ã€‚åŸºäº445ä¸ªä¸ªä½“èŠ±ç²‰ç²’çš„å…¨åŸºå› ç»„æµ‹åºï¼Œç»„è£…äº†ä¸€æ ªäºŒå€ä½“ææ ‘çš„ä¸¤ä¸ªåŸºå› ç»„ã€‚</p>
<p><strong>Genome size estimation</strong></p>
<p>After trimming off 10x Genomics barcodes and hexamers from the 61.7 Gb reads of the two 10x sc-CNV libraries, k-mer counting (k=21) was performed with <font color="red"><strong>Jellyfish</strong></font>. The k-mer histogram was provided to<font color="red"> <strong>findGSE</strong></font> to estimate the size of the â€œRojo PasioÌnâ€ genome under the heterozygous mode (with â€œexp_hom=200â€; Add- itional file 1: Fig. S3).</p>
<p><strong>Preliminary diploid-genome assembly and curation</strong></p>
<p>With the 19.9 G raw PacBio reads of â€œRojo PasioÌnâ€ (Additional file 1: Fig. S2), a pre-liminary diploid assembly was constructed using <font color="red"><strong>Canu</strong></font> (with options â€œgenome- Size=242500000 corMhapSensitivity=high corMinCoverage=0 corOutCoverage=100 correctedErrorRate=0.105â€).</p>
<p>All raw <strong>Illumina reads</strong> from the 10x libraries were <font color="red">firstly <strong>aligned</strong> to the <strong>initial assembly</strong></font> using <font color="red"><strong>bowtie2</strong></font>. Then, the purge haplotigs pipeline was used to remove haplotigs (i.e., haplotype-specific contigs inflating the true haploid genome) based on statistical analysis of sequencing depth and identify primary contigs to build up a curated haploid assembly. To reduce the false-positive rate in defining haplotigs, each haplotig was blasted to the curated assembly; if over 50% of the haplotig could not be covered by any primary contigs, it was re-collected as a primary contig.</p>
]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>denovo-III</tag>
      </tags>
  </entry>
  <entry>
    <title>HiFi-5-[HiC-Pro]-[MCscan]-[ALLHiC]</title>
    <url>/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/</url>
    <content><![CDATA[<p>HiC-Proå°†fqæ–‡ä»¶å¤„ç†æˆäº’ä½œallValidPairsï¼Œå†è½¬åŒ–æˆå¯è§†åŒ–hicæ–‡ä»¶(for juicer)</p>
<span id="more"></span>

<h1 id="HiCç®€ä»‹"><a href="#HiCç®€ä»‹" class="headerlink" title="HiCç®€ä»‹"></a>HiCç®€ä»‹</h1><ul>
<li><p><strong>1.1 Hi-CæŠ€æœ¯</strong>é«˜é€šé‡æŸ“è‰²ä½“æ„è±¡æ•è·æŠ€æœ¯(<code>High-throughput chromosome conformation capture</code>)ç ”ç©¶å…¨åŸºå› ç»„ä¸‰ç»´æ„è±¡åŠåˆ†ææŸ“è‰²è´¨ç‰‡æ®µç›¸äº’ä½œç”¨çš„å®éªŒæŠ€æœ¯</p>
</li>
<li><p><strong>1.2 Hi-Cç›®çš„</strong>äº†è§£æ ¸å†…æŸ“è‰²è´¨çš„ä¸‰ç»´æ„è±¡ã€è·å¾—ç»†èƒæ ¸å†…ç©ºé—´ä½ç½®éå¸¸æ¥è¿‘æˆ–å­˜åœ¨ç›¸äº’ä½œç”¨çš„æŸ“è‰²è´¨æµ‹åºç‰‡æ®µæ›´å¥½åœ°ç ”ç©¶æŸ“è‰²è´¨å†…æˆ–æŸ“è‰²è´¨é—´çš„äº’ä½œã€åŸºå› è°ƒæ§å…ƒä»¶åœ¨å…¨åŸºå› ç»„èŒƒå›´å†…è°ƒæ§çš„æƒ…å†µ</p>
</li>
<li><p><strong>1.3 Hi-Cåº”ç”¨æ–¹å‘</strong>è¾…åŠ©åŸºå› ç»„ç»„è£…ã€æ­ç¤ºç©ºé—´è°ƒæ§ã€æ­ç¤ºç‰©ç§è¿›åŒ–ã€ç–¾ç—…ç ”ç©¶ã€ä¸‰ç»´ç»“æ„å·®å¼‚åˆ†æã€è¿˜åŸæŸ“è‰²ä½“ä¸‰ç»´ç»“æ„ã€æ„å»ºæŸ“è‰²ä½“è·¨åº¦å•ä½“å‹</p>
</li>
<li><p><strong>1.4 äº’ä½œæœ¬è´¨</strong>ç»Ÿè®¡å­¦ä¸ŠåŸºå› ç»„ä¸¤ç‚¹ä¹‹é—´å‘ç”Ÿç©ºé—´æ¥è§¦çš„æ¦‚ç‡</p>
</li>
<li><p><strong>1.5 Hi-Cå®éªŒåŸç†</strong></p>
</li>
<li><p><strong>1.6 äºŒä»£æ–‡åº“æ„å»ºåŠæµ‹åº</strong></p>
</li>
<li><p><strong>1.7 Hi-Cå®é™…æ–‡åº“ç±»å‹</strong>å°†HICæ•°æ®è¿›è¡Œæ¯”å¯¹æ˜¯ä¼šå‡ºç°ä¸åŒçš„æ¯”å¯¹æƒ…å†µï¼Œéœ€è¦çš„æ˜¯<font color="blue">åŒç«¯å”¯ä¸€åŒ¹é…</font>ã€‚å¯¹å•ç«¯åŒ¹é…ã€å¤šå¤„æ¯”å¯¹ã€æœªæ¯”å¯¹çš„readsè¿›è¡Œè¿‡æ»¤ã€‚</p>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/5.png" alt="HiC-Proçš„ä½¿ç”¨"></p>
<p>Hi-Cæ–‡åº“æ„å»ºäº§ç”Ÿå¤šç§åˆ†å­ç±»å‹ï¼ŒåŒ…æ‹¬ re-ligationã€Dangling endsã€self circle ã€dump reads åŠvalid pairs readsç­‰ç±»å‹ã€‚ åœ¨ Hi-C åˆ†æä¸­ï¼Œ<font color="red">ä»…valid pairå¯ä»¥åæ˜ åŸºå› ç»„ä¸Šä½ç‚¹ä¸ä½ç‚¹é—´çš„äº’ä½œ</font>ã€‚å› æ­¤ï¼Œ<font color="blue">éé‡å¤çš„valid pair</font>æ‰€å æ¯”ä¾‹æ˜¯è¯„ä¼°Hi-Cæ–‡åº“è´¨é‡é‡è¦æŒ‡æ ‡</p>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/6.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆä¸‰ï¼‰ï¼šHi-C æ•°æ®æ¯”å¯¹åŠHiC-Proçš„ä½¿ç”¨"></p>
</li>
<li><p><strong>äº’ä½œçŸ©é˜µçš„ç”Ÿæˆ</strong>ç”±äºè®¡ç®—èµ„æºï¼Œæ•°æ®é‡ç­‰å› ç´ ï¼Œ<font color="blue">éœ€è¦ç¡®å®šä¸€ä¸ªäº’ä½œå•ä½ï¼šbin</font>ã€‚å°†åŸºå› ç»„æŒ‰ç…§ä¸€å®šå¤§å°åˆ†æˆbinã€‚<font color="red">å°†è¿‡æ»¤åçš„æœ‰æ•ˆåºåˆ—åˆ†é…åˆ°è¿™äº›binä¸­</font></p>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/7.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆä¸‰ï¼‰ï¼šHi-C æ•°æ®æ¯”å¯¹åŠHiC-Proçš„ä½¿ç”¨"></p>
</li>
<li><p><strong>äº’ä½œçŸ©é˜µçš„çŸ«æ­£</strong>Hi-Cæ•°æ®ä¸­ç”±äº<font color="blue">å†…åˆ‡é…¶åå¥½æ€§ã€åŸºå› ç»„æœ¬èº«è´¨é‡ã€åŸºå› ç»„åºåˆ—ç‰¹å¼‚æ€§</font> å¯¼è‡´å…¶åœ¨åŸºå› ç»„ä¸åŒä½ç½®é—´å­˜åœ¨åå·®ã€‚å› æ­¤ï¼Œ<font color="red">å¯¹äº’ä½œçŸ©é˜µæ ¡æ­£ï¼Œä½¿å…¶æ•°æ®åœ¨åŸºå› ç»„ä¸Šæ¯ä¸ªä½ç‚¹çš„è¦†ç›–åº¦ä¸€è‡´</font>ã€‚å¸¸ç”¨çŸ«æ­£æ–¹å¼æœ‰<font color="red"><strong>è¿­ä»£çŸ«æ­£ã€å½’ä¸€åŒ–</strong></font>ç­‰</p>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/8.png" alt="ä¸‰ç»´åŸºå› ç»„æŠ€æœ¯ï¼ˆä¸‰ï¼‰ï¼šHi-C æ•°æ®æ¯”å¯¹åŠHiC-Proçš„ä½¿ç”¨"></p>
</li>
</ul>
<h2 id="HiCå¸¸è§„è½¯ä»¶"><a href="#HiCå¸¸è§„è½¯ä»¶" class="headerlink" title="HiCå¸¸è§„è½¯ä»¶"></a>HiCå¸¸è§„è½¯ä»¶</h2><table>
<thead>
<tr>
<th align="left">è½¯ä»¶å</th>
<th align="left">hiclib</th>
<th align="left">HiC-Pro</th>
<th align="left">HICUP</th>
<th align="left">Juice</th>
</tr>
</thead>
<tbody><tr>
<td align="left">æ¯”å¯¹è½¯ä»¶</td>
<td align="left">Bowtie2</td>
<td align="left">Bowtie2</td>
<td align="left">Bowtie2</td>
<td align="left">BWA-mem</td>
</tr>
<tr>
<td align="left">æ¯”å¯¹ç­–ç•¥</td>
<td align="left">è¿­ä»£æ¯”å¯¹</td>
<td align="left">å…¨å±€ã€å±€éƒ¨æ¯”å¯¹</td>
<td align="left">å…ˆæˆªçŸ­åæ¯”å¯¹</td>
<td align="left">Pair-endï¼ŒåµŒåˆreadsè¿‡æ»¤</td>
</tr>
<tr>
<td align="left">åµŒåˆreadså¤„ç†</td>
<td align="left">âˆš</td>
<td align="left">âˆš</td>
<td align="left">âˆš</td>
<td align="left">âˆš</td>
</tr>
<tr>
<td align="left">æ„å»ºçŸ©é˜µ</td>
<td align="left">âˆš</td>
<td align="left">âˆš</td>
<td align="left">Ã—</td>
<td align="left">âˆš</td>
</tr>
<tr>
<td align="left">æ ‡å‡†åŒ–</td>
<td align="left">ICE</td>
<td align="left">ICE</td>
<td align="left">Ã—</td>
<td align="left">KR</td>
</tr>
<tr>
<td align="left">ç»“æœæ–‡ä»¶</td>
<td align="left">hdf5ã€hmã€bychr(HDF5)</td>
<td align="left">SAMã€validpair</td>
<td align="left">SAM</td>
<td align="left">SAMã€MNDã€.hic</td>
</tr>
<tr>
<td align="left">ç‰¹ç‚¹</td>
<td align="left">æ¯”å¯¹ç»“æœå¯é ï¼Œå­˜å‚¨æ¶ˆè€—å°</td>
<td align="left">ç®€å•æ˜“ç”¨ï¼Œè¾“å‡ºç»“æœå¯è¯»</td>
<td align="left">è¿‡æ»¤éå¸¸ä¸¥æ ¼</td>
<td align="left">åç»­åˆ†ææ¥å£å¤šï¼Œjuiceboxå¯è§†åŒ–</td>
</tr>
</tbody></table>
<h1 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h1><p>HiFiåŠ©åŠ›åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿åŸºå› ç»„ç»„è£…ï¼ŒNC</p>
<blockquote>
<p>Allele-aware chromosome-level genome assembly and efficient transgene-free genome editing for the autotetraploid cultivated alfalfa</p>
</blockquote>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨Canué»˜è®¤å‚æ•°ï¼Œåˆ©ç”¨CCS clean readsç»„è£…contigsã€‚ç»„è£…å¾—åˆ°çš„Contig N50å€¼ä¸º459kbï¼Œæ€»é•¿åº¦ä¸º3.15GBã€‚</p>
<blockquote>
<p>We assembled contigs from CCS clean reads using Canu, with default parameters. The N50 values of the contig sets were 459 kb, with total lengths 3154 Mb.</p>
</blockquote>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨HiC-Proå°†Hi-C readsä¸contigs è¿›è¡Œæ¯”å¯¹ï¼Œäº§ç”Ÿæ¯”å¯¹BAMæ–‡ä»¶ã€‚</p>
<blockquote>
<p>Hi-C reads were aligned to contigs using <a href="https://pubmed.ncbi.nlm.nih.gov/26619908/">HiC-Pro(2015)</a>, yielding an alignment BAM file.</p>
</blockquote>
<p>ï¼ˆ3ï¼‰ä½¿ç”¨æ³¨é‡Šçš„è’ºè—œè‹œè“¿è›‹ç™½ä½œä¸ºå‚è€ƒï¼Œå®Œå…¨åŸºäºåŒæºçš„ç­–ç•¥æ³¨é‡Šcontigsã€‚å¯¹138,729ä¸ªåŒæºåŸºå› è¿›è¡Œäº†ç»“æ„æ³¨é‡Šã€‚ç”¨MCscanç”¨äºé‰´å®šcontigså’Œå‚è€ƒåŸºå› ç»„ä¹‹é—´çš„å…±çº¿æ€§ã€‚æ˜¾ç¤ºç´«èŠ±è‹œè“¿å’Œè’ºè—œè‹œè“¿ä¹‹é—´çš„é«˜å…±çº¿æ€§ã€‚ã€ä¸‹è½½çˆ¶æ¯æœ¬petunia refã€‘</p>
<blockquote>
<p>Contigs were annotated with a <font color="red"><strong>solely homology-based strategy</strong></font>, using annotated Medicago truncatula proteins as references. 138,729 homologous genes were structurally annotated. <font color="red"><strong>MCscan</strong> in <strong>Jcvi</strong></font> (<a href="https://zenodo.org/record/31631#.XpkUyTOeask">https://zenodo.org/record/31631#.XpkUyTOeask</a>) was used to identify <font color="red"><strong>synteny blocks</strong></font> between <strong>contigs and the reference</strong> genome. <font color="red"><strong>Contigs syntenic</strong> to M. truncatula were <strong>stacked and aligned</strong> to M. truncatula chromosomes</font>. The syntenic contigs are summarized in Supplementary Table 4.</p>
</blockquote>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/1.png" alt="STable4"></p>
<p>ï¼ˆ4ï¼‰ä½¿ç”¨å†…éƒ¨è„šæœ¬å¤„ç†BAMæ–‡ä»¶ï¼Œå»é™¤ç­‰ä½åŸºå› contigsä¹‹é—´çš„linksã€‚ä½¿ç”¨ALLHiCè½¯ä»¶ï¼Œ<font color="red">æå–ã€èšç±»å’Œé‡æ’Contigs</font> (Contigs syntenicä¸è’ºè—œè‹œè“¿æŸ“è‰²ä½“ä¸€è‡´)ï¼Œå¾—åˆ°åŸå§‹çš„scaffoldsã€‚</p>
<blockquote>
<p>An <strong>in-house script</strong> was used to <font color="red">prune the BAM</font> file and <font color="red">discard links between allelic contigs</font>. Contigs syntenic to one chromosome of M. truncatula, e.g., chr1, were extracted, sub-clustered and reordered using <font color="red">ALLHiC</font>, yielding a raw scaffold set.</p>
</blockquote>
<p>ï¼ˆ5ï¼‰<a href="https://pubmed.ncbi.nlm.nih.gov/27467250/">Juicebox</a>ç”¨äºä»¥å›¾å½¢å’Œäº¤äº’æ–¹å¼å¾®è°ƒç»„è£…çš„scaffoldsã€‚å‰ªè£äº†40ä¸ªæ€»é•¿åº¦è¾¾1800Mbçš„scaffolds ã€‚</p>
<blockquote>
<p>Juicebox45 was used for fine-tuning assembled scaffolds in a graphic and inter-active fashion. Forty scaffolds with a total length of 1800 Mb were cropped (Supplementary Table 5).</p>
</blockquote>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/2.png" alt="STable5"></p>
<p>ï¼ˆ6ï¼‰ åŸºäºç»„è£…çš„scaffoldï¼Œé€šè¿‡Hi-Cæ•°æ®ï¼Œæ¯ä¸ªunplaced contigè¢«åˆ†é…åˆ°äº’ä½œæœ€å¼ºçš„é‚£äº›contig clusteré‡Œã€‚</p>
<blockquote>
<p>Based on this scaffold assembly, each unplaced contig was assigned to the contig cluster, to which the contig was most connected by Hi-C data.</p>
</blockquote>
<p>ï¼ˆ7ï¼‰ä½¿ç”¨ALLHiCå¯¹é‚£äº›contig clusterså†æ¬¡è¿›è¡Œé‡æ’å’Œæ„å»ºscaffoldã€‚</p>
<blockquote>
<p>Those contig clusters were reordered and scaffolded using ALLHiC. </p>
</blockquote>
<p>ï¼ˆ8ï¼‰ä½¿ç”¨Juiceboxå¯¹scaffoldsè¿›è¡Œå¾®è°ƒï¼Œå¹¶ä»scaffoldsä¸Šå»é™¤ä¸ä¸€è‡´çš„contigsï¼Œäº§ç”Ÿæœ€ç»ˆçš„æŸ“è‰²ä½“åŸºå› ç»„ï¼Œå…¶åŒ…å«32æ¡æŸ“è‰²ä½“(8ä¸ªåŒæºç»„ï¼Œæ¯ä¸ªç»„ä¸­æœ‰4ä¸ªç­‰ä½åŸºå› æŸ“è‰²ä½“)ï¼Œæ€»é•¿åº¦ä¸º2738Mbï¼Œå’Œ419MbæœªæŒ‚è½½åˆ°æŸ“è‰²ä½“æ°´å¹³çš„åºåˆ—ã€‚</p>
<blockquote>
<p>Using Juicebox, scaffolds were fine-tuned and discordant contigs were removed from scaffolds, and the final chromosome assembly was generated, containing 32 chromosomes with a total length of 2738 Mb (Supplementary Table 6).</p>
</blockquote>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/3.png" alt="STable6"></p>
<h1 id="HiC-Pro-install"><a href="#HiC-Pro-install" class="headerlink" title="HiC-Pro install"></a>HiC-Pro install</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda env create -f ./HiC-Pro/environment.yml -p ///software/HiC_Pro_ENV</span><br><span class="line"><span class="comment">#ã€install env in my software dirã€‘</span></span><br><span class="line">conda activate env</span><br><span class="line"></span><br><span class="line">tar -zxvf HiC-Pro-master.tar.gz</span><br><span class="line"><span class="built_in">cd</span> HiC-Pro-master</span><br><span class="line"><span class="comment">## Edit config-install.txt file if necessary</span></span><br><span class="line">make configure</span><br><span class="line">make install<span class="comment"># failed </span></span><br><span class="line"><span class="comment">#(g++ -Wall -O2 -std=c++0x -o build_matrix /xtdisk/xueyb_group/wangchenA/software/HiC-Pro-3.1.0/scripts/src/build_matrix.cpp; mv build_matrix /xtdisk/xueyb_group/wangchenA/software/HiC-Pro-3.1.0/scripts)</span></span><br><span class="line"><span class="comment">#(g++ -Wall -O2 -std=c++0x -o cutsite_trimming /xtdisk/xueyb_group/wangchenA/software/HiC-Pro-3.1.0/scripts/src/cutsite_trimming.cpp; mv cutsite_trimming /xtdisk/xueyb_group/wangchenA/software/HiC-Pro-3.1.0/scripts)</span></span><br><span class="line"><span class="comment">#cp -Ri /xtdisk/xueyb_group/wangchenA/software/HiC-Pro-3.1.0 /usr/local/bin//HiC-Pro_3.1.0</span></span><br><span class="line"><span class="comment">#cp: cannot create directory â€˜/usr/local/bin//HiC-Pro_3.1.0â€™: Permission denied</span></span><br><span class="line"><span class="comment">#make: *** [Makefile:78: cp] Error 1</span></span><br><span class="line"></span><br><span class="line">but <span class="keyword">in</span> the bin file,it can be use?</span><br></pre></td></tr></table></figure>

<p>Make configure and make install, whats the function of those two steps?</p>
<h1 id="HiC-Pro-GitHub"><a href="#HiC-Pro-GitHub" class="headerlink" title="HiC-Pro-GitHub"></a><a href="https://github.com/nservant/HiC-Pro">HiC-Pro-GitHub</a></h1><p><a href="https://doi.org/10.1186/s13059-015-0831-x">Genome Biology 2015</a></p>
<p>HiC-Pro was designed to process Hi-C data, from <font color="red"><strong>raw fastq files</strong></font> (paired-end Illumina data) to <font color="red"><strong>normalized contact maps</strong></font>. It supports the main Hi-C protocols, including digestion protocols as well as protocols that do not require restriction enzymes such as DNase Hi-C. In practice, HiC-Pro was successfully <font color="blue"><strong>applied to many data-sets</strong></font> including dilution Hi-C, in situ Hi-C, DNase Hi-C, Micro-C, capture-C, capture Hi-C or HiChip data.<br>The pipeline is flexible, scalable and optimized. It can operate either on a single laptop or on a computational cluster. HiC-Pro is sequential and each step of the workflow can be run independantly.<br>HiC-Pro includes a fast implementatation of the iterative correction method (see the <a href="https://github.com/hiclib/iced">iced python package</a> for more information). Finally, HiC-Pro can use phasing data to build <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/AS.md">allele-specific contact maps</a>.</p>
<h2 id="HiC-Pro-annotation-files"><a href="#HiC-Pro-annotation-files" class="headerlink" title="HiC-Pro annotation files"></a>HiC-Pro annotation files</h2><p>In order to process the raw data, HiC-Pro requires three annotation files. Note that the pipeline is provided with some Human and Mouse annotation files.<br><strong>Please be sure that the chromosome names are the same than the ones used in your bowtie indexes !</strong></p>
<ul>
<li><strong>A BED file</strong> of the <font color="blue"><strong>restriction fragments after digestion</strong></font>. This file <font color="blue">depends</font> both of the <font color="blue"><strong>restriction enzyme</strong></font> and the <font color="blue"><strong>reference genome</strong></font>. See the <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/FAQ.md">FAQ</a> and the <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/UTILS.md">HiC-Pro utilities</a> for details about <font color="blue"><strong>how to generate</strong></font> this file. A few annotation files are provided with the HiC-Pro sources as examples. æ ¹æ®é™åˆ¶æ€§å†…åˆ‡é…¶æ¶ˆåŒ–çš„å‚è€ƒåŸºå› ç»„ä¿¡æ¯ .bedæ–‡ä»¶ã€‚é…¶åˆ‡å›¾è°±</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#exampleï¼š/PATH/TO/HiC-Pro_2.11.1/annotation</span></span><br><span class="line"> head HindIII_resfrag_hg19.bed</span><br><span class="line"> chr1   0       16007   HIC_chr1_1    0   +</span><br><span class="line"> chr1   16007   24571   HIC_chr1_2    0   +</span><br><span class="line"> chr1   24571   27981   HIC_chr1_3    0   +</span><br><span class="line"> (...)</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#GENOME_FRAGMENT = # å‚¨å­˜æ¶ˆåŒ–ç¢ç‰‡ä½ç½®ä¿¡æ¯çš„bedæ–‡ä»¶ï¼Œä¸€èˆ¬åœ¨HiC-Proçš„annotationæ–‡ä»¶å¤¹ä¸‹</span></span><br><span class="line"><span class="comment">#LIGATION_SITE = # é…¶åˆ‡ä½ç‚¹é‡è¿æ¥åçš„åºåˆ—</span></span><br><span class="line"><span class="comment">#æ³¨ï¼šGENOME_FRAGMENT å’Œ LIGATION_SITE å®Œå…¨å–å†³äºä½¿ç”¨äº†ä»€ä¹ˆé…¶ï¼Œä¸€èˆ¬HiCå»ºåº“çš„é…¶æ˜¯Hind IIIï¼Œæ‰€ä»¥è¦ä»”ç»†æ£€æŸ¥æ•°æ®æ¥æºçš„è¯´æ˜ã€‚ </span></span><br><span class="line">digest_genome.py -r A^AGCTT -o HindIII_resfrag_hg19.bed hg19_rCRSchrm.fa  </span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è½¯ä»¶è„šæœ¬äº§ç”ŸåŸºå› ç»„é…¶åˆ‡å›¾è°±ï¼Œè¾“å…¥å†…åˆ‡é…¶åç§°æˆ–è€…é…¶åˆ‡ä½ç‚¹åºåˆ—éƒ½å¯ä»¥ï¼Œç”¨æ³•ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">digest_genome.py -r A^AGCTT -o mm9_hindiii.bed mm9.fasta</span><br><span class="line">digest_genome.py -r hindiii -o mm9_hindiii.bed mm9.fasta</span><br></pre></td></tr></table></figure>

<p>NcoIã€BamHIã€EcoRIã€HindIIIã€NdeIã€XhoI, å‚è€ƒï¼š<a href="https://www.biomart.cn/experiment/430/457/741/43956.htm"><font color="red"><strong>å¸¸è§é™åˆ¶æ€§å†…åˆ‡é…¶è¯†åˆ«åºåˆ—(é…¶åˆ‡ä½ç‚¹)</strong></font></a></p>
<table>
<thead>
<tr>
<th align="left">é™åˆ¶æ€§å†…åˆ‡é…¶</th>
<th align="left">é…¶åˆ‡ä½ç‚¹ï¼Œ<code>^</code>ä¸ºåˆ‡å‰²ä½ç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">MboI</td>
<td align="left">^GATC</td>
</tr>
<tr>
<td align="left">DpnII</td>
<td align="left">^GATC</td>
</tr>
<tr>
<td align="left">BglII</td>
<td align="left">A^GATCT</td>
</tr>
<tr>
<td align="left">HindIII</td>
<td align="left">A^AGCTT</td>
</tr>
</tbody></table>
<ul>
<li><strong>A table file</strong> of chromosomesâ€™ size. This file can be easily find on the <font color="blue">UCSC genome browser</font>. Of note, pay attention to the contigs or scaffolds, and be aware that HiC-pro will generate a map per chromosomes pair. For model organisms such as Human or Mouse, which are well annotated, we usually recommand to remove all scaffolds. æŸ“è‰²ä½“å¤§å°çš„è¡¨æ ¼æ–‡ä»¶ã€‚ä»UCSCä¸‹è½½æŸ“è‰²ä½“é•¿åº¦æ–‡ä»¶ï¼Œæˆ–è‡ªå·±æ ¹æ®fastaåºåˆ—ç»Ÿè®¡é•¿åº¦</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#exampleï¼š/PATH/TO/HiC-Pro_2.11.1/annotation</span><br><span class="line">head chrom_hg19.sizes</span><br><span class="line">   chr1    249250621</span><br><span class="line">   chr2    243199373</span><br><span class="line">   chr3    198022430</span><br><span class="line">   chr4    191154276</span><br><span class="line">   chr5    180915260</span><br><span class="line">   chr6    171115067</span><br><span class="line">   chr7    159138663</span><br><span class="line">   ...</span><br></pre></td></tr></table></figure>

<p><font color="green"><strong>how?</strong></font> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">samtools faidx genome.fa</span><br><span class="line">awk â€˜&#123;print $1 &quot;t&quot; $2&#125;â€˜ genome.fa.fai &gt; genome_sizes.bed</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>The bowtie2 indexes</strong>. See the <a href="http://bowtie-bio.sourceforge.net/bowtie2/index.shtml">bowtie2 manual page</a> for details about how to create such indexes.</p>
</li>
<li><p>```sh<br>bowtie2-build hg19.fasta hg19</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## how to use</span><br><span class="line"></span><br><span class="line">```sh</span><br><span class="line">  HiC-Pro --help</span><br><span class="line">  usage : HiC-Pro -i INPUT -o OUTPUT -c CONFIG [-s ANALYSIS_STEP] [-p] [-h] [-v]</span><br><span class="line">  Use option -h|--help for more information</span><br><span class="line"></span><br><span class="line">  HiC-Pro 3.1.0</span><br><span class="line">  ---------------</span><br><span class="line">  OPTIONS</span><br><span class="line"></span><br><span class="line">   -i|--input INPUT : &#x27;input data folder&#x27;; contains a folder per sample with input files</span><br><span class="line">   -o|--output OUTPUT : &#x27;output folder&#x27;</span><br><span class="line">   -c|--conf CONFIG : &#x27;configuration file&#x27; for Hi-C processing</span><br><span class="line">   [-p|--parallel] : if specified run HiC-Pro on a cluster&#x27;?&#x27;</span><br><span class="line">   [-s|--step ANALYSIS_STEP] : run only a subset of the HiC-Pro workflow; &#x27;if not specified the complete workflow is run&#x27;</span><br><span class="line">      mapping: perform reads &#x27;alignment&#x27; - require fast files</span><br><span class="line">      proc_hic: perform Hi-C &#x27;filtering&#x27; - require BAM files</span><br><span class="line">      quality_checks: run Hi-C &#x27;quality control&#x27; plots</span><br><span class="line">      merge_persample: &#x27;merge&#x27; multiple inputs and remove duplicates if specified - require .validPairs files</span><br><span class="line">      build_contact_maps: &#x27;Build raw inter/intrachromosomal contact maps&#x27; - require .allValidPairs files</span><br><span class="line">      ice_norm : run ICE &#x27;normalization&#x27; on contact maps - require .matrix files</span><br><span class="line">   [-h|--help]: help</span><br><span class="line">   [-v|--version]: version</span><br></pre></td></tr></table></figure></li>
<li><p><font color="blue"><strong>Copy and edit</strong></font> the configuration file <font color="blue"><strong>â€˜config-hicpro.txtâ€™</strong>Â </font> in your <font color="blue"><strong>local folder</strong></font>. See the <a href="https://github.com/nservant/HiC-Pro/blob/master/doc/MANUAL.md">manual</a> for details about the configuration file</p>
</li>
<li><p>Put <font color="blue"><strong>all input files in a rawdata folder</strong></font>. The input files have to be organized with <font color="blue"><strong>one folder per sample</strong></font>, such as;</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">+ PATH_TO_MY_DATA</span><br><span class="line">  + sample1</span><br><span class="line">    ++ file1_R1.fastq.gz</span><br><span class="line">    ++ file1_R2.fastq.gz</span><br><span class="line">    ++ ...</span><br><span class="line">  + sample2</span><br><span class="line">    ++ file1_R1.fastq.gz</span><br><span class="line">    ++ file1_R2.fastq.gz</span><br><span class="line">  *...</span><br></pre></td></tr></table></figure>

<ul>
<li>Run HiC-Pro on your <font color="blue"><strong>laptop</strong></font> in standalone model</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">MY_INSTALL_PATH/bin/HiC-Pro -i <span class="string">&#x27;FULL&#x27;</span>_PATH_TO_DATA_FOLDER -o FULL_PATH_TO_OUTPUTS -c MY_LOCAL_CONFIG_FILE</span><br></pre></td></tr></table></figure>

<ul>
<li>Run HiC-Pro on a <font color="blue"><strong>cluster</strong></font> (TORQUE/SGE/SLURM/LSF)</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">MY_INSTALL_PATH/bin/HiC-Pro -i FULL_PATH_TO_DATA_FOLDER -o FULL_PATH_TO_OUTPUTS -c MY_LOCAL_CONFIG_FILE -p</span><br></pre></td></tr></table></figure>

<ul>
<li>In the latter <font color="blue">case[cluster]</font>, you will have the following message :</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Please run HiC-Pro in two steps :</span><br><span class="line"> 1- The following command will launch the parallel workflow through 12 torque jobs:</span><br><span class="line"> qsub HiCPro_step1.sh</span><br><span class="line"> 2- The second command will merge all outputs to generate the contact maps:</span><br><span class="line"> qsub HiCPro_step2.sh</span><br></pre></td></tr></table></figure>

<p>Execute the displayed command from the <font color="blue"><strong>output folder</strong></font>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">qsub HiCPro_step1.sh</span><br></pre></td></tr></table></figure>

<p>Once executed succesfully (may take several hours), run the step using:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">qsub HiCPro_step2.sh</span><br></pre></td></tr></table></figure>

<h2 id="config-editing"><a href="#config-editing" class="headerlink" title="config editing"></a>config editing</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#######################################################################</span></span><br><span class="line"><span class="comment">## SYSTEM AND SCHEDULER - Start Editing Here !!</span></span><br><span class="line"><span class="comment">#######################################################################</span></span><br><span class="line">N_CPU = 2</span><br><span class="line">LOGFILE = hicpro.log</span><br><span class="line">JOB_NAME =</span><br><span class="line">JOB_MEM =</span><br><span class="line">JOB_WALLTIME =</span><br><span class="line">JOB_QUEUE =</span><br><span class="line">JOB_MAIL =</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BOWTIE2_IDX_PATH =</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#######################################################################</span></span><br><span class="line"><span class="comment">## Digestion Hi-C</span></span><br><span class="line"><span class="comment">#######################################################################</span></span><br><span class="line">GENOME_FRAGMENT = HindIII_resfrag_hg19.bed</span><br><span class="line">LIGATION_SITE = AAGCTAGCTT</span><br><span class="line">MIN_FRAG_SIZE =</span><br><span class="line">MAX_FRAG_SIZE =</span><br><span class="line">MIN_INSERT_SIZE =</span><br><span class="line">MAX_INSERT_SIZE =</span><br><span class="line">MIN_MAPQ: æœ€ä½çš„è´¨é‡åˆ†æ•°ï¼Œç”¨äºç­›é€‰ï¼Œè¡¨ç¤ºä½äºè¯¥MAPQå€¼ä¼šè¢«è¿‡æ»¤</span><br><span class="line">BOWTIE2_IDX_PATH: åŸºå› ç»„bowtie2ç´¢å¼•è·¯å¾„ï¼Œeg:/path/hg19</span><br><span class="line">BOWTIE2_GLOBAL_OPTIONS: é»˜è®¤GLOBALæ¯”å¯¹è®¾ç½®</span><br><span class="line">BOWTIE2_LOCAL_OPTIONS: é»˜è®¤LOCALæ¯”å¯¹è®¾ç½®</span><br><span class="line">REFERENCE_GENOMEï¼š Bowtie2ç´¢å¼•å‰ç¼€</span><br><span class="line">GENOME_SIZEï¼š åŸºå› ç»„sizes bedæ–‡ä»¶</span><br><span class="line">GENOME_FRAGMENT: åŸºå› ç»„é…¶åˆ‡æ–‡ä»¶,eg. /path/hg19_HindIII.bed</span><br><span class="line">LIGATION_SITE: é…¶åˆ‡ä½ç‚¹æœ«ç«¯è¡¥å¹³å†æ¬¡è¿æ¥åå½¢æˆçš„åµŒåˆåºåˆ—ï¼Œeg. AAGCTAGCTT</span><br><span class="line">MIN_FRAG_SIZE: æœ€å°çš„ç†è®ºé…¶åˆ‡ç‰‡æ®µå¤§å°,eg. 100</span><br><span class="line">MAX_FRAG_SIZE: æœ€å¤§çš„ç†è®ºé…¶åˆ‡ç‰‡æ®µå¤§å°,eg. 100000</span><br><span class="line">MIN_INSERT_SIZE: æœ€å°çš„æ–‡åº“ç‰‡æ®µå¤§å°,eg.100</span><br><span class="line">MAX_INSERT_SIZE: æœ€å¤§çš„æ–‡åº“ç‰‡æ®µå¤§å°,eg.1000</span><br><span class="line"><span class="string">&#x27;BIN_SIZE:éœ€è¦ç”Ÿæˆçš„çŸ©é˜µåˆ†è¾¨ç‡ï¼ˆbp)&#x27;</span></span><br><span class="line">MATRIX_FORMATï¼šçŸ©é˜µçš„å½¢å¼ï¼Œupperè¡¨ç¤ºä¿ç•™ä¸ŠåŠéƒ¨åˆ†</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">BOWTIE2_IDX_PATH = <span class="comment"># bowtie2ç´¢å¼•æ–‡ä»¶ç›®å½•ï¼Œç´¢å¼•æ–‡ä»¶æå‰ä¸‹è½½æˆ–ç”¨bowtie2-buildç”Ÿæˆ</span></span><br><span class="line">REFERENCE_GENOME = <span class="comment"># bowtie2ç´¢å¼•çš„æ–‡ä»¶å</span></span><br><span class="line">GENOME_SIZE = <span class="comment"># æŸ“è‰²ä½“å¤§å°æ–‡ä»¶ï¼Œå¯ä»http://hgdownload.cse.ucsc.edu/goldenPath/ ä¸‹è½½</span></span><br><span class="line">GENOME_FRAGMENT = <span class="comment"># å‚¨å­˜æ¶ˆåŒ–ç¢ç‰‡ä½ç½®ä¿¡æ¯çš„bedæ–‡ä»¶ï¼Œä¸€èˆ¬åœ¨HiC-Proçš„annotationæ–‡ä»¶å¤¹ä¸‹</span></span><br><span class="line">LIGATION_SITE = AAGCTAGCTT<span class="comment"># é…¶åˆ‡ä½ç‚¹é‡è¿æ¥åçš„åºåˆ—</span></span><br><span class="line"><span class="comment"># æ³¨ï¼šGENOME_FRAGMENT å’Œ LIGATION_SITE å®Œå…¨å–å†³äºä½¿ç”¨äº†ä»€ä¹ˆé…¶ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯Hind IIIï¼Œæ‰€ä»¥è¦ä»”ç»†æ£€æŸ¥æ•°æ®æ¥æºçš„è¯´æ˜ã€‚ </span></span><br><span class="line">PAIR2_EXT = <span class="comment"># æ ¹æ®æ–‡ä»¶åç§°ï¼Œåˆ†åˆ«è¾“å…¥åŒç«¯æ•°æ®æ–‡ä»¶åç§°ï¼Œä¸ç”¨è¾“å…¥åç¼€</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#???GENOME_SIZE = åœ¨å»ºç«‹çš„ç´¢å¼•ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼š</span></span><br><span class="line">cat &gt;chrom_bacteria.sizes  <span class="comment">#åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶cat &gt; filenameï¼Œæ–‡ä»¶åæˆ‘æ˜¯å‚è€ƒhicproçš„é…ç½®ç¤ºä¾‹ </span></span><br><span class="line">Chromosome 4016942  <span class="comment">#åœ¨æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œè¡¨æ˜è¿™ä¸ªå‚è€ƒåŸºå› çš„å¤§å°æ˜¯4016942bp,1bpå³ä¸º1ä¸ªç¢±åŸºå¯¹ï¼ˆbase pairï¼‰</span></span><br></pre></td></tr></table></figure>

<h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><p>The test dataset and associated results are available <a href="https://zerkalo.curie.fr/partage/HiC-Pro/">here</a>. Small fastq files (2M reads) extracted from the Dixon et al. 2012 paper are available for test.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">## Get the data. Will download a test_data folder and a configuration file</span></span><br><span class="line"> wget https://zerkalo.curie.fr/partage/HiC-Pro/HiCPro_testdata.tar.gz &amp;&amp; tar -zxvf HiCPro_testdata.tar.gz</span><br><span class="line"></span><br><span class="line"> <span class="comment">## Edit the configuration file and set the path to Human bowtie2 indexes</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">## Run HiC-Pro</span></span><br><span class="line"> time HICPRO_INSTALL_DIR/bin/HiC-Pro -c config_test_latest.txt -i test_data -o hicpro_latest_test</span><br></pre></td></tr></table></figure>

<h1 id="HIC-PROâ€™S-DOC"><a href="#HIC-PROâ€™S-DOC" class="headerlink" title="HIC-PROâ€™S DOC"></a><a href="http://nservant.github.io/HiC-Pro/">HIC-PROâ€™S DOC</a></h1><h1 id="åˆ†æ­¥åŸç†"><a href="#åˆ†æ­¥åŸç†" class="headerlink" title="åˆ†æ­¥åŸç†"></a>åˆ†æ­¥åŸç†</h1><p>refï¼š<a href="https://www.jianshu.com/p/76533e6d6152">https://www.jianshu.com/p/76533e6d6152</a></p>
<p><img src="/blog/2022/03/09/2022-03-09-HiFi-5-HiC-Pro/4.png" alt="img"></p>
<ul>
<li><p><font color="red"><strong>æ¯”å¯¹ã€è¿‡æ»¤HiCæ¯”å¯¹ç»“æœã€æ£€æµ‹æœ‰æ•ˆHiCåºåˆ—ã€ç»“æœåˆå¹¶ã€æ„å»ºHiCå…³è”å›¾è°±ã€å…³è”å›¾è°±æ ‡å‡†åŒ–ã€‚</strong></font></p>
</li>
<li><p>HiC-Proå¯è¾“å‡ºå„ä¸ªå°ºåº¦çš„HiC<font color="red">æ ‡å‡†åŒ–äº’ä½œå›¾è°±</font>ï¼Œä»æ¯ä¸ª<font color="red">çª—å£5Kbåˆ°1Mb</font>ï¼Œçª—å£è¶Šå¤§ï¼Œç”Ÿæˆäº’ä½œå…³ç³»è¶Šå°‘ï¼Œè®¡ç®—æ—¶é—´å°±è¶Šå°‘ï¼Œåä¹‹è¶Šå¤šã€‚åŒæ—¶HiC-Proèƒ½ä¸ä¸‹æ¸¸å¯è§†åŒ–è½¯ä»¶<font color="red"><strong>HiCPlotter</strong></font>ç­‰å…¼å®¹ï¼Œè¾“å‡ºæ–‡ä»¶å¯ç›´æ¥ç”¨äºå¯è§†åŒ–åˆ†æã€‚</p>
</li>
<li><p>HiC-Pro<font color="red">è‡ªåŠ¨åŒ–æ¯”å¯¹ï¼Œæ ‡å‡†åŒ–å’Œæ„å»ºç›¸äº’ä½œç”¨çŸ©é˜µ</font>ï¼Œåœ¨å¤„ç†å¤šæ ·åŒ–çš„æµ‹åºæ•°æ®æ—¶ï¼ŒHiC-Proèƒ½å¤Ÿ<strong>æ£€æµ‹å’Œè‡ªåŠ¨è¿‡æ»¤</strong>æµ‹åºæ•°é‡å·®çš„readså’Œæ— æ•ˆç‰‡æ®µã€‚</p>
</li>
</ul>
<h2 id="1-Reads-Mapping"><a href="#1-Reads-Mapping" class="headerlink" title="1.Reads Mapping"></a>1.Reads Mapping</h2><p>å°†fastqæ–‡ä»¶ç”¨bowtie2 mappingä¸€æ¬¡ï¼ŒæŸ¥çœ‹logï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat mapping_step1.log</span><br><span class="line"><span class="comment">###mapping fastq to reference genome , å°†unmappingçš„read å¦å­˜ä¸º unmap.fastq</span></span><br><span class="line">/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 30 --score-min L,-0.6,-0.2 --end-to-end --reorder --un bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap.fastq --rg-id BMG --rg SM:SRR400264_00_R2 -p 20 -x /PATH/TO/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U rawdata/dixon_2M/SRR400264_00_R2.fastq.gz 2&gt;&gt; logs/dixon_2M/SRR400264_00_R2_bowtie2.log| /PATH/TO/samtools/samtools-1.6/bin/samtools view -F 4 -bS - &gt; bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.bam</span><br><span class="line"></span><br><span class="line">/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 30 --score-min L,-0.6,-0.2 --end-to-end --reorder --un bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap.fastq --rg-id BMG --rg SM:SRR400264_00_R1 -p 20 -x /PATH/TO/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U rawdata/dixon_2M/SRR400264_00_R1.fastq.gz 2&gt;&gt; logs/dixon_2M/SRR400264_00_R1_bowtie2.log| /PATH/TO/samtools/samtools-1.6/bin/samtools view -F 4 -bS - &gt; bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.bam</span><br></pre></td></tr></table></figure>

<p>ç»“æœæ–‡ä»¶</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">|   |-- bwt2_global</span><br><span class="line">|   |   |-- dixon_2M</span><br><span class="line">|   |   |   |-- SRR400264_00_R1_hg19.bwt2glob.bam</span><br><span class="line">|   |   |   |-- SRR400264_00_R1_hg19.bwt2glob.unmap.fastq</span><br><span class="line">|   |   |   |-- SRR400264_00_R2_hg19.bwt2glob.bam</span><br><span class="line">|   |   |   |-- SRR400264_00_R2_hg19.bwt2glob.unmap.fastq</span><br><span class="line">|   |   `-- dixon_2M_2</span><br><span class="line">|   |       |-- SRR400264_01_R1_hg19.bwt2glob.bam</span><br><span class="line">|   |       |-- SRR400264_01_R1_hg19.bwt2glob.unmap.fastq</span><br><span class="line">|   |       |-- SRR400264_01_R2_hg19.bwt2glob.bam</span><br><span class="line">|   |       |-- SRR400264_01_R2_hg19.bwt2glob.unmap.fastq</span><br></pre></td></tr></table></figure>

<p>æœ‰mappingå’Œunmappingã€‚å› ä¸ºreadæ˜¯åµŒåˆåŸºå› ã€‚mappingä¸Šçš„æ˜¯èƒŒæ™¯åŸºå› ç»„ã€‚<font color="blue">unmappingéœ€è¦ä¸‹ä¸€æ­¥å¤„ç†</font>ã€‚</p>
<h2 id="2-ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤"><a href="#2-ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤" class="headerlink" title="2. ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤"></a>2. ç‰‡æ®µåˆ†é…å’Œè¿‡æ»¤</h2><p>æŸ¥çœ‹log</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat mapping_step2.log</span><br><span class="line"><span class="comment">### é…¶åˆ‡</span></span><br><span class="line">/PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/cutsite_trimming --fastq bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap.fastq --cutsite AAGCTAGCTT --out bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_trimmed.fastq &gt; logs/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_readsTrimming.log 2&gt;&amp;1</span><br><span class="line">/PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/cutsite_trimming --fastq bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap.fastq --cutsite AAGCTAGCTT --out bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_trimmed.fastq &gt; logs/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_readsTrimming.log 2&gt;&amp;1</span><br><span class="line"><span class="comment">### å†ç”¨bowtie2 mappingä¸€æ¬¡</span></span><br><span class="line">/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 20 --score-min L,-0.6,-0.2 --end-to-end --reorder --rg-id BML --rg SM:SRR400264_00_R1_hg19.bwt2glob.unmap -p 20 -x /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_trimmed.fastq 2&gt;&gt; logs/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_bowtie2.log | /PATH/TO/samtools/samtools-1.6/bin/samtools view -bS - &gt; bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_bwt2loc.bam</span><br><span class="line">/PATH/TO/bowtie2/bowtie2-2.3.3.1/bowtie2 --very-sensitive -L 20 --score-min L,-0.6,-0.2 --end-to-end --reorder --rg-id BML --rg SM:SRR400264_00_R2_hg19.bwt2glob.unmap -p 20 -x /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/Bowtie2Index/hg19 -U bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_trimmed.fastq 2&gt;&gt; logs/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_bowtie2.log | /PATH/TO/samtools/samtools-1.6/bin/samtools view -bS - &gt; bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_bwt2loc.bam</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€æ­¥å°†unmappingç»“æœï¼Œç”¨é…¶åˆ‡ä½ç‚¹åˆ†å‰²ï¼Œç„¶åå°†åˆ†å‰²ç»“æœï¼Œå†mappingä¸€æ¬¡ã€‚å¾—åˆ°ç»“æœ</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">|   |-- bwt2_local</span><br><span class="line">|       |-- dixon_2M</span><br><span class="line">|       |   |-- SRR400264_00_R1_hg19.bwt2glob.unmap_bwt2loc.bam</span><br><span class="line">|       |   |-- SRR400264_00_R1_hg19.bwt2glob.unmap_trimmed.fastq</span><br><span class="line">|       |   |-- SRR400264_00_R2_hg19.bwt2glob.unmap_bwt2loc.bam</span><br><span class="line">|       |   |-- SRR400264_00_R2_hg19.bwt2glob.unmap_trimmed.fastq</span><br><span class="line">|       |-- dixon_2M_2</span><br><span class="line">|           |-- SRR400264_01_R1_hg19.bwt2glob.unmap_bwt2loc.bam</span><br><span class="line">|           |-- SRR400264_01_R1_hg19.bwt2glob.unmap_trimmed.fastq</span><br><span class="line">|           |-- SRR400264_01_R2_hg19.bwt2glob.unmap_bwt2loc.bam</span><br><span class="line">|           |-- SRR400264_01_R2_hg19.bwt2glob.unmap_trimmed.fastq</span><br></pre></td></tr></table></figure>

<h2 id="3-mapping-combine-log"><a href="#3-mapping-combine-log" class="headerlink" title="3. mapping_combine.log"></a>3. mapping_combine.log</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat mapping_combine.log</span><br><span class="line"></span><br><span class="line"><span class="comment">### å°†globalçš„bamä¸localçš„bamç”¨samtools merge</span></span><br><span class="line">/PATH/TO/samtools/samtools-1.6/bin/samtools merge -@ 20 -n -f bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.bam bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R1_hg19.bwt2glob.unmap_bwt2loc.bam</span><br><span class="line">/PATH/TO/samtools/samtools-1.6/bin/samtools merge -@ 20 -n -f bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam bowtie_results/bwt2_global/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.bam bowtie_results/bwt2_local/dixon_2M/SRR400264_00_R2_hg19.bwt2glob.unmap_bwt2loc.bam</span><br><span class="line"></span><br><span class="line"><span class="comment">### sort</span></span><br><span class="line">/PATH/TO/samtools/samtools-1.6/bin/samtools sort -@ 20 -n -T tmp/SRR400264_00_R2_hg19 -o bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam</span><br><span class="line">/PATH/TO/samtools/samtools-1.6/bin/samtools sort -@ 20 -n -T tmp/SRR400264_00_R1_hg19 -o bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam</span><br><span class="line"></span><br><span class="line">[bam_sort_core] merging from 0 files and 20 in-memory blocks...</span><br><span class="line">[bam_sort_core] merging from 0 files and 20 in-memory blocks...</span><br><span class="line"></span><br><span class="line"><span class="comment">### æ”¹å</span></span><br><span class="line">mv bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam</span><br><span class="line">mv bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.sorted.bam bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam</span><br></pre></td></tr></table></figure>

<h2 id="4ã€merge"><a href="#4ã€merge" class="headerlink" title="4ã€merge"></a>4ã€merge</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### å°†R1ä¸R2 mergeä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚</span></span><br><span class="line">cat mergeSAM.log</span><br><span class="line">/PATH/TO/python/python-2.7.10/bin/python /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/mergeSAM.py -q 0 -t -v -f bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam -r bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam -o bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam</span><br><span class="line"><span class="comment">## mergeBAM.py</span></span><br><span class="line"><span class="comment">## forward= bowtie_results/bwt2/dixon_2M/SRR400264_00_R1_hg19.bwt2merged.bam</span></span><br><span class="line"><span class="comment">## reverse= bowtie_results/bwt2/dixon_2M/SRR400264_00_R2_hg19.bwt2merged.bam</span></span><br><span class="line"><span class="comment">## output= bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam</span></span><br><span class="line"><span class="comment">## min mapq= 0</span></span><br><span class="line"><span class="comment">## report_single= False</span></span><br><span class="line"><span class="comment">## report_multi= False</span></span><br><span class="line"><span class="comment">## verbose= True</span></span><br><span class="line"><span class="comment">## Merging forward and reverse tags ...</span></span><br></pre></td></tr></table></figure>

<h2 id="5ã€åˆ©ç”¨HiCProçš„mapped-2hic-fragments-pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯"><a href="#5ã€åˆ©ç”¨HiCProçš„mapped-2hic-fragments-pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯" class="headerlink" title="5ã€åˆ©ç”¨HiCProçš„mapped_2hic_fragments.pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯"></a>5ã€åˆ©ç”¨HiCProçš„mapped_2hic_fragments.pyç¨‹åºå°†æ¯”å¯¹ç»“æœè½¬åŒ–ä¸ºHi-Cç‰‡æ®µä¿¡æ¯</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat mapped_2hic_fragments.log</span><br><span class="line">/PATH/TO/python /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/scripts/mapped_2hic_fragments.py -v -S -t 100 -m 100000 -s 100 -l 600 -a -f /PATH/TO/HiC-Pro_2.11.1/annotation/HindIII_resfrag_hg19.bed -r bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam -o hic_results/data/dixon_2M</span><br><span class="line"><span class="comment">## overlapMapped2HiCFragments.py</span></span><br><span class="line"><span class="comment">## mappedReadsFile= bowtie_results/bwt2/dixon_2M/SRR400264_00_hg19.bwt2pairs.bam</span></span><br><span class="line"><span class="comment">## fragmentFile= /PATH/TO/HiC-Pro/HiC-Pro_2.11.1/annotation/HindIII_resfrag_hg19.bed</span></span><br><span class="line"><span class="comment">## minInsertSize= 100</span></span><br><span class="line"><span class="comment">## maxInsertSize= 600</span></span><br><span class="line"><span class="comment">## minFragSize= 100</span></span><br><span class="line"><span class="comment">## maxFragSize= 100000</span></span><br><span class="line"><span class="comment">## allOuput= True</span></span><br><span class="line"><span class="comment">## SAM ouput= True</span></span><br><span class="line"><span class="comment">## verbose= True</span></span><br></pre></td></tr></table></figure>

<p>å†å¯¹è¾“å‡ºçš„valid pairsæ–‡ä»¶æ’åºï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">LANG=en; sort -T tmp -k2,2V -k3,3n -k5,5V -k6,6n -o hic_results/data/sample/sample_sample_genome_ref.bwt2pairs.validPairs hic_results/data/sample/sample_sample_genome_ref.bwt2pairs.validPairs</span><br></pre></td></tr></table></figure>

<h2 id="6-å¯¹æ‰€æœ‰çš„valid-pairsè¿›è¡Œåˆå¹¶"><a href="#6-å¯¹æ‰€æœ‰çš„valid-pairsè¿›è¡Œåˆå¹¶" class="headerlink" title="6 å¯¹æ‰€æœ‰çš„valid pairsè¿›è¡Œåˆå¹¶"></a>6 å¯¹æ‰€æœ‰çš„valid pairsè¿›è¡Œåˆå¹¶</h2><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">LANG=en; sort -T tmp -S <span class="number">50</span>% -k2,<span class="number">2</span>V -k3,<span class="number">3</span>n -k5,<span class="number">5</span>V -k6,<span class="number">6</span>n -m hic_results/data/dixon_2M_2/SRR400264_01_hg19.bwt2pairs.validPairs | awk -F<span class="string">&quot;\t&quot;</span> <span class="string">&#x27;BEGIN&#123;c1=0;c2=0;s1=0;s2=0&#125;(c1!=<span class="subst">$2</span> || c2!=<span class="subst">$5</span> || s1!=<span class="subst">$3</span> || s2!=<span class="subst">$6</span>)&#123;print;c1=<span class="subst">$2</span>;c2=<span class="subst">$5</span>;s1=<span class="subst">$3</span>;s2=<span class="subst">$6</span>&#125;&#x27;</span> &gt; hic_results/data/dixon_2M_2/dixon_2M_2.allValidPairs</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆæœ€ç»ˆæ–‡ä»¶dixon_2M_2.allValidPairsã€‚</p>
<p>è¿™ä¸ªæ–‡ä»¶è¿˜ä¸èƒ½å¯è§†åŒ–ï¼Œå¦‚æœè¦å¯è§†åŒ–ï¼Œä¸€èˆ¬åœ¨juceboxé‡Œé¢æŸ¥çœ‹ã€‚éœ€è¦ç”¨é…å¥—çš„hicpro2juicebox.shæ¥è½¬åŒ–ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## e.g.1</span></span><br><span class="line">HICPRO_PATH/bin/utils/hicpro2juicebox.sh -i hicpro_res/hic_results/data/dixon_2M/dixon_2M_allValidPairs -g hg19 -j /usr/<span class="built_in">local</span>/juicebox/juicebox_clt_1.4.jar</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-j jar</span><br><span class="line">/PATH/TO/juicer/juicer/UGER/scripts/juicer_tools.jar</span><br></pre></td></tr></table></figure>

<h1 id="HiC-Pro-è¾“å‡º"><a href="#HiC-Pro-è¾“å‡º" class="headerlink" title="HiC-Pro è¾“å‡º"></a>HiC-Pro è¾“å‡º</h1><p>å…±æœ‰<strong>bowtie_results</strong>å’Œ<strong>hic_results</strong>ä¸¤ä¸ªç»“æœæ–‡ä»¶å¤¹ã€‚</p>
<p>å…¶ä¸­<strong>bowtie_results</strong>ä¸‹ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼šbwt2ã€bwt2_globalå’Œbwt2_localï¼Œåˆ†åˆ«æ˜¯åºåˆ—æ¯”å¯¹ç»“æœã€<font color="blue">æŸ“è‰²ä½“é—´</font>å…³è”æ¯”å¯¹ç»“æœå’Œ<font color="blue">æŸ“è‰²ä½“å†…</font>éƒ¨å…³è”æ¯”å¯¹ç»“æœã€‚bwt2æ–‡ä»¶å¤¹æœ‰æ•°æ®ç»Ÿè®¡ç»“æœè¾“å‡ºæ–‡ä»¶ï¼Œå¦‚mpairstatæ–‡ä»¶ã€‚</p>
<p><strong>hic_results</strong>æ–‡ä»¶å¤¹ä¸‹å…±æœ‰dataã€matrixä»¥åŠpicä¸‰ä¸ªæ–‡ä»¶å¤¹ã€‚</p>
<ul>
<li><p>dataæ–‡ä»¶å¤¹ä¸‹æ˜¯æ¯”å¯¹ä¸Šçš„æœ‰æ•ˆåºåˆ—å¯¹ï¼Œæ–‡ä»¶æœ«å°¾ä¸º_allValidPairsåˆå¹¶åçš„pairsæ•°æ®</p>
<p><code>DEPairs</code>:Dangling end pairsæ•°æ®</p>
<p><code>DumpPairs</code>:å®é™…ç‰‡æ®µé•¿åº¦å’Œç†è®ºç‰‡æ®µé•¿åº¦ä¸åŒçš„æ•°æ®</p>
<p><code>REPairs</code>ï¼šé…¶åˆ‡ç‰‡æ®µé‡æ–°è¿æ¥çš„pairs</p>
<p><code>FiltePairs</code>:MAPQè¿‡ä½çš„pairs</p>
<p><code>SCPairs</code>ï¼šç‰‡æ®µè‡ªè¿çš„pairs</p>
</li>
<li><p>picæ–‡ä»¶å¤¹ä¸‹æ˜¯å„ç±»ç»“æœæ•°æ®ç»Ÿè®¡ï¼›å­˜æ”¾ç»Ÿè®¡åˆ†æå›¾ç‰‡</p>
<p>HiCæ–‡åº“ç‰‡æ®µåˆ†å¸ƒæ–‡ä»¶</p>
<p>åŒç«¯æ¯”å¯¹è¿‡æ»¤è´¨æ§å›¾</p>
<p>æœ‰æ•ˆæ•°æ®è¿‡æ»¤è´¨æ§å›¾</p>
<p>é…å¯¹æ•°æ®ä¸åŒç±»å‹æ•°æ®æ¯”ä¾‹å±•ç¤ºå›¾</p>
</li>
<li><p>matrixæ–‡ä»¶å¤¹ä¸‹åˆ†ä¸º iced(æ ‡å‡†åŒ–) å’Œ raw(åŸå§‹) ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«æ ‡å‡†åŒ–åçš„å…³è”çŸ©é˜µå’Œåˆå§‹çš„å…³è”çŸ©é˜µã€‚å­˜æ”¾ä¸åŒåˆ†è¾¨ç‡çŸ©é˜µæ–‡ä»¶</p>
</li>
</ul>
<p>åç»­compartmentï¼ŒTADå’Œloopï¼Ÿ</p>
<h1 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzUyMTk4ODM0OQ==&mid=2247483678&idx=1&sn=a1aa97892723f6fb51bd3b01a6441e6c&chksm=f9d3f08ccea4799af0a4401e938307a3f6e860239e905deb6963a82a8fc799a4af504e96bc10&scene=178&cur_album_id=1399424041152528385#rd">å¾®ä¿¡å…¬ä¼—å·</a></p>
<p><a href="https://weixin.sogou.com/weixin?type=2&query=%E6%9F%93%E8%89%B2%E8%B4%A8%E9%AB%98%E7%BA%A7%E7%BB%93%E6%9E%84%E7%A0%94%E7%A9%B6%E4%B9%8BHi-C%E6%8A%80%E6%9C%AF%EF%BC%88%E4%B8%8B%E7%AF%87%EF%BC%89%E2%80%94%E2%80%94%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AE%9E%E6%88%98&ie=utf8&s_from=input&_sug_=n&_sug_type_=&w=01019900&sut=935&sst0=1646835948011&lkt=2,1646835946980,1646835947908">æŸ“è‰²è´¨é«˜çº§ç»“æ„ç ”ç©¶ä¹‹Hi-CæŠ€æœ¯ï¼ˆä¸‹ç¯‡ï¼‰â€”â€”å¯è§†åŒ–å®æˆ˜</a></p>
<h1 id="Error-debug"><a href="#Error-debug" class="headerlink" title="Error debug"></a>Error debug</h1><blockquote>
<p>HIC-PRO DOES NOT GENERATE ANY MAPS<br>HiC-Pro is using the chrom.sizes files to build the map.<br>Be sure that your chromosome names are the same in all annotations files (bowtie2 indexes, restriction fragments, chromosome sizes, etc.)</p>
</blockquote>
<blockquote>
<p>hiclib and mirnylib are not compatible with python 2.5 and 3.x, but work fine with py 2.6, 2.7</p>
<p>hiclibä¸»è¦ç”¨äºæ•°æ®æ ‡å‡†åŒ–ï¼Œhicproå¯ä»¥ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å®‰è£…hiclib? æˆ–è€…æ˜¯æƒ³æ¯”è¾ƒä¸¤è€…åˆ†æçš„ç»“æœï¼Ÿ</p>
<p>HiC-Proéœ€è¦pythonç‰ˆæœ¬&gt;=3.7, å®‰è£…3.9</p>
</blockquote>
<p><strong>Error1</strong>ï¼šdirectly use hicpro on the cluster,  â€”qual å¤šä¸€ä¸ª-æ— æ³•è§£å†³ï¼Œè‡ªå·±å®‰è£…<br>/software/biosoft/software/bowtie2-2.2.9/bowtie2-align-s: <font color="red"><strong>unrecognized option â€˜â€”qualsâ€™</strong></font><br>Bowtie 2 version 2.2.9 by Ben Langmead (<a href="mailto:&#108;&#97;&#x6e;&#103;&#109;&#101;&#97;&#x40;&#x63;&#x73;&#46;&#106;&#104;&#117;&#x2e;&#101;&#x64;&#117;">&#108;&#97;&#x6e;&#103;&#109;&#101;&#97;&#x40;&#x63;&#x73;&#46;&#106;&#104;&#117;&#x2e;&#101;&#x64;&#117;</a>, <a href="http://www.cs.jhu.edu/~langmea">www.cs.jhu.edu/~langmea</a>)<br>Usage:<br>  bowtie2 [options]* -x <bt2-idx> {-1 <m1> -2 <m2> | -U <r>} [-S <sam>]</sam></r></m2></m1></bt2-idx></p>
<p>Encountered internal Bowtie 2 exception (#1)<br>Command: /software/biosoft/software/bowtie2-2.2.9/bowtie2-align-s â€“wrapper basic-0 â€“very-sensitive -L 30 â€“score-min L,-0.6,-0.2 â€“end-to-end â€“reorder â€“rg-id BMG â€“rg SM:L3_R1 <font color="red"><strong>â€”quals</strong></font> -p 10 -x /xtdisk/xueyb_group/wangchenA/Petunia_denovo/HiFi/02.bwa_mapping/primary//HiFi.p_ctg â€“passthrough -U /tmp/34683.unp<br>(ERR): bowtie2-align exited with value 1</p>
<p>è‡ªå·±å®‰è£…æ—¶ï¼Œå…ˆåˆ›å»ºcondaç¯å¢ƒï¼Œå†tar xzvfï¼Œç„¶å<font color="red"><strong>ç¼–è¾‘config-install.txtçš„prefix å†make configure &amp;&amp; make install</strong></font><br><strong>Error2</strong>åœ¨é”™è¯¯äº§ç”Ÿoutputæ–‡ä»¶å¤¹æ—¶å†æ¬¡è¿è¡Œç›´æ¥æŠ¥é”™stat: <font color="red"><strong>Bad file descriptorï¼Œå…ˆåˆ é™¤output_dir</strong></font><br>è®¾ç½®config-install.txt çš„prefixæ—¶è®¾ç½®æˆ///software/HiC-Pro<font color="red"><strong>/</strong></font><br>æŠ¥é”™ï¼š<br><strong>Error3</strong>ï¼šinstall in another dir HiC-Proï¼Œ PREFIX = /xtdisk/xueyb_group/wangchenA/software/HiC-Pro/<br>/xtdisk/xueyb_group/wangchenA/software/HiC-Pro/HiC-Pro-3.1.0/bin/../scripts//Makefile:48: /xtdisk/xueyb_group/wangchenA/software/HiC-Pro<font color="red"><strong>//</strong></font>config-system.txt: No such file or directory<br>make:  No rule to make target â€˜/xtdisk/xueyb_group/wangchenA/software/HiC-Pro<font color="red"><strong>//</strong></font>config-system.txtâ€™.  Stop.<br>The config-system.txt file is a file which should be within the installation folder.<br>æ£€æŸ¥config-system.txt å‘ç°å¤šäº†//<br>è®¾ç½®config-install.txt çš„prefixæ—¶è®¾ç½®æˆ///software/HiC-Proæ—¶ä¼š<font color="red"><strong>è‡ªåŠ¨äº§ç”Ÿè½¯ä»¶åæ–‡ä»¶å¤¹</strong></font>ï¼Œåé¢<font color="red">å¤šåŠ æ–œæ /ç›´æ¥æŠ¥é”™</font></p>
<p><strong>successfully installed</strong>  </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(HiC_Pro_ENV) [HiC-Pro-3.1.0]$ vi config-install.txt </span><br><span class="line">PREFIX = ////software</span><br><span class="line">(HiC_Pro_ENV) [HiC-Pro-3.1.0]$ make configure</span><br><span class="line">make -f ./scripts/install/Makefile CONFIG_SYS=./config-install.txt</span><br><span class="line">make[1]: Entering directory <span class="string">&#x27;/xtdisk/group/wangchenA/HiC-Pro-3.1.0&#x27;</span></span><br><span class="line">./scripts/install/install_dependencies.sh -c ./config-install.txt -p /xtdisk/group/wangchenA/software -o /xtdisk/group/wangchenA/software/HiC-Pro_3.1.0 -q</span><br><span class="line">Make sure internet connection works <span class="keyword">for</span> your shell prompt under current user<span class="string">&#x27;s privilege ...</span></span><br><span class="line"><span class="string">Starting HiC-Pro installation !</span></span><br><span class="line"><span class="string">Checking dependencies</span></span><br><span class="line"><span class="string">- Python libraries ...OK</span></span><br><span class="line"><span class="string">- R installation ...OK</span></span><br><span class="line"><span class="string">- Bowtie2 installation ...OK</span></span><br><span class="line"><span class="string">- Samtools installation ...OK</span></span><br><span class="line"><span class="string">Checking HiC-Pro configuration</span></span><br><span class="line"><span class="string">- Configuration for TORQUE/PBS system ...OK</span></span><br><span class="line"><span class="string">done !</span></span><br><span class="line"><span class="string">make[1]: Leaving directory &#x27;</span>/xtdisk/group/wangchenA/HiC-Pro-3.1.0<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">(/HiC_Pro_ENV) [HiC-Pro-3.1.0]$ make install</span></span><br><span class="line"><span class="string">(g++ -Wall -O2 -std=c++0x -o build_matrix /xtdisk/group/wangchenA/HiC-Pro-3.1.0/scripts/src/build_matrix.cpp; mv build_matrix /xtdisk/group/wangchenA/HiC-Pro-3.1.0/scripts)</span></span><br><span class="line"><span class="string">(g++ -Wall -O2 -std=c++0x -o cutsite_trimming /xtdisk/group/wangchenA/HiC-Pro-3.1.0/scripts/src/cutsite_trimming.cpp; mv cutsite_trimming /xtdisk/group/wangchenA/HiC-Pro-3.1.0/scripts)</span></span><br><span class="line"><span class="string">cp -Ri /xtdisk/group/wangchenA/HiC-Pro-3.1.0 /xtdisk/group/wangchenA/software/HiC-Pro_3.1.0</span></span><br><span class="line"><span class="string">HiC-Pro installed in /xtdisk/group/wangchenA/software/HiC-Pro_3.1.0 !</span></span><br></pre></td></tr></table></figure>

<p>Issue from: <a href="https://github.com/nservant/HiC-Pro/issues/289">https://github.com/nservant/HiC-Pro/issues/289</a></p>
<blockquote>
<p>you <font color="green"><strong>do not have the rigths</strong></font> to install HiC-Pro in <font color="green"><strong>/usr/local/bin</strong></font><br>Update the <font color="green"><strong>PREFIX= in the config-install.txt</strong></font> file before running the installation</p>
<p>You <font color="green"><strong>cannot install it in the path where you have downloaded it</strong> </font>!Please <font color="green"><strong>set another prefix</strong></font>.Note that it will <font color="green"><strong>create the HiC-Pro_3.0.0 folder by itself</strong></font></p>
</blockquote>
<p><font color="red"><strong>NOTICE</strong></font></p>
<ul>
<li>./configure â€“prefix=  &amp;&amp;  make  &amp;&amp;  make install</li>
<li>Vim config-install.txt PREFIX  &amp;&amp;  make configure  &amp;&amp;  make install</li>
</ul>
<hr>
<p><strong>bowtie_pairing] Error 1</strong><br><a href="https://github.com/nservant/HiC-Pro/issues/482">https://github.com/nservant/HiC-Pro/issues/482</a></p>
<p>Thu Sep 23 04:23:58 CST 2021<br>Pairing of R1 and R2 tags â€¦<br>Logs: logs/sample1/mergeSAM.log<br>make: *** [bowtie_pairing] Error 1</p>
<p>the mergeSAM.log<br>~/miniconda3/envs/hic-pro_env/bin/python ~/02_software/hic-pro/HiC-Pro-3.1.0/scripts/mergeSAM.py -q 10 -t -v -f bowtie_results/bwt2/sample1/XB_R1_merged_canu_asm.fasta.bwt2merged.bam -r bowtie_results/bwt2/sample1/XB_R2_merged_canu_asm.fasta.bwt2merged.bam -o bowtie_results/bwt2/sample1/XB_merged_canu_asm.fasta.bwt2pairs.bam<br>[E::idx_find_and_load] Could not retrieve index file for â€˜bowtie_results/bwt2/sample1/XB_R1_merged_canu_asm.fasta.bwt2merged.bamâ€™<br>[E::idx_find_and_load] Could not retrieve index file for â€˜bowtie_results/bwt2/sample1/XB_R2_merged_canu_asm.fasta.bwt2merged.bamâ€™</p>
<p>mapping_combine.log:<br>[bam_sort_core] merging from 6120 files and 36 in-memory blocksâ€¦<br>[E::hts_open_format] Failed to open file â€œtmp/XB_R1_merged_canu_asm.fasta.1018.bamâ€ : Too many open files<br>samtools sort: fail to open â€œtmp/XB_R1_merged_canu_asm.fasta.1018.bamâ€: Too many open files</p>
<p>yes well done ! So the samtools sort failed.<br>If you look at your command, -@ 36 -m 21M, means that it only has 21Mo to sort the file which is too few.<br>So it has to swap a lot, and generate too many tmp files.<br>This memory parameter is in your configuration file SORT_RAM. By default, it is set to 768M</p>
<p>Actually, the SORT_RAM parameter is divided by the number of CPUs<br>For instance, using 1000M with 4 CPUs means that samtools sort is run with 250M of RAM.<br>So it makes sense â€¦ you have 1000M / 36 CPU = 27M of RAM.<br>I would suggest to decrease the number of CPU to 8 for instance â€¦ this is enough ! or to increase again the SORT_RAM parameter.</p>
<hr>
<p>ref</p>
<p><a href="https://www.plob.org/article/24873.html">https://www.plob.org/article/24873.html</a></p>
]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>denovo-III</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Linuxé›†ç¾¤ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿã€‘ã€LSF/SGE/Slurm/PBSã€‘ã€gridã€‘</title>
    <url>/blog/2022/03/06/2022-03-06-Linux-grid/</url>
    <content><![CDATA[<p>è°ƒåº¦å™¨ä¸»è¦æ˜¯åŸºäº<strong>HPCåœºæ™¯</strong>çš„<strong>é›†ç¾¤ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ</strong>ï¼Œè‹±æ–‡<strong>Cluster Scheduler</strong>ã€<strong>Job Scheduler</strong>ç­‰ã€‚</p>
<p>å¸‚é¢ä¸»æµè°ƒåº¦å™¨æœ‰å››å¤§æµæ´¾ï¼š<font color="red"><strong>LSF   SGE   Slurm   PBS</strong></font></p>
<span id="more"></span>

<h1 id="ä»Cluster-é›†ç¾¤-ã€Grid-ç½‘æ ¼-åˆ°-Cloud-ï¼ˆäº‘ï¼‰"><a href="#ä»Cluster-é›†ç¾¤-ã€Grid-ç½‘æ ¼-åˆ°-Cloud-ï¼ˆäº‘ï¼‰" class="headerlink" title="ä»Cluster (é›†ç¾¤)ã€Grid (ç½‘æ ¼) åˆ° Cloud ï¼ˆäº‘ï¼‰"></a>ä»Cluster (é›†ç¾¤)ã€Grid (ç½‘æ ¼) åˆ° Cloud ï¼ˆäº‘ï¼‰</h1><p>ä¸ºè§£å†³å¤æ‚çš„<strong>è®¡ç®—å¯†é›†å‹</strong>å’Œ<strong>æ•°æ®å¯†é›†å‹</strong>é—®é¢˜ï¼Œéœ€è¦<strong>é«˜ç½‘ç»œæ€§èƒ½</strong>ã€<strong>å¿«é€Ÿå­˜å‚¨</strong>ã€<strong>å¤§é‡å†…å­˜</strong>ã€<strong>è¶…é«˜è®¡ç®—èƒ½åŠ›</strong>ã€‚</p>
<h2 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a><strong>Cluster</strong></h2><p>ä¸€ç»„æ¾æ•£é›†æˆçš„è®¡ç®—æœº<strong>è½¯ä»¶</strong>æˆ–<strong>ç¡¬ä»¶</strong>è¿æ¥èµ·æ¥<strong>é«˜åº¦ç´§å¯†åœ°åä½œ</strong>å®Œæˆè®¡ç®—å·¥ä½œã€‚åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€å°è®¡ç®—æœºã€‚é›†ç¾¤ç³»ç»Ÿä¸­çš„<font color="blue"><strong>å•ä¸ªè®¡ç®—æœº</strong></font>é€šå¸¸ç§°ä¸º<font color="blue"><strong>èŠ‚ç‚¹node</strong></font>ï¼Œé€šå¸¸é€šè¿‡<strong>å±€åŸŸç½‘(LAN)è¿æ¥</strong>,æ€§ä»·æ¯”æ¯”<font color="blue"><strong>å¤§å‹æœºï¼ˆmainframeï¼‰</strong></font>ç­‰<strong>é«˜</strong>ã€‚</p>
<h2 id="Grid"><a href="#Grid" class="headerlink" title="Grid"></a><strong>Grid</strong></h2><p>é€šè¿‡<strong>åˆ©ç”¨</strong>å¤§é‡<strong>å¼‚æ„è®¡ç®—æœº</strong>çš„<strong>æœªç”¨èµ„æº</strong>ï¼Œå¦‚<strong>CPU</strong>ã€<strong>ç£ç›˜å­˜å‚¨</strong>ç­‰ï¼Œå°†å…¶ä½œä¸ºåµŒå…¥åœ¨åˆ†å¸ƒå¼çš„ä¸€ä¸ª<strong>è™šæ‹Ÿçš„è®¡ç®—æœºé›†ç¾¤</strong>ï¼Œä¸ºè§£å†³<strong>å¤§è§„æ¨¡è®¡ç®—é—®é¢˜</strong>æä¾›ä¸€ä¸ª<strong>æ¨¡å‹</strong>ã€‚ç›®æ ‡æ˜¯<font color="blue">è§£å†³</font>å¯¹å•ä¸€è¶…çº§è®¡ç®—æœºéƒ½<font color="blue">å›°éš¾çš„å¤§é—®é¢˜</font>ï¼Œå¹¶åŒæ—¶ä¿æŒè§£å†³å¤šä¸ª<font color="blue">è¾ƒå°</font>é—®é¢˜çš„çµæ´»æ€§ã€‚ç½‘æ ¼å¤©ç”Ÿå°±æ˜¯åœ¨æœ¬åœ°ç½‘ã€åŸåŸŸç½‘æˆ–å¹¿åŸŸç½‘ä¸Šè¿›è¡Œåˆ†å¸ƒçš„ã€‚ç½‘æ ¼<font color="blue">å¯ä»¥åˆ†å¸ƒåœ¨ä»»ä½•åœ°æ–¹</font>ã€‚è€Œ<font color="blue">é›†ç¾¤</font>ç‰©ç†ä¸Šéƒ½åœ¨<font color="blue">ä¸€å¤„</font>ï¼Œé€šå¸¸æ˜¯<font color="blue">å±€åŸŸç½‘äº’è¿</font>ã€‚</p>
<h2 id="Cloud"><a href="#Cloud" class="headerlink" title="Cloud"></a><strong>Cloud</strong></h2><p>é›†ç¾¤æŠ€æœ¯å‘å±•è€Œæ¥ï¼ŒåŒºåˆ«åœ¨äº<font color="blue">é›†ç¾¤è™½ç„¶æŠŠå¤šå°æœºå™¨è”èµ·æ¥</font>ï¼Œä½†å…¶<font color="blue">æŸé¡¹<strong>å…·ä½“ä»»åŠ¡</strong>æ‰§è¡Œçš„æ—¶å€™è¿˜æ˜¯ä¼šè¢«è½¬å‘åˆ°<strong>æŸå°æœåŠ¡å™¨</strong>ä¸Š</font>ï¼Œè€Œ<font color="blue">äº‘</font>å¯ä»¥ç®€å•è®¤ä¸ºæ˜¯<font color="blue">ä»»åŠ¡è¢«<strong>åˆ†å‰²æˆå¤šä¸ªè¿›ç¨‹</strong>åœ¨<strong>å¤šå°æœåŠ¡å™¨</strong>ä¸Š<strong>å¹¶è¡Œè®¡ç®—</strong></font>ï¼Œä¼˜åŠ¿æ˜¯å¤§æ•°æ®é‡çš„æ“ä½œæ€§èƒ½éå¸¸å¥½ã€‚äº‘å¯ä»¥ä½¿ç”¨å»‰ä»·çš„PCæœåŠ¡å™¨ ï¼Œå¯ä»¥<font color="blue"><strong>ç®¡ç†</strong>å¤§æ•°æ®é‡ä¸å¤§é›†ç¾¤</font>ï¼Œ<font color="blue">å…³é”®æŠ€æœ¯åœ¨äºèƒ½å¤Ÿå¯¹äº‘å†…çš„åŸºç¡€è®¾æ–½è¿›è¡ŒåŠ¨æ€æŒ‰éœ€åˆ†é…ä¸ç®¡ç†</font>ã€‚äº‘è®¡ç®—ä¸å¹¶è¡Œè®¡ç®—ã€åˆ†å¸ƒå¼è®¡ç®—çš„åŒºåˆ«ï¼Œ<font color="red">å¯¹äºè®¡ç®—æœºç”¨æˆ·ï¼Œ<strong>å¹¶è¡Œè®¡ç®—</strong>ç”±<strong>å•ä¸ªç”¨æˆ·å®Œæˆ</strong>ï¼Œ<strong>åˆ†å¸ƒå¼è®¡ç®—</strong>ç”±<strong>å¤šä¸ªç”¨æˆ·åˆä½œ</strong>å®Œæˆï¼Œ<strong>äº‘è®¡ç®—</strong>æ˜¯<strong>æ²¡æœ‰ç”¨æˆ·å‚ä¸</strong>ï¼Œè€Œæ˜¯äº¤ç»™<strong>ç½‘ç»œå¦ä¸€ç«¯çš„æœåŠ¡å™¨å®Œæˆ</strong>ã€‚</font></p>
<p><img src="/blog/2022/03/06/2022-03-06-Linux-grid/1.png" alt="img"></p>
<p><img src="/blog/2022/03/06/2022-03-06-Linux-grid/2.png" alt="img"></p>
<p><strong>ç ”ç©¶å‘ç°</strong>ï¼š<strong>å•†åŠ¡è®¡ç®—æœº</strong>åªç”¨åˆ°å…¶<strong>åŠŸèƒ½</strong>çš„ <strong>10ï¼… â€”20ï¼…</strong>ã€‚24 å°æ—¶å†…ï¼Œä¸€èˆ¬çš„ <strong>UNIX æœåŠ¡å™¨</strong>åª<strong>åˆ©ç”¨ 10ï¼…</strong> çš„æ—¶é—´ï¼Œå¤§å‹æœºå¤§çº¦ 40ï¼…ï¼Œ<strong>å°å¼æœºå°‘äº 5ï¼…</strong>ã€‚åŒæ ·æ—¶é—´é—´éš”å†…ï¼Œåˆ©ç”¨<strong>ç½‘æ ¼è®¡ç®—</strong>ï¼Œ<strong>èµ„æºåˆ©ç”¨</strong>å¯ä»¥è¾¾åˆ° <strong>90ï¼…</strong> ã€‚</p>
<h2 id="ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»"><a href="#ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»" class="headerlink" title="ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»"></a><strong>ä»æœåŠ¡è§’åº¦çœ‹ç½‘æ ¼åˆ†ç±»</strong></h2><ul>
<li><p><strong>ä¸“ç”¨ç½‘æ ¼</strong></p>
<p>ç”±ç”¨äºç½‘æ ¼çš„<strong>ä¸“ç”¨ç¡¬ä»¶</strong>å’Œ<strong>è®¡ç®—èµ„æº</strong>ç»„æˆ, æä¾›äº†<strong>æœ€å¤§</strong>çš„<strong>æ§åˆ¶</strong>å’Œ<strong>çµæ´»æ€§</strong></p>
</li>
<li><p><strong>éä¸“ç”¨ç½‘æ ¼</strong></p>
<p>æ›´å¤šåœ°<strong>ä¾èµ–</strong>äº<strong>ç°æœ‰ç½‘ç»œ</strong>å’Œ<strong>åŸºç¡€è®¾æ–½</strong>ï¼Œå¯¹<strong>ç½‘ç»œå†³ç­–</strong>çš„<strong>æ§åˆ¶å¾ˆå°‘</strong>ç”šè‡³ä¸èƒ½æ§åˆ¶ã€‚</p>
</li>
<li><p><strong>åˆ†å¸ƒå¼ç½‘æ ¼</strong></p>
<p>åˆ†å¸ƒå¼ç½‘æ ¼ ç”±åœ¨ WAN æˆ– <font color="blue"><strong>Internet ä¸Šåˆ†å¸ƒçš„</strong>ã€<strong>ä½äºä»»ä½•ä½ç½®</strong></font>ï¼ˆå†…éƒ¨æˆ–å¤–éƒ¨ï¼‰çš„<strong>è®¡ç®—æœºèµ„æºç»„æˆ</strong>ã€‚</p>
</li>
</ul>
<h2 id="ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»"><a href="#ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»" class="headerlink" title="ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»"></a><strong>ä»åº”ç”¨è§’åº¦ç½‘æ ¼åˆ†ç±»</strong></h2><ul>
<li><p><strong>è®¡ç®—ç½‘æ ¼</strong></p>
<p>ä¾§é‡äº<font color="blue">è®¡ç®—å¯†é›†å‹</font>æ“ä½œçš„ç½‘æ ¼</p>
</li>
<li><p><strong>æ•°æ®ç½‘æ ¼</strong></p>
<p>å¤„ç†æ•°æ®çš„æ•°æ®è®¡ç®—ç³»ç»Ÿâ€”â€”<font color="blue">æ§åˆ¶å¤§é‡çš„åˆ†å¸ƒå¼æ•°æ®çš„å…±äº«å’Œç®¡ç†</font></p>
</li>
<li><p><strong>è®¾å¤‡ç½‘æ ¼</strong></p>
<p><font color="blue">ç”¨äº<strong>è¿œç¨‹æ§åˆ¶</strong>è®¾å¤‡å’Œåˆ†æäº§ç”Ÿçš„æ•°æ®</font></p>
</li>
</ul>
<h1 id="SGE-Sun-Grid-Engine"><a href="#SGE-Sun-Grid-Engine" class="headerlink" title="SGE [Sun Grid Engine]"></a>SGE [Sun Grid Engine]</h1><p><font color="red">ä»<strong>ç™»é™†èŠ‚ç‚¹</strong>ä¸Š<strong>å‘è®¡ç®—èŠ‚ç‚¹</strong>è¿›è¡Œ<strong>ä»»åŠ¡æŠ•é€’</strong></font>ã€‚SGEæˆ–è€…å…¶ä»–é›†ç¾¤ç®¡ç†å·¥ä½œåšçš„äº‹æƒ…å°±æ˜¯<font color="blue">å°†ç”¨æˆ·æŠ•é€’çš„<strong>ä»»åŠ¡æ’é˜Ÿ</strong></font>ï¼Œç„¶åå°†ä»»åŠ¡äº¤ç»™<font color="blue"><strong>èƒ½å¤Ÿè¿è¡Œ</strong>çš„<strong>è®¡ç®—èŠ‚ç‚¹æ‰§è¡Œ</strong></font>ï¼Œå·¥ä½œæµç¨‹åˆ†å››æ­¥:</p>
<ol>
<li><strong>æ¥å—</strong>ç”¨æˆ·æŠ•æ”¾çš„<strong>ä»»åŠ¡</strong></li>
<li>åœ¨ä»»åŠ¡è¿è¡Œä»¥å‰ï¼Œå°†ä»»åŠ¡<strong>æ”¾åˆ°</strong>ä¸€ä¸ª<strong>å­˜å‚¨åŒºåŸŸ</strong></li>
<li><strong>å‘é€ä»»åŠ¡</strong>åˆ°ä¸€ä¸ª<strong>æ‰§è¡Œè®¾å¤‡</strong>ï¼Œå¹¶<strong>ç›‘æ§</strong>ä»»åŠ¡çš„è¿è¡Œ</li>
<li>è¿è¡Œ<strong>ç»“æŸ</strong>å†™å›ç»“æœå¹¶è®°å½•è¿è¡Œ<strong>æ—¥å¿—</strong></li>
</ol>
<h2 id="SGEçš„å¸¸ç”¨å‘½ä»¤"><a href="#SGEçš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="SGEçš„å¸¸ç”¨å‘½ä»¤"></a>SGEçš„å¸¸ç”¨å‘½ä»¤</h2><h3 id="ä»»åŠ¡æŠ•é€’"><a href="#ä»»åŠ¡æŠ•é€’" class="headerlink" title="ä»»åŠ¡æŠ•é€’"></a>ä»»åŠ¡æŠ•é€’</h3><p>SGEä¸­æŠ•é€’ä»»åŠ¡æ‰€ç”¨åˆ°çš„å‘½ä»¤æ˜¯<code>qsub</code>. æœ€ç®€å•çš„ç”¨æ³•ï¼Œå³å°†è¦æ‰§è¡Œçš„å‘½ä»¤é€šè¿‡æ ‡å‡†è¾“å…¥çš„æ–¹å¼ä¼ é€’ç»™<code>qsub</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ls -l &quot;</span> | qsub</span><br></pre></td></tr></table></figure>

<p>æŠ•é€’ä¹‹åå¯ä»¥ç”¨<code>qstat</code>æŸ¥çœ‹ä»»åŠ¡è¿è¡Œæƒ…å†µï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="/blog/2022/03/06/2022-03-06-Linux-grid/3.png" alt="img"></p>
<p>ä»»åŠ¡æŠ•é€’æƒ…å†µ</p>
<p>ç¬¬ä¸€åˆ—æ˜¯ä»»åŠ¡ç¼–å·, ç¬¬äºŒåˆ—æ˜¯ä¼˜å…ˆçº§ï¼Œç¬¬ä¸‰åˆ—æ˜¯ä»»åŠ¡åå­—ï¼Œåœ¨å‚æ•°é‡Œæ²¡æœ‰ç‰¹åˆ«è¯´æ˜çš„æƒ…å†µä¸‹ï¼ŒSGEä¼šç”¨ä»»åŠ¡çš„æ¥æºè¿›è¡Œå‘½ä»¤ï¼ŒSTDINè¡¨ç¤ºæ¥è‡ªäºæ ‡å‡†è¾“å…¥ï¼Œç¬¬å››åˆ—æ˜¯ç”¨æˆ·åï¼Œç¬¬äº”åˆ—æ˜¯è¿è¡ŒçŠ¶æ€(â€œrâ€è¡¨ç¤ºè¿è¡Œä¸­), ç¬¬å…­åˆ—è¡¨ç¤ºä»»åŠ¡æŠ•é€’å’Œå¼€å§‹æ—¶é—´ï¼Œç¬¬ä¸ƒåˆ—æ˜¯ä»»åŠ¡æŠ•é€’çš„èŠ‚ç‚¹ï¼Œç¬¬8åˆ—åˆ™æ˜¯è¦ç”³è¯·çš„çº¿ç¨‹æ•°ã€‚åœ¨æ‰§è¡Œå®Œæˆåä¼šåœ¨å®¶ç›®å½•ä¸‹ç”Ÿæˆâ€STDIN.e7883â€å’Œâ€STDIN.o7883â€, å…¶ä¸­7883æ˜¯ä»»åŠ¡ç¼–å·, å‰è€…å­˜æ”¾æ ‡å‡†é”™è¯¯è¾“å‡º, åè€…å­˜æ”¾æ ‡å‡†è¾“å‡ºï¼Œ å› æ­¤â€cat STDIN.o7883â€çš„å†…å®¹å°±æ˜¯<code>ls -l</code>çš„å†…å®¹ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•æ˜¯å…ˆå†™è„šæœ¬åæŠ•é€’ï¼Œæ¯”å¦‚å…ˆç¼–è¾‘æ–‡ä»¶â€ls.shâ€, ç„¶åç”¨â€qsub ls.shâ€æŠ•é€’ä»»åŠ¡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls -l</span><br></pre></td></tr></table></figure>

<p>è·Ÿä¹‹å‰ä¸€æ ·ï¼Œæœ€ååœ¨homeç›®å½•äº§ç”Ÿäº†â€ls.sh.exxxxâ€å’Œâ€ls.sh.exxxxâ€ä¸¤ä¸ªæ–‡ä»¶</p>
<p>å®é™…è‚¯å®šæ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œéœ€è¦å¢åŠ å„ç§å‚æ•°æ¥è°ƒæ•´<code>qsub</code>çš„è¡Œä¸ºï¼Œç”¨<code>qsub -help</code>å¯ä»¥çœ‹å®Œæ•´å‚æ•°ï¼Œä½†æ˜¯å¸¸ç”¨çš„ä¸ºå¦‚ä¸‹å‡ ä¸ª </p>
<ul>
<li>-q xxx : æŒ‡å®šè¦æŠ•é€’åˆ°çš„é˜Ÿåˆ—ï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ï¼ŒSGEä¼šåœ¨ç”¨æˆ·å¯ä½¿ç”¨çš„é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„é˜Ÿåˆ—</li>
<li>-Vï¼š <font color="red">å°†å½“å‰çš„ç¯å¢ƒå˜é‡ä¼ é€’åˆ°æ‰§è¡Œå‘½ä»¤çš„èŠ‚ç‚¹ã€åœ¨ä½¿ç”¨PBSæ—¶ï¼Œç›´æ¥è¿è¡Œå¯ä»¥æ‰§è¡Œï¼ŒæŠ•é€’PBSåˆ™å¤±è´¥ï¼Œæ˜¯ä»»åŠ¡åˆ°äº†è®¡ç®—èŠ‚ç‚¹ä¸è¯†åˆ«ç¯å¢ƒå˜é‡ï¼Ÿã€‘</font></li>
<li>cwd: åœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œä»»åŠ¡, sgeçš„æ—¥å¿—ä¼šè¾“å‡ºåˆ°å½“å‰è·¯å¾„ã€‚ ä¸å¢åŠ è¯¥æŒ‡ä»¤ï¼Œæ‰€æœ‰æŠ•é€’çš„ä»»åŠ¡éƒ½ä¼šåœ¨homeç›®å½•ä¸‹æ‰§è¡Œ</li>
<li>-l resource=value: è¯·æ±‚èµ„æºæ•°, ä¾‹å¦‚ <code>-l vf=25G -l h=node1</code> ä»»åŠ¡çš„é¢„ä¼°å†…å­˜è¦25G(å†…å­˜ä¼°è®¡çš„å€¼åº”ç¨å¾®å¤§äºçœŸå®å†…å­˜ï¼Œå†…å­˜é¢„ä¼°åå°å¯èƒ½ä¼šå¯¼è‡´èŠ‚ç‚¹è·‘æŒ‚), ç”³è¯·åœ¨node1ä¸Šè¿è¡Œ</li>
<li>-S /bin/bash: è¡¨ç¤ºåœ¨bashç¯å¢ƒä¸‹æ‰§è¡Œå‘½ä»¤ã€‚é»˜è®¤tcsh.</li>
<li>-pe openmpi 4: è¡¨ç¤ºä½¿ç”¨openmpiè¿›è¡Œå¹¶è¡Œè¿ç®—ï¼Œä¸”ç”³è¯·çš„çº¿ç¨‹æ˜¯4ï¼Œ</li>
<li>-N ä»»åŠ¡å: æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡çš„åå­—</li>
<li>-j y|n ï¼šæ˜¯å¦å°†æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å…¥åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶</li>
<li>-sync y|n: æ˜¯å¦ç­‰å¾…ä»»åŠ¡ç»“æŸï¼Œè¿”å›é€€å‡ºç </li>
<li>-o path: æŒ‡å®šæ ‡å‡†è¾“å‡ºçš„æ–‡ä»¶å¤¹</li>
</ul>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥æ·»åŠ è¿™äº›å‚æ•°è¿è¡Œä¸€äº›å‘½ä»¤ï¼Œä¾‹å¦‚åœ¨å‘½ä»¤è¡Œé‡ŒæŠ•é€’ä¸€ä¸ªæ¯”å¯¹ä»»åŠ¡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;bowtie2 -p 8 -x index/ref -1 data/A_1.fq -2 data/A_2.fq | samtools sort &gt; A.bam&quot;</span> | qsub -V -cwd -l vf=25G -S /bin/bash -pe openmpi 8 -N A.bt2</span><br></pre></td></tr></table></figure>

<p>è¿™äº›å‚æ•°é™¤äº†åœ¨<strong>å¤–éƒ¨è®¾ç½®</strong>å¤–ï¼Œè¿˜å¯ä»¥åœ¨shellè„šæœ¬<strong>å†…éƒ¨è®¾ç½®</strong>ï¼Œå¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#$ -S /bin/bash</span></span><br><span class="line"><span class="comment">#$ -V</span></span><br><span class="line"><span class="comment">#$ -cwd</span></span><br><span class="line"><span class="comment">#$ -l vf=25G</span></span><br><span class="line"><span class="comment">#$ -pe openmpi 8</span></span><br><span class="line"><span class="comment">#$ -N a.bt2</span></span><br><span class="line">bowtie2 -p 8 -x index/ref -1 data/A_1.fq -2 data/A_2.fq | samtools sort &gt; A.bam</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥è¯¢ä»»åŠ¡"><a href="#æŸ¥è¯¢ä»»åŠ¡" class="headerlink" title="æŸ¥è¯¢ä»»åŠ¡"></a>æŸ¥è¯¢ä»»åŠ¡</h3><p>é™¤ä»»åŠ¡æŠ•é€’å¤–ï¼ŒæŸ¥è¯¢ä»»åŠ¡ä¹Ÿæ˜¯å¸¸ç”¨å‘½ä»¤ï¼Œé™¤ç›´æ¥ç”¨<code>qstat</code>æŸ¥çœ‹ï¼Œè¿˜æœ‰å¦‚ä¸‹å‚æ•°æ¯”è¾ƒå¥½ç”¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">qstat -f        <span class="comment"># æŸ¥çœ‹ç”¨æˆ·ä»»åŠ¡</span></span><br><span class="line">qstat -j jobId  <span class="comment"># æŒ‰ä»»åŠ¡idæŸ¥çœ‹</span></span><br><span class="line">qstat -explain a|c|A|E -j jobID <span class="comment"># æŸ¥çœ‹ä»»åŠ¡ä»»åŠ¡å¹¶ç»™å‡ºè§£é‡Š</span></span><br><span class="line">qstat -u user   <span class="comment"># æŒ‰ç”¨æˆ·æŸ¥çœ‹</span></span><br></pre></td></tr></table></figure>

<p>ä»»åŠ¡çŠ¶æ€ï¼š</p>
<ul>
<li>qw: è¡¨ç¤ºç­‰å¾…çŠ¶æ€</li>
<li>hqw: ä»»åŠ¡æŒ‚èµ·ç­‰å¾…ä¸­ï¼Œå¾…ä¾èµ–çš„ä»»åŠ¡å®Œæˆåæ‰§è¡Œ</li>
<li>Eqw: æŠ•é€’ä»»åŠ¡å‡ºé”™</li>
<li>r: è¡¨ç¤ºä»»åŠ¡æ­£åœ¨è¿è¡Œ</li>
<li>s: æš‚æ—¶æŒ‚èµ·</li>
<li>dr: èŠ‚ç‚¹æŒ‚äº†ä¹‹åï¼Œåˆ é™¤ä»»åŠ¡å°±ä¼šå‡ºç°è¿™ä¸ªçŠ¶æ€ï¼Œåªæœ‰èŠ‚ç‚¹é‡å¯åï¼Œä»»åŠ¡æ‰ä¼šæ¶ˆå¤±</li>
</ul>
<h3 id="åˆ é™¤ä»»åŠ¡"><a href="#åˆ é™¤ä»»åŠ¡" class="headerlink" title="åˆ é™¤ä»»åŠ¡"></a>åˆ é™¤ä»»åŠ¡</h3><p>ä»»åŠ¡åˆ é™¤ä¹Ÿæ¯”è¾ƒé‡è¦ï¼Œå¶å°”ä¼šå‡ºç°ä»»åŠ¡æŠ•é€’å‡ºé”™çš„æƒ…å†µ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">qdel -j 1111   åˆ é™¤ä»»åŠ¡å·ä¸º1111çš„ä»»åŠ¡</span><br></pre></td></tr></table></figure>

<h3 id="å…¶ä»–å‘½ä»¤"><a href="#å…¶ä»–å‘½ä»¤" class="headerlink" title="å…¶ä»–å‘½ä»¤"></a>å…¶ä»–å‘½ä»¤</h3><ul>
<li><p>qrshï¼šä¸qsubç›¸æ¯”ï¼Œæ˜¯äº¤äº’å¼çš„æŠ•é€’ä»»åŠ¡ï¼Œæ³¨æ„å‚æ•°:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-now yes|no</span><br></pre></td></tr></table></figure>

<p>é»˜è®¤è®¾ç½®ä¸ºyes</p>
<ul>
<li>è‹¥è®¾ç½®ä¸ºyesï¼Œ<font color="blue">ç«‹å³è°ƒåº¦ä½œä¸š</font>ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨èµ„æºï¼Œåˆ™æ‹’ç»ä½œä¸šï¼Œä»»åŠ¡æŠ•é€’å¤±è´¥ï¼Œä»»åŠ¡çŠ¶æ€ä¸ºEqwã€‚</li>
<li>è‹¥è®¾ç½®ä¸ºnoï¼Œè°ƒåº¦æ—¶å¦‚æœæ²¡æœ‰å¯ç”¨èµ„æºï¼Œåˆ™å°†ä½œä¸š<font color="blue">æ’å…¥é˜Ÿåˆ—</font>ï¼Œç­‰å¾…è°ƒåº¦ã€‚</li>
<li>ä¾‹å­ï¼š qrsh -l vf=*G -q all.q -now no -w n *sh</li>
</ul>
</li>
<li><p>qacct ä»é›†ç¾¤æ—¥å¿—ä¸­æŠ½å–ä»»æ„è´¦æˆ·ä¿¡æ¯</p>
</li>
<li><p>qalter æ›´æ”¹å·²æäº¤ä½†æ­£å¤„äºæš‚æŒ‚çŠ¶æ€çš„ä½œä¸šçš„å±æ€§</p>
</li>
<li><p>qconf ä¸ºé›†ç¾¤å’Œé˜Ÿåˆ—é…ç½®æä¾›ç”¨æˆ·ç•Œé¢</p>
<ul>
<li><code>qconf -spl</code>æŸ¥çœ‹å¯ç”¨å¹¶è¡Œç¯å¢ƒ</li>
</ul>
</li>
<li><p>qhold é˜»æ­¢å·²æäº¤ä½œä¸šçš„æ‰§è¡Œ</p>
</li>
<li><p>qhost æ˜¾ç¤º<font color="blue">SGEæ‰§è¡Œä¸»æœº</font>ï¼ˆå³<font color="blue">å„ä¸ªè®¡ç®—èŠ‚ç‚¹</font>ï¼‰çš„<font color="blue">çŠ¶æ€ä¿¡æ¯</font></p>
<ul>
<li><code>qhost -j</code>æŒ‰ç…§èŠ‚ç‚¹æ˜¾ç¤ºä»»åŠ¡</li>
<li><code>qhost -F</code>å±•ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„èµ„æº</li>
</ul>
</li>
<li><p>qlogin å¯åŠ¨telnetæˆ–ç±»ä¼¼çš„ç™»å½•ä¼šè¯ã€‚</p>
</li>
</ul>
<h2 id="æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬"><a href="#æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬" class="headerlink" title="æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬"></a>æ¡ˆä¾‹ï¼šä¸€ä¸ªæŠ•é€’æ¯”å¯¹ä»»åŠ¡çš„ç®€å•è„šæœ¬</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"><span class="built_in">set</span> -u</span><br><span class="line"><span class="built_in">set</span> -o pipefail</span><br><span class="line"></span><br><span class="line">threads=8</span><br><span class="line">index=index/hg19</span><br><span class="line"></span><br><span class="line">FQ_DIR=<span class="string">&quot;analysis/0-raw-data&quot;</span></span><br><span class="line">ALIGN_DIR=<span class="string">&quot;analysis/2-read-align&quot;</span></span><br><span class="line">LOG_DIR=<span class="string">&quot;analysis/log&quot;</span></span><br><span class="line">TMP_DIR=<span class="string">&quot;analysis/tmp&quot;</span></span><br><span class="line"></span><br><span class="line">mkdir -p <span class="variable">$&#123;ALIGN_DIR&#125;</span></span><br><span class="line">mkdir -p <span class="variable">$&#123;LOG_DIR&#125;</span></span><br><span class="line">mkdir -p <span class="variable">$&#123;TMP_DIR&#125;</span></span><br><span class="line"></span><br><span class="line">tail -n+2 download_table.txt | cut -f 6 | <span class="keyword">while</span> <span class="built_in">read</span> id;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">    bowtie2 --very-sensitive-local --mm -p <span class="variable">$threads</span> -x <span class="variable">$index</span> -U <span class="variable">$&#123;FQ_DIR&#125;</span>/<span class="variable">$id</span>.fastq.gz 2&gt; <span class="variable">$&#123;LOG_DIR&#125;</span>/<span class="variable">$id</span>.bt2.log | \</span></span><br><span class="line"><span class="string">    samtools sort -@ 2 -m 1G -T <span class="variable">$&#123;TMP_DIR&#125;</span>/<span class="variable">$&#123;id&#125;</span> -o <span class="variable">$&#123;ALIGN_DIR&#125;</span>/<span class="variable">$&#123;id&#125;</span>.sort.bam&quot;</span> | qsub -V -cwd -pe openmpi <span class="variable">$threads</span> -N <span class="variable">$&#123;id&#125;</span>_bt2 -q all.q -S /bin/bash</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h1 id="PBS-Protable-Batch-System"><a href="#PBS-Protable-Batch-System" class="headerlink" title="PBS [Protable Batch System]"></a>PBS [Protable Batch System]</h1><h2 id="1-æœåŠ¡å™¨é›†ç¾¤"><a href="#1-æœåŠ¡å™¨é›†ç¾¤" class="headerlink" title="1. æœåŠ¡å™¨é›†ç¾¤"></a>1. æœåŠ¡å™¨é›†ç¾¤</h2><ul>
<li>æœåŠ¡å™¨é›†ç¾¤æŒ‡å°†å¾ˆå¤šæœåŠ¡å™¨é›†ä¸­ä¸€èµ·è¿›è¡ŒåŒç§æœåŠ¡ï¼Œåœ¨<font color="blue">å®¢æˆ·ç«¯çœ‹æ¥å°±åƒåªæœ‰ä¸€ä¸ªæœåŠ¡å™¨</font>ï¼Œé›†ç¾¤å¯ä»¥åˆ©ç”¨å¤šä¸ªè®¡ç®—æœºè¿›è¡Œ<font color="blue">å¹¶è¡Œè®¡ç®—</font>ä»è€Œè·å¾—å¾ˆé«˜çš„è®¡ç®—é€Ÿåº¦ï¼Œä¹Ÿå¯ä»¥ç”¨å¤šä¸ªè®¡ç®—æœºåš<font color="blue">å¤‡ä»½</font>ï¼Œä»è€Œä½¿å¾—ä»»ä½•ä¸€ä¸ªæœºå™¨åäº†æ•´ä¸ªç³»ç»Ÿè¿˜æ˜¯æ­£å¸¸è¿è¡Œã€‚</li>
<li>é›†ç¾¤æ˜¯ä¸€ç»„ç‹¬ç«‹çš„è®¡ç®—æœºï¼ˆèŠ‚ç‚¹ï¼‰çš„é›†åˆä½“ï¼ŒèŠ‚ç‚¹é—´é€šè¿‡é«˜æ€§èƒ½çš„äº’è¿ç½‘ç»œè¿æ¥ï¼›<strong>å„èŠ‚ç‚¹</strong>é™¤ä½œä¸º<strong>å•ä¸€è®¡ç®—èµ„æº</strong>ä¾›äº¤äº’å¼ç”¨æˆ·ä½¿ç”¨å¤–ï¼Œè¿˜å¯ä»¥<strong>ååŒå·¥ä½œ</strong>å¹¶è¡¨ç°ä¸ºä¸€ä¸ªå•ä¸€çš„ã€é›†ä¸­çš„è®¡ç®—èµ„æºä¾›å¹¶è¡Œè®¡ç®—ä»»åŠ¡ä½¿ç”¨ã€‚</li>
</ul>
<p><strong>1.1. é›†ç¾¤ç³»ç»ŸåŸºæœ¬ä¿¡æ¯</strong></p>
<ul>
<li>é›†ç¾¤é…åˆ¶çš„<a href="https://baike.baidu.com/item/%E5%88%80%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8/1375424">åˆ€ç‰‡è®¡ç®—èŠ‚ç‚¹</a>çš„CPUï¼ŒGPUé…åˆ¶æƒ…å†µã€‚<a href="https://www.dt-stor.com/yingpanbaike/407.html#:~:text=%E5%88%80%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E4%BC%A0%E7%BB%9F%E6%9C%BA%E6%9E%B6%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E6%AF%94%EF%BC%8C%E5%88%80%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9B%A0%E5%85%B1%E4%BA%AB%E5%86%B7%E5%8D%B4%E3%80%81%E7%94%B5%E6%BA%90%E7%B3%BB%E7%BB%9F%E8%80%8C%E6%88%90%E4%B8%BA%E5%8F%97%E6%AC%A2%E8%BF%8E%E7%9A%84%E8%8A%82%E8%83%BD%E7%8E%AF%E4%BF%9D%E4%BA%A7%E5%93%81%EF%BC%8C%E4%B8%8E%E5%90%8C%E7%AD%89%E7%9A%841U%E6%9C%BA%E6%9E%B6%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E6%AF%94%EF%BC%8C%E8%83%BD%E8%80%97%E9%99%8D%E4%BD%8E%E8%BE%BE,40%25%EF%BC%8C%E7%A9%BA%E9%97%B4%E5%8D%A0%E7%94%A8%E5%87%8F%E5%B0%9140%25%20%E3%80%82">åˆ€ç‰‡æœºä¼˜ç¼ºç‚¹</a>; <a href="https://www.intel.cn/content/www/cn/zh/products/docs/processors/cpu-vs-gpu.html">GPUä¸CPU</a>ã€‚</li>
<li>ç³»ç»Ÿé…å¤‡çš„<strong>å¹¶è¡Œæ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œå„ç»„<strong>åˆ€ç‰‡æœº</strong>ä¹‹é—´çš„<strong>ç½‘ç»œè¿æ¥</strong></li>
<li>ç³»ç»Ÿé…åˆ¶çš„<font color="blue">ç™»é™†ç®¡ç†èŠ‚ç‚¹</font>ï¼Œéƒ¨ç½²çš„é›†ç¾¤ç®¡ç†ç³»ç»Ÿã€‚ç”¨æˆ·å¯æ ¹æ®<font color="blue">ç™»å½•èŠ‚ç‚¹IPï¼Œç™»å½•é›†ç¾¤ï¼Œæäº¤ä½œä¸š</font>ï¼Œç¼–è¯‘ç¨‹åºã€‚</li>
</ul>
<p><strong>1.2. é›†ç¾¤è®¡ç®—èµ„æºåˆ—è¡¨</strong></p>
<p><img src="/blog/2022/03/06/2022-03-06-Linux-grid/4.png" alt="é›†ç¾¤è®¡ç®—èµ„æºåˆ—è¡¨ç¤ºä¾‹"></p>
<ul>
<li>ä¸€èˆ¬æ­å»ºå¥½é›†ç¾¤åï¼Œéƒ½ä¼šç»™å‡ºé›†ç¾¤è®¡ç®—èµ„æºåˆ—è¡¨ï¼Œç±»ä¼¼äºä¸Šå›¾çš„å‡ ä¸ªéƒ¨åˆ†ã€‚<ul>
<li>é¦–å…ˆï¼Œä¼šå°†æ•´ä¸ª<font color="blue">é›†ç¾¤åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰</font>ï¼Œå¹¶æ ¹æ®<font color="blue">é˜Ÿåˆ—èµ„æºé…ç½®</font>æƒ…å†µè¿›è¡Œ<font color="blue">ç›¸åº”å‘½å</font>ï¼›</li>
<li> å…¶æ¬¡ï¼Œ<font color="blue">æ¯ä¸ª<strong>é˜Ÿåˆ—</strong>ä¸‹è‹¥å¹²ä¸ª<strong>è®¡ç®—èŠ‚ç‚¹</strong>ï¼ˆ<strong>nodes</strong>ï¼‰ï¼Œæ¯ä¸ªè®¡ç®—èŠ‚ç‚¹é…åˆ¶<strong>è‹¥å¹²ä¸ªCPU</strong>ï¼ˆ<strong>ppn</strong>ï¼‰</font>ï¼›</li>
<li>æœ€åï¼Œå¯¹é›†ç¾¤çš„ä¸€äº›å…¶ä»–<strong>ä¿¡æ¯è¯´æ˜</strong>å’Œ<strong>é™åˆ¶æƒ…å†µè¯´æ˜</strong>ï¼Œå¦‚CPUå‹å·å’Œæ ¸æ•°ï¼Œç”¨æˆ·<strong>å¯æäº¤çš„ä½œä¸šæ•°</strong>ï¼Œæ¯ä¸ªä½œä¸šçš„<strong>æœ€å¤§è¿è¡Œæ—¶é—´</strong>ç­‰ã€‚</li>
</ul>
</li>
<li>åœ¨å¾€é›†ç¾¤ä¸ŠæŠ•é€’ä»»åŠ¡ä¹‹å‰ï¼Œé¦–å…ˆè¦äº†è§£è¯¥<strong>ä»»åŠ¡æ‰€éœ€çš„è®¡ç®—èµ„æºæ˜¯å¦èƒ½è¢«é›†ç¾¤æ‰€æ»¡è¶³</strong>ã€‚</li>
</ul>
<h2 id="2-PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ"><a href="#2-PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="2. PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ"></a>2. PBSä»»åŠ¡ç®¡ç†ç³»ç»Ÿ</h2><h3 id="2-1-PBS-ç®€ä»‹"><a href="#2-1-PBS-ç®€ä»‹" class="headerlink" title="2.1 PBS ç®€ä»‹"></a><strong>2.1 PBS ç®€ä»‹</strong></h3><ul>
<li>PBS ï¼ˆProtable Batch Systemï¼‰ æ˜¯ä¸€ç§å¸¸ç”¨ä½œä¸šç®¡ç†ç³»ç»Ÿï¼Œå…¶ä»–ç±»ä¼¼çš„è¿˜æœ‰ LSF å’Œ SLURMã€‚</li>
</ul>
<ul>
<li><p>PBSä¼šæ ¹æ®ä¸€ä¸ªé›†ç¾¤ä¸Šçš„<strong>å¯ç”¨è®¡ç®—èŠ‚ç‚¹</strong>çš„<strong>è®¡ç®—èµ„æº</strong><font color="blue">ç®¡ç†å’Œè°ƒåº¦</font>æ‰€æœ‰è®¡ç®—ä½œä¸šï¼ˆæ— è®ºæ‰¹å¤„ç†ä½œä¸šè¿˜æ˜¯äº¤äº’å¼ä½œä¸šï¼‰ã€‚</p>
</li>
<li><p>ç›®å‰æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š<font color="blue">OpenPBSï¼ˆå¼€æºï¼‰</font>å’Œ<font color="blue">PBSProï¼ˆå•†ä¸šï¼‰</font>ã€‚TORQUEï¼šåŸºäºPBSé¡¹ç›®çš„å¼€æºè½¯ä»¶ï¼Œæ˜¯å¼€æºçš„OpenPBSæ”¹è¿›ç‰ˆã€‚ä¸»è¦åŒ…æ‹¬ï¼š</p>
</li>
<li><p><strong>PBS Server</strong>ï¼šè¿è¡Œäºé›†ç¾¤çš„<font color="red"><strong>ç®¡ç†èŠ‚ç‚¹</strong></font>ã€‚<font color="red"><strong>åˆ›å»ºå¹¶æ¥å—ä½œä¸šã€ä¿®æ”¹ä½œä¸šã€æ¿€æ´»è°ƒåº¦å™¨ï¼ˆPBS Schedulerï¼‰ä»¥åŠé€šçŸ¥PBSæ‰§è¡Œå™¨ï¼ˆPBS Momsï¼‰æ‰§è¡Œä½œä¸š</strong></font></p>
</li>
<li><p><strong>PBS Scheduleræ¿€æ´»è°ƒåº¦å™¨</strong>ï¼šæ ¹æ®èµ„æºç®¡ç†å™¨è·çŸ¥<strong>å„ä¸ªèŠ‚ç‚¹çš„èµ„æºçŠ¶å†µ</strong>å’Œ<strong>ç³»ç»Ÿçš„ä½œä¸šä¿¡æ¯</strong>ç”Ÿæˆç›¸åº”<font color="red">ä½œä¸šä¼˜å…ˆçº§åˆ—è¡¨</font></p>
</li>
<li><p><strong>PBS MomsPBSæ‰§è¡Œå™¨</strong>ï¼š<font color="blue">æ¯ä¸ªèŠ‚ç‚¹å‡æœ‰ä¸€ä¸ª<strong>åå°è¿›ç¨‹</strong>ï¼Œè¯¥è¿›ç¨‹çœŸæ­£<strong>å¯åŠ¨</strong>å’Œ<strong>åœæ­¢</strong>æäº¤åˆ°è¯¥èŠ‚ç‚¹çš„ä½œä¸š</font></p>
</li>
</ul>
<h3 id="2-2-å¸¸ç”¨PBSå‘½ä»¤"><a href="#2-2-å¸¸ç”¨PBSå‘½ä»¤" class="headerlink" title="2.2 å¸¸ç”¨PBSå‘½ä»¤"></a><strong>2.2 å¸¸ç”¨PBSå‘½ä»¤</strong></h3><ul>
<li>æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€<br><font color="red"><strong>pbsnodes ï¼ˆæŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹ï¼‰</strong></font><br><font color="red"><strong>pbsnodes -l free ï¼ˆæŸ¥çœ‹ç©ºé—²èŠ‚ç‚¹ï¼‰</strong></font><br>pbsnodes æŸèŠ‚ç‚¹ ï¼ˆæŸ¥çœ‹æŸèŠ‚ç‚¹çŠ¶æ€ï¼‰</li>
<li>èŠ‚ç‚¹åˆ‡æ¢<br><font color="red"><strong>ssh æŸèŠ‚ç‚¹ ï¼ˆè½¬åˆ°æŸèŠ‚ç‚¹ï¼‰</strong></font></li>
<li>é€€å‡ºèŠ‚ç‚¹<br><strong>exit ï¼ˆç¦»å¼€èŠ‚ç‚¹ï¼‰</strong></li>
<li>æŸ¥çœ‹ä»»åŠ¡è¿è¡ŒçŠ¶æ€<br><font color="red"><strong>ã€qstat ï¼ˆåˆ—å‡ºæ‰€æœ‰ä½œä¸šè¿è¡ŒçŠ¶æ€ï¼‰ã€‘</strong></font></li>
</ul>
<blockquote>
<p>ã€ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ä¿¡æ¯ã€‘</p>
<ul>
<li><p>Job ID ä»»åŠ¡IDå·</p>
</li>
<li><p>Name ä»»åŠ¡è„šæœ¬åç§°</p>
</li>
<li><p>User ç”¨æˆ·å</p>
</li>
<li><p>Time Use ä»»åŠ¡è¿è¡Œæ—¶é—´</p>
</li>
<li><p>S State ä»»åŠ¡çŠ¶æ€<br>* B åªç”¨äºä»»åŠ¡å‘é‡ï¼Œè¡¨ç¤ºä»»åŠ¡å‘é‡å·²ç»å¼€å§‹æ‰§è¡Œ<br>* E ä»»åŠ¡åœ¨è¿è¡Œåé€€å‡º<br>* H ä»»åŠ¡è¢«æœåŠ¡å™¨æˆ–ç”¨æˆ·æˆ–è€…ç®¡ç†å‘˜é˜»å¡<br>* Q ä»»åŠ¡æ­£åœ¨æ’é˜Ÿä¸­ï¼Œç­‰å¾…è¢«è°ƒåº¦è¿è¡Œ<br>* R ä»»åŠ¡æ­£åœ¨è¿è¡Œ<br>* S ä»»åŠ¡è¢«æœåŠ¡å™¨æŒ‚èµ·ï¼Œç”±äºä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡éœ€è¦å½“å‰ä»»åŠ¡çš„èµ„æº<br>* T ä»»åŠ¡è¢«è½¬ç§»åˆ°å…¶å®ƒæ‰§è¡ŒèŠ‚ç‚¹äº†<br>* U ç”±äºæœåŠ¡å™¨ç¹å¿™ï¼Œä»»åŠ¡è¢«æŒ‚èµ·<br>* W ä»»åŠ¡åœ¨ç­‰å¾…å®ƒæ‰€è¯·æ±‚çš„æ‰§è¡Œæ—¶é—´çš„åˆ°æ¥(qsub -a)<br>* X åªç”¨äºå­ä»»åŠ¡ï¼Œè¡¨ç¤ºå­ä»»åŠ¡å®Œæˆ<br>* C è¡¨ç¤ºç¨‹åºæ­£åœ¨è¢«å…³é—­ï¼Œä¸€èˆ¬æ˜¯ç¨‹åºè¿è¡Œé”™è¯¯ï¼ŒæŠ¥é”™</p>
</li>
<li><p>Queue ä»»åŠ¡æ‰§è¡Œæ‰€åœ¨é˜Ÿåˆ—</p>
</li>
</ul>
<p><strong>qstat -q ï¼ˆåˆ—å‡ºé˜Ÿåˆ—ä½¿ç”¨ä¿¡æ¯ï¼‰</strong><br><strong>qstat -n ï¼ˆåˆ—å‡ºé˜Ÿåˆ—ä¸­ä½¿ç”¨çš„èŠ‚ç‚¹ï¼‰</strong><br><strong>qstat -f jobid ï¼ˆæŸ¥çœ‹jobidä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼‰</strong></p>
</blockquote>
<ul>
<li><strong>æäº¤</strong>ä»»åŠ¡åˆ°é›†ç¾¤<br>qsub æ–‡ä»¶å.pbs/.sh ï¼ˆæäº¤ä»»åŠ¡ï¼‰<br>echo â€œscript.pyâ€ | qsub -l q batch1 -l nodes=1:ppn=2 (ç›´æ¥åœ¨ç»ˆç«¯è®¾ç½®PBSèµ„æºå‘½ä»¤ï¼Œå¹¶åœ¨æ­¤èµ„æºä¸‹æäº¤å¯æ‰§è¡Œè„šæœ¬)</li>
<li><strong>ä»»åŠ¡æŒ‚èµ·ï¼Œé‡Šæ”¾ï¼Œé‡æ–°åŠ è½½</strong><br>qholdï¼šæŒ‚èµ·ä½œä¸š<br>qrlsï¼šé‡Šæ”¾æŒ‚èµ·çš„ä½œä¸š<br>qrerunï¼šé‡æ–°è¿è¡Œä½œä¸š</li>
<li><strong>ä»»åŠ¡æ›´æ”¹</strong><br>qmoveï¼šå°†ä½œä¸šç§»åŠ¨åˆ°å¦ä¸€ä¸ªé˜Ÿåˆ—<br>qalterï¼š æ›´æ”¹ä½œä¸šèµ„æºå±æ€§</li>
<li>åˆ é™¤ä»»åŠ¡<br><strong>qdel jobid</strong> ï¼ˆå–æ¶ˆä»»åŠ¡ï¼‰</li>
</ul>
<h3 id="2-3-qsub-æäº¤ä»»åŠ¡"><a href="#2-3-qsub-æäº¤ä»»åŠ¡" class="headerlink" title="2.3 qsub æäº¤ä»»åŠ¡"></a><strong>2.3 qsub æäº¤ä»»åŠ¡</strong></h3><p><strong>2.3.1 é€šè¿‡ç»ˆç«¯æäº¤ä»»åŠ¡</strong></p>
<ul>
<li>é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ç»™ qsub å‘½ä»¤</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;python script.py -i inputdir -o outdir &quot; | qsub -q Batch1 -l nodes=1:ppn=1 -l mem=40gb -N jobname</span><br></pre></td></tr></table></figure>

<p><strong>æ‰§è¡Œscript.py è„šæœ¬ï¼Œ é€šè¿‡pbsæŠ•é€’ä»»åŠ¡, ä»»åŠ¡æäº¤åˆ°Batch1é˜Ÿåˆ—ï¼Œæ‰€éœ€èµ„æºä¸ºï¼Œ1ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ä½¿ç”¨1ä¸ªcpu, 40GBç‰©ç†å†…å­˜ï¼Œè¯¥ä»»åŠ¡å‘½åjobname</strong></p>
<ul>
<li>-N ä»»åŠ¡åç§°</li>
<li>-q æŒ‡å®šQueue</li>
<li><font color="red">-l</font> resource_list æŒ‡å®š<font color="red">ä»»åŠ¡æ‰€éœ€èµ„æº</font><br>ä¸€èˆ¬åŒ…æ‹¬ï¼š<br>* cput=Nï¼Œ è¯·æ±‚Nç§’CPUæ—¶é—´ï¼ŒNä¹Ÿå¯ä»¥å†™æˆhh:mm::ssï¼Œå•ä½åˆ†åˆ«æ˜¯ æ—¶ï¼šåˆ†ï¼šç§’<br>* mem=N[K|M|G|][B|W], è¯·æ±‚Nå¤§å°çš„<font color="red">å†…å­˜</font><br>* nodes=N, Nä¸ª<font color="red">èŠ‚ç‚¹</font><br>* ppn=M, æ¯ä¸ªèŠ‚ç‚¹éœ€è¦Mä¸ª<font color="red">cpu</font></li>
<li>-e path å°†æ ‡å‡†é”™è¯¯é‡å®šå‘åˆ°path</li>
<li>-o path æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°path</li>
<li>-j join å°†æ ‡å‡†è¾“å‡ºä¿¡æ¯ä¸æ ‡å‡†é”™è¯¯ä¿¡æ¯åˆå¹¶åˆ°åŒä¸€ä¸ªæ–‡ä»¶joinä¸­å»</li>
<li>-p priority ä»»åŠ¡ä¼˜å…ˆçº§ï¼Œæ•´æ•°ï¼Œæ— å®šä¹‰é»˜è®¤0</li>
<li>-m mail_options mail_option =aï¼šå·¦å³abortæ—¶ç»™ç”¨æˆ·å‘ä¿¡ï¼›=bï¼šä½œä¸šå¼€å§‹æ—¶å‘ä¿¡ï¼›=eï¼šä½œä¸šç»“æŸæ—¶å‘ä¿¡. é»˜è®¤=a</li>
</ul>
<p><strong>2.3.2 <font color="red">PBSé€šè¿‡shè„šæœ¬æ‰§è¡Œå‘½ä»¤</font></strong></p>
<ul>
<li><font color="red">åœ¨ PBS è„šæœ¬ä¸­ä»¥ #PBS æ–¹å¼æŒ‡å®š</font><br>åœ¨PBSç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ä½¿ç”¨qsubå‘½ä»¤æäº¤ç”¨æˆ·ç¨‹åºã€‚ç”¨æˆ·è¿è¡Œç¨‹åºçš„å‘½ä»¤ ä»¥åŠ PBSç¯å¢ƒå˜é‡è®¾ç½® å…±åŒç»„æˆäº†PBSä½œä¸šè„šæœ¬ã€‚</li>
<li>æ³¨é‡Šä¸º â€œ#â€ å¼€å¤´</li>
<li>PBSæŒ‡ä»¤ä¸º â€œ#PBSâ€ å¼€å¤´</li>
<li>shellå‘½ä»¤ ï¼ˆè¿è¡Œè„šæœ¬çš„å‘½ä»¤ï¼‰</li>
</ul>
<p>ä¾‹å¦‚ run.sh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">å‚æ•°è§£æ</span></span><br><span class="line"><span class="meta">#</span><span class="bash">æŒ‡å®šèŠ‚ç‚¹æ•°ç›® ppnæŒ‡æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œçš„cpuæ•°é‡ï¼ˆ4ä¸ªå°èŠ‚ç‚¹ï¼Œæ¯ä¸ª48ä¸ªCPUï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -l nodes=1:ppn=16</span></span><br><span class="line"><span class="meta">#</span><span class="bash">æŒ‡å®šåˆå¹¶åˆ°æ ‡å‡†è¾“å‡ºæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -j oe</span></span><br><span class="line"><span class="meta">#</span><span class="bash">è®¾ç½®ç¨‹åºè¿è¡Œçš„æœ€å¤§æ—¶é—´192å°æ—¶</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -l walltime=192:00:00</span></span><br><span class="line"><span class="meta">#</span><span class="bash">æŒ‡å®šqsubçš„æ‰€æœ‰ç¯å¢ƒå˜é‡éƒ½ä¼ é€’åˆ°æ‰¹å¤„ç†ä½œä¸šä¸­</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -V</span></span><br><span class="line"><span class="meta">#</span><span class="bash">è¾“å‡ºæ–‡ä»¶</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -o /public/home/tang/chaim/back_info/<span class="variable">$jobname</span>.out</span></span><br><span class="line"><span class="meta">#</span><span class="bash">é”™è¯¯è¾“å‡ºæ–‡ä»¶</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -e /public/home/tang/chaim/back_info/<span class="variable">$jobname</span>.err</span></span><br><span class="line">cd PBS_O_OUTDIR</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¨‹åºæ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">python script.py -i inputdir -o outdir </span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ‰§è¡Œè„šæœ¬</span></span><br><span class="line">qsub run.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ¶å®šå‘½ä»¤å¼€å§‹è¿è¡Œçš„æ—¶é—´</span>  </span><br><span class="line">qusb -a 070000 run.s  #7å¤©åè¿è¡Œç¨‹åºï¼Œæ­¤æ—¶æ˜¯å¤„äºWçŠ¶æ€(ç­‰å¾…çŠ¶æ€)</span><br><span class="line">qsub -a 2400 run.s #24håè¿è¡Œç¨‹åº</span><br></pre></td></tr></table></figure>

<p><strong>2.3.3 é€šè¿‡äº¤äº’å¼çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡</strong></p>
<ul>
<li><strong>qsub -I</strong></li>
<li>qsub -I -q Batch1 -l nodes=1:ppn=1 -l mem=80gb -N jobname</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">[#</span><span class="bash">11<span class="comment">#Rd01@login ~]$</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">qsub -I -q Batch1 -l nodes=1:ppn=1 -l mem=80gb -N jobname</span></span><br><span class="line">qsub: waiting for job 1230615.admin to start</span><br><span class="line">qsub: job 1230615.admin ready</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">[#</span><span class="bash">1<span class="comment">#Rd01@comput4 ~]$</span></span></span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-PBSå¸¸ç”¨ç¯å¢ƒå˜é‡"><a href="#2-4-PBSå¸¸ç”¨ç¯å¢ƒå˜é‡" class="headerlink" title="2.4 PBSå¸¸ç”¨ç¯å¢ƒå˜é‡"></a><strong>2.4 PBSå¸¸ç”¨ç¯å¢ƒå˜é‡</strong></h3><ul>
<li>PBS_ENVIRONMENTï¼šæ‰¹å¤„ç†ä½œä¸šä¸º PBS_BATCHï¼Œäº¤äº’å¼ä½œä¸šä¸º PBS_INTERACTIVE</li>
<li>PBS_JOBIDï¼šPBS ç³»ç»Ÿç»™ä½œä¸šåˆ†é…çš„æ ‡è¯†å·</li>
<li>PBS_JOBNAMEï¼šç”¨æˆ·æŒ‡å®šçš„ä½œä¸šåç§°</li>
<li>PBS_NODEFILEï¼šåŒ…å«ä½œä¸šæ‰€ç”¨è®¡ç®—èŠ‚ç‚¹çš„æ–‡ä»¶å</li>
<li>PBS_QUEUEï¼šä½œä¸šæ‰€æ‰§è¡Œçš„é˜Ÿåˆ—åç§°</li>
<li>PBS_O_HOMEï¼šæ‰§è¡Œ qsub å‘½ä»¤çš„ HOME ç¯å¢ƒå˜é‡å€¼</li>
<li>PBS_O_PATHï¼šæ‰§è¡Œ qsub å‘½ä»¤çš„ PATH ç¯å¢ƒå˜é‡å€¼</li>
<li>PBS_O_SHELLï¼šæ‰§è¡Œ qsub å‘½ä»¤çš„ SHELL ç¯å¢ƒå˜é‡å€¼</li>
<li>PBS_O_HOSTï¼šæ‰§è¡Œ qsub å‘½ä»¤èŠ‚ç‚¹åç§°</li>
<li>PBS_O_QUEUEï¼šæäº¤ä½œä¸šçš„æœ€åˆé˜Ÿåˆ—åç§°</li>
<li>PBS_O_WORKDIRï¼šæ‰§è¡Œ qsub å‘½ä»¤æ‰€åœ¨çš„ç»å¯¹è·¯å¾„</li>
</ul>
<h1 id="è°ƒåº¦å™¨"><a href="#è°ƒåº¦å™¨" class="headerlink" title="è°ƒåº¦å™¨"></a>è°ƒåº¦å™¨</h1><p><strong>å¦‚æœæœ‰ä¸€å¤©ï¼Œä½ æœ‰16ä¸‡ä¸ªCPUï¼Œä½ è¦æ€ä¹ˆç”¨ï¼Ÿ</strong> <strong>è°ƒåº¦å™¨</strong>æœ€å¤§ç¨‹åº¦å‹æ¦¨ç°æœ‰<strong>èµ„æºæˆ–æ—¶é—´çš„æœ€å¤§ä»·å€¼</strong>ã€‚</p>
<p>ä¸åŒè¡Œä¸šå› ä½¿ç”¨ä¹ æƒ¯å’Œä¸åŒè°ƒåº¦å™¨å¯¹åº”ç”¨çš„æ”¯æŒåŠ›åº¦ä¸åŒï¼Œå¾€å¾€æœ‰ä¸åŒåå¥½ï¼š<strong>æ¯”å¦‚é«˜æ ¡å’Œè¶…ç®—ç»å¸¸ç”¨Slurmï¼ŒåŠå¯¼ä½“å…¬å¸æœ€å¸¸ç”¨çš„æ˜¯LSFå’ŒSGEï¼Œå·¥ä¸šåˆ¶é€ ä¸šå¯èƒ½ç”¨PBSæ›´å¤šä¸€äº›ã€‚</strong></p>
<p>1ç¯‡ <a href="https://fastonetech.com/blog/biotech-fastone-help-hms-on-molecules-selection-20200709/">15å°æ—¶è™šæ‹Ÿç­›é€‰10äº¿åˆ†å­ï¼Œã€ŠNatureã€‹+HMSéªŒè¯äº‘ç«¯æ–°è¯ç ”å‘æœªæ¥</a> æ–‡ç« é‡Œå“ˆä½›å¤§å­¦åŒ»å­¦é™¢ç”¨<strong>äº‘ç«¯16ä¸‡ä¸ªCPUæ¥ç­›é€‰10äº¿ç§åŒ–åˆç‰©</strong>ï¼Œåªç”¨äº†15å°æ—¶ã€‚<br><strong>è¶…å¤§è§„æ¨¡è®¡ç®—é›†ç¾¤ä¸Šçš„å·¥ä½œæµç¨‹å›¾</strong>ï¼š</p>
<p><img src="/blog/2022/03/06/2022-03-06-Linux-grid/5.png" alt="è°ƒåº¦å™¨-ç”Ÿä¿¡åˆ†æ-é«˜æ€§èƒ½è®¡ç®—é›†ç¾¤-åŒ–åˆç‰©ç­›é€‰"></p>
<p>è“è‰²æ¡†è¡¨ç¤ºè®¡ç®—èŠ‚ç‚¹ï¼Œå…¶ä¸­åŒ…å«CPUæ ¸æ•°ï¼ˆè“è‰²æ¡†å†…çš„é»‘è‰²æ­£æ–¹å½¢ï¼‰ï¼Œç´«è‰²å°åœ†åœˆä»£è¡¨å¾…å¤„ç†çš„é…ä½“ã€‚æ•´å¼ å›¾ä»£è¡¨æ•´ä¸ªè®¡ç®—é›†ç¾¤ï¼Œå¹¶è¡Œè¿è¡Œ1.1åˆ°X.1ä¸ªä»»åŠ¡ï¼Œä»»åŠ¡1.1å®Œæˆåä¼šè‡ªåŠ¨è¿è¡Œä»»åŠ¡1.2ï¼Œä»¥æ­¤ç±»æ¨ç›´åˆ°ä»»åŠ¡å®Œæˆã€‚<br>æ¯ä¸ªä»»åŠ¡ï¼ˆåŒ…å«å¤šä¸ªå­ä»»åŠ¡ï¼‰ä½¿ç”¨3ä¸ªè®¡ç®—èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰8ä¸ªCPUæ ¸ã€‚</p>
<p><strong>å‡è®¾æœ‰10äº¿åŒ–åˆç‰©éœ€è¦ç­›é€‰ï¼Œé¢å¯¹16ä¸‡CPUï¼ŒæŠŠæµç¨‹å›¾é‡Œç¼ºä¹çš„æ—¶é—´ç»´åº¦è€ƒè™‘è¿›æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¤šæ€è€ƒå‡ ä¸ªé—®é¢˜ï¼š</strong></p>
<ol>
<li><strong>16ä¸‡CPUï¼Œæ€ä¹ˆé¡ºåˆ©ä¸€ä¸€é…ç½®ï¼Œå¯åŠ¨ï¼Œå…³é—­ï¼Ÿ</strong></li>
<li><strong>æ€ä¹ˆèƒ½è®©é›†ç¾¤æ•´ä½“èµ„æºåˆ©ç”¨ç‡æœ€é«˜ï¼Ÿè·‘æ›´å¤šä»»åŠ¡ï¼Ÿ</strong></li>
<li><strong>èƒ½ä¸èƒ½æŒ‡å®šç‰¹å®šä»»åŠ¡åœ¨æŸç§ç±»å‹è®¡ç®—èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Ÿ</strong></li>
<li><strong>ä»»åŠ¡ä¹‹é—´å­˜åœ¨å…ˆåé¡ºåºï¼Œèƒ½å¦ç¡®ä¿ç‰¹å®šä»»åŠ¡ä¸€å®šå…ˆè¿è¡Œï¼Ÿ</strong></li>
<li><strong>æ€ä¹ˆç»Ÿè®¡å’Œé™åˆ¶ä¸åŒç”¨æˆ·çš„ç”¨é‡ï¼Ÿ</strong></li>
<li><strong>æ€ä¹ˆç›‘æ§æ¯ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€å’Œä½¿ç”¨æƒ…å†µï¼Ÿ</strong></li>
<li><strong>æ€ä¹ˆé™ä½é›†ç¾¤çš„æ•´ä½“è¿è¡Œæˆæœ¬ï¼Ÿé¿å…æµªè´¹ï¼Ÿ</strong></li>
<li><strong>è®¡ç®—èŠ‚ç‚¹é—´ç½‘ç»œ/æ•°æ®ä¼ è¾“æ€ä¹ˆè€ƒè™‘ï¼Ÿ</strong></li>
<li><strong>å¦‚ä½•åº”å¯¹äº‘ä¸Šé›†ç¾¤èµ„æºé«˜åº¦åŠ¨æ€çš„ç‰¹æ€§ï¼Ÿç©ºé—²èµ„æºä¸è¶³æ—¶æ€ä¹ˆåŠï¼Ÿ</strong></li>
</ol>
<p>å¦‚æœè¿˜ä¸æ˜¯ç‰¹åˆ«æ˜ç™½ï¼Œå†æ‰“ä¸ªæ¯”æ–¹ã€‚è®¤çœŸæƒ³åƒä¸€ä¸‹ä½ æ˜¯è€æ¿ï¼Œæ‰‹é‡Œæœ‰ä¸”åªæœ‰100ä¸ªæ‰“å·¥äººï¼Œä½ æƒ³æƒ³è¦æ€ä¹ˆç®¡ç†æ‰èƒ½è®©ä»–ä»¬æ›´å¥½åœ°ä¸ºä½ å·¥ä½œï¼Ÿï¼Ÿ</p>
<p><strong>åŸºäºè¿™å‡ å®¶ä¸»æµè°ƒåº¦å™¨ï¼šLSF/SGE/Slurm/PBSä»¥åŠå®ƒä»¬çš„ä¸åŒæ¼”åŒ–ç‰ˆæœ¬è¿›è¡Œäº†æ¢³ç†å’Œç›˜ç‚¹ï¼Œå°¤å…¶æ˜¯å¯¹äº‘çš„æ”¯æŒæ–¹é¢åˆ’äº†é‡ç‚¹ã€‚</strong></p>
<h2 id="LSF"><a href="#LSF" class="headerlink" title="LSF"></a>LSF</h2><p><strong>åŸºäºLSFï¼ˆLoad Sharing Facilityï¼‰çš„è°ƒåº¦å™¨ä¸»è¦æœ‰Spectrum LSFã€PlatformLSFã€OpenLavaä¸‰å®¶ã€‚</strong></p>
<p>æ—©æœŸLSFç”±Torontoå¤§å­¦å¼€å‘çš„Utopiaç³»ç»Ÿå‘å±•è€Œæ¥ã€‚<br>2007å¹´ï¼Œ<strong>Platform Computing</strong>åŸºäºæ—©æœŸè€ç‰ˆæœ¬çš„LSFå¼€æºäº†ä¸€ä¸ªç®€åŒ–ç‰ˆPlatform Lavaã€‚</p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®2011å¹´ä¸­æ­¢äº†ï¼Œè¢«<strong>OpenLava</strong>æ¥æ‰‹ã€‚<br>2011å¹´ï¼ŒPlatformå‘˜å·¥David BigagliåŸºäºPlatform Lavaçš„æ´¾ç”Ÿä»£ç åˆ›å»ºäº†OpenLava 1.0ã€‚2014å¹´ï¼Œä¸€äº›Platformçš„å‘˜å·¥æˆç«‹äº†Teraprocå…¬å¸ï¼Œä¸ºOpenLavaæä¾›å¼€å‘å’Œå•†ä¸šæ”¯æŒã€‚<strong>2016å¹´IBMå°±LSFç‰ˆæƒå¯¹Teraprocå…¬å¸å‘èµ·è¯‰è®¼ï¼Œ2018å¹´IBMèƒœè¯‰ï¼ŒOpenLavaè¢«ç¦ç”¨ã€‚</strong></p>
<p>2011å¹´ï¼ŒPlatform Lavaå¼€æºé¡¹ç›®ä¸­æ­¢åã€‚<strong>2012å¹´1æœˆï¼ŒIBMæ”¶è´­äº†Platform Computingã€‚Spectrum LSF</strong>å°±æ˜¯IBMæ”¶è´­åæ¨å‡ºçš„å•†ç”¨ç‰ˆæœ¬ï¼Œç›®å‰æ›´æ–°åˆ°10.1.0ï¼ŒåŒæ—¶æ”¯æŒLinuxå’ŒWindowsï¼Œ<font color="red">æœ€å¤§èŠ‚ç‚¹æ•°è¶…è¿‡6000ï¼Œåœ¨å›½å†…æä¾›å•†ä¸šæ”¯æŒã€‚</font><br><strong>Platform LSF</strong>æ˜¯LSFçš„æ—©æœŸç‰ˆæœ¬ï¼Œä¸Spectrum LSFä¸€æ ·å±äºIBMï¼Œç›®å‰ç‰ˆæœ¬æ˜¯9.1.3ï¼Œç›®æµ‹å·²ç»åœæ­¢æ›´æ–°ä»¥ç»´æŠ¤ä¸ºä¸»ã€‚</p>
<h2 id="SGE"><a href="#SGE" class="headerlink" title="SGE"></a>SGE</h2><p><strong>åŸºäºSGEï¼ˆSun Grid Engineï¼‰çš„è°ƒåº¦å™¨åŒ…æ‹¬UGEï¼ˆUniva Grid Engineï¼‰å’ŒSGEï¼ˆSon of Grid Engineï¼‰ã€‚</strong></p>
<p>1993å¹´ï¼Œ<strong>Grid Engine</strong>ä½œä¸ºå•†ä¸šè½¯ä»¶å‘å¸ƒï¼Œå…ˆåä½¿ç”¨äº†<strong>CODINE</strong>ï¼ˆComputing in Distributed Networked Environmentsï¼‰ã€<strong>GRD</strong>ï¼ˆGlobal Resource Directorï¼‰ä½œä¸ºåç§°ã€‚1999å¹´ï¼Œç¬¬ä¸€æ¬¡ç”±Genias Softwareæ¨å‡ºå¸‚åœºï¼Œç„¶åè¢«Gridwareå…¬å¸æ”¶è´­ã€‚ç›´åˆ°2000å¹´è¢«SUNæ”¶è´­ä¹‹åæ­£å¼æ”¹å<strong>Sun Grid Engine</strong>ï¼Œ2001å¹´å‘å¸ƒå¼€æºç‰ˆã€‚</p>
<p>2010å¹´è¢«Oracleæ”¶è´­åæ”¹å<strong>Oracle Grid Engine</strong>ï¼Œæ”¹æˆé—­æºç‰ˆï¼Œä¸æä¾›æºä»£ç ã€‚åŸæ¥å¼€æºé¡¹ç›®çš„èµ„æ–™åº“ç¦æ­¢ç”¨æˆ·ä¿®æ”¹ã€‚<br>äºæ˜¯ï¼ŒGrid Engineç¤¾åŒºå¼€å§‹å¼€æºç‰ˆæœ¬çš„<strong>SGE</strong>ï¼ˆ<strong>Son of Grid Engine</strong>ï¼‰é¡¹ç›®ã€‚è¯¥è°ƒåº¦å™¨æœ€åä¸€æ¬¡æ›´æ–°ä¸º2016å¹´çš„8.1.9ï¼Œç”±äºå­˜åœ¨ç‰ˆæƒé£é™©ï¼ŒSGEå·²é•¿æœŸæ— ç»´æŠ¤å’Œæ›´æ–°ã€‚</p>
<p>2013å¹´Univaæ”¶è´­äº†Oracle Grid Engineï¼Œæˆä¸ºå”¯ä¸€å•†ä¸šè½¯ä»¶<strong>UGEï¼ˆUniva Grid Engineï¼‰</strong>æä¾›å•†ã€‚UGEæœ€æ–°ç‰ˆæœ¬ä¸º8.6.15ï¼ŒåŒæ—¶æ”¯æŒLinuxå’ŒWindowsï¼Œå›½å†…æš‚æ— å•†ä¸šæ”¯æŒçš„ç›¸å…³ä¿¡æ¯ã€‚<br>2020å¹´9æœˆï¼ŒAltairæ”¶è´­äº†Univaã€‚</p>
<h2 id="Slurm-å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾"><a href="#Slurm-å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾" class="headerlink" title="Slurm å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾"></a>Slurm <strong>å››å¤§æµæ´¾é‡Œå”¯ä¸€çº¯å¼€æºæ´¾</strong></h2><p><font color="red"><strong>Slurmå…¨ç§°ä¸ºSimple Linux Utility for Resource Management</strong></font>ï¼Œå‰æœŸä¸»è¦ç”±åŠ³ä¼¦æ–¯åˆ©å¼—è«å°”å›½å®¶å®éªŒå®¤ã€SchedMDã€Linux NetworXã€Hewlett-Packard å’Œ Groupe Bull è´Ÿè´£å¼€å‘ï¼Œå—åˆ°é—­æºè½¯ä»¶Quadrics RMSçš„å¯å‘ã€‚</p>
<p>Slurmæœ€æ–°ç‰ˆæœ¬ä¸º20.02ï¼Œç›®å‰ç”±ç¤¾åŒºå’ŒSchedMDå…¬å¸å…±åŒç»´æŠ¤ï¼Œ<strong>ä¿æŒå¼€æºå’Œå…è´¹</strong>ï¼Œç”±SchedMDå…¬å¸æä¾›å•†ä¸šæ”¯æŒï¼Œä»…æ”¯æŒLinuxç³»ç»Ÿï¼Œ<font color="red">æœ€å¤§èŠ‚ç‚¹æ•°é‡è¶…è¿‡12ä¸‡</font>ã€‚<br>Slurmæ‹¥æœ‰<font color="red">å®¹é”™ç‡é«˜ã€æ”¯æŒå¼‚æ„èµ„æºã€é«˜åº¦å¯æ‰©å±•ç­‰ä¼˜ç‚¹ï¼Œæ¯ç§’å¯æäº¤è¶…è¿‡1000ä¸ªä»»åŠ¡ï¼Œä¸”ç”±äºæ˜¯å¼€æ”¾æ¡†æ¶ï¼Œé«˜åº¦å¯é…ç½®ï¼Œæ‹¥æœ‰è¶…è¿‡100ç§æ’ä»¶ï¼Œå› æ­¤é€‚ç”¨æ€§ç›¸å½“å¼ºã€‚</font></p>
<p><strong>å…¨çƒ60%çš„TOP500è¶…ç®—ä¸­å¿ƒå’Œè¶…å¤§è§„æ¨¡é›†ç¾¤ï¼ˆåŒ…æ‹¬æˆ‘å›½çš„å¤©æ²³äºŒå·ç­‰ï¼‰éƒ½é‡‡ç”¨Slurmä½œä¸ºè°ƒåº¦ç³»ç»Ÿã€‚æˆ‘ä»¬çš„TOP500å°±æ˜¯ç”¨Slurmè°ƒåº¦äº‘ä¸Šèµ„æºè·‘çš„ã€‚</strong><a href="https://fastonetech.com/blog/top500/">ä¸Šæ¦œå•¦ï½èŠ±è´¹4å°æ—¶5500ç¾å…ƒï¼Œé€ŸçŸ³ç§‘æŠ€è·»èº«å…¨çƒè¶…ç®—TOP500</a></p>
<p>æ”¯æŒåœ¨Slurmä¸Šçš„é›†ç¾¤è‡ªåŠ¨ä¼¸ç¼©å’Œäº‘ç«¯è´¹ç”¨ç›‘æ§ï¼Œå¹¶æ”¯æŒAWSã€é˜¿é‡Œäº‘ã€Azureã€è…¾è®¯äº‘ã€åä¸ºäº‘ã€Google Cloudç­‰äº‘å‚å•†ã€‚</p>
<p><strong><a href="https://fastonetech.com/blog/case-vina-20201021/">ç”Ÿä¿¡äº‘å®è¯Vol.3</a>ï¼šæé€Ÿ2920å€ï¼ç”¨AutoDockVinaå¯¹æ¥2800ä¸‡ä¸ªåˆ†å­  è¿™ç¯‡ä¸»è¦åŸºäºç”¨æˆ·ä¸åŒçš„ç­–ç•¥ï¼Œè·¨åŒºã€è·¨ç±»å‹è‡ªåŠ¨ä¸ºç”¨æˆ·è°ƒåº¦äº‘èµ„æºï¼Œå¦‚ä½•ä»¥æœ€å¿«é€Ÿåº¦oræœ€ä½æˆæœ¬å®Œæˆè®¡ç®—ä»»åŠ¡ã€‚</strong></p>
<h2 id="PBS"><a href="#PBS" class="headerlink" title="PBS"></a>PBS</h2><p><strong>åŸºäºPBSï¼ˆPortable Batch Systemï¼‰çš„è°ƒåº¦å™¨åŒ…æ‹¬OpenPBSã€PBS PROã€Moab/TORQUEã€‚</strong></p>
<p>PBSæœ€åˆæ˜¯ç”±MRJ Technology Solutionsäº 1991 å¹´ 6 æœˆå¼€å§‹ä¸º <font color="red">NASA æ‰€ç ”å‘çš„ä½œä¸šè°ƒåº¦ç³»ç»Ÿ</font>ï¼ŒMRJäº 20 ä¸–çºª90 å¹´ä»£æœ«è¢« Veridian æ”¶è´­ã€‚2003å¹´ï¼ŒAltairæ”¶è´­äº†Veridianï¼Œè·å¾—äº†PBSçš„æŠ€æœ¯å’ŒçŸ¥è¯†äº§æƒã€‚<br><font color="red"><strong>PBS Pro</strong></font>æ˜¯Altairæ——ä¸‹PBS WORKSæä¾›çš„<font color="red">å•†ä¸šç‰ˆæœ¬ï¼Œæ”¯æŒå¯è§†åŒ–ç•Œé¢ï¼ŒèŠ‚ç‚¹æ•°è¶…è¿‡50000ä¸ªã€‚</font></p>
<p>2016å¹´AltairåŸºäº<strong>PBS Pro</strong>æä¾›äº†å¼€æºè®¸å¯ç‰ˆæœ¬ï¼Œå…¶ä¸MRJäº1998å¹´å‘å¸ƒçš„åŸå§‹å¼€æºç‰ˆæœ¬ä¸¤è€…åˆäºŒä¸ºä¸€å¤§è‡´å°±æ˜¯ç°åœ¨çš„<font color="red"><strong>OpenPBS</strong></font>ã€‚<font color="red">ä¸Proç‰ˆæœ¬æ¯”ï¼Œå¤šäº†å¾ˆå¤šé™åˆ¶ï¼Œä½†éƒ½æ”¯æŒLinuxå’ŒWindowsã€‚</font></p>
<p><strong>Moab/TORQUEåˆåœ¨ä¸€èµ·æ˜¯ä¸€ä¸ªå®Œæ•´è°ƒåº¦å™¨çš„åŠŸèƒ½ï¼Œç°åœ¨å±äºåŒä¸€å®¶å…¬å¸Adaptive Computingã€‚</strong>90å¹´ä»£ä¸­æœŸç”±MHPCCçš„David Jacksonå¼€å‘çš„Mauiï¼Œä»–åæ¥åˆ›ç«‹äº†Adaptive Computingã€‚</p>
<p><strong>Moab</strong>æ˜¯Adaptive Computing å…¬å¸ï¼ˆå‰èº«ä¸º Cluster Resources å…¬å¸å¼€å‘çš„Maui Cluster Schedulerï¼‰ç»´æŠ¤çš„ OpenPBS åˆ†æ”¯ï¼Œ2003å¹´å‘å¸ƒã€‚è¯¥é¡¹ç›®æœ€åˆæ˜¯å¼€æºå…è´¹çš„ï¼Œåæ¥å˜æˆäº†å•†ç”¨è½¯ä»¶Moabåä¸å†å…è´¹ã€‚</p>
<p><strong>TORQUE</strong>ï¼ˆTerascale Open-source Resource and QUEue Managerï¼‰æ—©æœŸçš„ Torque ä¹Ÿæ˜¯å¼€æºå…è´¹è½¯ä»¶ï¼Œä¸è¿‡ 2018 å¹´ 6 æœˆå¼€å§‹ TORQUE ä¸å†å¼€æºã€‚<br><font color="red">ä¸¤è€…å‡åªæ”¯æŒLinuxç³»ç»Ÿï¼Œæä¾›å¯è§†åŒ–ç•Œé¢ï¼Œæ‹¥æœ‰çº¦æ•°åƒä¸ªèŠ‚ç‚¹ã€‚</font></p>
<p>äº‘æœåŠ¡æ–¹é¢ï¼ŒPBS Proèƒ½é€šè¿‡<strong>Altair Controläº§å“</strong>ä»æœ¬åœ°æº¢å‡ºåˆ°å¤šäº‘å’ŒAuto-Scaleé›†ç¾¤è‡ªåŠ¨ä¼¸ç¼©ï¼Œæ”¯æŒçš„äº‘å‚å•†åŒ…æ‹¬AWSã€Azureå’ŒGoogle Cloudã€‚</p>
<p>Moab/TORQUE åˆ™å¯é€šè¿‡ <strong>NODUSCloud OS äº§å“</strong>å®ç°æœ¬åœ°æ‰©å±•åˆ°äº‘ï¼Œæ”¯æŒTORQUE æˆ– Slurmé›†ç¾¤å’Œè‡ªåŠ¨ä¼¸ç¼©ï¼Œå¯æ”¯æŒçš„äº‘å‚å•†åŒ…æ‹¬AWSã€Azureã€GoogleCloud å’Œåä¸ºäº‘ï¼Œå¹¶é€šè¿‡ Account Manager äº§å“å®ç°äº‘ç«¯è´¹ç”¨ç›‘æ§ã€‚</p>
<hr>
<p>ref</p>
<p> <a href="https://fastonetech.com/blog/cluster-scheduler-20201105/">https://fastonetech.com/blog/cluster-scheduler-20201105/</a></p>
<p><a href="https://www.jianshu.com/p/45e3f88086f3">https://www.jianshu.com/p/45e3f88086f3</a></p>
<p><a href="https://www.jianshu.com/p/b7b540a3c015">https://www.jianshu.com/p/b7b540a3c015</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>technology</tag>
      </tags>
  </entry>
  <entry>
    <title>HiFi-4-QC-BUSCO</title>
    <url>/blog/2022/03/05/2022-03-02-HiFi-4-BUSCO/</url>
    <content><![CDATA[<p>BUSCO - <strong>B</strong>enchmarking <strong>U</strong>niversal <strong>S</strong>ingle-<strong>C</strong>opy <strong>O</strong>rthologs</p>
<p>æ™®éé€šç”¨çš„å•æ‹·è´ç›´ç³»åŒæºæµ‹è¯•?</p>
<span id="more"></span>

<p>officialï¼š<a href="https://busco.ezlab.org/busco_userguide.html">https://busco.ezlab.org/busco_userguide.html</a></p>
<p>Ref:<a href="https://www.jianshu.com/p/5041460f7a5d">https://www.jianshu.com/p/5041460f7a5d</a></p>
<p>BUSCOæ˜¯ä½¿ç”¨pythonè¯­è¨€ç¼–å†™çš„<font color="blue">å¯¹<strong>è½¬å½•ç»„</strong>å’Œ<strong>åŸºå› ç»„ç»„è£…è´¨é‡</strong>è¿›è¡Œ<strong>è¯„ä¼°</strong></font>çš„è½¯ä»¶ã€‚ç›¸è¿‘ç‰©ç§é—´æ€»æœ‰ä¸€äº›ä¿å®ˆåºåˆ—ï¼ŒBUSCO<font color="blue">ä½¿ç”¨è¿™äº›<strong>ä¿å®ˆåºåˆ—</strong>ä¸<strong>ç»„è£…ç»“æœ</strong>è¿›è¡Œ<strong>æ¯”å¯¹</strong></font>ï¼Œé‰´å®šç»„è£…ç»“æœæ˜¯å¦åŒ…å«è¿™äº›åºåˆ—ï¼ŒåŒ…å«å•æ¡ã€å¤šæ¡è¿˜æ˜¯éƒ¨åˆ†æˆ–è€…ä¸åŒ…å«ç­‰æƒ…å†µç»™å‡ºç»“æœ</p>
<blockquote>
<p>BUSCO è½¯ä»¶æ ¹æ®<strong>OrthoDB æ•°æ®åº“</strong>ï¼Œæ„å»ºäº†<strong>å‡ ä¸ªå¤§çš„è¿›åŒ–åˆ†æ”¯</strong>çš„<strong>å•æ‹·è´åŸºå› é›†</strong>ã€‚å°†è½¬å½•æœ¬æ‹¼æ¥ç»“æœ<strong>ä¸è¯¥åŸºå› é›†æ¯”è¾ƒ</strong>ï¼Œæ ¹æ®æ¯”å¯¹ä¸Šçš„æ¯”ä¾‹ã€å®Œæ•´æ€§ï¼Œæ¥è¯„ä»·æ‹¼æ¥ç»“æœçš„<strong>å‡†ç¡®æ€§å’Œå®Œæ•´æ€§</strong></p>
</blockquote>
<p>åŸºäºå¤§é‡ç‰©ç§çš„<font color="blue">å•æ‹·è´åŸºå› æ„å»ºæ•°æ®é›†</font>ï¼Œç”¨äºè¯„ä¼°<font color="blue"><strong>åŸºå› ç»„ç»„è£…ï¼Œè½¬å½•ç»„ç»„è£…ï¼ŒåŸºå› æ³¨é‡Šï¼Œè›‹ç™½é›†çš„å®Œæ•´æ€§</strong></font>ã€‚core-genes æ„å»ºæ–¹å¼ï¼Œ90%ç‰©ç§å…±äº«çš„åŸºå› å³ä¸ºæ ¸å¿ƒåŸºå› ã€‚ä½¿ç”¨çš„æ˜¯ç›´ç³»åŒæºåŸºå› å®¶æ—çš„æ¦‚å¿µï¼ŒåŸºäº100ä¸ªç‰©ç§åŸºå› ç»„ï¼ŒæŸä¸€ä¸ªåŸºå› å®¶æ—å­˜åœ¨äº&gt;90ä¸ªåŸºå› ç»„ä¸­ï¼Œå³å°†è¯¥åŸºå› å®¶æ—è®¤å®šä¸ºæ ¸å¿ƒåŸºå› </p>
<p>BUSCOä½¿ç”¨å…¶ä»–å·¥å…·æ­å»ºæµç¨‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">genoem assemble : tBLASTn --&gt; Augustus --&gt; HMMER3 âˆš</span><br><span class="line">Transcriptome   :             Find ORF --&gt; HMMER3</span><br><span class="line">Gene set        :                          HMMER3</span><br></pre></td></tr></table></figure>

<h1 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h1><h2 id="conda"><a href="#conda" class="headerlink" title="conda"></a>conda</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ²¡æœ‰é•œåƒçš„è¯ï¼Œæ·»åŠ é•œåƒ</span><br><span class="line">conda config --show </span><br><span class="line">conda config --add channels conda-forge</span><br><span class="line"></span><br><span class="line"># æ„å»ºcondaçš„python3ç¯å¢ƒ</span><br><span class="line">ã€conda create --name python36 python=3.6ã€‘</span><br><span class="line">#  ç„¶åæ¿€æ´»</span><br><span class="line">ã€conda activate python36ã€‘</span><br><span class="line"># æ‰§è¡Œå®‰è£…</span><br><span class="line">ã€conda install -c conda-forge -c bioconda busco=5.3.0ã€‘</span><br><span class="line"># åœ¨ä½¿ç”¨å®Œbuscoä¹‹åå¯ä»¥é€€å‡ºpython36ç¯å¢ƒ</span><br><span class="line">ã€conda deactivateã€‘</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ç‹¬ç«‹å®‰è£…ï¼Ÿ"><a href="#ç‹¬ç«‹å®‰è£…ï¼Ÿ" class="headerlink" title="ç‹¬ç«‹å®‰è£…ï¼Ÿ"></a>ç‹¬ç«‹å®‰è£…ï¼Ÿ</h2><p>buscoï¼Œä¾èµ–Augustusï¼ŒHMMERï¼ŒBlast+</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#  ============ ä¸‹è½½BUSCO  ============ </span></span><br><span class="line"><span class="built_in">cd</span> ~/Applications/download</span><br><span class="line">wget -c https://gitlab.com/ezlab/busco/-/archive/master/busco-master.zip -O busco.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># ============ ä¸‹è½½ä¾èµ–çš„å·¥å…· ============</span></span><br><span class="line"><span class="comment"># ä¸‹è½½Augustus</span></span><br><span class="line">wget -c http://bioinf.uni-greifswald.de/augustus/binaries/augustus.current.tar.gz</span><br><span class="line"><span class="comment"># ä¸‹è½½HMMER</span></span><br><span class="line">wget -c http://eddylab.org/software/hmmer/hmmer.tar.gz -O hmmer.tar.gz</span><br><span class="line"><span class="comment"># ä¸‹è½½Blast+</span></span><br><span class="line">wget -c ftp://ftp.ncbi.nlm.nih.gov/blast/executables/LATEST/ncbi-blast-2.7.1+-x64-linux.tar.gz</span><br><span class="line"><span class="comment">#-------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="built_in">cd</span> ~/Applications/download</span><br><span class="line"></span><br><span class="line"><span class="comment"># === å®‰è£…busco ===</span></span><br><span class="line">unzip busco.zip</span><br><span class="line"><span class="comment"># æ”¹å</span></span><br><span class="line">mv busco-master busco </span><br><span class="line"><span class="comment"># ç§»åŠ¨åˆ°å¤–éƒ¨</span></span><br><span class="line">mv busco ../</span><br><span class="line"><span class="built_in">cd</span> ../busco</span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">python setup.py install</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ~/Applications/download</span><br><span class="line"><span class="comment"># === å®‰è£…Augustus ===</span></span><br><span class="line">tar -xzvf augustus.current.tar.gz</span><br><span class="line"><span class="built_in">cd</span> augustus-3.3.1</span><br><span class="line"><span class="built_in">cd</span> ../</span><br><span class="line">mv augustus-3.3.1 ../</span><br><span class="line"><span class="built_in">cd</span> ../augustus-3.3.1</span><br><span class="line"><span class="comment"># æ‰“å¼€common.mkæ–‡ä»¶ï¼Œå°†ZIPINPUT = trueæ³¨é‡Šæ‰ï¼ˆå³åœ¨æœ€å‰é¢åŠ ä¸€#å·ï¼‰</span></span><br><span class="line">vim common.mk</span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ~/Applications/download</span><br><span class="line"><span class="comment"># === å®‰è£…HMMER ===</span></span><br><span class="line">tar -xzvf hmmer.tar.gz</span><br><span class="line"><span class="built_in">cd</span> hmmer-3.2.1</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="comment"># === å®‰è£…blast+ ===</span></span><br><span class="line">tar -xzvf ncbi-blast-2.7.1+-x64-linux.tar.gz</span><br><span class="line"><span class="comment"># æ”¹å</span></span><br><span class="line">mv ncbi-blast-2.7.1+ ../blast+-2.7.1-linux</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å®‰è£…åŒ…</span></span><br><span class="line"><span class="built_in">cd</span> ~/Applications/download</span><br><span class="line">rm busco.zip</span><br><span class="line">rm augustus.current.tar.gz</span><br><span class="line">rm hmmer.tar.gz</span><br><span class="line">rm ncbi-blast-2.7.1+-x64-linux.tar.gz</span><br></pre></td></tr></table></figure>



<h2 id="ä¸‹è½½æ•°æ®åº“æ–‡ä»¶"><a href="#ä¸‹è½½æ•°æ®åº“æ–‡ä»¶" class="headerlink" title="ä¸‹è½½æ•°æ®åº“æ–‡ä»¶"></a>ä¸‹è½½æ•°æ®åº“æ–‡ä»¶</h2><p><a href="https://busco-data.ezlab.org/v5/data/lineages/">https://busco-data.ezlab.org/v5/data/lineages/</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¤§ç±»äº”ç±»</span><br><span class="line">- Bacteria ç»†èŒ</span><br><span class="line">- Protists åŸç”Ÿç”Ÿç‰©</span><br><span class="line">- Metazoa åç”ŸåŠ¨ç‰©</span><br><span class="line">- Fungi çœŸèŒ</span><br><span class="line">- Plant æ¤ç‰©</span><br><span class="line">ä¸‹è½½çš„æ˜¯æ¤ç‰©ç›¸å…³ embryophyta_odb10.2020-09-10.tar.gz</span><br><span class="line"># è§£å‹æ–‡ä»¶</span><br><span class="line">tar -xzvf embryophyta_odb9.tar.gz</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ—¶éœ€è¦å¯¹åº”çš„æ•°æ®åº“æ–‡ä»¶è·¯å¾„ ///embryophyta_odb9</p>
<h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><p>é…ç½®æ˜¯å¿…é¡»çš„ï¼Œ<strong>è¿™ä¸€æ­¥éœ€è¦ä»”ç»†ä¸€äº›ï¼Œè·¯å¾„å‡ºé”™çš„è¯æ˜¯æ— æ³•é€šè¿‡buscoçš„æ£€æµ‹çš„</strong>ï¼Œåœ¨å®‰è£…å¥½è½¯ä»¶ä¹‹å <code>~/Applications/busco/config/</code>ä¹‹ä¸­å¹¶æ²¡æœ‰<code>config.ini</code>æ–‡ä»¶ï¼Œåªæœ‰ä¸€ä¸ª<code>config.ini_default</code>æ–‡ä»¶ï¼Œå¯ä»¥æŠŠé‡Œé¢çš„å†…å®¹å¤åˆ¶ä¸‹æ¥ï¼Œ</p>
<ul>
<li>æ–¹æ³•1</li>
</ul>
<p>æ–°å»º<code>config.ini</code>æ–‡ä»¶æˆ–è€…ç›´æ¥å¤åˆ¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp config.ini_default config.ini</span><br></pre></td></tr></table></figure>

<ul>
<li>æ–¹æ³•2</li>
</ul>
<p>ä¹Ÿå¯æ–°å»º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¢åŠ é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim ~/Applications/busco/config/config.ini</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># BUSCO specific configuration</span></span><br><span class="line"><span class="comment">#It ã€overrides default valuesã€‘ in code and dataset cfg, and is ã€overridden by arguments in command lineã€‘</span></span><br><span class="line"><span class="comment"># Uncomment lines when appropriate</span></span><br><span class="line">[busco]</span><br><span class="line"><span class="comment"># Input file</span></span><br><span class="line">;<span class="keyword">in</span> = ./sample_data/target.fa</span><br><span class="line"><span class="comment"># Run name, used in output files and folder</span></span><br><span class="line">;out = SAMPLE</span><br><span class="line"><span class="comment"># Where to store the output directory</span></span><br><span class="line"><span class="comment">#ã€ï¼Ÿã€‘ out_path = /workdir</span></span><br><span class="line"><span class="comment"># Path to the BUSCO dataset</span></span><br><span class="line">;lineage_path = ./sample_data/example</span><br><span class="line"><span class="comment"># Which mode to run (ã€genome / protein / transcriptomeã€‘)</span></span><br><span class="line">;mode = genome</span><br><span class="line"><span class="comment"># How many threads to use for ã€multithreadedã€‘ steps</span></span><br><span class="line">;cpu = 1</span><br><span class="line"><span class="comment"># Domain for augustus retraining, eukaryota or prokaryota</span></span><br><span class="line"><span class="comment"># ã€Do not changeã€‘ this unless you know exactly why !!!</span></span><br><span class="line">;domain = eukaryota</span><br><span class="line"><span class="comment"># Force rewrite if files already exist (True/False)</span></span><br><span class="line">;force = False</span><br><span class="line"><span class="comment"># Restart mode (True/False)</span></span><br><span class="line">;restart = False</span><br><span class="line"><span class="comment"># Blast e-value</span></span><br><span class="line">;evalue = 1e-3</span><br><span class="line"><span class="comment"># Species to use with augustus, for old datasets only</span></span><br><span class="line">;species = fly</span><br><span class="line"><span class="comment"># Augustus extra parameters</span></span><br><span class="line"><span class="comment"># Use single quotes, like this: &#x27;--param1=1 --param2=2&#x27;</span></span><br><span class="line">;augustus_parameters = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># Tmp folder</span></span><br><span class="line">;tmp_path = ./tmp/</span><br><span class="line"><span class="comment"># How many candidate regions (contigs, scaffolds) to consider for each BUSCO</span></span><br><span class="line">;<span class="built_in">limit</span> = 3</span><br><span class="line"><span class="comment"># Augustus long mode for retraining (True/False)</span></span><br><span class="line">;long = False</span><br><span class="line"><span class="comment"># Quiet mode (True/False)</span></span><br><span class="line">;quiet = False</span><br><span class="line"><span class="comment"># Debug logs (True/False), it needs Quiet to be False</span></span><br><span class="line">debug = True</span><br><span class="line"><span class="comment"># tar gzip output files (True/False)</span></span><br><span class="line">;gzip = False</span><br><span class="line"><span class="comment"># Force single core for the tblastn step</span></span><br><span class="line">;blast_single_core = True</span><br><span class="line"></span><br><span class="line">ã€[tblastn]ã€‘</span><br><span class="line"><span class="comment"># path to tblastn</span></span><br><span class="line">path = ~/Applications/blast+-2.7.1-linux/bin</span><br><span class="line"></span><br><span class="line">ã€[makeblastdb]ã€‘</span><br><span class="line"><span class="comment"># path to makeblastdb</span></span><br><span class="line">path = ~/Applications/blast+-2.7.1-linux/bin</span><br><span class="line"></span><br><span class="line">ã€[augustus]ã€‘</span><br><span class="line"><span class="comment"># path to augustus</span></span><br><span class="line">path = ~/Applications/augustus-3.3.1/bin</span><br><span class="line"></span><br><span class="line">ã€[etraining]ã€‘</span><br><span class="line"><span class="comment"># path to augustus etraining</span></span><br><span class="line">path = ~/Applications/augustus-3.3.1/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># path to augustus perl scripts, redeclare it for each new script        </span></span><br><span class="line">ã€[gff2gbSmallDNA.pl]ã€‘                                                      </span><br><span class="line">path = ~/Applications/augustus-3.3.1/scripts                         </span><br><span class="line">ã€[new_species.pl]ã€‘                                                         </span><br><span class="line">path = ~/Applications/augustus-3.3.1/scripts                         </span><br><span class="line">ã€[optimize_augustus.pl]ã€‘                                                   </span><br><span class="line">path = ~/Applications/augustus-3.3.1/scripts                         </span><br><span class="line">                                                                         </span><br><span class="line">ã€[hmmsearch]ã€‘                                                              </span><br><span class="line"><span class="comment"># path to HMMsearch executable                                           </span></span><br><span class="line">path = ~/Applications/hmmer-3.2.1/src                                </span><br><span class="line">                                                                         </span><br><span class="line">ã€[Rscript]ã€‘                                                                </span><br><span class="line"><span class="comment"># path to Rscript, if you wish to use the plot tool                      </span></span><br><span class="line">path = /usr/bin/</span><br></pre></td></tr></table></figure>

<p>æ–°å»ºconfig.ini`æ–‡ä»¶ä¹‹åï¼Œ</p>
<ol>
<li>å°†<code>config.ini</code>æ–‡ä»¶ä¸­çš„<code>out_path = /workdir</code>å‰é¢åŠ ä¸Š<code>#</code><br>å› ä¸ºè¾“å‡ºè·¯å¾„æœ‰æ—¶å€™ä¼šå‡ºé”™ï¼Œæ‰€ä»¥æ³¨é‡Šæ‰ï¼Œä¹‹åè¿è¡Œbuscoï¼Œ<font color="blue">è¾“å‡ºçš„è·¯å¾„å°±æ˜¯cdçš„è·¯å¾„</font></li>
<li>ä¹‹åéœ€è¦æ”¹è¿™å‡ é¡¹å¯¹åº”çš„è·¯å¾„ï¼ˆ<strong>é‡Œé¢çš„è·¯å¾„éœ€è¦æ›´æ”¹ä¸ºè‡ªå·±çš„å·¥å…·çš„è·¯å¾„</strong>ï¼‰</li>
</ol>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ç›¸å…³</th>
</tr>
</thead>
<tbody><tr>
<td>[tblastn]</td>
<td>blast+</td>
</tr>
<tr>
<td>[makeblastdb]</td>
<td>blast+</td>
</tr>
<tr>
<td>[augustus]</td>
<td>Augustus</td>
</tr>
<tr>
<td>[hmmsearch]</td>
<td>HMMER</td>
</tr>
<tr>
<td>[gff2gbSmallDNA.pl]</td>
<td>Augustus</td>
</tr>
<tr>
<td>[new_species.pl]</td>
<td>Augustus</td>
</tr>
<tr>
<td>[optimize_augustus.pl]</td>
<td>Augustus</td>
</tr>
<tr>
<td>[hmmsearch]</td>
<td>HMMER</td>
</tr>
</tbody></table>
<h1 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># augustuså·¥å…·çš„æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;/home/ssd/Applications/augustus-3.3.1/bin:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="comment"># augustuså·¥å…·é™„åŠ è„šæœ¬æ‰€åœ¨æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;/home/ssd/Applications/augustus-3.3.1/scripts:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="comment"># augustuså·¥å…·é…ç½®æ–‡ä»¶çš„æ‰€åœ¨ä½ç½® ã€‚AUGUSTUS_CONFIG_PATH éœ€è¦ä½¿ç”¨ç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="built_in">export</span> AUGUSTUS_CONFIG_PATH=<span class="string">&quot;/home/ssd/Applications/augustus-3.3.1/config&quot;</span></span><br><span class="line"><span class="comment"># hmmerå·¥å…·çš„æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;/home/ssd/Applications/hmmer-3.2.1/src:<span class="variable">$PATH</span>&quot;</span></span><br><span class="line"><span class="comment"># blast+å·¥å…·çš„æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">&quot;/home/ssd/Applications/blast+-2.7.1-linux/bin:<span class="variable">$PATH</span>&quot;</span></span><br></pre></td></tr></table></figure>



<h1 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">run_BUSCO.py -i [ç»„è£…çš„æ–‡ä»¶.fasta]  -l  [æ•°æ®åº“æ–‡ä»¶å¤¹] -o [è¾“å‡ºæ–‡ä»¶å] -m [è¯„ä¼°æ¨¡å¼] [å…¶ä»–ä¸€äº›é€‰é¡¹]</span><br></pre></td></tr></table></figure>

<p>å®ä¾‹ï¼Œå¦‚æœç”¨<code>conda</code>å®‰è£…BUSCOã€‚æ‰§è¡Œåªéœ€å†™<code>busco</code>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆcdåˆ°å¯¹åº”çš„ç»„è£…æ–‡ä»¶çš„æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment"># ç¡®ä¿canuå…¨è·¯å¾„ï¼Œcondaå®‰è£…ï¼Œwhich busco</span></span><br><span class="line"><span class="comment"># -i è¾“å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># -l BUSCOçš„æ•°æ®åº“æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># -o è¾“å‡ºçš„æ–‡ä»¶åçš„åç¼€ä»¥åŠæ–‡ä»¶å¤¹çš„åç§°</span></span><br><span class="line"><span class="comment"># -m åˆ†æç±»å‹ï¼ˆgenomeã€transcriptomeã€proteinsï¼‰</span></span><br><span class="line"><span class="comment"># --cpu çº¿ç¨‹æ•°</span></span><br><span class="line">busco \</span><br><span class="line">    -i contigs.fasta \</span><br><span class="line">    -l ~/database/BUSCO/embryophyta_odb9 \</span><br><span class="line">    -o suffix\</span><br><span class="line">    -m genome \</span><br><span class="line">    --cpu 8</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a><font color="red">å‚æ•°</font></h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">usage: busco -i [SEQUENCE_FILE] -l [LINEAGE] -o [OUTPUT_NAME] -m [MODE] [OTHER OPTIONS]</span><br><span class="line"></span><br><span class="line">Welcome to BUSCO 5.3.0: the Benchmarking Universal Single-Copy Ortholog assessment tool.</span><br><span class="line">For more detailed usage information, please review the README file provided with this distribution and the BUSCO user guide. Visit this page https://gitlab.com/ezlab/busco<span class="comment">#how-to-cite-busco to see how to cite BUSCO</span></span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  <span class="string">&#x27;-i&#x27;</span> SEQUENCE_FILE, --<span class="keyword">in</span> SEQUENCE_FILE</span><br><span class="line">                        Input sequence file <span class="keyword">in</span> <span class="string">&#x27;FASTA format&#x27;</span>. Can be an assembled genome or transcriptome (DNA), or protein sequences from an annotated gene <span class="built_in">set</span>. Also possible to use a path to a directory containing multiple input files.</span><br><span class="line">  <span class="string">&#x27;-o&#x27;</span> OUTPUT, --out OUTPUT</span><br><span class="line">                        Give your analysis run a recognisable short name. <span class="string">&#x27;Output folders and files will be labelled with this name&#x27;</span>. The path to the output folder is <span class="built_in">set</span> with --out_path.</span><br><span class="line">  <span class="string">&#x27;-m&#x27;</span> MODE, --mode MODE  Specify <span class="built_in">which</span> BUSCO analysis mode to run.</span><br><span class="line">                        There are three valid modes:</span><br><span class="line">                        - geno or <span class="string">&#x27;genome&#x27;</span>, <span class="keyword">for</span> genome assemblies (DNA)</span><br><span class="line">                        - tran or transcriptome, <span class="keyword">for</span> transcriptome assemblies (DNA)</span><br><span class="line">                        - prot or proteins, <span class="keyword">for</span> annotated gene sets (protein)</span><br><span class="line">  <span class="string">&#x27;-l&#x27;</span> LINEAGE, --lineage_dataset LINEAGE</span><br><span class="line">                        Specify the name of the BUSCO lineage to be used<span class="string">&#x27;database?&#x27;</span></span><br><span class="line">  --augustus            Use augustus gene predictor <span class="keyword">for</span> eukaryote runs</span><br><span class="line">  --augustus_parameters --PARAM1=VALUE1,--PARAM2=VALUE2</span><br><span class="line">                        Pass additional arguments to Augustus. All arguments should be contained within a single string with no white space, with each argument separated by a comma.</span><br><span class="line">  --augustus_species AUGUSTUS_SPECIES</span><br><span class="line">                        Specify a species <span class="keyword">for</span> Augustus training.</span><br><span class="line">  --auto-lineage        Run auto-lineage to find optimum lineage path</span><br><span class="line">  --auto-lineage-euk    Run auto-placement just on eukaryote tree to find optimum lineage path</span><br><span class="line">  --auto-lineage-prok   Run auto-lineage just on non-eukaryote trees to find optimum lineage path</span><br><span class="line">  <span class="string">&#x27;-c&#x27;</span> N, --cpu N         Specify the number (N=<span class="built_in">integer</span>) of threads/cores to use.</span><br><span class="line">  <span class="string">&#x27;--config&#x27;</span> CONFIG_FILE  Provide a config file</span><br><span class="line">  --datasets_version DATASETS_VERSION</span><br><span class="line">                        Specify the version of BUSCO datasets, e.g. odb10</span><br><span class="line">  <span class="string">&#x27;--download&#x27;</span> [dataset [dataset ...]]</span><br><span class="line">                        Download dataset. Possible values are a specific dataset name, <span class="string">&quot;all&quot;</span>, <span class="string">&quot;prokaryota&quot;</span>, <span class="string">&quot;eukaryota&quot;</span>, or <span class="string">&quot;virus&quot;</span>. If used together with other <span class="built_in">command</span> line arguments, make sure to place this last.</span><br><span class="line">  --download_base_url DOWNLOAD_BASE_URL</span><br><span class="line">                        Set the url to the remote BUSCO dataset location</span><br><span class="line">  --download_path DOWNLOAD_PATH</span><br><span class="line">                        Specify <span class="built_in">local</span> filepath <span class="keyword">for</span> storing BUSCO dataset downloads</span><br><span class="line">  <span class="string">&#x27;-e&#x27;</span> N, --evalue N      <span class="string">&#x27;E-value cutoff for BLAST searches&#x27;</span>. Allowed formats, 0.001 or 1e-03 (Default: 1e-03)</span><br><span class="line">  -f, --force           Force rewriting of existing files. Must be used when output files with the provided name already exist.</span><br><span class="line">  -h, --<span class="built_in">help</span>            Show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  --<span class="built_in">limit</span> N             How many candidate regions (contig or transcript) to consider per BUSCO (default: 3)</span><br><span class="line">  --list-datasets       Print the list of available BUSCO datasets</span><br><span class="line">  --long                Optimization Augustus self-training mode (Default: Off); adds considerably to the run time, but can improve results <span class="keyword">for</span> some non-model organisms</span><br><span class="line">  --metaeuk_parameters <span class="string">&quot;--PARAM1=VALUE1,--PARAM2=VALUE2&quot;</span></span><br><span class="line">                        Pass additional arguments to Metaeuk <span class="keyword">for</span> the first run. All arguments should be contained within a single string with no white space, with each argument separated by a comma.</span><br><span class="line">  --metaeuk_rerun_parameters <span class="string">&quot;--PARAM1=VALUE1,--PARAM2=VALUE2&quot;</span></span><br><span class="line">                        Pass additional arguments to Metaeuk <span class="keyword">for</span> the second run. All arguments should be contained within a single string with no white space, with each argument separated by a comma.</span><br><span class="line">  <span class="string">&#x27;--offline&#x27;</span>            <span class="string">&#x27;To indicate that BUSCO cannot attempt to download files&#x27;</span></span><br><span class="line">  --out_path OUTPUT_PATH</span><br><span class="line">                        Optional location <span class="keyword">for</span> results folder, excluding results folder name. <span class="string">&#x27;Default is current working directory&#x27;</span>.</span><br><span class="line">  -q, --quiet           Disable the info logs, <span class="string">&#x27;displays only errors&#x27;</span></span><br><span class="line">  -r, --restart         <span class="string">&#x27;Continue a run that had already partially completed&#x27;</span>.</span><br><span class="line">  --tar                 <span class="string">&#x27;Compress some subdirectories with many files to save space&#x27;</span></span><br><span class="line">  --update-data         Download and replace with last versions all lineages datasets and files necessary to their automated selection</span><br><span class="line">  -v, --version         Show this version and <span class="built_in">exit</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>fastaæ–‡ä»¶ä¸­ï¼Œä¸€äº›ç»„è£…å·¥å…·ç”Ÿæˆçš„<code>contig</code>çš„åå­—æ˜¯å½¢å¦‚<code>&gt;contig/1/12345</code>ä¹‹ç±»çš„ï¼Œè¿™ç§fastaæ–‡ä»¶è¿è¡Œæ—¶BUSCOä¼šæŠ¥é”™ï¼Œè§£å†³åŠæ³•æ˜¯æ”¹åï¼Œperlå•è¡Œã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat contig.fasta | perl -p -e <span class="string">&#x27;s&#123;/&#125;&#123;&#125;g&#x27;</span> &gt; contig.new.fasta</span><br></pre></td></tr></table></figure>





<h1 id="ç»“æœè§£è¯»"><a href="#ç»“æœè§£è¯»" class="headerlink" title="ç»“æœè§£è¯»"></a>ç»“æœè§£è¯»</h1><p>åœ¨è¿è¡Œæ–‡ä»¶å¤¹ä¸‹ä¼šæœ‰</p>
<ul>
<li><code>run_suffix</code> æ–‡ä»¶å¤¹ï¼šå› ä¸ºä¸Šé¢<code>-o</code>é€‰é¡¹è®¾ç½®äº†<code>suffix</code>ï¼Œæ‰€ä»¥æ–‡ä»¶å¤¹åç§°åŠ äº†åç¼€ã€‚æ–‡ä»¶å¤¹é‡Œï¼Œæœ‰ä¸€ä¸ªæ–‡ä»¶æœ€ä¸ºé‡è¦ã€‚æ˜¯<code>short_summary_suffix.txt</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Summarized benchmarking in BUSCO notation for file assembly/spades/contigs.fasta</span><br><span class="line"># BUSCO was run in mode: genome</span><br><span class="line">    C:98.6%[S:98.6%,D:0.0%],F:0.0%,M:1.4%,n:148</span><br><span class="line"></span><br><span class="line">    146 Complete BUSCOs (C)</span><br><span class="line">    146 Complete and single-copy BUSCOs (S)</span><br><span class="line">    0   Complete and duplicated BUSCOs (D)</span><br><span class="line">    0   Fragmented BUSCOs (F)</span><br><span class="line">    2   Missing BUSCOs (M)</span><br><span class="line">    148 Total BUSCO groups searched</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">ç¼©å†™</th>
<th>å…¨ç§°</th>
<th>è¯´æ˜</th>
<th>å…³ç³»</th>
</tr>
</thead>
<tbody><tr>
<td align="left">C</td>
<td>Complete</td>
<td>å¤šå°‘ä¸ªBUSCOæµ‹è¯•åŸºå› è¢«è¦†ç›–ã€‚</td>
<td>C = S + D</td>
</tr>
<tr>
<td align="left">S</td>
<td>single-copy</td>
<td>å¤šå°‘ä¸ªåŸºå› ç»è¿‡æ¯”å¯¹å‘ç°æ˜¯å•æ‹·è´ã€‚</td>
<td>-</td>
</tr>
<tr>
<td align="left">D</td>
<td>duplicated</td>
<td>å¤šå°‘ä¸ªåŸºå› ç»è¿‡æ¯”å¯¹å‘ç°åŒ…å«å¤šæ‹·è´ã€‚</td>
<td>-</td>
</tr>
<tr>
<td align="left">F</td>
<td>Fragment</td>
<td>å¤šå°‘ä¸ªåŸºå› ç»è¿‡æ¯”å¯¹è¦†ç›–ä¸å®Œå…¨ï¼Œåªæ˜¯éƒ¨åˆ†æ¯”å¯¹ä¸Šã€‚</td>
<td>-</td>
</tr>
<tr>
<td align="left">M</td>
<td>Miss</td>
<td>æ²¡æœ‰å¾—åˆ°æ¯”å¯¹ç»“æœçš„åŸºå› æ•°</td>
<td>-</td>
</tr>
<tr>
<td align="left">Total</td>
<td>Total</td>
<td>æ€»å…±æµ‹è¯•çš„åŸºå› æ¡ç›®æ•°</td>
<td>Total = C + F + M</td>
</tr>
</tbody></table>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">ä¸€èˆ¬æƒ…å†µä¸‹å¯¹äºå®Œæ•´åº¦è¾ƒå¥½çš„åŸºå› ç»„ç»„è£…ç»“æœæ¥è®²ï¼ŒComplete and single-copyè¶Šå¤šè¶Šå¥½ï¼Œè€ŒComplete and duplicatedå’ŒMissingè¶Šå°‘è¶Šå¥½ï¼Œå¯¹äºFragmentedä¹Ÿå°½å¯èƒ½åœ°å°‘ä¸€äº›ã€‚</span><br><span class="line">çœŸå®é¡¹ç›®ä¸­ï¼ŒComplete BUSCOs (C) çš„æ¯”ä¾‹é€šå¸¸éƒ½èƒ½è¾¾åˆ° <span class="number">80%</span> ä»¥ä¸Šã€‚</span><br><span class="line">Cå€¼è¡¨ç¤ºå’ŒBUSCOé›†ç›¸æ¯”çš„å®Œæ•´åº¦ï¼ŒMå€¼è¡¨ç¤ºå¯èƒ½ç¼ºå°‘çš„åŸºå› æ•°ï¼ŒDåˆ™æ˜¯é‡å¤æ•°ã€‚</span><br></pre></td></tr></table></figure>



<p>ä¸‰ç§æ¯”å¯¹</p>
<ul>
<li>æƒ…å†µ1 - å®Œå…¨è¦†ç›–</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">è¯´æ˜: +è¡¨ç¤ºç»„è£…å¾—åˆ°åŸºå› åºåˆ— -è¡¨ç¤ºç”¨äºæµ‹è¯•çš„åŸºå› åºåˆ—</span><br><span class="line"></span><br><span class="line">ç»„è£… : ================+++++++==============</span><br><span class="line">æµ‹è¯•                   -------</span><br><span class="line">                       æˆ–è€…</span><br><span class="line">ç»„è£… : ==============+++++++++++============</span><br><span class="line">æµ‹è¯•                   -------               </span><br></pre></td></tr></table></figure>

<ul>
<li>æƒ…å†µ2 - éƒ¨åˆ†è¦†ç›–</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç»„è£… : ================+++++++==============</span><br><span class="line">æµ‹è¯•                   -----</span><br><span class="line">                     /      \</span><br><span class="line">                       æˆ–è€…</span><br><span class="line">ç»„è£… : ================+++++++==============</span><br><span class="line">æµ‹è¯•                   -------</span><br><span class="line">                     /        \</span><br></pre></td></tr></table></figure>

<ul>
<li>æƒ…å†µ3 - æ²¡æœ‰æ¯”å¯¹</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç»„è£… : ================+++++++==============</span><br><span class="line">æµ‹è¯• </span><br></pre></td></tr></table></figure>

<p>ä¸€èˆ¬<code>S</code> + <code>D</code>çš„æ•°å€¼ä¹Ÿå°±æ˜¯<code>C</code>çš„å€¼è¶Šå¤§è¶Šå¥½ï¼Œä½†æ˜¯åœ¨æ–‡çŒ®ä¸­ä½œè€…è¯´å¦‚æœ<code>D</code>çš„æ•°å€¼å¤ªå¤šçš„è¯å¯èƒ½æ„å‘³ç€ç»„è£…é”™è¯¯çš„å¯èƒ½æ€§è¾ƒå¤§ã€‚å› ä¸ºä¸€ä¸ªåŸºå› ï¼ˆBUSCOæ•°æ®åº“ä¸­è¯¥åŸºå› ä¸€èˆ¬ä¸ºå•æ‹·è´ï¼‰è¢«è¦†ç›–å¤šæ¬¡ï¼Œé‚£ä¹ˆå¯èƒ½å°±æ˜¯è¯´è¯¥åŸºå› æ‰€åœ¨çš„ç‰‡æ®µç»„è£…å¯èƒ½å‡ºç°é—®é¢˜ã€‚<br>å› ä¸ºç†è®ºä¸Š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç†è®ºä¸Šï¼š--------------------------------------------</span><br><span class="line">å®é™…ä¸Šï¼š--------   ----------    ----------    -----</span><br><span class="line">é”™è¯¯çš„ï¼š--------                 -------------</span><br><span class="line">           \\\\                    ///</span><br><span class="line">          -----------     --------------</span><br></pre></td></tr></table></figure>

<p>ç†è®ºä¸Šç»„è£…ä¹‹åå„ä¸ªç‰‡æ®µä¹‹é—´åº”è¯¥å‰åæœ‰åºï¼Œä¹‹é—´é™¤äº†é‡å¤åŒºåŸŸæˆ–è€…å…¶ä»–ç‰¹æ®Šç‰‡æ®µä¹‹å¤–ä¸åº”è¯¥æœ‰å¯ä»¥é‡å çš„åœ°æ–¹ã€‚<br>ä¾‹å¦‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sequence1 : ..TAGTCGTGA                         GTGCATGCTGTAGC..</span><br><span class="line">                       \                       /</span><br><span class="line">                        AAAATTGG......CGATGAAAA</span><br><span class="line">                       /                       \</span><br><span class="line">sequence2 : ..GGGTAGCGG                         TTGACTAGCTAGCT..</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ä¸­é—´ä¸€æ®µåºåˆ—æ˜¯ä¸¤ä¸ªåºåˆ—çš„å…±åŒéƒ¨åˆ†ï¼Œé™¤éè¿™ä¸ªåºåˆ—å­˜åœ¨å¤šä¸ªæ‹·è´ï¼Œå¦åˆ™å°±å¾ˆå¯èƒ½æ˜¯æ‹¼æ¥é”™è¯¯ã€‚é€šå¸¸ä¸€èˆ¬è¿™ç§æ‹¼æ¥é”™è¯¯çš„åºåˆ—çš„ä¸¤ç«¯ä¼šå‡ºç°é‡å¤åºåˆ—ã€‚å¦å¤–å¦‚æœæ˜¯å¤šå€ä½“ç»„è£…çš„è¯ï¼Œ<code>D</code>å€¼ä¹Ÿå¯èƒ½å¤§ã€‚</p>
<p>ä¸€èˆ¬æ¥çœ‹ï¼Œ<code>S</code>ä¼¼ä¹è¶Šå¤§è¶Šå¥½ï¼Œ<code>M</code>è¶Šå°è¶Šå¥½ï¼Œè¯´æ˜ç»„è£…çš„è¶Šå®Œæ•´ï¼Œå› ä¸ºæ£€æµ‹çš„å•æ‹·è´åŒæºåŸºå› å‡ºç°å¾—å¤šã€‚ä½†æ˜¯<code>D</code>ä¸<code>F</code>è¿™ä¸¤ä¸ªæ•°å€¼è¶Šå¤§ä¸è§å¾—å°±æ˜¯å¥½çš„ï¼Œå› ä¸ºç»„è£…çš„é”™è¯¯å¯èƒ½ä¼šå¸¦æ¥è¿™ä¸¤ä¸ªå€¼çš„å¢å¤§ã€‚ä¸èƒ½ä»…ä»…åªæ˜¯é€šè¿‡è¿™ä¸€ä¸ªè½¯ä»¶æ¥åˆ¤å®šã€‚æ¯”å¦‚è¿˜å¯ä»¥å€ŸåŠ©<code>QUAST</code>å’Œå¸¸è§„æŒ‡æ ‡<code>N50</code>ã€<code>æ€»çš„æ ¸é…¸é‡</code>ã€<code>ç‚¹é˜µå›¾</code>ç­‰ç­‰å¤šä¸ªè¾…åŠ©æ ‡å‡†æ¥è¿›è¡Œç»¼åˆçš„è¯„ä¼°ã€‚</p>
<h1 id="ç”»å›¾"><a href="#ç”»å›¾" class="headerlink" title="ç”»å›¾"></a>ç”»å›¾</h1><p>æ‰§è¡Œå®Œæ¯•åï¼Œå¯ä½¿ç”¨<code>generate_plot.py</code>ç”»å›¾ï¼Œæ¡å½¢å›¾ã€‚</p>
<ul>
<li>é¦–å…ˆæŠŠæ‰€æœ‰ç»è¿‡BUSCOæ£€æµ‹çš„ç»“æœèšé›†åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¹‹å†…</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir my_summaries</span><br><span class="line">cp run_SPEC1/short_summary_SPEC1.txt my_summaries/.</span><br><span class="line">cp run_SPEC2/short_summary_SPEC2.txt my_summaries/.</span><br><span class="line">cp run_SPEC3/short_summary_SPEC3.txt my_summaries/.</span><br><span class="line">cp run_SPEC4/short_summary_SPEC4.txt my_summaries/.</span><br><span class="line">cp run_SPEC5/short_summary_SPEC5.txt my_summaries/.</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿è¡Œ</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python scripts/generate_plot.py â€“wd my_summaries</span><br></pre></td></tr></table></figure>

<p>äº”ä¸ªæ•°å€¼å˜æˆæ¡å½¢å›¾æ˜¾ç¤ºï¼Œå¯¹æ¯”æ›´åŠ æ˜æ˜¾.</p>
]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>denovo-III</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€paperã€‘Insight into the evolution of the Solanaceae from the parental genomes of Petunia hybrida</title>
    <url>/blog/2022/03/02/2022-03-02-paper-Petunia/</url>
    <content><![CDATA[<p>Solanaceae èŒ„ç§‘</p>
<span id="more"></span>

<h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>The assemblies include 91.3% and 90.2% coverage of their diploid genomes (1.4 Gb; 2n = 14) containing 32,928 and 36,697 protein-coding genes, respectively. The genomes reveal that the Petunia lineage has experienced at least two rounds of hexaploidization: the older gamma event, which is shared with most Eudicots, and a more recent Solanaceae event that is shared with tomato and other solanaceous species. Transcription factors involved in the shift from bee to moth pollination reside in particularly dynamic regions of the genome, which may have been key to the remarkable diversity of floral colour patterns and pollination systems. The high-quality genome sequences will enhance the value of Petunia as a model system for research on unique biological phenomena such as small RNAs, symbiosis, self-incompatibility and circadian rhythms.</p>
<p>çŸ®ç‰µç‰›æ˜¯ä¸€ç§æµè¡Œçš„èŠ±å›æ¤ç‰©ï¼Œä½œä¸ºä¸€ç§é—ä¼ å­¦æ¨¡å¼ç³»ç»Ÿæœ‰ç€æ‚ ä¹…çš„å†å²ã€‚æˆ‘ä»¬æŠ¥é“äº†å…¶ä¸¤ä¸ªé‡ç”Ÿäº²æœ¬è…‹æ¯›å‡å•èƒèŒ(P. axillaris N)å’Œè†¨èƒ€å‡å•èƒèŒ(P. inflata S6)è¿‘äº¤ç³»è¡ç”Ÿç‰©çš„å…¨åŸºå› ç»„æµ‹åºå’Œç»„è£…ã€‚è¯¥ç»„åˆçš„äºŒå€ä½“åŸºå› ç»„è¦†ç›–ç‡ä¸º91.3%å’Œ90.2% (1.4 Gb;2n = 14)ï¼Œåˆ†åˆ«å«æœ‰32,928ä¸ªå’Œ36,697ä¸ªè›‹ç™½ç¼–ç åŸºå› ã€‚åŸºå› ç»„æ˜¾ç¤ºçŸ®çŸ®èŠ±è‡³å°‘ç»å†äº†ä¸¤è½®å…­å€åŒ–:æ›´å¤è€çš„ä¼½ç›äº‹ä»¶ï¼Œä¸å¤§å¤šæ•°åŒå­å¶æ¤ç‰©å…±äº«ï¼Œä»¥åŠæ›´è¿‘çš„èŒ„ç§‘äº‹ä»¶ï¼Œä¸ç•ªèŒ„å’Œå…¶ä»–èŒ„ç§‘æ¤ç‰©å…±äº«ã€‚è½¬å½•å› å­å‚ä¸äº†ä»èœœèœ‚åˆ°é£è›¾çš„ä¼ ç²‰è¿‡ç¨‹ï¼Œå®ƒä»¬ä½äºåŸºå› ç»„ä¸­ç‰¹åˆ«æ´»è·ƒçš„åŒºåŸŸï¼Œè¿™å¯èƒ½æ˜¯èŠ±çš„é¢œè‰²æ¨¡å¼å’Œä¼ ç²‰ç³»ç»Ÿæ˜¾è‘—å¤šæ ·æ€§çš„å…³é”®ã€‚é«˜è´¨é‡çš„åŸºå› ç»„åºåˆ—å°†æé«˜çŸ®ç§çŸ®èŠ±ä½œä¸ºç ”ç©¶å°rnaã€å…±ç”Ÿã€è‡ªäº¤ä¸äº²å’Œæ€§å’Œæ˜¼å¤œèŠ‚å¾‹ç­‰ç‹¬ç‰¹ç”Ÿç‰©ç°è±¡çš„æ¨¡å‹ç³»ç»Ÿçš„ä»·å€¼ã€‚</p>
<p>çŸ®ç‰µç‰›ï¼ˆ<em>Petunia hybrida</em>ï¼‰å±äºèŒ„ç§‘ï¼ˆSolanaceaeï¼‰ï¼Œæ˜¯ä¸€ç§æµè¡Œçš„èŠ±å›æ¤ç‰©ï¼Œé•¿æœŸä½œä¸ºä¸€ä¸ªé—ä¼ æ¨¡å¼ç³»ç»Ÿã€‚æœ¬è®ºæ–‡æŠ¥é“äº†çŸ®ç‰µç‰›çš„ä¸¤ä¸ªé‡ç”Ÿäº²æœ¬çš„åŸºå› ç»„ï¼Œ<em>P. axillaris</em> N å’Œ <em>P. inflata</em> S6ã€‚The assemblies include 91.3% and 90.2% coverage of their diploid genomes (1.4 Gb; 2n = 14) containing 32,928 and 36,697 protein-coding genes, respectively. ç»„è£…çš„åŸºå› ç»„çŸ®ç‰µç‰›çš„åŸºå› ç»„å¤§å°å¤§çº¦æ˜¯1.4Gbï¼Œ14å¯¹æŸ“è‰²ä½“ã€‚æŠ¥é“çš„ä¸¤ä¸ªåŸºå› ç»„åˆ†åˆ«æ³¨é‡Šåˆ°32928å’Œ36697ä¸ªç¼–ç è›‹ç™½åŸºå› ã€‚</p>
<p><em>P. axillaris</em> N åŸºå› ç»„çš„ç»„è£…åˆ©ç”¨äº†137 Xçš„äºŒä»£æµ‹åºï¼ˆIlluminaï¼‰æ•°æ®å’Œ 21 Xä¸‰ä»£æµ‹åºï¼ˆPacBioï¼‰æŠ€æœ¯æ•°æ®ï¼Œ<em>P. inflata</em> S6 åŸºå› ç»„çš„ç»„è£…åˆ©ç”¨äº† 135 X çš„äºŒä»£æµ‹åºæ•°æ®ï¼Œæµ‹åºæ·±åº¦éƒ½ä¸ä½ã€‚ç›¸ä¿¡çŸ®ç‰µç‰›åŸºå› ç»„çš„å‘å¸ƒä¼šæ¨åŠ¨è‡ªäº¤ä¸äº²å’Œã€èŠ±è‰²ç­‰æ–¹é¢çš„ç ”ç©¶ã€‚</p>
]]></content>
      <categories>
        <category>paper</category>
      </categories>
      <tags>
        <tag>petunia</tag>
      </tags>
  </entry>
  <entry>
    <title>HiFi-3-assemble-software</title>
    <url>/blog/2022/03/02/2022-03-02-HiFi-3-software/</url>
    <content><![CDATA[<p>Hifiasm is a <font color="blue"><strong>fast haplotype-resolved de novo assembler</strong></font> for <font color="blue"><strong>PacBio HiFi reads(High Fidelity,high accuracy consensus reads)</strong></font>. HiCanu, Hifiasm, BUSCO, Peregrine, minimap2</p>
<span id="more"></span>



<h1 id="HiFi-å¿«-å‡†-ç‹ "><a href="#HiFi-å¿«-å‡†-ç‹ " class="headerlink" title="HiFi å¿« å‡† ç‹ "></a><a href="https://zhuanlan.zhihu.com/p/138395531">HiFi å¿« å‡† ç‹ </a></h1><h2 id="ç»„è£…å¿«"><a href="#ç»„è£…å¿«" class="headerlink" title="ç»„è£…å¿«"></a>ç»„è£…å¿«</h2><p>CLRæˆ–Nanoporeé•¿Readsæµ‹åºå‡†ç¡®æ€§è¾ƒä½ï¼Œè¿›è¡Œç»„è£…æ—¶éœ€è¦åˆ©ç”¨é«˜å‡†ç¡®æ€§IlluminaçŸ­Readsçº é”™ã€‚è€ŒHiFi Readsæœ¬èº«å³é«˜å‡†ç¡®æ€§é•¿Readsï¼Œå¯ç›´æ¥æ‹¼æ¥ï¼Œå› æ­¤å¤§å¤§èŠ‚çœè¿ç®—èµ„æºå’Œæ—¶é—´ã€‚ç¬¬ä¸€ç¯‡åˆ©ç”¨HiFiè¿›è¡ŒäººåŸºå› ç»„ç»„è£…çš„æŠ¥é“è¡¨æ˜ï¼Œ<font color="red"><strong>HiFi Readsç»„è£…é€Ÿåº¦æ¯”CLR Readså¿«10â€“100å€</strong></font> <a href="https://pubmed.ncbi.nlm.nih.gov/31406327/">[1]</a>ã€‚å¦ä¸€é¡¹åŒæ—¶åˆ©ç”¨HiFi å’ŒCLR å¯¹äººåŸºå› ç»„ç»„è£…çš„æ¯”è¾ƒä¸­ï¼ŒHiFi ç»„è£…ä»…èŠ±è´¹çº¦2,800ä¸ªCPUæ—¶ï¼Œè€ŒCLR ç»„è£…èŠ±è´¹è¶…è¿‡50,000ä¸ªCPUæ—¶ï¼Œåˆ©ç”¨Nanopore Readsè¿›è¡Œç»„è£…æ›´æ˜¯èŠ±è´¹çº¦151,000ä¸ªCPUæ—¶ <a href="https://pubmed.ncbi.nlm.nih.gov/31711268/">[2]</a>ã€‚27 Gbå…­å€ä½“åŠ å·çº¢æ‰è¶…å¤§åŸºå› ç»„ï¼Œåˆ©ç”¨HiFi Readsä¸¤å‘¨å°±å®Œæˆç»„è£…ã€‚</p>
<h2 id="ç»„è£…å‡†"><a href="#ç»„è£…å‡†" class="headerlink" title="ç»„è£…å‡†"></a>ç»„è£…å‡†</h2><h3 id="1-è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“"><a href="#1-è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“" class="headerlink" title="1 è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“"></a>1 è¿ç»­æ€§ä¸CLRå’ŒNanoporeç›¸å½“</h3><p>è™½HiFi Readsåœ¨<font color="red"><strong>è¯»é•¿æ‰“æŠ˜æ‰£</strong></font>ï¼Œä½†åœ¨<font color="red"><strong>è¿ç»­æ€§æ–¹é¢æ¯«ä¸é€Šè‰²</strong></font>äºPacBio CLRå’ŒNanopore Readsã€‚åŒæ—¶åˆ©ç”¨HiFi å’ŒCLR å¯¹äººåŸºå› ç»„ç»„è£…çš„æ¯”è¾ƒä¸­ï¼Œ<font color="red"><strong>HiFi å’ŒCLR ç»„è£…çš„Contigs N50ç›¸å½“</strong></font>ï¼ˆ25.52 Mbå’Œ29.26 Mbï¼‰ã€‚ä¸€èˆ¬è®¤ä¸º<font color="red">Nanopore ultra-long</font>åœ¨åŸºå› ç»„ç»„è£…<font color="red"><strong>è¿ç»­æ€§æ›´å…·ä¼˜åŠ¿</strong></font>ï¼Œä½†åŒæ—¶åˆ©ç”¨HiFi å’ŒNanopore è¿›è¡Œæ°´ç¨»ç»„è£…çš„æŠ¥é“ä¸­ï¼Œä¸‰ä¸ªç»„è£…è½¯ä»¶ä¸­ä¸¤ä¸ªçš„ç»„è£…ç»“æœéƒ½æ˜¾ç¤º<font color="red"><strong>HiFi ç»„è£…Contigs N50é«˜äºNanopore Reads</strong></font> <a href="https://pubmed.ncbi.nlm.nih.gov/33319909/">[3]</a>ã€‚</p>
<h3 id="2-ç»„è£…è´¨é‡æ˜¾è‘—æå‡"><a href="#2-ç»„è£…è´¨é‡æ˜¾è‘—æå‡" class="headerlink" title="2 ç»„è£…è´¨é‡æ˜¾è‘—æå‡"></a>2 ç»„è£…è´¨é‡æ˜¾è‘—æå‡</h3><p>ç”±äºHiFi ä¸IllunimaçŸ­Readså…·æœ‰ç›¸å½“çš„ç¢±åŸºå‡†ç¡®æ€§ï¼Œå› æ­¤åœ¨ç»„è£…ä¸Šå…·æœ‰CLRå’ŒNanoporeæ— æ³•æ¯”æ‹Ÿçš„ä¼˜åŠ¿ã€‚åˆ©ç”¨HiFi å¯¹äººåŸºå› ç»„ç»„è£…ç»“æœè¡¨æ˜ï¼Œ<font color="red"><strong>HiFi ç»„è£…è´¨é‡æ¯”CLRé«˜6å€ï¼Œæ¯”ç»Illuminaæ ¡æ­£çš„Nanoporeé«˜77å€</strong></font> <a href="https://pubmed.ncbi.nlm.nih.gov/31406327/">[1]</a>ã€‚</p>
<p>å€¼å¾—ä¸€æï¼Œåˆ©ç”¨HiFi å’ŒNanopore è¿›è¡Œæ°´ç¨»ç»„è£…æ–‡ç« è¡¨æ˜ï¼Œ<font color="red"><strong>å¯¹äºé«˜é‡å¤åŒºåŸŸåˆ©ç”¨é«˜è´¨é‡Illuminaå¯¹Nanoporeé•¿Readsçº é”™æ•ˆæœä¸€èˆ¬</strong></font>ã€‚åŸå› åœ¨äºIllumina<font color="blue">çŸ­Readsåœ¨é‡å¤åŒºåŸŸå¾ˆéš¾å‡†ç¡®æ¯”å¯¹</font>ï¼Œå¯¼è‡´<strong>è¦†ç›–æ·±åº¦æœ‰é™</strong>ï¼Œå› è€Œ<strong>æ— æ³•èµ·åˆ°å‡†ç¡®çº é”™çš„ä½œç”¨</strong>ã€‚è€ŒHiFi å…¼å…·é•¿è¯»é•¿å’Œé«˜å‡†ç¡®æ€§åŒé‡ä¼˜åŠ¿ï¼Œå¯¹<font color="red"><strong>é‡å¤åŒºåŸŸ</strong>ä»ç„¶èƒ½å¤Ÿè·å¾—<strong>è¾ƒé«˜</strong>çš„ç»„è£…<strong>è´¨é‡</strong></font>ã€‚</p>
<h3 id="3-å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡"><a href="#3-å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡" class="headerlink" title="3 å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡"></a>3 å¯¹é‡å¤åŒºåŸŸå’Œç€ä¸ç²’åŒºåŸŸå…·æœ‰è¾ƒé«˜çš„åˆ†è¾¨ç‡</h3><p>é™¤äº†æ•´ä¸ªåŸºå› ç»„çš„è¿ç»­æ€§å’Œå‡†ç¡®æ€§ï¼ŒHiFi åœ¨<font color="red"><strong>é‡å¤åŒºåŸŸ</strong>å’Œ<strong>ç€ä¸ç²’åŒºåŸŸ</strong></font>çš„ç»„è£…ä¹Ÿè¡¨ç°ä¸ä¿—ã€‚å¯¹äººåŸºå› ç»„çš„ç»„è£…è¡¨ç°ä¸Šï¼ŒHiFi ç»„è£…å¯¹<font color="red"><strong>æ•£åœ¨é‡å¤</strong>çš„<strong>åˆ†è¾¨ç‡ä¸º43%</strong></font>ï¼Œ<font color="red"><strong>é«˜äº</strong> CLRå’Œå·²æœ‰çš„Nanoporeç‰ˆæœ¬</font>ã€‚å¯¹äº<font color="red"><strong>æ•°ç™¾æ‹·è´çš„ä¸²è”é‡å¤</strong></font>ï¼ŒHiFi ç»„è£…<font color="red">æ¯”CLRå…·æœ‰<strong>æ›´é«˜</strong>çš„<strong>åˆ†è¾¨ç‡</strong>å’Œ<strong>å‡†ç¡®æ€§</strong></font>ã€‚è€Œä¸“é—¨é’ˆå¯¹HiFi Readsç»„è£…ä¼˜åŒ–çš„<font color="blue"><strong>HiCanu</strong></font>åœ¨<font color="blue"><strong>é‡å¤åºåˆ—å’Œç€ä¸ç²’ç»„è£…</strong></font>æ–¹é¢æ›´æœ‰è‰¯å¥½è¡¨ç°ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/9.png" alt="img"></p>
<p>HiFiå’ŒCLRå¯¹<strong>ä¸²è”é‡å¤åŒºåŸŸç»„è£…</strong>ç»“æœçš„æ¯”è¾ƒ <a href="https://pubmed.ncbi.nlm.nih.gov/31711268/">[2]</a></p>
<p><strong>variable number of tandem repeats (VNTRs)</strong></p>
<blockquote>
<p>b) Dot plot of a <strong>6.7 kbp VNTR</strong> in the <strong>intron</strong> of <em>RTEL1</em> (chr20:63693361â€“63693833) (top panel), <strong>which was resolved in the HiFi assembly only</strong>. The <strong>CLR assembly</strong> contained a <strong>gap</strong> over this region. The overall structure and length of this VNTR was <strong>supported by the ONT reads</strong> mapping to this location, which averaged 5,956 +/âˆ’ 1799 bp (n = 5 ultra-long ONT reads), placing the HiFi sequence length at &lt;1 standard deviation away from the average ONT read. The motif homology plot (bottom panel) indicates that the content of the <em>RTEL1</em> VNTR is relatively pure, with an average sequence identity to the 15-mer repeat unit of 94.49% across the 439 copies.</p>
</blockquote>
<blockquote>
<p>c)Dot plot of the <strong>zinc finger protein gene <em>ZNF717</em></strong> (GRCh38 coordinates: chr3:75777127â€“75780446) (top panel), which was <strong>collapsed in the CLR</strong> assembly but <strong>fully represented in the HiFi assembly</strong>. The number of copies of this <strong>35 bp repeat unit</strong> increased from <strong>15 in the CLR</strong> assembly to <strong>89 in the HiFi</strong> assembly. The large amount of variation between individual copies of this VNTR is shown in the region between the <strong>red lines</strong> in the motif homology plots (bottom panels). The <strong>level of purity within the VNTR increased</strong> from 80.38% sequence identity in the CLR assembly to 90.75% sequence identity in the HiFi assembly. The red vertical lines indicate the start and end position of the VNTR.</p>
</blockquote>
<h2 id="ç‹ "><a href="#ç‹ " class="headerlink" title="ç‹ "></a>ç‹ </h2><h3 id="1-ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ"><a href="#1-ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ" class="headerlink" title="1 ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ"></a><strong>1 ç®€å•å¤æ‚åŸºå› ç»„é€šåƒ</strong></h3><p>PacBioå®˜æ–¹ï¼Œé™¤äº†å·²æŠ¥é“çš„<strong>äººã€æ°´ç¨»ã€æœè‡å’Œè·—åº“èšŠ</strong>ï¼Œç›®å‰HiFi ç»„è£…å·²ç»åœ¨<strong>äººã€å¤§éº»ã€ç‡•éº¦ã€å››å€ä½“æœˆå­£å’Œå…­å€ä½“åŠ å·çº¢æ‰</strong>ç­‰ç‰©ç§ä¸­åº”ç”¨ã€‚å³ä¾¿æ˜¯<strong>å¤§éº»ã€ç‡•éº¦ã€æœˆå­£ã€åŠ å·çº¢æ‰</strong>è¿™äº›<strong>å¤æ‚</strong>åŸºå› ç»„ï¼ŒHiFi ç»„è£…ä¸ä¿—ã€‚11 Gbç‡•éº¦çš„Contig N50é«˜è¾¾<strong>20 Mb</strong>ï¼é«˜é‡å¤é«˜æ‚åˆçš„å¤šå€ä½“è£¸å­æ¤ç‰©çš„åŠ å·çº¢æ‰è¶…å¤§åŸºå› ç»„ï¼ŒHiFi çš„Contig N50ä¹Ÿè¾¾åˆ°1.92 Mbï¼Œè¿œé«˜äºå·²æŠ¥é“å…¶ä»–è£¸å­æ¤ç‰©åŸºå› ç»„ã€‚</p>
<h3 id="2-é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…"><a href="#2-é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…" class="headerlink" title="2 é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…"></a><strong>2 é«˜è´¨é‡å•å€å‹åŸºå› ç»„ç»„è£…</strong></h3><p>ç»„è£…<strong>å¤šå€ä½“</strong>æ—¶ï¼Œç»„è£…è½¯ä»¶å¿…é¡»èƒ½<strong>åŒºåˆ†ä¸åŒçš„ç­‰ä½åŸºå› </strong>ï¼Œå¹¶<strong>ä¿å­˜ä¸ºä¸åŒçš„åºåˆ—</strong>ã€‚ç”¨HiCanuå¯¹äººåŸºå› ç»„çš„HiFi Readsç»„è£…ç»“æœåŒ…å«<strong>è¶…è¿‡2 Gbçš„æ›¿ä»£Contig</strong>ï¼Œè€Œ<strong>å…¶å®ƒè½¯ä»¶</strong>åªèƒ½äº§ç”Ÿ<strong>ä¸åˆ°400 Mb</strong>çš„<strong>æ›¿ä»£Contig</strong>ã€‚è¯´æ˜HiCanuç»“åˆHiFi Readså…·æœ‰æ›´å¼ºçš„<strong>åŒºåˆ†å•å€å‹çš„èƒ½åŠ›</strong>ã€‚å¹¶ä¸”ï¼ŒHiCanuç»„è£…çš„<font color="blue">ä¸»è¦Contig</font>å’Œ<font color="blue">æ›¿ä»£Contig</font>éƒ½å…·æœ‰è¾ƒé«˜çš„<font color="red">BUSCOå®Œæ•´æ€§</font>ï¼ˆ&gt; <strong>94ï¼…</strong>å’Œ&gt; 75ï¼…ï¼‰ï¼Œè¿œ<strong>é«˜</strong>äº<strong>Nanopore ultra-long Reads</strong>ç»„è£…çš„BUSCOå®Œæ•´æ€§ï¼ˆåˆ†åˆ«åªæœ‰**63%<strong>å’Œ</strong>0.3%**ï¼‰ã€‚</p>
<h1 id="hifiasm-Official-doc"><a href="#hifiasm-Official-doc" class="headerlink" title="hifiasm Official doc"></a><a href="https://github.com/chhylp123/hifiasm">hifiasm Official doc</a></h1><p><strong>install</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Install hifiasm (requiring g++ and zlib)</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/chhylp123/hifiasm</span><br><span class="line"><span class="comment">#download zipfile unzip</span></span><br><span class="line"><span class="built_in">cd</span> hifiasm &amp;&amp; make</span><br></pre></td></tr></table></figure>

<p><strong>simple use</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Run on test data (use -f0 for small datasets)?</span></span><br><span class="line">wget https://github.com/chhylp123/hifiasm/releases/download/v0.7/chr11-2M.fa.gz</span><br><span class="line">./hifiasm -o <span class="built_in">test</span> -t4 -f0 chr11-2M.fa.gz 2&gt; test.log</span><br><span class="line">ã€awk <span class="string">&#x27;/^S/&#123;print &quot;&gt;&quot;$2;print $3&#125;&#x27;</span> test.bp.p_ctg.gfa &gt; test.p_ctg.faã€‘  <span class="comment"># get primary contigs in FASTA</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Assemble inbred/homozygous genomes (-l0 disables duplication purging)</span></span><br><span class="line"><span class="comment">#?</span></span><br><span class="line">hifiasm -o CHM13.asm -t32 -l0 CHM13-HiFi.fa.gz 2&gt; CHM13.asm.log</span><br><span class="line"><span class="comment"># Assemble heterozygous genomes with built-in duplication purging</span></span><br><span class="line"><span class="comment">#?</span></span><br><span class="line">hifiasm -o HG002.asm -t32 HG002-file1.fq.gz HG002-file2.fq.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># Hi-C phasing with paired-end short reads in two FASTQ files</span></span><br><span class="line"><span class="comment">#add Hi-C data</span></span><br><span class="line">hifiasm -o HG002.asm --h1 read1.fq.gz --h2 read2.fq.gz HG002-HiFi.fq.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># Trio binning assembly (requiring https://github.com/lh3/yak)</span></span><br><span class="line"><span class="comment">#combine parent sequencing data</span></span><br><span class="line">yak count -b37 -t16 -o pat.yak &lt;(cat pat_1.fq.gz pat_2.fq.gz) &lt;(cat pat_1.fq.gz pat_2.fq.gz)</span><br><span class="line">yak count -b37 -t16 -o mat.yak &lt;(cat mat_1.fq.gz mat_2.fq.gz) &lt;(cat mat_1.fq.gz mat_2.fq.gz)</span><br><span class="line">hifiasm -o HG002.asm -t32 -1 pat.yak -2 mat.yak HG002-HiFi.fa.gz</span><br></pre></td></tr></table></figure>

<h2 id="introduction"><a href="#introduction" class="headerlink" title="introduction"></a>introduction</h2><p>Hifiasm is a <font color="blue"><strong>fast haplotype-resolved de novo assembler</strong></font> for <font color="blue"><strong>PacBio HiFi reads</strong></font>. It can <strong>assemble a human genome in several hours</strong> and assemble a <strong>~30Gb</strong> California redwood genome in <strong>a few days</strong>. Hifiasm emits <font color="red"><strong>partially phased assemblies</strong></font> of quality competitive with the best assemblers. Given <font color="green"><strong>parental short reads</strong></font> or <font color="green"><strong>Hi-C data</strong></font>, it produces arguably <font color="red"><strong>the best haplotype-resolved assemblies</strong></font> so far.</p>
<h2 id="Why-Hifiasm"><a href="#Why-Hifiasm" class="headerlink" title="Why Hifiasm?"></a>Why Hifiasm?</h2><ul>
<li>Hifiasm delivers high-quality assemblies. It tends to generate <font color="blue">longer contigs</font> and resolve <font color="blue">more segmental duplications</font> than other assemblers.</li>
<li>Given <font color="blue">Hi-C reads</font> or <font color="blue">short reads from the parents</font>, hifiasm can produce overall <font color="blue"><strong>the best haplotype-resolved assembly</strong></font> so far. It is the assembler of choice by the <a href="https://humanpangenome.org/">Human Pangenome Project</a> for the first batch of samples.</li>
<li>Hifiasm can <font color="blue">purge duplications?</font> between haplotigs without relying on third-party tools such as purge_dups. Hifiasm does <font color="blue">not need polishing tools?</font> like pilon or racon, either. This simplifies the assembly pipeline and saves running time.</li>
<li>Hifiasm is <font color="blue">fast</font>. It can assemble a human genome in half a day and assemble a ~30Gb redwood genome in three days. <font color="blue">No genome is too large for hifiasm</font>.</li>
<li>Hifiasm is trivial to install and easy to use. It does not required Python, R or C++11 compilers, and can be compiled into a single executable. The default setting works well with a variety of genomes.</li>
</ul>
<h1 id="hifiasm-paper"><a href="#hifiasm-paper" class="headerlink" title="hifiasm paper"></a>hifiasm paper</h1><p>refï¼š<a href="https://www.jianshu.com/p/6d79690dce5d">https://www.jianshu.com/p/6d79690dce5d</a></p>
<p><a href="https://hifiasm.readthedocs.io/en/latest/index.html">https://hifiasm.readthedocs.io/en/latest/index.html</a></p>
<p><a href="https://links.jianshu.com/go?to=https://github.com/chhylp123/hifiasm">https://github.com/chhylp123/hifiasm</a></p>
<p><a href="https://links.jianshu.com/go?to=https://www.nature.com/articles/s41592-020-01056-5">https://www.nature.com/articles/s41592-020-01056-5</a></p>
<h2 id="åŸç†ä»‹ç»1"><a href="#åŸç†ä»‹ç»1" class="headerlink" title="åŸç†ä»‹ç»1"></a>åŸç†ä»‹ç»1</h2><p>hifiasmæœ‰æ•ˆåˆ©ç”¨PacBio HiFiæµ‹åºæŠ€æœ¯ï¼Œåœ¨<font color="red"><strong>åˆ†å‹ç»„è£…å›¾(pahsed assembly gprah)</strong></font>ä¸­å¯é çš„è¡¨ç¤ºå•å€ä½“ä¿¡æ¯ã€‚</p>
<p><strong>ç¬¬ä¸€é˜¶æ®µ</strong>ï¼šé€šè¿‡æ‰€æœ‰åºåˆ—ç›¸äº’æ¯”å¯¹ï¼Œå¯¹æ½œåœ¨æµ‹åºé”™è¯¯çº æ­£ã€‚å¦‚æœ<font color="red">ä¸€ä¸ªä½ç½®åªå­˜åœ¨ä¸¤ç§ç¢±åŸºç±»å‹</font>ï¼Œä¸”æ¯ä¸ªç¢±åŸºç±»å‹<font color="red">è‡³å°‘æœ‰3æ¡readæ”¯æŒ</font>ï¼Œé‚£ä¹ˆè¿™ä¸ªä½ç½®ä¼šè¢«å½“ä½œ<font color="red">æ‚åˆä½ç‚¹</font>ï¼Œå¦åˆ™è§†ä½œæµ‹åºé”™è¯¯çº æ­£ã€‚</p>
<p><strong>ç¬¬äºŒé˜¶æ®µ</strong>ï¼šæ ¹æ®<font color="red">åºåˆ—ä¹‹é—´é‡å å…³ç³»</font>ï¼Œæ„å»º<font color="red">åˆ†å‹çš„å­—ç¬¦ä¸²å›¾(phased string graph)</font>ã€‚å…¶ä¸­è°ƒæ•´æœå‘çš„åºåˆ—ä½œä¸º<font color="red">é¡¶ç‚¹(vertex)</font>ï¼Œä¸€è‡´é‡å ä½œä¸º<font color="red">è¾¹(edge)</font>ã€‚å­—ç¬¦ä¸²å›¾ä¸­çš„<font color="red">æ°”æ³¡(bubble)</font>åˆ™æ˜¯<font color="red">æ‚åˆä½ç‚¹</font>ã€‚</p>
<p><strong>ç¬¬ä¸‰é˜¶æ®µ</strong>ï¼šå¦‚æœæ²¡æœ‰é¢å¤–çš„ä¿¡æ¯ï¼Œhifiasmä¼š<font color="red">éšæœºé€‰æ‹©æ°”æ³¡ä¸€è¾¹</font>æ„å»ºprimary assemblyï¼Œå¦ä¸€è¾¹åˆ™æ˜¯alternate assembly. è¯¥ç­–ç•¥å’ŒHiCanuï¼ŒFalcon-Unzipä¸€æ ·ã€‚å¯¹äºæ‚åˆåŸºå› ç»„è€Œè¨€ï¼Œç”±äºå­˜åœ¨ä¸€ä¸ªä»¥ä¸Šçš„çº¯åˆhaplotypeï¼Œå› æ­¤<font color="red">primary assemblyå¯èƒ½è¿˜ä¼šåŒ…å«haplotigs</font>ã€‚HiCanuä¾èµ–ç¬¬ä¸‰æ–¹çš„purge_dups, è€Œhifiasmå†…éƒ¨å®ç°purge_dupsç®—æ³•çš„å˜ç§ï¼Œç®€åŒ–äº†æµç¨‹ã€‚å¦‚æœæœ‰<font color="red">é¢å¤–ä¿¡æ¯</font>ï¼Œhifiasmå¯æ­£ç¡®çš„å¯¹<font color="red">haplotypeè¿›è¡Œåˆ†å‹</font>ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/1.png" alt="img"></p>
<h2 id="hifiasm-åŸç†ä»‹ç»2"><a href="#hifiasm-åŸç†ä»‹ç»2" class="headerlink" title="hifiasm åŸç†ä»‹ç»2"></a>hifiasm åŸç†ä»‹ç»2</h2><p><strong>å¯è¯†åˆ«å•å€å‹çš„çº é”™</strong></p>
<p>Hifiasmå°†æ‰€æœ‰hifi readsè¯»å–åˆ°å†…å­˜ä¸­è¿›è¡Œ<font color="red"><strong>all-vs-allæ¯”å¯¹å¹¶çº é”™</strong></font>ã€‚åŸºäºreadsé—´overlapä¿¡æ¯ï¼Œå¦‚æœreadä¸Šæœ‰ä¸€ä¸ªç¢±åŸºä¸å…¶ä»–ç¢±åŸºä¸åŒï¼Œå¹¶æœ‰<font color="red"><strong>è‡³å°‘3æ¡readsæ”¯æŒ</strong></font>ï¼Œåˆ™è®¤ä¸ºå®ƒæ˜¯<font color="red"><strong>SNP</strong></font>å¹¶ä¿ç•™ï¼Œ<strong>å¦åˆ™</strong>è®¤ä¸ºæ˜¯é”™è¯¯å¹¶<strong>çº æ­£</strong>ã€‚</p>
<p><strong>ç»„è£…å›¾çš„æ„å»º</strong></p>
<p>åœ¨æ ¡æ­£ä¹‹åï¼Œå¤§å¤šæ•°é”™è¯¯è¢«å»é™¤ï¼ŒåŒæ—¶<font color="red"><strong>æ‚åˆå˜å¼‚ä¿¡æ¯è¢«ä¿ç•™</strong></font>ã€‚åŸºäºè¿™äº›ä¿¡æ¯ï¼ŒHifiasmæ„å»ºäº†<font color="red"><strong>ä»¥readsä¸ºé¡¶ç‚¹ã€é‡å åŒºä¸ºè¾¹çš„å®šç›¸string-graph</strong></font>ã€‚</p>
<p><strong>ç»„è£…åºåˆ—çš„ç”Ÿæˆ</strong></p>
<ul>
<li><p>å¦‚æœ<font color="red">æ²¡æœ‰å…¶ä»–æ•°æ®</font>ï¼ŒHifiasmåœ¨è¾“å‡ºåºåˆ—æ—¶ä¼š<font color="red"><strong>ä»»æ„é€‰æ‹©</strong>æ¯ä¸ªæ°”æ³¡<strong>bubble</strong>çš„<strong>ä¸€ä¾§è¾“å‡º</strong>ç±»ä¼¼<strong>Falcon unzip</strong>å’Œ<strong>HiCanu</strong>çš„ä¸»è¦ç»„è£…ç»“æœ</font>ï¼ˆprimary contigsï¼‰ã€‚</p>
</li>
<li><p>å¦‚æœåŒæ—¶æœ‰<font color="red">çˆ¶æ¯æœ¬çš„æµ‹åºæ•°æ®</font>ï¼ŒHifiasmå¯ä»¥é€šè¿‡<font color="red">äº²æœ¬ç‰¹æœ‰çš„kmer</font>åœ¨å›¾ä¸Š<font color="red">è¯†åˆ«æ¥è‡ªçˆ¶æ¯æœ¬çš„åºåˆ—</font>ï¼Œå¾—åˆ°<font color="red"><strong>ä¸¤å¥—å•å€ä½“</strong>åŸºå› ç»„</font>ã€‚</p>
</li>
<li><p>å½“ç„¶HiFiasmæ–‡ç« ä¸­ä¹Ÿæåˆ°ï¼š</p>
<p>ä¸å…¶ä»–åŸºäºå›¾å½¢çš„æ±‡ç¼–ç¨‹åºä¸åŒï¼ŒHiFiasmè‡´åŠ›äº<strong>ä¿æŒæ‰€æœ‰å•å€å‹çš„è¿ç»­æ€§ã€‚</strong><br><font color="red"><strong>HiCanu</strong>åªè¯•å›¾<strong>ä¿æŒä¸€ä¸ªäº²æœ¬å•å€å‹</strong>çš„<strong>è¿ç»­æ€§</strong></font>ï¼Œå¹¶ä¸”ç»å¸¸<font color="red">ç ´åå¦ä¸€ä¸ªå•å€å‹çš„è¿ç»­æ€§</font>ï¼Œå½“åˆ†ç¦»äº²æœ¬å•å€å‹æ—¶ï¼Œè¿™äº›çªå˜ç‚¹å°†å¯¼è‡´å•å€å‹åˆ†è§£çš„ç¢ç‰‡â€”HiCanu<font color="red">æ²¡æœ‰å……åˆ†åˆ©ç”¨HiFi Reads</font><br>Hifiasmé’ˆå¯¹HiFiç‰¹ç‚¹å¼€å‘ï¼Œåœ¨hifiæ•°æ®çš„ç»„è£…è¡¨ç°ä¸Šè¾ƒåŒç±»è½¯ä»¶æ›´ä¸ºçªå‡ºï¼Œåœ¨å¤šä¸ªåŸºå› ç»„ä¸Šè¡¨ç°å‡ºäº†æ›´é«˜çš„<strong>å‡†ç¡®æ€§</strong>å’Œç»„è£…çš„<strong>è¿ç»­æ€§</strong>ã€‚</p>
</li>
</ul>
<h2 id="ä»…HiFiæ•°æ®æ¨¡å¼"><a href="#ä»…HiFiæ•°æ®æ¨¡å¼" class="headerlink" title="ä»…HiFiæ•°æ®æ¨¡å¼"></a>ä»…HiFiæ•°æ®æ¨¡å¼</h2><p>æœ€åŸºæœ¬çš„ç”¨æ³•ï¼Œä¼šå¾—åˆ°ä¸¤ä¸ªéƒ¨åˆ†åˆ†å‹çš„ç»„è£…</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget https://github.com/chhylp123/hifiasm/releases/download/v0.7/chr11-2M.fa.gz</span><br><span class="line">hifiasm -o <span class="built_in">test</span> -t 32 chr11-2M.fa.gz 2&gt; test.log</span><br><span class="line"><span class="comment">#-oè¾“å‡ºæ–‡ä»¶å‰ç¼€ -tçº¿ç¨‹</span></span><br></pre></td></tr></table></figure>

<p>ç»“æœæ–‡ä»¶å…³æ³¨å¦‚ä¸‹å‡ é¡¹ (prefixä¸ºå‰ç¼€ï¼‰</p>
<ul>
<li><code>prefix.bp.r_utg.gfa</code>: haplotype-resolved raw unitig graphï¼Œè®°å½•æ‰€æœ‰çš„å•å€å‹ä¿¡æ¯</li>
<li><code>prefix.bp.p_utg.gfa</code>: åœ¨raw unitig graphåŸºç¡€ä¸Šè¿‡æ»¤å°çš„bubbleï¼Œ</li>
<li><code>prefix.bp.p_ctg.gfa</code>: ä¸»è¦contigçš„assembly graph</li>
<li><code>prefix.bp.hap1.p_ctg.gfa</code>: haplotype1çš„éƒ¨åˆ†åˆ†å‹çš„contig graph</li>
<li><code>prefix.bp.hap2.p_ctg.gfa</code>: haplotype2çš„éƒ¨åˆ†åˆ†å‹çš„contig graph</li>
</ul>
<p>å¦‚æœå¹¶ä¸éœ€è¦éƒ¨åˆ†åˆ†å‹çš„ç»„è£…ï¼Œåªè¦primaryå’Œalternateçš„ç»„è£…ç»“æœï¼Œå¯ä»¥åœ¨ä¹‹å‰å‘½ä»¤çš„åŸºç¡€ä¸Šï¼ŒåŠ ä¸Š <code>--primary</code>å‚æ•°ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">hifiasm --primary -o <span class="built_in">test</span> -t 32 chr11-2M.fa.gz 2&gt; test.log2</span><br></pre></td></tr></table></figure>

<p>ç”±äºhifiasmè¿è¡Œæ—¶ä¼šå°†æ­¥éª¤ä¸­çº é”™å’Œç›¸äº’æ¯”å¯¹çš„ç»“æœä¿å­˜æˆ bin æ–‡ä»¶ï¼Œå› æ­¤reruné€Ÿåº¦å¾ˆå¿«(å‰ç¼€åå·®å¼‚)ã€‚</p>
<p>primayæ¨¡å¼ä¸‹è¾“å‡ºçš„æ–‡ä»¶å’Œä¹‹å‰çš„ç±»ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒåœ¨äºæ²¡æœ‰ <strong>bp</strong></p>
<p>prefix<code>.r_utg.gfa</code>: haplotype-resolved raw unitig graph: ä¿ç•™äº†ç»„è£…ç”Ÿæˆçš„æ‰€æœ‰å•ä½“å‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½“ç»†èƒçªå˜å’Œé‡å¤çš„æµ‹åºé”™è¯¯ã€‚</p>
<p>prefix<code>.p_utg.gfa</code>: haplotype-resolved processed unitig graph without small bubblesï¼šæ— å°æ°”æ³¡çš„å•å€å‹è§£æï¼›å»æ‰ç”±äºä½“ç»†èƒçªå˜å’Œæ•°æ®èƒŒæ™¯å™ªéŸ³å¼•èµ·çš„small bubblesï¼ˆè¿™ä¸ªå¹¶ä¸æ˜¯çœŸæ­£çš„å•ä½“å‹ä¿¡æ¯ï¼‰ï¼Œå¯¹äºé«˜åº¦æ‚åˆåŸºå› ç»„ç‰©ç§ä¼˜å…ˆé€‰æ‹©è¿™ä¸ªç»“æœã€‚</p>
<p>prefix<code>.p_ctg.gfa</code>: assembly graph of primary contigsï¼šå¯¹äºä½æ‚åˆåº¦ç‰©ç§æ¥è¯´ï¼Œä¼˜å…ˆé€‰æ‹©è¯¥æ–‡ä»¶ï¼›å¯¹äºé«˜æ‚åˆåº¦ç‰©ç§ï¼Œè¯¥ç»“æœä»£è¡¨å…¶ä¸­ä¸€ä¸ªå•å€å‹ã€‚</p>
<p>prefix<code>.a_ctg.gfa</code>: assembly graph of alternate contigsï¼šç»„è£…å‡ºæ¥çš„å¦ä¸€å¥—å•ä½“å‹åŸºå› ç»„ç»“æœã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#contigï¼Œé€šè¿‡awkæå–</span></span><br><span class="line">awk <span class="string">&#x27;/^S/&#123;print &quot;&gt;&quot;$2;print $3&#125;&#x27;</span> test.p_ctg.gfa &gt; test.p_ctg.fa</span><br></pre></td></tr></table></figure>

<h2 id="åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼"><a href="#åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼" class="headerlink" title="åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼"></a>åŒäº²äºŒä»£æµ‹åºTrio-binningæ¨¡å¼</h2><p>å¦‚æœæœ‰åŒäº²æ•°æ®ï¼Œåˆ™å¯ä½¿ç”¨trio-binningæ–¹æ³•è¿›è¡Œæ›´å¯é çš„åˆ†å‹ã€‚åˆ†ä¸ºä¸¤æ­¥ï¼Œ<font color="red"><strong>å…ˆç”¨yakç»Ÿè®¡k-mersï¼Œ ç„¶åç”¨hifiasmè¿›è¡Œç»„è£…</strong></font></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yak count -k31 -b37 -t16 -o pat.yak paternal.fq.gz</span><br><span class="line">yak count -k31 -b37 -t16 -o mat.yak maternal.fq.gz</span><br><span class="line">hifiasm -o NA12878.asm -t 32 -1 pat.yak -2 mat.yak NA12878.fq.gz</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå’Œä¹‹å‰ç±»ä¼¼ï¼Œä¸»è¦å…³æ³¨æ–‡ä»¶å<font color="red">å¸¦ dip çš„è¾“å‡ºgfaæ–‡ä»¶</font></p>
<ul>
<li><strong>prefix.r_utg.gfa</strong>(Haplotype-resolved raw unitig graph in GFA format):ä¿å­˜äº†æ‰€æœ‰çš„å•å€å‹ä¿¡æ¯ã€‚</li>
</ul>
<ul>
<li><code>prefix.dip.hap1.p_ctg.gfa</code>: å®Œæˆåˆ†å‹çš„<font color="red"><strong>çˆ¶æºå•å€ä½“ contigå›¾</strong></font>ã€‚(Phased paternal/haplotype1 contig graph):ä¿ç•™äº†é˜¶æ®µæ€§çˆ¶ç³»/å•å€å‹1ç»„è£…ã€‚</li>
<li><code>prefix.dip.hap2.p_ctg.gfa</code>: å®Œå…¨åˆ†å‹çš„<font color="red"><strong>æ¯æºå•å€ä½“contigå›¾</strong></font>ã€‚(Phased maternal/haplotype2 contig graph):ä¿ç•™äº†é˜¶æ®µæ€§æ¯ç³»/å•å€å‹2ç»„è£…ã€‚</li>
</ul>
<h2 id="é™„åŠ Hi-Cæ¨¡å¼"><a href="#é™„åŠ Hi-Cæ¨¡å¼" class="headerlink" title="é™„åŠ Hi-Cæ¨¡å¼"></a>é™„åŠ Hi-Cæ¨¡å¼</h2><p>ç”±äºHi-Cæ•°æ®èƒ½å¤Ÿæä¾›<strong>è¿œè·ä¿¡æ¯</strong>ï¼Œå› æ­¤ä¹Ÿèƒ½<strong>ç”¨äºå•å€ä½“åˆ†å‹</strong>ã€‚éœ€è¦åŠ ä¸¤ä¸ªå‚æ•°ï¼Œ h1ä¸ºHi-Cçš„read1, h2 ä¸ºHi-Cçš„read2</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hifiasm -o NA12878.asm -t 32 --h1 read1.fq.gz --h2 read2.fq.gz HiFi-reads.fq.gz</span><br></pre></td></tr></table></figure>

<p>åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªcontigè¦ä¹ˆæ˜¯æ¥è‡ªäºçˆ¶äº²ï¼Œè¦ä¹ˆæ˜¯æ¥è‡ªäºæ¯äº²ã€‚hifiasmå°†<font color="red">åŒä¸€æ¥æºçš„contigæ”¾åœ¨åŒä¸€ä¸ªç»„è£…ä¸­</font>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œhifiasmæœªå¿…èƒ½å¤Ÿå¤„ç†å¥½<font color="red">ç€ä¸ç²’é™„è¿‘åŒºåŸŸ</font>ï¼Œå¦å¤–<font color="red">hifiasmä¸­Hi-Cä¹Ÿä¸ä¼šç”¨äºè¿›è¡Œscaffold</font>ã€‚</p>
<p>è¾“å‡ºç»“æœé‡ç‚¹å…³æ³¨å¸¦hicçš„æ–‡ä»¶</p>
<ul>
<li><code>prefix.hic.p_ctg.gfa</code>: ä¸»è¦contigçš„ç»„è£…å›¾</li>
<li><code>prefix.hic.hap1.p_ctg.gfa</code>: å®Œå…¨åˆ†å‹çš„haplotype1çš„contigå›¾</li>
<li><code>prefix.hic.hap2.p_ctg.gfa</code>: å®Œå…¨åˆ†å‹çš„haplotype2çš„contigå›¾</li>
<li><code>prefix.hic.a_ctg.gfa</code> : å¦‚æœè®¾ç½®äº† <code>--primary</code>å‚æ•°ï¼Œè¿˜ä¼šè¾“å‡ºè¯¥æ¬¡è¦contigçš„ç»„è£…å›¾</li>
</ul>
<h2 id="æ—¥å¿—å’Œå‚æ•°è°ƒæ•´"><a href="#æ—¥å¿—å’Œå‚æ•°è°ƒæ•´" class="headerlink" title="æ—¥å¿—å’Œå‚æ•°è°ƒæ•´"></a>æ—¥å¿—å’Œå‚æ•°è°ƒæ•´</h2><p>ç»å¤§éƒ¨åˆ†çš„æ—¶å€™ï¼Œåªéœ€è¦ä½¿ç”¨é»˜è®¤å‚æ•°å³å¯å¾—åˆ°ç›¸å¯¹æ¯”è¾ƒå¥½çš„ç»“æœã€‚ä½†æ˜¯å½“é»˜è®¤å‚æ•°æ— æ³•è¾¾åˆ°ç›®çš„ï¼Œå°±éœ€è¦æ£€æŸ¥æ—¥å¿—ä¿¡æ¯ï¼Œé˜…è¯»ç›¸å…³å‚æ•°ä»è€Œä¼˜åŒ–ç»“æœã€‚</p>
<p>æ—¥å¿—ä¿¡æ¯ä¸»è¦åˆ†ä¸‰é¡¹</p>
<ul>
<li><font color="red">k-merå›¾</font>: çº¯åˆæ ·æœ¬ä¸€ä¸ªpeakï¼Œæ‚åˆæ ·æœ¬2ä¸ªpeakã€‚</li>
<li><font color="red">çº¯åˆå³°çš„è¦†ç›–åº¦</font>: <code>[M::purge_dups] homozygous read coverage threshold: X</code> , ä¸€èˆ¬ä¼šç”±hifiasmè‡ªåŠ¨æ¨æ–­ã€‚</li>
<li><font color="red">æ‚åˆ/çº¯åˆç¢±åŸºæ•°ç›®ï¼ˆHi-Cæ¨¡å¼ï¼‰</font>: Hi-Cæ¨¡å¼ä¸‹ï¼Œå¦‚æœçº¯åˆçš„ç¢±åŸºæ•°è¶…è¿‡æ‚åˆç¢±åŸºæ•°ï¼Œé‚£ä¹ˆhifiasmå°±ä¸å®¹æ˜“æ‰¾å¯¹çº¯åˆreadçš„æ‰€åœ¨å³°ã€‚</li>
</ul>
<p>å¯¹äºæ—¥å¿—ä¿¡æ¯ï¼Œæœ€ä¸»è¦å…³æ³¨<font color="red">k-merå›¾</font>ï¼Œä»è€Œåˆ¤æ–­hifiasmæ˜¯å¦èƒ½å¤Ÿæ­£ç¡®çš„æ‰¾åˆ°çº¯åˆå³°ï¼Œæ‚åˆå³°æ‰€åœ¨ä½ç½®ã€‚å¦‚æœhifiasmæ²¡æœ‰æ‰¾å¯¹çº¯åˆå³°æ‰€åœ¨çš„ä½ç½®ï¼Œå°±éœ€è¦<font color="red">æ ¹æ®k-merå›¾æ‰‹åŠ¨æŒ‡å®š?</font> <code>--hom-cov</code>ã€‚</p>
<p>å¯¹äºä¸€ä¸ªç»„è£…ç»“æœï¼Œæœ€ç›´æ¥çš„<strong>è¯„ä¼°æ ‡å‡†</strong>å°±æ˜¯<font color="red">åŸºå› ç»„å¤§å°æ˜¯å¦ç¬¦åˆé¢„æœŸ</font>ï¼Œåˆ†å‹çš„<font color="red">ä¸¤å¥—åŸºå› ç»„æ˜¯å¦ç›¸å·®ä¸å¤§</font>ï¼Œåºåˆ—<strong>æ˜¯å¦è¶³å¤Ÿé•¿</strong>ï¼Œ<strong>æ˜¯å¦å­˜åœ¨é”™è¯¯ç»„è£…</strong>çš„æƒ…å†µã€‚</p>
<p>å¦‚æœåŸºå› ç»„<font color="red"><strong>å¤§å°ä¸ç¬¦åˆé¢„æœŸ</strong></font>ï¼Œä¸€èˆ¬éƒ½æ˜¯hifiasm<strong>æ‰¾é”™çº¯åˆå³°çš„ä½ç½®</strong>ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®š <code>--hom-cov</code>ï¼›</p>
<p>å¦‚æœåˆ†å‹çš„ä¸¤å¥—åŸºå› ç»„<font color="red"><strong>å·®åˆ«è¿‡å¤§</strong></font>ï¼Œåˆ™é€šè¿‡é™ä½ <code>-s</code> è°ƒæ•´ã€‚</p>
<p>å¦‚æœ<font color="red"><strong>åºåˆ—ä¸å¤Ÿé•¿ï¼Œç‰‡æ®µåŒ–æ˜æ˜¾</strong></font>ï¼Œåˆ™å¯å°è¯•<font color="red">å¢åŠ </font>  <code>-D</code> å’Œ  <code>-N</code>, è™½å¢åŠ è¿è¡Œæ—¶é—´ï¼Œä½†ä¼š<font color="red">æé«˜é‡å¤åŒºåŸŸçš„åˆ†è¾¨ç‡</font>ã€‚</p>
<p>å¦‚æœåç»­çš„Hi-Cï¼Œæˆ–è€…BioNanoå‘ç°hifiasmç»„è£…ç»“æœ<font color="red"><strong>æœ‰æ¯”è¾ƒå¤šé”™è¯¯ç»„è£…</strong></font>ï¼Œåˆ™å¯ä»¥é€‚å½“é™ä½ <code>--purge-max</code>, <code>-s</code>å’Œ <code>-O</code>ã€‚æˆ–è€…è®¾ç½® <code>-u</code> å…³é—­post-join æ­¥éª¤ï¼Œhifiasmé€šè¿‡è¯¥æ­¥éª¤æé«˜ç»„è£…çš„è¿ç»­æ€§ã€‚</p>
<h2 id="è¾“å…¥æ ¼å¼-fqè¿˜æ˜¯fa"><a href="#è¾“å…¥æ ¼å¼-fqè¿˜æ˜¯fa" class="headerlink" title="è¾“å…¥æ ¼å¼ fqè¿˜æ˜¯fa"></a>è¾“å…¥æ ¼å¼ fqè¿˜æ˜¯fa</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># bam --&gt; fasta</span><br><span class="line">samtools view *.bam | awk &#x27;&#123;print &quot;&gt;&quot;$1&quot;\n&quot;$10&#125;&#x27; &gt; fasta</span><br><span class="line"># bam2fastq</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="HiCanu-https-canu-readthedocs-io-en-latest-index-html"><a href="#HiCanu-https-canu-readthedocs-io-en-latest-index-html" class="headerlink" title="HiCanu[https://canu.readthedocs.io/en/latest/index.html]"></a>HiCanu[<a href="https://canu.readthedocs.io/en/latest/index.html]">https://canu.readthedocs.io/en/latest/index.html]</a></h1><hr>
<p>ref <a href="https://www.jianshu.com/p/c1aeeae77cb5">https://www.jianshu.com/p/c1aeeae77cb5</a></p>
<p>Canuåˆ†ä¸‰ä¸ªæ­¥éª¤ï¼Œ<font color="red"><strong>çº é”™</strong></font>ï¼Œ<font color="red"><strong>ä¿®æ•´</strong></font>å’Œ<font color="red"><strong>ç»„è£…</strong></font>ï¼Œæ¯ä¸€æ­¥<font color="red">æ­¥éª¤<strong>ç›¸ä¼¼</strong></font>ï¼š</p>
<ul>
<li>åŠ è½½readåˆ°readæ•°æ®åº“ï¼ŒgkpStore</li>
<li>å¯¹k-merè¿›è¡Œè®°æ•°ï¼Œç”¨äºè®¡ç®—åºåˆ—é—´çš„overlap</li>
<li>è®¡ç®—overlap</li>
<li>åŠ è½½overlapåˆ°overlapæ•°æ®åº“ï¼ŒOvlStore</li>
<li>æ ¹æ®readå’Œoverlapå®Œæˆç‰¹å®šåˆ†æç›®æ ‡<ul>
<li>read<font color="blue"><strong>çº é”™</strong></font>æ—¶ä¼šä»overlapä¸­æŒ‘é€‰ä¸€è‡´æ€§åºåˆ—æ›¿æ¢åŸå§‹çš„å™ªå£°read</li>
<li>read<font color="blue"><strong>ä¿®æ•´</strong></font>æ—¶ä¼šä½¿ç”¨overlapç¡®å®šreadå“ªäº›åŒºåŸŸæ˜¯é«˜è´¨é‡åŒºåŸŸï¼Œå“ªäº›åŒºåŸŸè´¨é‡è¾ƒä½éœ€è¦ä¿®æ•´ã€‚æœ€åä¿ç•™å•ä¸ªæœ€é«˜è´¨é‡çš„åºåˆ—å—</li>
<li>åºåˆ—<font color="blue"><strong>ç»„è£…</strong></font>æ—¶æ ¹æ®ä¸€è‡´çš„overlapå¯¹åºåˆ—è¿›è¡Œç¼–æ’(layout), æœ€åå¾—åˆ°contig</li>
</ul>
</li>
</ul>
<p>ä¸‰æ­¥<font color="blue">å¯åˆ†å¼€</font>è¿è¡Œï¼Œæ—¢å¯ç”¨<font color="blue">Canuçº é”™åç»“æœ</font>ä½œä¸º<font color="blue">å…¶ä»–ç»„è£…è½¯ä»¶è¾“å…¥</font>ï¼Œä¹Ÿå¯å°†å…¶ä»–è½¯ä»¶çš„çº é”™ç»“æœä½œä¸ºCanuçš„è¾“å…¥ã€‚</p>
<p><font color="red">å‡ ä¸ª<strong>å…¨å±€å‚æ•°</strong></font>ï¼š</p>
<ul>
<li><font color="red"><strong>genomeSize</strong></font>è®¾ç½®é¢„ä¼°åŸºå› ç»„å¤§å°ï¼Œç”¨äºCanu<font color="blue">ä¼°è®¡æµ‹åº<strong>æ·±åº¦</strong></font>, The genome size should be your best guess of the haploid genome size of what is being assembled, It is used primarily to estimate coverage in reads, NOT as the desired assembly size.</li>
<li><font color="red">maxThreads</font>è®¾ç½®æœ€å¤§<font color="blue">çº¿ç¨‹</font></li>
<li><font color="red">rawErrorRate</font>è®¾ç½®<font color="blue">ä¸¤ä¸ª<strong>æœªçº é”™readä¹‹é—´</strong>æœ€å¤§<strong>æœŸæœ›å·®å¼‚ç¢±åŸºæ•°</strong></font></li>
<li><font color="red">correctedErrorRate</font>è®¾ç½®<font color="blue"><strong>çº é”™å</strong>readä¹‹é—´æœ€å¤§<strong>æœŸæœ›å·®å¼‚ç¢±åŸºæ•°</strong>ï¼Œ<strong>ç»„è£…</strong>æ­¥éª¤<strong>å¤šæ¬¡è°ƒæ•´</strong></font></li>
<li><font color="red">minReadLength</font>è¡¨ç¤º<font color="blue">åªä½¿ç”¨å¤§äºé˜ˆå€¼çš„åºåˆ—</font></li>
<li><font color="red">minOverlapLength</font>è¡¨ç¤º<font color="blue">Overlapæœ€å°é•¿åº¦</font></li>
<li>æé«˜minReadLengthå¯<strong>æ</strong>é«˜è¿è¡Œ<strong>é€Ÿ</strong>åº¦ï¼Œå¢åŠ minOverlapLengthå¯<strong>é™</strong>ä½<strong>å‡é˜³æ€§overlap</strong></li>
</ul>
<p><font color="blue">æµ‹è¯•æ•°æ®</font> â€œ<a href="https://links.jianshu.com/go?to=https://www.nature.com/articles/s41467-018-03016-2">High contiguity Arabidopsis thaliana genome assembly with a single nanopore flow cell</a>â€œã€‚ æä¾› <em>Arabidopsis thaliana</em> KBS-Mac-74 çš„30XçŸ­ç‰‡æ®µæ–‡åº“äºŒä»£æµ‹åºã€PacBioå’ŒNanoporeçš„ä¸‰ä»£æµ‹åºä»¥åŠBionanoæµ‹åºæ•°æ®, æ‹Ÿå—èŠ¥åŸºå› ç»„è¢«è®¤ä¸ºæ˜¯æ¤ç‰©é‡‘æ ‡å‡†ï¼Œæ•°æ®é€‚åˆç»ƒä¹ ã€‚é¡¹ç›®ç¼–å·â€PRJEB21270â€, åœ¨European Nucleotide Archiveä¸Šæ‰¾åˆ°ä¸‹è½½åœ°å€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">## PacBio Sequal</span><br><span class="line">wget -c -q ftp://ftp.sra.ebi.ac.uk/vol1/ERA111/ERA1116568/bam/pb.bam</span><br><span class="line">## MinION</span><br><span class="line">wget -c -q ftp://ftp.sra.ebi.ac.uk/vol1/ERA111/ERA1116595/fastq/ont.fq.gz</span><br><span class="line"># Illuminia MiSeq</span><br><span class="line">wget -c -q ftp://ftp.sra.ebi.ac.uk/vol1/ERA111/ERA1116569/fastq/il_1.fq.gz</span><br><span class="line">wget -c -q ftp://ftp.sra.ebi.ac.uk/vol1/ERA111/ERA1116569/fastq/il_2.fq.gz</span><br></pre></td></tr></table></figure>

<p><font color="blue">PacBioæ•°æ®ä»¥BAMæ ¼å¼å­˜å‚¨</font>ï¼Œé€šè¿‡å®‰è£…PacBioçš„smrtlinkå·¥å…·å¥—è£…ï¼Œä½¿ç”¨å…¶ä¸­<font color="blue">bam2fasta</font>è½¬æ¢</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;build index for convert&#x27;</span></span><br><span class="line">~/opt/biosoft/smrtlink/smrtcmds/bin/pbindex pb.bam &amp;</span><br><span class="line"><span class="comment"># convert bam to fasta</span></span><br><span class="line">~/opt/biosoft/smrtlink/smrtcmds/bin/bam2fasta -o pb pb.bam &amp;</span><br></pre></td></tr></table></figure>

<p>PacBioçš„smrtlinkå·¥å…·å¥—è£…å¤§å°1.4Gï¼Œä¸‹è½½é€Ÿåº¦æ…¢ï¼Œå®‰è£…æ‰‹åŠ¨ç¡®è®¤å„ç§é€‰é¡¹, å¥½å¤„æ˜¯å·¥å…·å…¨ã€‚</p>
<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>latest: <a href="https://github.com/marbl/canu/releases/tag/v2.2">https://github.com/marbl/canu/releases/tag/v2.2</a></p>
<h2 id="Run-Canu"><a href="#Run-Canu" class="headerlink" title="Run Canu"></a>Run Canu</h2><p><strong>ç¬¬ä¸€æ­¥</strong>ï¼š<font color="red"><strong>çº é”™</strong></font>ã€‚ä¸‰ä»£æµ‹åºé”™è¯¯ç‡é«˜ï¼ŒåŸå§‹æ•°æ®å……æ»¡å™ªéŸ³ã€‚é€šè¿‡<strong>åºåˆ—</strong>é—´<strong>ç›¸äº’æ¯”è¾ƒçº é”™å¾—åˆ°é«˜å¯ä¿¡åº¦çš„ç¢±åŸº</strong>ã€‚<font color="blue">ä¸»è¦<strong>è°ƒæ•´ä¸¤ä¸ªå‚æ•°</strong></font></p>
<ul>
<li><font color="blue">corOutCoverage</font>: æ§åˆ¶<strong>å¤šå°‘æ•°æ®</strong>ç”¨äºçº é”™ã€‚å¦‚æ‹Ÿå—èŠ¥120MåŸºå› ç»„ï¼Œ100Xæµ‹åº12Gæ•°æ®ï¼Œå¦‚æœåªç”¨æœ€é•¿6Gæ•°æ®çº é”™ï¼Œå‚æ•°è®¾ç½®ä¸º50(120m x 50)ã€‚<strong>è®¾ç½®å¤§äºæµ‹åºæ·±åº¦çš„å€¼</strong>å¦‚120è¡¨ç¤º<strong>ä½¿ç”¨æ‰€æœ‰æ•°æ®</strong>ã€‚<font color="green"><strong>-pacbio-raw</strong></font></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">canu -correct \</span><br><span class="line">    -p ath -d pb_ath \</span><br><span class="line">    Threads=10 gnuplotTested=<span class="literal">true</span>\</span><br><span class="line">    genomeSize=120m minReadLength=2000 minOverlapLength=500\</span><br><span class="line">    corOutCoverage=120 corMinCoverage=2 \</span><br><span class="line">    -pacbio-raw pb.fasta.gz</span><br></pre></td></tr></table></figure>

<p>æ³¨: æœ‰äº›æœåŠ¡å™¨<strong>æ²¡æœ‰å®‰è£…gnuplot</strong>, <strong>gnuplotTested=true</strong> è·³è¿‡æ£€æŸ¥ã€‚</p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼š<font color="red"><strong>ä¿®æ•´</strong></font>ã€‚ä¸ºè·å–æ›´é«˜è´¨é‡çš„åºåˆ—ï¼Œ<font color="blue">ç§»é™¤å¯ç–‘åŒºåŸŸ</font>ï¼ˆå¦‚æ®‹ç•™çš„SMRTbellæ¥å¤´)ã€‚<font color="green"><strong>-pacbio-corrected</strong></font></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">canu -trim \</span><br><span class="line">        -p ath -d pb_ath</span><br><span class="line">        maxThreads=20 gnuplotTested=<span class="literal">true</span>\</span><br><span class="line">        genomeSize=120m minReadLength=2000 minOverlapLength=500\</span><br><span class="line">        -pacbio-corrected ath/pb_ath.correctedReads.fasta.gz</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬ä¸‰æ­¥</strong>: <font color="red"><strong>ç»„è£…</strong></font>ã€‚å‰ä¸¤æ­¥è·å¾—é«˜è´¨é‡åºåˆ—åæ­£å¼ç»„è£…ã€‚ ä¸»è¦è°ƒæ•´å‚æ•°æ˜¯<font color="red">çº é”™åçš„<strong>åºåˆ—é”™è¯¯ç‡ correctedErrorRate</strong></font>ï¼Œå®ƒä¼šå½±å“utgOvlErrorRateã€‚å¯å°è¯•å¤šä¸ªå‚æ•°ï¼Œå› ä¸ºé€Ÿåº¦è¾ƒå—ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># error rate 0.035</span></span><br><span class="line">canu -assemble \</span><br><span class="line">    -p ath -d ath-erate-0.035 \</span><br><span class="line">    maxThreads=20 gnuplotTested=<span class="literal">true</span> \</span><br><span class="line">    genomeSize=120m\</span><br><span class="line">    correctedErrorRate=0.035 \</span><br><span class="line">    -pacbio-corrected atg/pb_ath.trimmedReads.fasta.gz</span><br><span class="line"><span class="comment"># error rate 0.050</span></span><br><span class="line">canu -assemble \</span><br><span class="line">    -p ath -d ath-erate-0.050 \</span><br><span class="line">    maxThreads=20 gnuplotTested=<span class="literal">true</span> \</span><br><span class="line">    genomeSize=120m\</span><br><span class="line">    correctedErrorRate=0.050 \</span><br><span class="line">    -pacbio-corrected atg/pb_ath.trimmedReads.fasta.gz</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºæ–‡ä»¶<font color="red"><strong>ath.contigs.fasta</strong></font>ç»“æœæ–‡ä»¶ã€‚</p>
<h2 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#qsub: submit error (No default queue specified MSG=requested queue not found)</span></span><br><span class="line"><span class="comment">#invalid useGrid (1) and gridEngine (PBS); found no execution hosts - is grid available from this host?.</span></span><br></pre></td></tr></table></figure>

<p>issue: <a href="https://github.com/marbl/canu/issues/1040">https://github.com/marbl/canu/issues/1040</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">advice : Canu uses the <span class="string">&quot;PBS command pbsnodes&quot;</span> to poll your available resources. On your compute nodes this is not working. See the FAQ: http://canu.readthedocs.io/en/latest/faq.html<span class="comment">#my-run-stopped-with-the-error-failed-to-submit-batch-jobs</span></span><br><span class="line">If your nodes <span class="string">&#x27;cannot access/submit&#x27;</span> to the <span class="string">&#x27;grid&#x27;</span> <span class="keyword">then</span> Canu <span class="string">&#x27;wont work with your grid system&#x27;</span>. These are grid configuration issues so youll have to check with your sysadmin <span class="keyword">if</span> it can be changed. If not, youll have to run Canu on a single node or use useGrid=remote from the head node <span class="built_in">which</span> will <span class="built_in">print</span> the commands <span class="keyword">for</span> you to manually run (see issue <span class="comment">#822).</span></span><br></pre></td></tr></table></figure>

<p><a href="https://canu.readthedocs.io/en/latest/faq.html#my-run-stopped-with-the-error-failed-to-submit-batch-jobs">canu FAQ</a></p>
<p><strong>How do I run Canu on my SLURM / SGE / PBS / LSF / Torque system?</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Canu will <span class="string">&#x27;detect and configure&#x27;</span> itself to use on most <span class="string">&#x27;grids&#x27;</span>. You <span class="keyword">do</span> not need to submit Canu to the grid <span class="keyword">in</span> this <span class="keyword">case</span>. Canu will query the system <span class="keyword">for</span> <span class="string">&#x27;grid support&#x27;</span>, configure itself <span class="keyword">for</span> the machines <span class="string">&#x27;available in the grid&#x27;</span>, <span class="keyword">then</span> submit itself to the grid <span class="keyword">for</span> execution. You can <span class="keyword">then</span> monitor the run <span class="string">&#x27;using your grid&#x27;</span>.</span><br><span class="line"></span><br><span class="line">Canu will <span class="string">&#x27;NOT request explicit time limits or queues/partitions&#x27;</span>. You can supply your own grid options, such as a partition on SLURM, an account code on SGE, and/or time limits with gridOptions=<span class="string">&quot;&lt;your options list&gt;&quot;</span> <span class="built_in">which</span> will passed to every job submitted by Canu. Similar options exist <span class="keyword">for</span> every stage of Canu, <span class="built_in">which</span> could be used to, <span class="keyword">for</span> example, restrict overlapping to a specific partition or queue.</span><br><span class="line"></span><br><span class="line">ã€ã€ã€<span class="string">&#x27;To disable grid support and run only on the local machine, specify useGrid=false&#x27;</span>ã€‘ã€‘ã€‘</span><br><span class="line"></span><br><span class="line">It is possible to <span class="built_in">limit</span> the number of grid <span class="built_in">jobs</span> running at the same time, but this isnâ€™t directly supported by Canu. The various gridOptions parameters can pass grid-specific parameters to the submit commands used; see Issue <span class="comment">#756 for Slurm and SGE examples.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#common options:</span></span><br><span class="line">useGrid=string</span><br><span class="line">      - Run under grid control (<span class="literal">true</span>), <span class="string">&#x27;locally (false)&#x27;</span>, or <span class="built_in">set</span> up <span class="keyword">for</span> grid control</span><br><span class="line">        but dont submit any <span class="built_in">jobs</span> (remote)</span><br></pre></td></tr></table></figure>



<h2 id="Advice"><a href="#Advice" class="headerlink" title="Advice"></a>Advice</h2><h3 id="åç»­åˆ†æè¦å»å†—ä½™"><a href="#åç»­åˆ†æè¦å»å†—ä½™" class="headerlink" title="åç»­åˆ†æè¦å»å†—ä½™"></a>åç»­åˆ†æè¦å»å†—ä½™</h3><p>Canu2.0ä¹‹å‰çš„contigå°½ç®¡è¿è¡Œæ—¥å¿—è¯´æ²¡æœ‰bubbleï¼Œå…¶å®æ˜¯æ²¡æœ‰æ£€æµ‹åˆ°ã€‚Canu2.0æ‰åŠ ä¸Šè¯¥ä¿¡æ¯ã€‚ä½†ä½œè€…å¼ºçƒˆæ¨èå…ˆç”¨purge_dupså»å†—ä½™ï¼Œé¿å…è½¯ä»¶éš¾ä»¥æ£€æµ‹åˆ°çš„å†—ä½™åºåˆ—å­˜åœ¨å½±å“åç»­åˆ†æã€‚</p>
<p>ä½œè€…ï¼šæ—§ç‰ˆCanuæ²¡æœ‰çœŸæ­£æ£€æµ‹åˆ°bubbleï¼Œå› æ­¤contigåŒ…å«ç€bubleï¼Œå»ºè®®åç»­åˆ†æç”¨purge_dups å¤„ç†è¿™äº›å†—ä½™åºåˆ—</p>
<p>Canuæ”¹åŠ¨åŸºæœ¬ä¸Šæ˜¯å¢åŠ æ–°åŠŸèƒ½ï¼Œæé«˜ç»„è£…å‡†ç¡®æ€§ï¼Œæé«˜ç»„è£…é€Ÿåº¦ï¼Œå¸¸è§„bugä¿®å¤ã€‚</p>
<p>1.8ç‰ˆæœ¬æ›´æ”¹äº†Nanoporeçš„é”™è¯¯ç‡ï¼Œæé«˜10å€å·¦å³ç»„è£…é€Ÿåº¦ï¼ŒåŒæ—¶å®Œæ•´æ”¯æŒäº†trio-binning</p>
<p>1.9ç‰ˆå¼€å§‹å¢åŠ PacBioçš„HiFiæ•°æ®ï¼Œæå¤§æé«˜ç›¸äº’æ¯”å¯¹é€Ÿåº¦</p>
<p>è¿™äº›ä¿®æ”¹ï¼Œå¯ä»¥ç›´æ¥å°†ç»„è£…å¾—åˆ°çš„contigç”¨äºåç»­åˆ†æ</p>
<p>è€Œ2.0åšäº†è®¸å¤šä¼˜åŒ–ç”¨æ¥ä¿è¯contigç»„è£…æ›´é•¿æ›´å‡†ç¡®ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯åœ¨contigæ„å»ºæœŸé—´ä¼šæ£€æµ‹bubbles, é˜²æ­¢ä»–ä»¬æ‰“æ–­æ‚åˆåŸºå› ç»„</p>
<p>ä¾‹å¦‚ç»„è£…å‘ç°æŸ“è‰²ä½“æ˜æ˜¾åå¤§ï¼Œç”¨æ–°Canuç»„è£…è¯¥ç‰©ç§æ—¶å€™å‘ç°ï¼Œå‰åä¸¤æ¬¡ç»„è£…ç»“æœåœ¨bubblesä¸€æ æœ‰æ˜æ˜¾å·®åˆ«ã€‚1.8ç‰ˆæœ¬æ˜¯0ï¼Œ2.0ç‰ˆæœ¬æ˜¯136ï¼Œçº¦6MåŸºå› ç»„å¤§å°ã€‚</p>
<p>æŸ¥çœ‹ä¹‹å‰æ‰€æœ‰ç»„è£…ç‰©ç§çš„æ—¥å¿—ï¼Œå‘ç°bubbleä¸€æ éƒ½æ˜¯0ï¼ˆå³ä¾¿æ˜¯æ‚åˆåŸºå› ç»„ï¼‰ã€‚</p>
<p>æ„å‘³ç€ï¼Œ2.0ç‰ˆæœ¬è£…çš„åŸºå› ç»„ä¸èƒ½ç›´æ¥ç”¨äºä¸‹æ¸¸çš„HiCï¼Œè€Œéœ€è¦å…ˆæŠŠbubbleè¿™éƒ¨åˆ†åºåˆ—ç»™è¿‡æ»¤æ‰ï¼Œä¸ç„¶åŸºå› ç»„åç¦»å®é™…å€¼ã€‚</p>
<h3 id="é«˜æ‚åˆç‰©ç§ç»„è£…"><a href="#é«˜æ‚åˆç‰©ç§ç»„è£…" class="headerlink" title="é«˜æ‚åˆç‰©ç§ç»„è£…"></a>é«˜æ‚åˆç‰©ç§ç»„è£…</h3><p>é«˜æ‚åˆç‰©ç§ç»„è£…ï¼ŒCanuå»ºè®®æ˜¯ç”¨ <code>batOptions=-dg 3 -db 3 -dr 1 -ca 500 -cp 50</code>å‚æ•°å°½é‡åˆ†å‡ºä¸¤å¥—å•å€å‹ï¼Œç„¶åå¯¹åŸºå› ç»„å»å†—ä½™ã€‚</p>
<p><code>batOptions</code>è¡¨ç¤ºä¼ é€’åç»­çš„å‚æ•°ç»™ç»„è£…è½¯ä»¶<code>bogart</code>, <code>-dg 3 -db3</code>é™ä½è‡ªåŠ¨ç¡®å®šé˜ˆå€¼æ—¶çš„é”™è¯¯ç‡ç¦»å·®(deviation)ï¼Œä»è€Œæ›´å¥½åˆ†å¼€å•å€å‹ã€‚<code>-dr 1 -ca 500 -cp 50</code>ä¼šå½±å“é”™è¯¯ç»„è£…çš„æ‹†åˆ†ï¼Œå¯¹äºä¸€ä¸ªæ¨¡æ£±ä¸¤å¯çš„contigï¼Œå¦‚æœå¦ä¸€æ¡å¯é€‰è·¯å¾„çš„overlapé•¿åº¦è‡³å°‘æ˜¯500bpï¼Œæˆ–å¦ä¸€æ¡å¯é€‰è·¯å¾„æ—¶åœ¨é•¿åº¦ä¸Šå’Œå½“å‰æœ€ä½³è·¯å¾„å­˜åœ¨50%çš„å·®å¼‚ï¼Œé‚£ä¹ˆå°†contigæ‹†åˆ†ã€‚</p>
<p>å…³äºæ‚åˆç‰©ç§ç»„è£…çš„è®¨è®ºï¼Œå‚è€ƒ<a href="https://links.jianshu.com/go?to=https://github.com/marbl/canu/issues/201%23issuecomment-233750764">https://github.com/marbl/canu/issues/201#issuecomment-233750764</a></p>
<h3 id="è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ"><a href="#è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ" class="headerlink" title="è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ"></a>è´­ä¹°SSDé¿å…æœåŠ¡å™¨IOç“¶é¢ˆ</h3><p>å¦‚æœæœåŠ¡å™¨çº¿ç¨‹æ•°å¾ˆå¤šï¼Œåœ¨æ™®é€šæœºæ¢°ç¡¬ç›˜ä¸Šç»„è£…ï¼Œè€Œä¸”ç³»ç»Ÿè¿˜æ˜¯CentOSï¼Œé‚£ä¹ˆéœ€è¦è°ƒæ•´ä¸€ä¸ªå‚æ•°ï¼Œé¿å…å…¶ä¸­ä¸€æ­¥çš„IOä¸¥é‡å½±å“æœåŠ¡å™¨æ€§èƒ½ã€‚</p>
<p>Canué€šè¿‡ä¸¤ä¸ªç­–ç•¥è¿›è¡Œå¹¶è¡Œï¼Œbucketizing (â€˜ovbâ€™ ä»»åŠ¡) å’Œ sorting (â€˜ovsâ€™ ä»»åŠ¡)ã€‚ bucketizingä¼šä»1-overlapè¯»å–è¾“å‡ºçš„overlapï¼Œå°†ä»–ä»¬<strong>å¤åˆ¶</strong>ä¸€ä»½ä½œä¸ºä¸­é—´æ–‡ä»¶ã€‚sortingä¸€æ­¥å°†è¿™äº›æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­è¿›è¡Œæ’åºç„¶å<strong>å†™å‡º</strong>åˆ°ç¡¬ç›˜ä¸Šã€‚ å¦‚æœä½ çš„overlapè¾“å‡ºç‰¹åˆ«å¤šï¼Œé‚£ä¹ˆè¯¥æ­¥éª¤å°†ä¼šç¬é—´æŒ¤çˆ†çš„ä½ çš„IO.</p>
<p>ä¸ºäº†é¿å…æ‚²å‰§å‘ç”Ÿï¼Œè¯·å¢åŠ å¦‚ä¸‹å‚æ•°: <code>ovsMemory=16G ovbConcurrency=15 ovsConcurrency=15</code>ï¼Œ ä¹Ÿå°±æ˜¯é™ä½è¿™ä¸¤æ­¥åŒæ—¶æŠ•é€’çš„ä»»åŠ¡æ•°ï¼Œç¼“è§£IOå‹åŠ›ã€‚</p>
<hr>
<h1 id="HiFIç»„è£…å®ä¾‹"><a href="#HiFIç»„è£…å®ä¾‹" class="headerlink" title="HiFIç»„è£…å®ä¾‹"></a>HiFIç»„è£…å®ä¾‹</h1><p>Contiguity, Completeness, and Correctness</p>
<h2 id="2018-10"><a href="#2018-10" class="headerlink" title="2018.10"></a>2018.10</h2><p>PacBioå…¬å¸ é«˜ä¿çœŸ å•åˆ†å­ é•¿è¯»é•¿ æµ‹åºã€HiFiã€‘æ¨¡å¼</p>
<h2 id="2019-01"><a href="#2019-01" class="headerlink" title="2019.01"></a>2019.01</h2><p>é¦–ç¯‡åˆ©ç”¨HiFiæ•°æ®è¿›è¡ŒäººåŸºå› ç»„ ç»“æ„å˜å¼‚æ£€æµ‹ å’Œ åŸºå› ç»„ç»„è£… æ–‡ç« å‘å¸ƒ</p>
<h2 id="2020-01"><a href="#2020-01" class="headerlink" title="2020.01"></a>2020.01</h2><p>HiFiåœ¨ å››å€ä½“ç«ç‘° ç‡•éº¦ å¤§éº» ç™½è›‰ ç­‰å¤šä¸ªç‰©ç§åŸºå› ç»„ç»„è£…</p>
<h2 id="2020-03-27Gbå…­å€ä½“åŠ å·çº¢æ‰"><a href="#2020-03-27Gbå…­å€ä½“åŠ å·çº¢æ‰" class="headerlink" title="2020.03 27Gbå…­å€ä½“åŠ å·çº¢æ‰"></a>2020.03 27Gbå…­å€ä½“åŠ å·çº¢æ‰</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzkxMjIzNzY3Mw==&mid=2247489444&idx=2&sn=e6e9e4eebac756a0d518ee4a0fa09956&source=41#wechat_redirect">PacBioç§‘å­¦å®¶åˆ©ç”¨HiFiæµ‹åºä¸¤å‘¨å†…å®ŒæˆåŸºå› ç»„é«˜è¾¾27Gbçš„å…­å€ä½“åŠ å·çº¢æ‰åŸºå› ç»„ç»„è£…</a></p>
<h3 id="åˆè¡·"><a href="#åˆè¡·" class="headerlink" title="åˆè¡·"></a>åˆè¡·</h3><p><font color="blue">15Gbå…­å€ä½“å°éº¦</font>åŸºå› ç»„ï¼Œé€‰æ‹©<font color="blue">HiFiè¿˜æ˜¯CLRï¼Ÿ</font><font color="blue">11Gbç‡•éº¦</font>åŸºå› ç»„ç»„è£…è¯´æ˜<font color="blue">HiFiç»„è£…<strong>è¶…å¤§åŸºå› ç»„</strong>çš„èƒ½åŠ›</font>ï¼Œ<strong>Contig N50</strong>é«˜è¾¾<strong>20Mb</strong>ï¼HiFi Reads <font color="blue"><strong>è¯»å–é•¿åº¦</strong></font> å’Œ <font color="blue"><strong>å‡†ç¡®æ€§</strong></font> ä¹‹é—´çš„ <font color="blue"><strong>å¹³è¡¡</strong></font> æ˜¯å¦èƒ½å…‹æœæœ€è‰°å·¨çš„åŸºå› ç»„ï¼ˆå¤§ä¸”å¤æ‚ï¼‰æŒ‘æˆ˜ï¼Ÿ</p>
<h3 id="æµ‹åºè¿‡ç¨‹"><a href="#æµ‹åºè¿‡ç¨‹" class="headerlink" title="æµ‹åºè¿‡ç¨‹"></a>æµ‹åºè¿‡ç¨‹</h3><p>æ–¯å¦ç¦å¤§å­¦æ ¡å›­å†…é‡‡æ ·ï¼ŒDNAæå–æ–‡åº“æ„å»ºã€‚</p>
<p>ä½¿ç”¨<font color="blue">BluePippin[é«˜åˆ†å­é‡DNAæ ¸é…¸ç‰‡æ®µåˆ†ç¦»å’Œå›æ”¶]</font>å°†DNAç‰‡æ®µé€‰æ‹©å¤§å°è®¾ä¸º<strong>15 kb</strong>ï¼Œæ›´é•¿çš„æ’å…¥ç‰‡æ®µå…è®¸HiFiè¯»é•¿è¾¾åˆ°<strong>50 kb</strong>ã€‚ HiFi reads çš„å‡†ç¡®ç‡åˆ†å¸ƒå¯ä»¥å‘ç°æ‰€æœ‰readså‡†ç¡®ç‡<strong>éƒ½åœ¨Q20ä»¥ä¸Š</strong>ï¼ŒHiFi reads<strong>æœ€å¯†é›†</strong>çš„æ’å…¥ç‰‡æ®µåœ¨<strong>20k-30kåŒºé—´</strong>ï¼Œæœ€é•¿çš„æ’å…¥ç‰‡æ®µè¾¾åˆ°<strong>50kç²¾åº¦éƒ½é«˜äºQ20</strong>(99ï¼…)ï¼Œå¤§çº¦æœ‰<strong>è¶…è¿‡ä¸€åŠçš„reads</strong>å‡†ç¡®ç‡æ¥è¿‘æˆ–è¶…è¿‡<strong>Q30</strong>(99.9%)ã€‚</p>
<p><strong>7å¤©è¿ç»­æµ‹åº</strong>å…±è·å¾—<strong>606Gb</strong> HiFiæ•°æ®ï¼Œç›¸å½“äº<strong>22X</strong>ã€‚åœ¨ä¹‹å‰å¾ˆå¤šä½¿ç”¨HiFiè¿›è¡Œç»„è£…çš„é¡¹ç›®ä¸­å‘ç°ï¼Œåªéœ€<strong>20å€</strong>å·¦å³çš„è¦†ç›–åº¦å°±èƒ½å¤Ÿäº§ç”Ÿ<strong>å‡ºè‰²</strong>çš„ç»„è£…ç»“æœï¼Œä¸”<strong>ä¸éœ€è¦NGSçº é”™</strong>ã€‚</p>
<h3 id="ç»„è£…ç»“æœ"><a href="#ç»„è£…ç»“æœ" class="headerlink" title="ç»„è£…ç»“æœ"></a>ç»„è£…ç»“æœ</h3><p>åœ¨è·å¾—HiFiæ•°æ®ä¹‹åï¼ŒPacBioè´Ÿè´£<strong>è¶…å¤§åŸºå› ç»„ç»„è£…</strong>çš„èµ„æ·±ç”Ÿä¿¡ç§‘å­¦å®¶<strong>Greg Concepcion</strong>å¼€å§‹äº†åŠ å·çº¢æ‰åŸºå› ç»„çš„ç»„è£…å·¥ä½œã€‚Gregé€‰æ‹©çš„å·¥å…·æ˜¯<font color="red">Hifiasm</font>ï¼Œå› ä¸ºè¿™æ˜¯ç›®å‰<font color="blue"><strong>æœ€å¿«</strong>çš„ä¸”<strong>ä¸“æ³¨äºè§£æå•å€å‹</strong>çš„ç»„è£…è½¯ä»¶</font>ã€‚</p>
<p>Hifiasmè½¯ä»¶è¿è¡Œ<font color="red">6å¤©</font>åï¼Œç»„è£…å·¥ä½œé¡ºåˆ©å®Œæˆã€‚å…·ä½“æ¶ˆè€—è®¡ç®—èµ„æºå¦‚ä¸‹ï¼›</p>
<p>æœåŠ¡å™¨é…ç½®ï¼š64æ ¸512Gb RAM</p>
<p>ç”ŸæˆHiFiæ•°æ®ï¼š46,000 CPU hours</p>
<p>åŸºå› ç»„ç»„è£…ï¼š7,200 CPU hoursï¼Œæ€»å…±åˆ†ææ—¶é—´6å¤©</p>
<p>å¯¹æ¯”2019å¹´Oxford Nanopore + NGSåŒæ ·ç»„è£…åŠ å·çº¢æ‰ï¼Œä½¿ç”¨2Tbå†…å­˜,æœ€ç»ˆèŠ±è´¹5-6ä¸ªæœˆæ‰å®Œæˆç»„è£…ã€‚</p>
<p>Sequencing and assembling mega-genomes of mega-trees: the giant sequoia and coast redwood genomesï¼Œ<strong>Nanopore Community Meeting 2019</strong>ã€æœ€å¤§å†…å­˜ä½¿ç”¨ï¼š2Tï¼›error correctionï¼š330ï¼Œ000CPU hoursï¼›Assembly post-error-correctionï¼š700ï¼Œ000CPU hoursï¼›wall clock timeï¼š5-6monthã€‘</p>
<p>è·å¾—çš„ç»“æœæƒŠäººï¼Œç»“æœå‡ ä¹æ˜¯<font color="blue">é¢„æœŸåŸºå› å¤§å°<strong>ä¸¤å€</strong></font>ï¼Œè€Œ<font color="blue">Contig N50</font>è¾¾åˆ°<font color="blue"><strong>1.92Mb</strong></font> ï¼ç›¸å¯¹2019å¹´Oxford Nanopore + NGSç»„è£…<font color="blue"><strong>æå‡18å€</strong></font>ã€‚å¤§äºé¢„æœŸåŸºå› ç»„å¤§å°çš„ç»„è£…ä¸­ï¼Œå¤§éƒ¨åˆ†å¯æ˜¯<font color="blue"><strong>ä¸¤ä¸ªç±»ä¼¼çš„å•å€å‹</strong></font>ï¼Œè€Œ<font color="red"><strong>å¹¶éå®Œå…¨ä¸åŒçš„å…­å€ä½“</strong></font>ï¼Œè¿™ä¸æœ€è¿‘Scottå‘è¡¨çš„çº¢æ‰ç›¸å…³ç ”ç©¶ç±»ä¼¼ï¼Œå°è¯äº†åŠ å·çº¢æ‰çš„å¤šå€ä½“åŒ–æ˜¯<font color="red"><strong>è‡ªå¤šå€ä½“äº‹ä»¶</strong></font>ã€‚</p>
<p><img src="/blog/./640.jpeg" alt="å›¾ç‰‡"></p>
<p><font color="blue">åŠ å·çº¢æ‰ç»„è£…ç»“æœä¸­<strong>BUSCOè¯„åˆ†åªæœ‰59%??</strong> </font>ä¸æ˜¯ä¸€èˆ¬<strong>è¾ƒå¥½</strong>çš„ç»„è£…ç»“æœBUSCOå€¼éƒ½è¦é«˜è¾¾<font color="blue"><strong>90%ä»¥ä¸Šå—ï¼Ÿ</strong></font>å› ä¸º<font color="blue">è£¸å­æ¤ç‰©ï¼ˆåŠ å·çº¢æ‰å±äºè£¸å­æ¤ç‰©ï¼‰çš„BUSCOåŸºå› é›†ä¸è¢«å­æ¤ç‰©çš„<strong>BUSCOåŸºå› é›†ç›¸å·®å¾ˆ</strong>å¤š</font>ã€‚æ„å‘³ç€é’ˆå¯¹åŠ å·çº¢æ‰ä½¿ç”¨<font color="red"><strong>é€šç”¨BUSCOåŸºå› é›†</strong></font>æ¥<font color="red"><strong>è¯„ä¼°</strong>åŸºå› ç»„å®Œæ•´æ€§<strong>ä¸å‡†ç¡®</strong></font>ï¼Œåªæ˜¯<strong>ç›®å‰æ²¡æœ‰</strong>å…¶å®ƒ<strong>æ›´å¥½</strong>è¯„ä¼°æ–¹æ³•ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä»åŠ å·çº¢æ‰åŸºå› ç»„ç ”ç©¶ä¸­å¾—åˆ°ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œå¯¹PacBio SMRTæµ‹åºå……æ»¡ä¿¡å¿ƒï¼Œå»ºè®®ä½¿ç”¨HiFiæ•°æ®ä»ä»»ä½•ç”Ÿç‰©ä½“ç”Ÿæˆé«˜è´¨é‡çš„åŸºå› ç»„æ•°æ®ã€‚ </p>
<p>å…¶æ¬¡ï¼Œå®ƒå°†å½»åº•æ”¹å˜å¯¹<strong>å¤§å‹ï¼Œå¤æ‚</strong>çš„åŸºå› ç»„è£…é…çš„è®¤çŸ¥ã€‚ä¹‹å‰ç»éªŒæ˜¯<strong>è¶…å¤§å‹å¤æ‚åŸºå› ç»„</strong>ç»„è£…éœ€è¦èŠ±è´¹<strong>å¤§é‡æ—¶é—´</strong>å’Œç”Ÿä¿¡<strong>è®¡ç®—èµ„æº</strong>ï¼Œè¿˜ä¸åŒ…æ‹¬æµ‹åºæ—¶é—´ã€‚è€ŒåŠ å·çº¢æ‰åºå¤§åŸºå› ç»„åœ¨çŸ­çŸ­17å¤©å†…å°±å¯å®Œæˆï¼ˆåŒ…æ‹¬4å¤©æ ·å“å‡†å¤‡å’Œå»ºåº“ï¼Œ7å¤©æµ‹åºå’Œ6å¤©ç»„è£…ï¼‰ã€‚ </p>
<p><strong>é€šè¿‡PacBio HiFiæ•°æ®ï¼Œå¯ä»¥å¯¹<font color="blue">ä»»ä½•ç”Ÿç‰©</font>è¿›è¡Œ<font color="blue">é«˜è´¨é‡</font>çš„åŸºå› ç»„æµ‹åºã€‚</strong></p>
<h2 id="2020-05"><a href="#2020-05" class="headerlink" title="2020.05"></a>2020.05</h2><p>HiFiåŠ©åŠ›åŒæºå››å€ä½“ç´«èŠ±è‹œè“¿åŸºå› ç»„ç»„è£…ï¼ŒNCå‘è¡¨</p>
<p>Allele-aware chromosome-level genome assembly and efficient transgene-free genome editing for the autotetraploid cultivated alfalfa</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨Canué»˜è®¤å‚æ•°ï¼Œåˆ©ç”¨CCS clean readsç»„è£…contigsã€‚ç»„è£…å¾—åˆ°çš„Contig N50å€¼ä¸º459kbï¼Œæ€»é•¿åº¦ä¸º3.15GBã€‚</p>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨HiC-Proå°†Hi-C readsä¸contigs è¿›è¡Œæ¯”å¯¹ï¼Œäº§ç”Ÿæ¯”å¯¹BAMæ–‡ä»¶ã€‚</p>
<p>ï¼ˆ3ï¼‰ä½¿ç”¨æ³¨é‡Šçš„è’ºè—œè‹œè“¿è›‹ç™½ä½œä¸ºå‚è€ƒï¼Œå®Œå…¨åŸºäºåŒæºçš„ç­–ç•¥æ³¨é‡Šcontigsã€‚å¯¹138,729ä¸ªåŒæºåŸºå› è¿›è¡Œäº†ç»“æ„æ³¨é‡Šã€‚ç”¨MCscanç”¨äºé‰´å®šcontigså’Œå‚è€ƒåŸºå› ç»„ä¹‹é—´çš„å…±çº¿æ€§ã€‚æ˜¾ç¤ºç´«èŠ±è‹œè“¿å’Œè’ºè—œè‹œè“¿ä¹‹é—´çš„é«˜å…±çº¿æ€§ã€‚ã€ä¸‹è½½çˆ¶æ¯æœ¬petunia refã€‘</p>
<p>ï¼ˆ4ï¼‰ä½¿ç”¨å†…éƒ¨è„šæœ¬å¤„ç†BAMæ–‡ä»¶ï¼Œå»é™¤ç­‰ä½åŸºå› contigsä¹‹é—´çš„linksã€‚ä½¿ç”¨ALLHiCè½¯ä»¶ï¼Œæå–ã€èšç±»å’Œé‡æ’Contigs (Contigs syntenicä¸è’ºè—œè‹œè“¿æŸ“è‰²ä½“ä¸€è‡´)ï¼Œå¾—åˆ°åŸå§‹çš„scaffoldsã€‚</p>
<p>ï¼ˆ5ï¼‰Juiceboxç”¨äºä»¥å›¾å½¢å’Œäº¤äº’æ–¹å¼å¾®è°ƒç»„è£…çš„scaffoldsã€‚å‰ªè£äº†40ä¸ªæ€»é•¿åº¦è¾¾1800Mbçš„scaffolds ã€‚</p>
<p>ï¼ˆ6ï¼‰ åŸºäºç»„è£…çš„scaffoldï¼Œé€šè¿‡Hi-Cæ•°æ®ï¼Œæ¯ä¸ªunplaced contigè¢«åˆ†é…åˆ°äº’ä½œæœ€å¼ºçš„é‚£äº›contig clusteré‡Œã€‚</p>
<p>ï¼ˆ7ï¼‰ä½¿ç”¨ALLHiCå¯¹é‚£äº›contig clusterså†æ¬¡è¿›è¡Œé‡æ’å’Œæ„å»ºscaffoldã€‚</p>
<p>ï¼ˆ8ï¼‰ä½¿ç”¨Juiceboxå¯¹scaffoldsè¿›è¡Œå¾®è°ƒï¼Œå¹¶ä»scaffoldsä¸Šå»é™¤ä¸ä¸€è‡´çš„contigsï¼Œäº§ç”Ÿæœ€ç»ˆçš„æŸ“è‰²ä½“åŸºå› ç»„ï¼Œå…¶åŒ…å«32æ¡æŸ“è‰²ä½“(8ä¸ªåŒæºç»„ï¼Œæ¯ä¸ªç»„ä¸­æœ‰4ä¸ªç­‰ä½åŸºå› æŸ“è‰²ä½“)ï¼Œæ€»é•¿åº¦ä¸º2738Mbï¼Œå’Œ419MbæœªæŒ‚è½½åˆ°æŸ“è‰²ä½“æ°´å¹³çš„åºåˆ—ã€‚</p>
<h2 id="2020-07"><a href="#2020-07" class="headerlink" title="2020.07"></a>2020.07</h2><p>åŠ å·å¤§å­¦HiFiç»„è£…äººå®Œæ•´XæŸ“è‰²ä½“ï¼ŒNature</p>
<p>Miga Karen H,Koren Sergey,Rhie Arang et al. Telomere-to-telomere assembly of a complete human X chromosome.[J] .Nature, 2020.</p>
<h1 id="HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…"><a href="#HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…" class="headerlink" title="HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…"></a><a href="https://www.jianshu.com/p/4d42719d8b01">HiFiä¸ä¸åŒç±»å‹åŸºå› ç»„ç»„è£…</a></h1><h2 id="é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³"><a href="#é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³" class="headerlink" title="é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³"></a><strong>é«˜é‡å¤åŸºå› ç»„â€”ç‰ç±³</strong></h2><p>ç‰ç±³ï¼ˆ<em>Z.mays</em>ï¼‰æ˜¯ä¸–ç•Œä¸Šäº§é‡æœ€é«˜ç§æ¤æœ€å¹¿çš„ä½œç‰©ï¼Œä¹Ÿæ˜¯é—ä¼ å­¦å’ŒåŸºå› ç»„å­¦çš„åŸºç¡€modelã€‚ç‰ç±³åŸºå› ç»„ç»å†<font color="blue"><strong>å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶</strong></font>å’Œ<font color="blue"><strong>é•¿æœ«ç«¯é‡å¤è½¬åº§å­æ‰©å¢</strong></font>å¯¼è‡´åŸºå› ç»„<strong>æ€¥å‰§æ‰©å¤§</strong>ï¼ˆ<font color="red">2.3Gb</font>ï¼‰ã€‚æœ€ç»ˆå¯¼è‡´ç‰ç±³åŸºå› ç»„ä¸­<font color="red"><strong>è½¬åº§å­å æ¯”é«˜è¾¾85%</strong></font>ã€‚</p>
<p>åˆ©ç”¨<strong>HiFi</strong>ç»„è£…çš„<font color="blue"><strong>ç‰ç±³B73</strong></font>åŸºå› ç»„å¤§å°ä¸º<font color="blue"><strong>2.164 Gb</strong></font>ï¼Œ<strong>ç•¥å¤§äº</strong>2017å¹´å‘è¡¨çš„åˆ©ç”¨PacBio <font color="blue">CLR</font>çš„ç»„è£…ç‰ˆæœ¬ï¼ˆ<font color="blue">2.104 Gb</font>ï¼‰ã€‚åœ¨è¿ç»­æ€§æ–¹é¢ï¼ŒHiFiç»„è£…<font color="blue"><strong>Contig N50åˆ™è¾¾åˆ°28.2 Mb</strong></font>ï¼Œæå‡è¿‘<font color="red"><strong>23å€</strong></font>ï¼Œç”šè‡³<strong>è¶…è¿‡</strong>æœ€è¿‘å‘è¡¨çš„<strong>NC358</strong>åŸºå› ç»„ã€‚<font color="red"><strong>BUSCOè¯„ä¼°è¡¨æ˜</strong></font>ï¼ŒHiFiç»„è£…ç‰ˆæœ¬çš„ç»„è£…è´¨é‡ä¹Ÿ<font color="red"><strong>é«˜äºæ‰€æœ‰</strong></font>å·²å‘è¡¨çš„<strong>ç‰ç±³åŸºå› ç»„ç‰ˆæœ¬</strong>ã€‚åœ¨æ—¶é—´å’Œèµ„æºæ¶ˆè€—ä¸Šï¼Œæœ€è¿‘å‘è¡¨çš„<strong>75Ã— CLRæ•°æ®</strong>ç»„è£…NC358åŸºå› ç»„èŠ±è´¹äº†<strong>11,520 CPU hours</strong>ï¼Œè€ŒHiFiæ•°æ®ç»„è£…ä»…åœ¨6å°æ—¶å®Œæˆï¼Œä»…èŠ±è´¹360 CPU hoursï¼Œ<font color="red"><strong>èµ„æºæ¶ˆè€—èŠ‚çœäº†31å€</strong></font>ã€‚ä½“ç°äº†HiFiåœ¨<font color="blue">é«˜é‡å¤åŸºå› ç»„ç»„è£…</font>çš„æ˜æ˜¾<font color="blue">ä¼˜åŠ¿</font>ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/10.png" alt="img"></p>
<p>HiFi ç»„è£… <strong>ç‰ç±³B73</strong> åŸºå› ç»„ç»“æœ</p>
<h2 id="å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™"><a href="#å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™" class="headerlink" title="å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™"></a><strong>å¤§å‹å¤æ‚åŸºå› ç»„â€”é»„è…¿å±±è›™</strong></h2><p>é»„è…¿å±±è›™ï¼ˆ<em>R. muscosa</em>ï¼‰æ˜¯ä¸€ç§ä¸¤æ –åŠ¨ç‰©ã€‚<font color="blue"><strong>ä¸¤æ –åŠ¨ç‰©</strong>æ˜¯<strong>è„Šæ¤åŠ¨ç‰©</strong>ä¸­<strong>åŸºå› ç»„å¤§å°å˜åŒ–æœ€å¤§</strong>çš„ä¸€ç±»</font>ï¼Œå·²å®ŒæˆåŸºå› ç»„æµ‹åºçš„<strong>ç¾è¥¿é’å£èˆ</strong>é«˜è¾¾<strong>32 Gb</strong>ã€‚è›™ç§‘ç‰©ç§ä¸­ï¼Œæœ€å¤§åŸºå› ç»„è¾¾10 Gbä»¥ä¸Šï¼Œé»„è…¿å±±è›™çš„åŸºå› ç»„<strong>é¢„è®¡9 Gb</strong>å·¦å³ã€‚</p>
<p>åˆ©ç”¨HiFiæ•°æ®ç»„è£…çš„é»„è…¿å±±è›™åŸºå› ç»„è·å¾—<font color="blue">ä¸¤å¥—å•å€å‹åŸºå› ç»„</font>ï¼Œå•å€å‹åŸºå› ç»„å¤§å°åˆ†åˆ«ä¸º<font color="blue">9.03Gå’Œ5.23 Gb</font>ï¼Œ<font color="red"><strong>ä¸»è¦å•å€å‹åŸºå› ç»„</strong></font>å¤§å°<strong>æ¥è¿‘é¢„ä¼°</strong>åŸºå› ç»„å¤§å°ã€‚<font color="red"><strong>ä¸»è¦å•å€å‹åŸºå› ç»„</strong>Contig <strong>N50è¾¾2.8 M</strong>ï¼Œ<strong>è¿œé«˜äº</strong>å·²å‘è¡¨çš„è›™ç§‘ç‰©ç§åŸºå› ç»„</font>ã€‚HiFi ç»„è£…çš„<font color="blue"><strong>é»„è…¿å±±è›™</strong>åŸºå› ç»„çš„<strong>BUSCOè¯„ä¼°ç»“æœ</strong>ä¹Ÿ<strong>æ˜æ˜¾é«˜äº</strong>å¦å¤–ä¸¤ä¸ªç‰©ç§çš„åŸºå› ç»„</font>ã€‚æ­¤å¤–ï¼Œè™½ç„¶é»„è…¿å±±è›™çš„åŸºå› ç»„é«˜è¾¾9 Gbï¼Œåˆ©ç”¨HiFi ç»„è£…ä¹Ÿä»…èŠ±è´¹<strong>12å°æ—¶</strong>ã€‚ä¸Šè¿°è¡¨æ˜ï¼ŒHiFiå¿«é€Ÿç»„è£…<font color="blue">é«˜è´¨é‡å¤§å‹åŸºå› ç»„</font>å‡ºè‰²ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/11.png" alt="img"></p>
<p>HiFiç»„è£… <strong>é»„è…¿å±±è›™</strong> åŸºå› ç»„ç»“æœ</p>
<h2 id="å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“"><a href="#å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“" class="headerlink" title="å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“"></a><strong>å¼‚æºå¤šå€ä½“åŸºå› ç»„â€”è‰è“</strong></h2><p>æ ½åŸ¹è‰è“ï¼ˆ<em>F. x ananassa</em>ï¼‰æ˜¯ä¸€ä¸ª<font color="blue"><strong>å¼‚æº</strong>å…«å€ä½“ç‰©ç§ï¼ˆ2n=8x=56ï¼‰</font>ï¼Œç”±ä¸¤ç§<font color="blue">é‡ç”Ÿå…«å€ä½“ç‰©ç§å¤©ç„¶æ‚äº¤</font>äº§ç”Ÿï¼Œè¿™<font color="blue"><strong>ä¸¤ç§é‡ç”Ÿå…«å€ä½“</strong>éƒ½æ˜¯<strong>100å¤šä¸‡å¹´</strong>å‰<strong>å››ç§äºŒå€ä½“ç¥–å…ˆç‰©ç§åˆå¹¶</strong>çš„äº§ç‰©</font>ã€‚</p>
<p>åˆ©ç”¨HiFiæ•°æ®ç»„è£…çš„å…«å€ä½“è‰è“åŸºå› ç»„è·å¾—äº†<font color="blue">ä¸¤å¥—å•å€å‹åŸºå› ç»„</font>ï¼Œå¤§å°åˆ†åˆ«ä¸º<font color="blue">776Må’Œ304 M</font>ï¼Œ<font color="red"><strong>ä¸»è¦å•å€å‹åŸºå› ç»„</strong></font>çš„å¤§å°ä¸<strong>2019å¹´</strong>æœ€æ–°<strong>å‘è¡¨</strong>çš„<strong>æ ½åŸ¹è‰è“åŸºå› ç»„ç›¸å½“</strong>ï¼Œä½†<font color="blue">Contig N50è¾¾<strong>15.5 Mb</strong>ï¼Œæå‡<strong>193å€</strong></font>ã€‚æ­¤å¤–ï¼Œæ•´ä¸ªåŸºå› ç»„ç»„è£…ä»…èŠ±è´¹<strong>3å°æ—¶</strong>ã€‚ä¸Šè¿°ç»“æœä½“ç°HiFiæµ‹åºåœ¨<font color="blue">å¤šå€ä½“åŸºå› ç»„ç»„è£…ä¸­çš„è‰¯å¥½è¡¨ç°</font>ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/12.png" alt="img"></p>
<p>HiFi æ•°æ®ç»„è£… <strong>å…«å€ä½“è‰è“</strong> åŸºå› ç»„ç»“æœ</p>
<h2 id="åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œè“¿-âˆš"><a href="#åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œè“¿-âˆš" class="headerlink" title="åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œè“¿ âˆš"></a><strong>åŒæºå¤šå€ä½“åŸºå› ç»„â€”è‹œ</strong>è“¿ âˆš</h2><p>æ ½åŸ¹ç´«èŠ±è‹œè“¿ï¼ˆ<em>M. sativa</em>ï¼‰æ˜¯ä¸€ç§<font color="blue">è‡ªäº¤ä¸äº²å’Œçš„<strong>åŒæº</strong>å››å€ä½“ï¼ˆ2n=4Ã—=32ï¼‰</font>æ¤ç‰©ã€‚5æœˆæ˜†æ˜åŠ¨ç‰©ç ”ç©¶æ‰€ç­‰å•ä½åˆ©ç”¨HiFiæµ‹åºï¼ˆçº¦23Ã—ï¼‰å®ç°æ ½åŸ¹ç´«èŠ±è‹œè“¿çš„åŸºå› ç»„ç»„è£… <a href="https://pubmed.ncbi.nlm.nih.gov/32427850/">paper</a>ã€‚</p>
<p>åˆ©ç”¨ä¸“é—¨é’ˆå¯¹HiFiæ•°æ®å¼€å‘çš„ç»„è£…è½¯ä»¶<font color="red"><strong>HiCanuå’ŒHifiasm</strong></font>é‡æ–°å¯¹è¯¥åŸºå› ç»„è¿›è¡Œç»„è£…ã€‚<font color="blue">HiCanuç»„è£…ç‰ˆæœ¬</font>åŸºå› ç»„å¤§å°ä¸º<font color="blue">2.66 G</font>ï¼Œ<strong>ç•¥ä½</strong>äº<font color="blue">Canuç‰ˆæœ¬</font>ï¼›<font color="blue"><strong>Hifiasmç»„è£…ç‰ˆæœ¬</strong></font>çš„åŸºå› ç»„å¤§å°ï¼ˆ<font color="blue">3.22 G</font>ï¼‰åˆ™ç•¥é«˜äºCanuç‰ˆæœ¬ã€‚<font color="red"><strong>HiCanu</strong>å’Œ<strong>Hifiasm</strong>çš„ç»„è£…çš„<strong>Contig N50</strong>åˆ†åˆ«ä¸º<strong>1.67</strong>å’Œ<strong>1.73</strong> Mbï¼Œ<strong>æ˜æ˜¾é«˜äºCanu</strong>ç‰ˆæœ¬</font>ã€‚æµ‹è¯•ç»“æœåŠå·²å‘è¡¨çš„è‹œè“¿åŸºå› ç»„å‡è¡¨æ˜ï¼ŒHiFièƒ½å¤Ÿå®ç°<font color="blue">åŒæºå¤šå€ä½“åŸºå› ç»„çš„é«˜è´¨é‡ç»„è£…</font>ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/14.png" alt="åŒæºå››å€ä½“è‹œè“¿åŸºå› ç»„ç»„è£…ç»“æœæ¯”è¾ƒ"></p>
<h2 id="å•å€å‹åŸºå› ç»„-äºº"><a href="#å•å€å‹åŸºå› ç»„-äºº" class="headerlink" title="å•å€å‹åŸºå› ç»„   äºº"></a><strong>å•å€å‹åŸºå› ç»„   äºº</strong></h2><p>ç›®å‰å·²å‘è¡¨å¤šä¸ªé«˜è´¨é‡äººåŸºå› ç»„åºåˆ—ï¼Œä¸”å·²æœ‰å¤šä¸ªåˆ©ç”¨HiFiç»„è£…äººåŸºå› ç»„çš„æ¡ˆä¾‹ï¼Œåˆ©ç”¨HiFiç»„è£…å‡º<strong>äººä¸¤å¥—å•å€å‹åŸºå› ç»„</strong>ä¹Ÿå·²ç»è¢«æŠ¥é“ã€‚</p>
<p>åˆ©ç”¨HiFi å¯¹äººåŸºå› ç»„ç»„è£…ï¼Œè·å¾—ä¸¤å¥—å•å€å‹åŸºå› ç»„ã€‚<font color="blue"><strong>ä¸¤å¥—å•å€å‹åŸºå› ç»„</strong>å¤§å°åˆ†åˆ«ä¸º<strong>3.14G</strong>å’Œ<strong>2.50 G</strong>ï¼Œ<strong>Contig N50</strong>åˆ†åˆ«ä¸º<strong>42.2M</strong>å’Œ<strong>1.6 M</strong></font>ã€‚è¿™ä¸€ç»“æœä¸<strong>å·²å‘è¡¨çš„åˆ©ç”¨HiFiæ•°æ®ç»„è£…çš„HG002å’ŒHG00733åŸºå› ç»„ç›¸å½“ã€‚æ•´ä¸ªç»„è£…è¿‡ç¨‹ä»…èŠ±è´¹2å°æ—¶ã€‚</strong>ä¸Šè¿°ç»“æœä½“ç°HiFiåœ¨<font color="blue">å•å€å‹åŸºå› ç»„ç»„è£…ä¸­çš„ä¼˜åŠ¿</font>ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/13.png" alt="img"></p>
<p>HiFi ç»„è£… äºº åŸºå› ç»„ç»“æœ</p>
<hr>
<h1 id="ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline-SV-calling"><a href="#ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline-SV-calling" class="headerlink" title="ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline SV calling"></a>ï¼ŸPacbioåºåˆ—ç»“æ„å˜å¼‚germline SV calling</h1><p><a href="https://blog.csdn.net/weixin_36416921/article/details/112277318">https://blog.csdn.net/weixin_36416921/article/details/112277318</a> ï¼Ÿï¼Ÿ</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/2.png" alt="img"></p>
<ul>
<li><p>è·å–bamæ–‡ä»¶ï¼ˆPacbioä¸‹æœºæ•°æ®ï¼‰ã€‚</p>
</li>
<li><p>subreads.bamæ–‡ä»¶ åˆ°ccs.bamæ–‡ä»¶</p>
</li>
<li><p>bamåˆ°fastqæ–‡ä»¶</p>
</li>
<li><p>æ•°æ®åˆ†æï¼Œå˜å¼‚æ£€æµ‹</p>
<ul>
<li><strong>mapping &amp; calling ã€</strong>nextSV2æµç¨‹ã€‘</li>
<li>å¸¸ç”¨çš„é•¿åºåˆ—æ¯”å¯¹è½¯ä»¶æœ‰<strong>ngmlr</strong> å’Œ <strong>minimap2</strong>ï¼Œä¸åŒçš„mappingè½¯ä»¶å¾—åˆ°ç»“æœç•¥æœ‰å·®åˆ«ï¼Œminimap2æ¯”å¯¹å¾—åˆ°çš„ç»“æœè¾ƒå¤šï¼Ÿ</li>
<li><strong>sniffles calling</strong> </li>
</ul>
</li>
</ul>
<hr>
<p>ä¸€èˆ¬è®¤ä¸ºåªæœ‰CLRçš„subreadséœ€è¦ç”¨NGSæ ¡æ­£ï¼Œccsæˆ–hifi readså·²ç»è‡ªèº«æ ¡æ­£äº†ï¼Œä¸ç”¨é¢å¤–æ ¡æ­£ã€‚å½“ccsçš„é˜ˆå€¼è®¾å®šä¸º3æ—¶ï¼Œå¾—åˆ°çš„åºåˆ—å°±æ˜¯HIFI readsäº†ã€‚</p>
<h1 id="HiFi-HiCanu"><a href="#HiFi-HiCanu" class="headerlink" title="HiFi+HiCanu"></a>HiFi+HiCanu</h1><p>ref: <a href="http://www.genome.cn/News/Industry/1099.html">http://www.genome.cn/News/Industry/1099.html</a></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/32801147/">HiCanu: accurate assembly of segmental duplications, satellites, and allelic variants from high-fidelity long reads</a> <strong>2020.09 Genom Res</strong></p>
<p><strong>PacBio HiFi+HiCanu</strong>å®Œæˆå‡†ç¡®åº¦è¶…99.999%ï¼Œ<strong>Contig N50</strong>è¾¾åˆ°<strong>77Mb</strong>çš„<strong>äººç±»</strong>åŸºå› ç»„ç»„è£…ç»“æœï¼</p>
<p>NIHç§‘å­¦å®¶ä½¿ç”¨PacBio HiFi Readsç»„è£…åŸºå› ç»„æ–‡ç«  <strong>HiCanu</strong>ã€‚ä½¿ç”¨HiCanuç»„è£…å·¥å…·ï¼ˆä¸“é—¨é’ˆå¯¹ HiFi Readsä¼˜åŒ–ç»„è£…æµç¨‹ï¼‰ï¼Œå¯¹<font color="red"><strong>æœè‡</strong></font>å’Œ<font color="red"><strong>äººç±»</strong></font><strong>æ ‡å‡†åŸºå› ç»„</strong>ç»„è£…ï¼Œé‡ç‚¹æ¢ç´¢HiFi Readså¯¹<font color="blue"><strong>åŸºå› ç»„å•å€å‹çš„åŒºåˆ†</strong></font>ï¼Œä¸»è¦<font color="blue"><strong>ç»„ç»‡ç›¸å®¹æ€§å¤åˆä½“ï¼ˆMHCï¼‰å˜å¼‚</strong></font>ï¼ŒæŸ“è‰²ä½“<font color="blue"><strong>å«æ˜ŸåŒºåŸŸ</strong></font>å’Œ<font color="blue"><strong>ç‰‡æ®µé‡å¤</strong></font>çš„æ£€æµ‹èƒ½åŠ›ã€‚</p>
<h2 id="åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡"><a href="#åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡" class="headerlink" title="åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡"></a><strong>åŸºå› ç»„è¿ç»­æ€§å’Œå‡†ç¡®æ€§æå‡</strong></h2><p>30X HiFi Readsé€šè¿‡HiCanuå°†äººCHM13ç»†èƒç³»çš„åŸºå› ç»„ç»„è£…çš„<strong>Contig N50</strong> æå‡è‡³<strong>77M</strong>ï¼Œå•ç¢±åŸºå‡†ç¡®æ€§è¶…è¿‡99.999%ï¼ˆQ50ï¼‰ï¼åœ¨ç»„è£…çš„å‡†ç¡®æ€§è¿ç»­æ€§ä¸¤ä¸ªæ–¹é¢ï¼ŒHiFi Readsçš„ç»„è£…ç»“æœéƒ½è¶…è¿‡äº†æœ€æ–° é«˜è¦†ç›–åº¦ è¶…é•¿ ç‰›æ´¥ çº³ç±³å­”æµ‹åº çš„ç»“æœã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/3.png" alt="3.png"></p>
<p>ä½¿ç”¨PacBio HiFiå’ŒUltra-Long (Oxford Nanoproe) ç»„è£…äººCHM13åŸºå› ç»„ç»“æœå¯¹æ¯”ï¼Œéƒ½<strong>æœªç»çŸ­è¯»é•¿æµ‹åºæ•°æ®polish</strong>ã€‚Peregrine, Canuå’ŒHiCanuæ˜¯ä¸åŒçš„ç»„è£…å·¥å…·ã€‚</p>
<h2 id="åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡-åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°"><a href="#åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡-åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°" class="headerlink" title="åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡[åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°]"></a><strong>åŸºå› ç»„å•å€å‹æ£€æµ‹çš„æå‡</strong>[åšæ­¤å›¾ç±»ä¼¼è¯„ä¼°]</h2><p>ç»„è£…å¤šå€ä½“æ—¶ï¼Œç»„è£…è½¯ä»¶è¦èƒ½åŒºåˆ†<font color="blue"><strong>ä¸åŒç­‰ä½åŸºå› </strong></font>ï¼Œå¹¶å°†å®ƒä»¬<font color="blue"><strong>ä¿å­˜ä¸ºä¸åŒçš„åºåˆ—</strong></font>ï¼Œä»¥<font color="blue"><strong>ä¸»è¦Contig</strong>å’Œ<strong>æ›¿ä»£Contig</strong>æ¨¡å¼</font>è¡¨ç¤ºã€‚å¯¹äº<font color="blue">åŒå€ä½“äºº</font>åŸºå› ç»„ç»„è£…ï¼ŒHiCanuç»„è£…ç»“æœ<font color="blue">åŒ…å«<strong>è¶…è¿‡2 Gbp</strong>çš„<strong>æ›¿ä»£Contig</strong></font>ï¼Œè€Œ<font color="blue">å…¶å®ƒç»„è£…è½¯ä»¶</font>åªèƒ½äº§ç”Ÿ<font color="blue">ä¸åˆ°400 Mbpçš„æ›¿ä»£Contig [hifiasmå¦‚ä½•?]</font>ã€‚è¯´æ˜<font color="blue">HiCanu</font>ç»“åˆHiFi Readså…·æœ‰<font color="blue">æ›´å¼ºçš„<strong>åŒºåˆ†å•å€å‹èƒ½åŠ›</strong></font>ã€‚å¦‚ä¸‹å›¾ï¼ŒHiCanuç»„è£…çš„<font color="red">ä¸»è¦Contigå’Œæ›¿ä»£Contig<strong>éƒ½</strong></font>å…·æœ‰<font color="red">è¾ƒé«˜çš„<strong>BUSCOå®Œæ•´æ€§</strong></font>ï¼ˆåˆ†åˆ«**&gt; 94ï¼…<strong>å’Œ</strong>&gt; 75ï¼…<strong>ï¼‰ï¼Œè€Œé‡‡ç”¨ <strong>è¶…é•¿ ç‰›æ´¥çº³ç±³å­”æµ‹åº</strong>çš„BUSCOå®Œæ•´æ€§åˆ†åˆ«åªæœ‰</strong>63%<strong>å’Œ</strong>0.3%**ã€‚å¹¶ä¸”HiCanu + HiFi Readsçš„<font color="red"><strong>Phase Block NG50?</strong></font>æ˜¯é«˜è¦†ç›–åº¦è¶…é•¿ç‰›æ´¥çº³ç±³å­”æµ‹åºçš„2.5å€ï¼</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/4.png" alt="4"></p>
<p>HiCanuä¸å…¶å®ƒç»„è£…è½¯ä»¶ <strong>ç»„è£… åŒå€ä½“åŸºå› ç»„ ç»“æœå¯¹æ¯”</strong>ï¼Œå…¶ä¸­HG00733çš„Haplotype asm hap1(hap2)aå’ŒHG002çš„Haplotype asm hap1(hap2)b çš„æ•°æ®æ˜¯<font color="red"><strong>HiFiç»“åˆHi-Cçš„ç»„è£…ç»“æœ</strong></font>ã€‚</p>
<p>ä¸ºäº†<font color="red">è¯„ä¼°</font>ä¸åŒç»„è£…å·¥å…·å¯¹<strong>éš¾ä»¥æ£€æµ‹</strong>çš„<font color="red"><strong>å¤æ‚ä¸´åºŠç›¸å…³ç­‰ä½åŸºå› åˆ†å‹ç»“æœ</strong></font>ï¼Œé€šè¿‡HiCanu+ HiFi å¾—åˆ°çš„å…­ä¸ªç»å…¸çš„<font color="blue">äººç±»ç™½ç»†èƒæŠ—åŸï¼ˆHLAï¼‰åŸºå› </font>çš„<font color="blue">è£…é…åˆ†å‹ç»“æœ</font>ä¸ä¹‹å‰é€šè¿‡<strong>å¤šç§æ£€æµ‹æ–¹æ³•</strong>è·å¾—çš„<strong>å·²çŸ¥HG002å’ŒHG00733ç­‰ä½åŸºå› </strong>è¿›è¡Œæ¯”è¾ƒã€‚<font color="red">åªæœ‰HiCanuå’ŒTrioCanuèƒ½å¤Ÿ<strong>æ¢å¤</strong>å…·æœ‰<strong>100ï¼…åºåˆ—åŒä¸€æ€§</strong>çš„<strong>æ‰€æœ‰ç­‰ä½åŸºå› </strong></font>ã€‚è¿™ä¹Ÿä½“ç°HiCanu+ HiFiå¯¹äºæ½œåœ¨çš„å¤æ‚ä¸´åºŠç›¸å…³åŸºå› çš„ç²¾ç¡®æ£€æµ‹èƒ½åŠ›ã€‚</p>
<h2 id="åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—"><a href="#åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—" class="headerlink" title="åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—"></a><strong>åº”å¯¹å¤æ‚ç‰‡æ®µé‡å¤åºåˆ—</strong></h2><p>ä¸ºäº†è¯„ä¼°å¯¹<font color="red"><strong>ç‰‡æ®µé‡å¤ï¼ˆSDï¼Œsegmental duplicationsï¼‰</strong>åºåˆ—çš„ç»„è£…èƒ½åŠ›</font>ï¼Œä½¿ç”¨äº†BACæ–‡åº“æŒ‘æˆ˜ã€‚è¢«<strong>é€‰æ‹©</strong>çš„<strong>BACæ–‡åº“åºåˆ—åŒ…å«å¤§é‡ç‰‡æ®µé‡å¤åºåˆ—</strong>ï¼Œè€Œç‰‡æ®µé‡å¤åŒºåŸŸæ˜¯åŸºå› ç»„<font color="blue"><strong>æœ€éš¾ç»„è£…åŒºåŸŸä¹‹ä¸€</strong></font>ã€‚ç»è¿‡åˆæ­¥æ¯”å¯¹ï¼ŒHiCanu+ HiFiåœ¨æ‰€æœ‰ç»„è£…æ–¹æ¡ˆä¸­<font color="red">è§£ææœ€å¤šçš„BAC</font>ï¼Œå¹¶ä¸”å®ç°<font color="red">æœ€é«˜çš„BACå¯¹æ¯”è´¨é‡</font>ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/5.png" alt="ä¸åŒæµ‹åºæ•°æ®ä¸ç»„è£…å·¥å…·åœ¨BACæ–‡åº“æŒ‘æˆ˜ä¸­çš„ç»“æœ"></p>
<p>ä¸åŒæµ‹åºæ•°æ®ä¸ç»„è£…å·¥å…·åœ¨BACæ–‡åº“æŒ‘æˆ˜ä¸­çš„ç»“æœ</p>
<p>é’ˆå¯¹<font color="blue">CHM13ä¸­<strong>æœªèƒ½</strong>æˆåŠŸè§£æçš„BACæ·±å…¥ç ”ç©¶</font>ï¼Œå‘ç°å…¶ä¸­ã€11ä¸ªBACæœ¬èº«å¯èƒ½åŒ…å«ç»„è£…é”™è¯¯æˆ–å…‹éš†ä¼ªåƒ?ã€‘ã€‚æ‰‹åŠ¨æ£€æŸ¥11ä¸ªBACçš„HiFiç»„è£…ç»“æœï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾ç»„è£…é”™è¯¯ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚è¿™è¡¨æ˜HiCanu+ HiFi å®é™…ä¸ŠæˆåŠŸè§£æCHM13 341ä¸ªBACä¸­çš„<strong>337ä¸ª</strong>ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/6.png" alt="1585618676593848.png"></p>
<p>äººå·¥æ£€æŸ¥å¯èƒ½æœ¬èº«å­˜åœ¨é”™è¯¯çš„BAC</p>
<h2 id="äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£…-how"><a href="#äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£…-how" class="headerlink" title="äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£… [how?]"></a>äººç±»æŸ“è‰²ä½“ç€ä¸ç²’çš„ç»„è£… [how?]</h2><p>ä½¿ç”¨HiCanu+HiFi æˆåŠŸç”ŸæˆåŒ…æ‹¬CHM13 <font color="blue"><strong>19å·æŸ“è‰²ä½“ç€ä¸ç²’åœ¨å†…</strong></font>çš„<font color="blue"><strong>å…±9ä¸ªäººç±»æŸ“è‰²ä½“ç€ä¸ç²’è£…é…å›¾</strong></font>ã€‚CHM13 <font color="red"><strong>19å·æŸ“è‰²ä½“ç€ä¸ç²’åŒºåŸŸè¢«è®¤ä¸ºæ˜¯æœ€éš¾ç»„è£…çš„ç€ä¸ç²’ä¹‹ä¸€</strong></font>ï¼Œå› ä¸ºå®ƒ<font color="red"><strong>ç”±å¤šä¸ªHORï¼ˆHigher Order Repeatï¼‰åŒºåŸŸç»„æˆ</strong></font>å¹¶<font color="red"><strong>ä¸1å·å’Œ5å·æŸ“è‰²ä½“çš„ç€ä¸ç²’åŒºåŸŸå…±äº«Î±å«æ˜Ÿåºåˆ—</strong></font>ã€‚</p>
<p>HiCanu+HiFi ä¸ä»…èƒ½<font color="red">ç»„è£…<strong>è¦†ç›–æ•´ä¸ªç€ä¸ç²’</strong>çš„contig<strong>ç¾¤</strong></font>ï¼Œè€Œä¸”å¯ä»¥<font color="red">å‡†ç¡®<strong>åŒºåˆ†</strong>ä¸‰ä¸ª<strong>ä¸åŒçš„HORåŒºåŸŸ???</strong></font>ï¼š<strong>D19Z1ï¼ŒD19Z2å’ŒD19Z3</strong>ã€‚åœ¨ä¹‹å‰çš„<font color="red"><strong>XæŸ“è‰²ä½“T2Tç ”ç©¶</strong>ä¸­</font>ï¼Œä¸ºäº†è¾¾åˆ°å¦‚æ­¤å®Œæ•´çš„äººç±»æŸ“è‰²ä½“<strong>ç€ä¸ç²’ç»„è£…</strong>ç»“æœï¼Œéœ€è¦<font color="blue">ä½¿ç”¨åŒ…æ‹¬<strong>é«˜æ·±åº¦è¶…é•¿çº³ç±³å­”æµ‹åº</strong>ï¼Œ<strong>60X PacBio CLR</strong>æµ‹åºå’Œ<strong>illuminaçŸ­è¯»é•¿</strong>æµ‹åºçš„æ•°æ®<strong>å…±åŒ</strong>ç»„è£…</font>æ‰èƒ½è¾¾åˆ°è¿™æ ·çš„æ•ˆæœã€‚è€Œç°åœ¨<font color="blue">ä»…ä½¿ç”¨<strong>ä¸€ç§</strong>æµ‹åºæŠ€æœ¯</font>ï¼Œå³<strong>HiFi ç»“åˆHiCanu</strong>å°±èƒ½<strong>è§£æ</strong>äººç±»æŸ“è‰²ä½“<strong>ç€ä¸ç²’</strong>ç»“æ„ã€‚</p>
<p><img src="/blog/2022/03/02/2022-03-02-HiFi-3-software/7.png" alt="1585618881806532.png"></p>
<p>CHM13 19å·æŸ“è‰²ä½“<font color="blue"><strong>ç€ä¸ç²’çš„HiCanuè£…é…</strong></font>ã€‚tig00006497çš„<font color="red"><strong>RepeatMasker</strong>æ­ç¤ºäº†ä½äº<strong>19å·ç€ä¸ç²’</strong>ï¼ˆD19Z1ï¼ŒD19Z2Î±å’ŒD19Z3ï¼›æ ‡æœ‰é»‘æ¡ï¼‰ä¸­çš„<strong>ä¸‰ä¸ªÎ±å«æ˜ŸHORåŒºåŸŸ</strong></font>ã€‚è¿™äº›<strong>HORåºåˆ—é•¿åº¦</strong>åˆ†åˆ«ä¸º<strong>606 kbpï¼Œ289 kbpå’Œ3.96 Mbp</strong>ï¼Œåˆ†åˆ«ç”±<strong>13-mer</strong>ï¼Œå¤æ‚çš„<strong>é«˜é˜¶HOR</strong>å’Œ<strong>äºŒèšä½“HORå•å…ƒ</strong>ç»„æˆ?</p>
<h2 id="æ€»ç»“ä¸å±•æœ›"><a href="#æ€»ç»“ä¸å±•æœ›" class="headerlink" title="æ€»ç»“ä¸å±•æœ›"></a><strong>æ€»ç»“ä¸å±•æœ›</strong></h2><p>é€šè¿‡æœ¬ç ”ç©¶ï¼Œè¯æ˜<font color="blue">HiFi ç»“åˆHiCanu</font>èƒ½å¤Ÿç”Ÿæˆè¿„ä»Šä¸ºæ­¢<font color="blue">æœ€å‡†ç¡®ï¼Œæœ€å®Œæ•´</font>çš„äººç±»åŸºå› ç»„<font color="blue">è£…é…ä½“</font>ã€‚å…¶ä»–åº”ç”¨ï¼Œä¾‹å¦‚åŒæ ·éœ€è¦é«˜ç²¾åº¦Readsçš„<strong>å®åŸºå› ç»„ç»„è£…</strong>ã€‚<font color="red">HiFiæ“…é•¿è§£å†³<strong>å¤§å‹é«˜åº¦ç›¸ä¼¼</strong>ï¼ˆä½†<strong>ä¸å®Œå…¨ç›¸åŒ</strong>ï¼‰çš„<strong>é‡å¤åºåˆ—</strong></font>ã€‚HiCanu+HiFi å¯¹äººç±»<strong>1å·ï¼Œ7å·ï¼Œ9å·å’Œ16å·</strong>æŸ“è‰²ä½“çš„é‡å»º<strong>æ˜¾è‘—æ”¹å–„</strong>å…ˆå‰<strong>è¶…é•¿çº³ç±³å­”æµ‹åºçš„ç»„è£…è¿ç»­æ€§</strong>ã€‚è¿™äº›æŸ“è‰²ä½“åŒ…å«<font color="blue">å¤šä¸ªé•¿åº¦è¶…è¿‡<strong>200 kbpçš„ç‰‡æ®µé‡å¤</strong></font>ï¼Œéœ€è¦ <font color="blue">HiFi æ‰èƒ½<strong>è¯†åˆ«</strong>å˜å¼‚å¹¶<strong>åˆ†ç¦»</strong>å‡º<strong>å•ä¸ªæ‹·è´</strong></font>ã€‚ä½¿ç”¨ <strong>HiFi <font color="red">ç‹¬ç«‹å®Œæˆ</font><strong>äººç±»æŸ“è‰²ä½“</strong>ä¹ä¸ªç€ä¸ç²’åŒºåŸŸ</strong>çš„è£…é…è‰å›¾ï¼Œè¿™ä¹Ÿæ˜¯T2Té¡¹ç›®çš„æœ€éš¾æŒ‘æˆ˜ä¹‹ä¸€ã€‚</p>
<p><font color="blue">HiFi çš„é•¿åº¦</font>å¯¹ç»„è£…ç»“æœæœ‰å¾ˆå¤§å½±å“ï¼Œç›®å‰æœ€æ–°HiFi Readså·²ç»è¾¾åˆ°25kã€‚HiCanuåœ¨äºšé©¬é€Š<strong>äº‘å¹³å°</strong>ä¸Šç»„è£…ä¸€ä¸ª<strong>äºº</strong>ç±»åŸºå› ç»„åªéœ€è¦<strong>22å°æ—¶</strong>ï¼Œè¿™è¿˜<strong>ä¸æ˜¯ç›®å‰æœ€å¿«</strong>çš„é’ˆå¯¹ HiFiæ•°æ®çš„ç»„è£…è½¯ä»¶ï¼Œæœ€å¿«çš„è½¯ä»¶åªéœ€è¦<strong>2å°æ—¶</strong>ã€‚ç›¸ä¿¡æœªæ¥éšç€HiFi Readsçš„é•¿åº¦ä¸æ–­æé«˜ï¼Œä»¥åŠæ›´å¤šé’ˆå¯¹PacBio HiFi Readsä¼˜åŒ–çš„ç»„è£…è½¯ä»¶å‡ºç°ï¼ŒåŸºå› ç»„çš„ä»å¤´ç»„è£…ä¼š<strong>æ›´å¿«æ›´å‡†</strong>ã€‚</p>
<h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      <categories>
        <category>Software</category>
      </categories>
      <tags>
        <tag>denovo-III</tag>
      </tags>
  </entry>
  <entry>
    <title>Sequencing data and fastq.gz</title>
    <url>/blog/2022/03/01/2022-03-01-sequencing-data/</url>
    <content><![CDATA[<h1 id="fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»"><a href="#fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»" class="headerlink" title="fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»"></a>fastqå‹ç¼©ä¹‹gzipæ–‡ä»¶å¤§å°ä¸æ ·æœ¬æ•°æ®é‡å…³ç³»</h1><span id="more"></span>

<p>ref : <a href="https://www.zxzyl.com/archives/1011">https://www.zxzyl.com/archives/1011</a></p>
<p>æµ‹åºæ—¶ï¼Œå…ˆæ‹¿åˆ°çš„æ˜¯æ ·æœ¬fastqå‹ç¼©åçš„gzæ–‡ä»¶ï¼Œè‹¥å…³å¿ƒæ•°æ®é‡å¤Ÿä¸å¤Ÿï¼Œåˆ™éœ€è®¡ç®—fastq.gzæ–‡ä»¶å¤§å°å’Œæµ‹åºæ•°æ®é‡çš„å…³ç³»ã€‚</p>
<p>ç”¨Miseqæµ‹åºæ•°æ®ï¼ˆgzæ–‡ä»¶200Mï¼‰ï¼ŒHiseq panelï¼ˆgzæ–‡ä»¶50Mï¼‰å’ŒWESæµ‹åºæ•°æ®ï¼ˆgzæ–‡ä»¶4Gï¼‰è¿›è¡Œç®€å•åˆ†æã€‚å‘ç°ï¼Œ<font color="green"><strong>è™½ç„¶R1å’ŒR2æ•°æ®é‡æ˜¯ä¸€æ ·ï¼Œè§£å‹å‡ºæ¥çš„æ–‡ä»¶å¤§å°ä¸€æ ·ï¼Œä½†R2çš„gzipæ–‡ä»¶æ€»æ¯”R1å¤§</strong></font>ã€‚ä¸ç®¡æ˜¯Miseqè¿˜æ˜¯Hiseqçš„panelæµ‹åºï¼Œå‹ç¼©åçš„R2å‡å¤§äºR1æ–‡ä»¶ï¼Œä¸”æ–‡ä»¶è¶Šå°ï¼Œå·®å¼‚è¶Šå¤§ã€‚</p>
<p>å› R1å’ŒR2æ•°æ®é‡ç›¸åŒï¼Œåªçœ‹R1çš„çœŸå®æ–‡ä»¶å’Œgzæ–‡ä»¶å¤§å°ä¸æ•°æ®é‡ä¹‹é—´çš„å…³ç³»ã€‚<br><font color="green"><strong>æ•°æ®é‡</strong></font>=FASTQæ–‡ä»¶è¡Œæ•°/4x<font color="green"><strong>151</strong></font>/1000/<font color="green"><strong>1000</strong></font> å•ä½ä¸º<strong>M</strong><br><font color="green"><strong>çœŸå®æ–‡ä»¶å¤§å°ä¼°è®¡</strong></font>=FASTQæ–‡ä»¶è¡Œæ•°/4x<font color="green"><strong>357</strong></font>/1024/<font color="green"><strong>1024</strong></font> å•ä½ä¸º<strong>M</strong>ï¼Œé¢„æµ‹å€¼ï¼Œå·®åˆ«ä¸å¤§ï¼Œ<strong>å› ä¸ºFASTQæ–‡ä»¶ä¸­æ¯å››è¡Œ357ä¸ªå­—ç¬¦</strong>ï¼ˆå’Œå¹³å°å’Œè®¾ç½®æœ‰å…³ç³»ï¼‰ï¼Œæ¯ä¸ªå­—ç¬¦1byteã€‚</p>
<p>GZæ–‡ä»¶å¤§å°é€šè¿‡ll -hæŸ¥çœ‹</p>
<p>å› ä¸ºFASTQæ–‡ä»¶æ˜¯<strong>è§„èŒƒ</strong>çš„ï¼Œ<strong>æ¯å››è¡Œå­—ç¬¦åŸºæœ¬ä¸€è‡´</strong>ï¼Œæ‰€ä»¥<font color="green"><strong>FASTQçœŸå®æ–‡ä»¶å¤§å°å’Œæ•°æ®é‡æˆæ­£æ¯”</strong></font>ã€‚<strong>å‰é¢æåˆ°æ¯å››è¡Œæœ‰357ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­åºåˆ—åªå 151ä¸ªå­—ç¬¦ï¼ŒFASTQæ–‡ä»¶å¤§å°å¤§æ¦‚æ˜¯æµ‹åºé‡çš„357/151â‰ˆ2.3å€å¤š</strong>ã€‚ä½†å› FASTQæ–‡ä»¶ä¸ºæ–‡æœ¬æ–‡ä»¶ï¼Œå ç”¨ç©ºé—´è¾ƒå¤§ï¼Œæ‰€ä»¥ä¸€èˆ¬å°†FASTQæ–‡ä»¶å‹ç¼©æˆgzã€‚</p>
<p>ç”¨gzæ–‡ä»¶å¤§å°é™¤ä»¥ä¼°è®¡çš„çœŸå®æ–‡ä»¶å¤§å°ï¼Œå¾—åˆ°å‹ç¼©æ¯”ï¼Œå‘ç°å‹ç¼©æ¯”å’Œæµ‹åºå¹³å°æœ‰å…³ç³»ï¼Œ<font color="green"><strong>Miseq</strong>çš„å‹ç¼©æ¯”åœ¨<strong>0.35</strong>å·¦å³ï¼Œ<strong>Hiseq</strong>å¹³å°ä¸­çš„panelæµ‹åºåœ¨<strong>0.24</strong>å·¦å³ï¼Œ<strong>WES</strong>åœ¨<strong>0.2</strong>å·¦å³</font>ã€‚å¯ä»¥å‘ç°WESçš„æ•°æ®çš„å‹ç¼©æ•ˆç‡æœ€é«˜ï¼ŒçŒœæµ‹ä¸åŒå¹³å°åœ¨å‹ç¼©è¿‡ç¨‹ä¸­è®¾ç½®çš„å‹ç¼©æ¯”ä¾‹ä¸åŒã€‚Hiseqæµ‹åºå¹³å°çš„gzæ–‡ä»¶å‹ç¼©æ€§èƒ½å¤§äºMiseqå¹³å°ã€‚</p>
<ul>
<li><p>ä»¥Miseqçš„gzipæ–‡ä»¶å¤§å°å’Œæ•°æ®é‡<strong>ä½œå›¾</strong>ï¼Œå¯ä»¥å¾ˆç›´è§‚çš„å‘ç°gzæ–‡ä»¶å¤§å°å’Œæ•°æ®é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚æ–œç‡æ˜¯1.245ï¼Œæˆªè·å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå› ä¸ºçºµåæ ‡å¾ˆå¤§ã€‚ä¹Ÿå°±æ˜¯è¯´R1æ–‡ä»¶çš„æ•°æ®é‡çº¦ç­‰äºgzipæ–‡ä»¶çš„1.245å€ã€‚</p>
</li>
<li><p><strong>ä»å¦å¤–ä¸€ä¸ªè§’åº¦è®¡ç®—</strong>ï¼Œ<font color="green"><strong>R1æ–‡ä»¶æ•°æ®é‡=gzipæ–‡ä»¶å¤§å°/å‹ç¼©æ•ˆç‡/2.3</strong></font>ï¼Œåˆ™å› ä¸ºMiseqçš„å‹ç¼©æ•ˆç‡åœ¨0.35ï¼ŒHiseqåœ¨0.23å·¦å³ï¼Œæ‰€ä»¥Miseq R1æ–‡ä»¶çš„æ•°æ®é‡å¤§æ¦‚æ˜¯gzipæ–‡ä»¶çš„<font color="green">1.242å€ï¼ˆ1/0.35/2.3ï¼‰</font>ï¼Œå’Œä¸Šå›¾æ‹Ÿåˆçš„ç»“æœå¾ˆç›¸è¿‘ï¼Œ<strong>Hiseqçº¦åœ¨1.89(1/0.23/2.3)å€</strong>ã€‚çœŸå®çš„æ•°æ®é‡å…¶å®æ˜¯R1æ–‡ä»¶æ•°æ®é‡çš„2å€ï¼ˆR2æ–‡ä»¶ä¸­çš„æ•°æ®é‡å’ŒR1æ–‡ä»¶ç›¸åŒï¼‰ã€‚</p>
</li>
</ul>
<p><strong>ç»“è®ºï¼š</strong>ä¸åŒå¹³å°å’Œä¸åŒæµ‹åºæ–¹æ³•ä¹‹é—´çš„<font color="green">fastqæ–‡ä»¶å‹ç¼©æ¯”ä¾‹å¹¶ä¸ä¸€è‡´</font>ï¼Œä½†åŒä¸€ç§æ–¹æ³•å’Œå¹³å°å†…çš„å‹ç¼©æ¯”ä¾‹æ˜¯ç›¸è¿‘çš„ï¼Œå› è€Œå¯ä»¥æ ¹æ®gzipæ–‡ä»¶çš„å¤§å°æ¨æµ‹å‡ºæµ‹åºçš„æ•°æ®é‡ã€‚</p>
<p><strong>Miseqçš„æµ‹åºé‡çº¦æ˜¯R1 gzipæ–‡ä»¶å¤§å°çš„2.49å€(R1+R2)ï¼ŒHiseqçš„æµ‹åºé‡çº¦æ˜¯R1 gzipæ–‡ä»¶å¤§å°çš„3.78å€ã€‚</strong>ä¸åŒå¹³å°å’Œæ–¹æ³•ä¹‹é—´ï¼Œè¿™ä¸ªå€¼æ˜¯ä¸å›ºå®šçš„ï¼Œå¯ä»¥æ ¹æ®æ‰‹å¤´çš„æ•°æ®è®¡ç®—ä¸€ä¸‹è¿™ä¸ªæ¯”ä¾‹ï¼Œå°±èƒ½è¿…é€Ÿçš„ä¼°ç®—å‡ºæ ·æœ¬çš„æ•°æ®é‡ã€‚</p>
]]></content>
      <categories>
        <category>assemble</category>
      </categories>
      <tags>
        <tag>fastq</tag>
      </tags>
  </entry>
  <entry>
    <title>Genome assemble pipeline</title>
    <url>/blog/2022/02/28/2022-02-28-genome-assemble/</url>
    <content><![CDATA[<p>Genome assemble pipeline</p>
<span id="more"></span>

<blockquote>
<p>å†…å®¹å‡æ¥è‡ªè²æ²™åŸºå› ï¼ˆ<a href="https://links.jianshu.com/go?to=http://www.frasergen.com/">Frasergen</a>ï¼‰æš‘æœŸç”Ÿä¿¡åŸ¹è®­ç­è¯¾å ‚ç¬”è®°</p>
<p><a href="https://www.jianshu.com/p/c7663d2cf337">https://www.jianshu.com/p/c7663d2cf337</a></p>
</blockquote>
<h2 id="Genome-de-nove-åŸºç¡€çŸ¥è¯†"><a href="#Genome-de-nove-åŸºç¡€çŸ¥è¯†" class="headerlink" title="Genome de nove åŸºç¡€çŸ¥è¯†"></a>Genome <em>de nove</em> åŸºç¡€çŸ¥è¯†</h2><ul>
<li>åŸºå› ç»„æ˜¯ç‰©ç§æ‰€å«æœ‰çš„ä¸€å¥—é—ä¼ ç‰©è´¨(å•å€ä½“ç»†èƒæ ¸ã€ç»†èƒå™¨æ‰€å«çš„å…¨éƒ¨DNAåˆ†å­) , åŒ…æ‹¬å…¨å¥—åŸºå› å’Œé—´éš”åºåˆ—</li>
<li>åŸºå› ç»„=ç‰©ç§æ‰€æ‹¥æœ‰çš„ä¸€å¥—å®Œæ•´å•å€ä½“åºåˆ—</li>
<li>åˆ©ç”¨æµ‹åºæŠ€æœ¯å¯¹ç‰©ç§ä½“å†…æ‰€æœ‰DNAåˆ†å­è¿›è¡Œæµ‹åº,è·å–ç¢±åŸºç»„æˆ,æ˜ç¡®åŸºå› ç»“æ„ä¿¡æ¯,å¤–æ˜¾å­åŠå†…å«å­åŒºåŸŸã€å¯åŠ¨å­ä½ç½®,ä»¥åŠåŸºå› çš„æ’åˆ—é¡ºåºåŠåŠŸèƒ½</li>
<li>åŸºå› ç»„<em>de nove</em>,åˆç§°åŸºå› ç»„ä»å¤´æµ‹åº,æ˜¯æŒ‡å¯¹åŸºå› ç»„åºåˆ—æœªçŸ¥(æˆ–ä»…æœ‰åŸºå› ç»„è‰å›¾)çš„ç‰©ç§è¿›è¡Œå…¨åŸºå› ç»„æµ‹åº,ç„¶åè¿›è¡Œæ‹¼è£…,ä»è€Œå¾—åˆ°è¯¥ç‰©ç§çš„å…¨åŸºå› ç»„åºåˆ—,ä¸ºåç»­åŠŸèƒ½åŸºå› æŒ–æ˜ã€è°ƒæ§ä»£è°¢ç½‘ç»œæ„å»ºã€ç‰©ç§è¿›åŒ–åˆ†æç­‰å¥ å®šåŸºç¡€ã€‚</li>
</ul>
<h2 id="æ„å»ºå‚è€ƒåŸºå› ç»„pipeline"><a href="#æ„å»ºå‚è€ƒåŸºå› ç»„pipeline" class="headerlink" title="æ„å»ºå‚è€ƒåŸºå› ç»„pipeline"></a>æ„å»ºå‚è€ƒåŸºå› ç»„pipeline</h2><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/1.png" alt="1"></p>
<h3 id="åŸºå› ç»„Surveyåˆ†æ"><a href="#åŸºå› ç»„Surveyåˆ†æ" class="headerlink" title="åŸºå› ç»„Surveyåˆ†æ"></a>åŸºå› ç»„Surveyåˆ†æ</h3><ul>
<li><p>åŸºå› ç»„SurveyåŸºäºå°ç‰‡æ®µæ–‡åº“çš„ä½æ·±åº¦æµ‹åºæ•°æ®( 50X-100X ) ;</p>
</li>
<li><p>é€šè¿‡K-meråˆ†æ ,æœ‰æ•ˆçš„<strong>è¯„ä¼°åŸºå› ç»„å¤§å°ã€GCå«é‡ã€æ‚åˆåº¦ä»¥åŠé‡å¤åºåˆ—çš„å«é‡ç­‰ä¿¡æ¯</strong>;</p>
</li>
<li><p>æ˜¯å…¨é¢äº†è§£æŸä¸€ç‰©ç§åŸºå› ç»„ç‰¹å¾çš„æœ‰æ•ˆæ–¹æ³•;</p>
</li>
<li><p>ä¸ºåç»­çš„å…¨åŸºå› ç»„ <em>de novo</em> æµ‹åºçš„ç»„è£…ç­–ç•¥çš„åˆ¶å®šæä¾›ç†è®ºä¾æ®ã€‚</p>
</li>
</ul>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/2.png" alt="2"></p>
<h4 id="è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°"><a href="#è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°" class="headerlink" title="è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°"></a>è¡¥å……çŸ¥è¯†1ï¼šåŸºå› ç»„å¤æ‚åº¦è¯„ä¼°</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/3.png" alt="3"></p>
<h4 id="è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹"><a href="#è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹" class="headerlink" title="è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹"></a>è¡¥å……çŸ¥è¯†2ï¼šæ ¹æ®kmer-å›¾ç¡®è®¤ç‰©ç§å€å‹</h4><blockquote>
<p>äºŒå€ä½“ï¼šæ‚åˆå³°ï¼šä¸»å³°ï¼šé‡å¤å³°=1ï¼š2ï¼š4ï¼ˆxï¼‰</p>
</blockquote>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/4.png" alt="4"></p>
<blockquote>
<p>ä¸‰å€ä½“ï¼šæ­£å¸¸æƒ…å†µä¸‹æ‚åˆå³°ï¼šä¸»å³°ï¼šé‡å¤å³° = 1:2:3ï¼ˆå·¦å›¾ï¼‰ã€‚ä¸»å³°å’Œé‡å¤å³°æ·±åº¦ä½åˆ™å¯èƒ½é‡å åœ¨ä¸€èµ·ï¼šæ‚åˆå³°ï¼šä¸»å³°ï¼šé‡å¤å³° = 1:2ï¼ˆå³å›¾ï¼‰</p>
</blockquote>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/5.png" alt="5"></p>
<blockquote>
<p><strong>å¼‚æºå››å€ä½“</strong>ï¼š2ä¸ªå³°ï¼Œå‘ˆç°1:2çš„å…³ç³»</p>
</blockquote>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/6.png" alt="6"></p>
<blockquote>
<p><strong>åŒæºå››å€ä½“</strong>ï¼šåŒæºå››å€ä½“çš„å³°å°±æ˜¯1 : 2 : 3 : 4 ,å…¶ä¸­3å’Œ4ç»å¸¸é‡å åœ¨ä¸€èµ·</p>
</blockquote>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/7.png" alt="7"></p>
<h4 id="è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿"><a href="#è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿" class="headerlink" title="è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿"></a>è¡¥å……çŸ¥è¯†3ï¼šSurveyä¼˜åŠ¿</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/8.png" alt="8"></p>
<h3 id="åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š"><a href="#åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š" class="headerlink" title="åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š"></a>åŸºå› ç»„ç»„è£…ä¸æ³¨é‡Š</h3><ul>
<li><strong>Contig</strong>ï¼šä½¿ç”¨çŸ­readsä¹‹é—´çš„overlapå…³ç³»æ‹¼æ¥æ‰€å¾—çš„æ— GAPåºåˆ—ç‰‡æ®µ</li>
<li><strong>Scaffold</strong>ï¼šé€šè¿‡å¤§ç‰‡æ®µæ–‡åº“å°†Contigè¿›-æ­¥è¿æ¥æ‰€å¾—çš„é•¿åºåˆ—ç‰‡æ®µï¼Œå„ä¸ªContigä¹‹é—´ç”¨â€Nâ€å¡«è¡¥</li>
</ul>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/9.png" alt="9"></p>
<ul>
<li><p>ç»„è£…è´¨é‡è¯„ä»·åŸºæœ¬æŒ‡æ ‡ï¼š<strong>ContigN50</strong>ä¸<strong>ScaffoldN50</strong></p>
</li>
<li><p>å°†ç»„è£…æ‰€å¾—åºåˆ—<strong>ä»å¤§åˆ°å°</strong>æ’åˆ—ï¼Œå¹¶ä¾æ¬¡ç›¸åŠ ï¼Œå½“<strong>ç´¯åŠ é•¿åº¦è¾¾åˆ°æ€»é•¿åº¦ä¸€åŠæ—¶ï¼Œæœ€åä¸€æ¡åºåˆ—çš„é•¿åº¦</strong>å³ä¸ºN50;N50è¶Šå¤§ï¼Œç»„è£…ç»“æœè¿ç»­æ€§è¶Šå¥½</p>
</li>
</ul>
<h4 id="ç»„è£…æµç¨‹"><a href="#ç»„è£…æµç¨‹" class="headerlink" title="ç»„è£…æµç¨‹"></a>ç»„è£…æµç¨‹</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/10.png" alt="10"></p>
<h4 id="ç»„è£…"><a href="#ç»„è£…" class="headerlink" title="ç»„è£…"></a>ç»„è£…</h4><p>å¸¸ç”¨è½¯ä»¶æœ‰**<a href="https://links.jianshu.com/go?to=https://canu.readthedocs.io/en/latest/">Canu</a>, <a href="https://links.jianshu.com/go?to=https://github.com/xiaochuanle/MECAT">MECAT</a>, <a href="https://links.jianshu.com/go?to=https://github.com/PacificBiosciences/pb-assembly">FALCON</a><strong>ã€‚ä»é¡¹ç›®å‘¨æœŸã€ç»„è£…ç»“æœã€èµ„æºæ¶ˆè€—ç­‰æ–¹é¢ç»¼åˆæ¥çœ‹,è²æ²™åŸºå› ï¼ˆ<a href="https://links.jianshu.com/go?to=http://www.frasergen.com/">Frasergen</a>ï¼‰é¦–é€‰</strong>Mecat 2**è¿›è¡ŒåŸºå› ç»„ç»„è£…ã€‚</p>
<p>####Hi-Cè¾…åŠ©ç»„è£…</p>
<p>Hi-Cæ•°æ®çš„ä¸€èˆ¬è§„å¾‹:<br>â¢ æŸ“è‰²ä½“å†…çš„äº’ä½œé«˜äºæŸ“è‰²ä½“é—´çš„äº’ä½œ<br>â¢ æŸ“è‰²ä½“å†…äº’ä½œå¼ºåº¦éšçº¿æ€§è·ç¦»å¢åŠ è€Œå‡å¼±</p>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/11.png" alt="11"></p>
<h4 id="ç»„è£…ç»“æœè¯„ä¼°"><a href="#ç»„è£…ç»“æœè¯„ä¼°" class="headerlink" title="ç»„è£…ç»“æœè¯„ä¼°"></a>ç»„è£…ç»“æœè¯„ä¼°</h4><p>æ•°æ®å›æ¯”ï¼šä¸ºäº†è¯„ä¼°ç»„è£…çš„å®Œæ•´æ€§å’Œæµ‹åºè¦†ç›–çš„å‡åŒ€æ€§,é€‰æ‹©CLR (Continuous Long Reads) subreads ,ä½¿ç”¨æ¯”å¯¹å·¥å…·Minimap2 ( v2.5é»˜è®¤å‚æ•°)æ¯”å¯¹å›ç»„è£…å¥½çš„åŸºå› ç»„,ç»Ÿè®¡readsçš„æ¯”å¯¹ç‡ã€è¦†ç›–åŸºå› ç»„çš„ç¨‹åº¦ä»¥åŠæ·±åº¦çš„åˆ†å¸ƒæƒ…å†µ,ç”±æ­¤è¯„ä¼°ç»„è£…çš„å®Œæ•´æ€§å’Œæµ‹åºè¦†ç›–çš„å‡åŒ€æ€§,ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>
<p>BUSCOè¯„ä¼°ï¼šåŸºäºOrthoDBä¸­çš„å•æ‹·è´åŒæºåŸºå› é›†,ä½¿ç”¨BUSCO ( V3.0.2 )é¢„æµ‹è¿™äº›åŸºå› å¹¶ç»Ÿè®¡å…¶å®Œæ•´åº¦,ç¢ç‰‡åŒ–ç¨‹åº¦åŠå¯èƒ½çš„ä¸¢å¤±ç‡ã€‚ç”±æ­¤è¯„ä¼°æ•´ä¸ªç»„è£…ç»“æœä¸­åŸºå› åŒºçš„å®Œæ•´æ€§(å¤§äº90%è¾ƒå¥½)ã€‚BUSCOè¯„ä¼°ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/12.png" alt="12"></p>
<h4 id="åŸºå› ç»“æ„æ³¨é‡Š"><a href="#åŸºå› ç»“æ„æ³¨é‡Š" class="headerlink" title="åŸºå› ç»“æ„æ³¨é‡Š"></a>åŸºå› ç»“æ„æ³¨é‡Š</h4><p>åŸºå› ç»“æ„é¢„æµ‹åŒ…æ‹¬é¢„æµ‹åŸºå› ç»„ä¸­çš„åŸºå› ä½ç‚¹ã€å¼€æ”¾æ€§é˜…è¯»æ¡†æ¶ï¼ˆORFï¼‰ã€ç¿»è¯‘èµ·å§‹ä½ç‚¹å’Œç»ˆæ­¢ä½ç‚¹ã€å†…å«å­å’Œå¤–æ˜¾å­åŒºåŸŸã€å¯åŠ¨å­å’Œç»ˆæ­¢å­ã€å¯å˜å‰ªåˆ‡ä½ç‚¹ä»¥åŠè›‹ç™½ç¼–ç åºåˆ—ï¼ˆCDSï¼‰ç­‰</p>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/13.png" alt="13"></p>
<h4 id="åŸºå› åŠŸèƒ½æ³¨é‡Š"><a href="#åŸºå› åŠŸèƒ½æ³¨é‡Š" class="headerlink" title="åŸºå› åŠŸèƒ½æ³¨é‡Š"></a>åŸºå› åŠŸèƒ½æ³¨é‡Š</h4><p>å…¨åŸºå› ç»„æµ‹åºå°†äº§ç”Ÿå¤§é‡æ•°æ®ï¼Œæ­¤å‰æ™®éé‡‡ç”¨æ¯”å¯¹æ–¹æ³•å¯¹å¯¹é¢„æµ‹å‡ºæ¥çš„<strong>ç¼–ç åŸºå› </strong>è¿›è¡ŒåŠŸèƒ½æ³¨é‡Šï¼Œé€šè¿‡ä¸å„ç§åŠŸèƒ½æ•°æ®åº“ï¼ˆNRã€Swiss-Prot ã€GOã€KOGã€KEGGï¼‰è¿›è¡Œè›‹ç™½è´¨æ¯”å¯¹ï¼Œè·å–è¯¥åŸºå› çš„åŠŸèƒ½ä¿¡æ¯ã€‚å…¶ä¸­GOå’ŒKEGGæ•°æ®åº“åˆ†åˆ«åœ¨åŸºå› åŠŸèƒ½å’Œä»£è°¢é€šè·¯ç ”ç©¶ä¸­å æ®é‡è¦åœ°ä½ã€‚</p>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/14.png" alt="14"></p>
<h4 id="éç¼–ç RNAæ³¨é‡Š"><a href="#éç¼–ç RNAæ³¨é‡Š" class="headerlink" title="éç¼–ç RNAæ³¨é‡Š"></a>éç¼–ç RNAæ³¨é‡Š</h4><p>éç¼–ç RNAï¼ˆncRNAï¼‰ï¼ŒæŒ‡ä¸ç¿»è¯‘æˆè›‹ç™½è´¨çš„RNAï¼Œå¦‚<br> miRNA(MicroRNA),<br> tRNA(è½¬è¿RNA)ï¼Œ<br> rRNA(æ ¸ç³–ä½“RNA),<br> snRNAï¼ˆå°æ ¸RNAï¼‰ç­‰ã€‚<br> åˆ©ç”¨tRNAscan-SEå¯¹å…¨åŸºå› ç»„è¿›è¡ŒtRNAé¢„æµ‹ï¼›åˆ©ç”¨RNAmmeré¢„æµ‹å…¨åŸºå› çš„rRNAï¼›åˆ©ç”¨Rfamæ•°æ®åº“é€šè¿‡cmscané‰´å®šå…¨åŸºå› ç»„éç¼–ç RNA</p>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/15.png" alt="15"></p>
<h4 id="é‡å¤åºåˆ—åˆ†æ"><a href="#é‡å¤åºåˆ—åˆ†æ" class="headerlink" title="é‡å¤åºåˆ—åˆ†æ"></a>é‡å¤åºåˆ—åˆ†æ</h4><p>é‡å¤åºåˆ—å¹¿æ³›å­˜åœ¨äºçœŸæ ¸ç”Ÿç‰©åŸºå› ç»„ä¸­ï¼Œè¿™äº›é‡å¤åºåˆ—æˆ–é›†ä¸­æˆç°‡ï¼Œæˆ–åˆ†æ•£åœ¨åŸºå› ä¹‹é—´ï¼Œæ ¹æ®åˆ†å¸ƒæŠŠé‡å¤åºåˆ—åˆ†ä¸ºåˆ†æ•£é‡å¤åºåˆ—ï¼ˆInterpersed repeatï¼‰å’Œä¸²è”é‡å¤åºåˆ—ï¼ˆTendam repeatï¼‰</p>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/16.png" alt="16"></p>
<h4 id="åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º"><a href="#åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º" class="headerlink" title="åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º"></a>åŸºå› ç»„åœˆå›¾ç»“æœå±•ç¤º</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/18.png" alt="18"></p>
<h3 id="æ¯”è¾ƒåŸºå› ç»„å­¦"><a href="#æ¯”è¾ƒåŸºå› ç»„å­¦" class="headerlink" title="æ¯”è¾ƒåŸºå› ç»„å­¦"></a>æ¯”è¾ƒåŸºå› ç»„å­¦</h3><ul>
<li><p>æ¯”è¾ƒåŸºå› ç»„å­¦æ˜¯ä»åŸºå› ç»„ä¸­è§£æç”Ÿç‰©å­¦æ„ä¹‰</p>
<p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/19.png" alt="19"></p>
</li>
</ul>
<h4 id="åŸºå› å®¶æ—èšç±»"><a href="#åŸºå› å®¶æ—èšç±»" class="headerlink" title="åŸºå› å®¶æ—èšç±»"></a>åŸºå› å®¶æ—èšç±»</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/20.png" alt="20"></p>
<h4 id="ç³»ç»Ÿè¿›åŒ–æ ‘"><a href="#ç³»ç»Ÿè¿›åŒ–æ ‘" class="headerlink" title="ç³»ç»Ÿè¿›åŒ–æ ‘"></a>ç³»ç»Ÿè¿›åŒ–æ ‘</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/21.png" alt="21"></p>
<h4 id="ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—"><a href="#ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—" class="headerlink" title="ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—"></a>ç‰©ç§åˆ†æ­§æ—¶é—´è®¡ç®—</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/22.png" alt="22"></p>
<h4 id="åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ"><a href="#åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ" class="headerlink" title="åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ"></a>åŸºå› å®¶æ—æ‰©å±•æ”¶ç¼©åˆ†æ</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/23.png" alt="23"></p>
<h4 id="æ­£é€‰æ‹©åˆ†æ"><a href="#æ­£é€‰æ‹©åˆ†æ" class="headerlink" title="æ­£é€‰æ‹©åˆ†æ"></a>æ­£é€‰æ‹©åˆ†æ</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/24.png" alt="24"></p>
<h4 id="å…±çº¿æ€§åˆ†æ-éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³"><a href="#å…±çº¿æ€§åˆ†æ-éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³" class="headerlink" title="å…±çº¿æ€§åˆ†æ(éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³)"></a>å…±çº¿æ€§åˆ†æ(éœ€åˆ°æŸ“è‰²ä½“æ°´å¹³)</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/25.png" alt="25"></p>
<h4 id="å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ-WGD"><a href="#å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ-WGD" class="headerlink" title="å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ(WGD)"></a>å…¨åŸºå› ç»„å¤åˆ¶åˆ†æ(WGD)</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/26.png" alt="26"></p>
<h4 id="æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„de-noveæµ‹åºæ•°æ®ï¼‰"><a href="#æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„de-noveæµ‹åºæ•°æ®ï¼‰" class="headerlink" title="æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„de noveæµ‹åºæ•°æ®ï¼‰"></a>æ³›åŸºå› ç»„åˆ†æï¼ˆéœ€è¦å¤šä»½åŸºå› ç»„<em>de nove</em>æµ‹åºæ•°æ®ï¼‰</h4><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/27.png" alt="27"></p>
<h2 id="æ–‡ç« "><a href="#æ–‡ç« " class="headerlink" title="æ–‡ç« "></a>æ–‡ç« </h2><p><img src="/blog/2022/02/28/2022-02-28-genome-assemble/28.png" alt="28"></p>
<p><a href="https://links.jianshu.com/go?to=https://pan.baidu.com/s/1t_xbRf4Bj3DoHTQV-y6xAQ">https://pan.baidu.com/s/1t_xbRf4Bj3DoHTQV-y6xAQ</a></p>
<p>yyds</p>
]]></content>
      <categories>
        <category>assemble</category>
      </categories>
      <tags>
        <tag>pipeline</tag>
      </tags>
  </entry>
  <entry>
    <title>Soapdenovo2</title>
    <url>/blog/2022/02/24/2022-02-25-soapdenovo2/</url>
    <content><![CDATA[<h1 id="soapdenovo2"><a href="#soapdenovo2" class="headerlink" title="soapdenovo2:"></a>soapdenovo2:</h1><span id="more"></span>

<p>SOAPdenovoä½¿ç”¨è¯´æ˜ï¼Œå†…å®¹åŒ…æ‹¬ç¨‹åº<font color="green"><strong>ä½¿ç”¨</strong></font>ã€<font color="green"><strong>å‚æ•°è¯´æ˜</strong></font>ã€<font color="green"><strong>å‚æ•°è°ƒæ•´</strong></font>ã€ä¸»è¦<font color="green"><strong>è¾“å‡ºæ–‡ä»¶</strong></font>çš„æ ¼å¼è¯´æ˜ç­‰ã€‚</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/1.png" alt="img"></p>
<h1 id="contiging"><a href="#contiging" class="headerlink" title="contiging"></a>contiging</h1><p><em><strong>a.</strong></em>  åŸºå› ç»„DNAéšæœºæ‰“æ–­ï¼Œä½¿ç”¨paired-endæµ‹åºã€‚é•¿åº¦åœ¨150-500bpçš„short clonesæ‰©å¢ç›´æ¥æµ‹åºã€‚åœ¨2-10kbçš„é•¿paired-end libraries é€šè¿‡DNAç¯åŒ–ã€fragmentationç ´ç¢ï¼Œç„¶åå‡€åŒ–400-600bpçš„ç¢ç‰‡ä¸ºäº†cluster ç»“æ„ã€‚</p>
<p><em><strong>b.</strong></em>  raw reads æˆ–é¢„ä¿®æ­£readsè¢«å­˜å‚¨ï¼Œde Bruijn graph data structure è¢«ç”¨äºè¡¨ç¤ºreadsé—´overlapã€‚</p>
<p>Kmer-graphæ„å»ºï¼šæ‰€æœ‰readsè¢«åˆ‡å‰²æˆæŸä¸€å›ºå®šKmeré•¿åº¦çš„åºåˆ—ï¼ˆ21bp=&lt;kmer&lt;=127bpï¼‰ï¼Œå½¢æˆç­‰é•¿çš„Kmersã€‚å°†Kmersè¿æˆå›¾ã€‚<font color="green"><strong>ç›¸é‚»çš„kmersæ˜¯é€šè¿‡K-1 overlapingè¿æ¥</strong></font>ï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦æˆå¯¹åºåˆ—æ¯”å¯¹ï¼ˆThe neighboring kmers are K-1 overlaping which generated from read sequences, so it doesnâ€™t need pair-wise reads alignment.ï¼‰ã€‚é‡å¤åºåˆ—åœ¨å›¾ä¸­è¢«å‹ç¼©ã€‚</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/2.png" alt="img"></p>
<p><em><strong>c.</strong></em>  äº§ç”Ÿ<font color="red"><strong>tipsç¿¼å°–ã€bubblesæ°”æ³¡ã€low coverage linksä½è¦†ç›–ç‡é“¾æ¥ã€tiny repeatå¾®å°é‡å¤</strong></font>ç­‰é—®é¢˜ã€‚</p>
<p><font color="blue"><strong>tipsç¿¼å°–ï¼ˆaï¼‰</strong></font>å’Œ<font color="blue"><strong>bubblesæ°”æ³¡ï¼ˆcï¼‰</strong></font>ï¼šç”±äº<strong>æµ‹åºé”™è¯¯</strong>æˆ–<strong>æ‚åˆ</strong>æˆ–<strong>é«˜é‡å¤åºåˆ—</strong>ç›¸ä¼¼æ€§ï¼Œå°†ä¼šå¯¼è‡´ç¿¼å°–å’Œæ°”æ³¡å‡ºç°ã€‚</p>
<p><font color="blue"><strong>low coverage linksä½è¦†ç›–ç‡é“¾æ¥ï¼šï¼ˆbï¼‰ï¼ˆdï¼‰</strong></font>ã€‚</p>
<p><font color="blue"><strong>tiny repeatå¾®å°é‡å¤(e)</strong></font>ï¼šé‡å¤åœ¨graphä¸­è¢«å‹ç¼©ï¼Œå¹¶ä½œä¸ºä¸åŒè·¯å¾„çš„å…±äº«è¾¹ç¼˜ï¼Œä½†æ˜¯èƒ½å¤Ÿé€šè¿‡reads ç©¿è¿‡æ¥è§£å†³ã€‚</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/3.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/4.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/5.png" alt="img"></p>
<p>ç§»é™¤é”™è¯¯é“¾æ¥å’Œgraph simplificationå›¾å½¢ç®€åŒ–ï¼Œå¾—åˆ°contigs or contig  graphsï¼štipsç¿¼å°–ç§»é™¤ï¼›åˆ é™¤ä½è¦†ç›–é“¾æ¥ï¼›bubblesåˆå¹¶æ°”æ³¡ï¼›è§£å†³å¾®å°é‡å¤ï¼›</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/6.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/7.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/8.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/9.png" alt="img"></p>
<p> <em><strong>d.</strong></em>  contig  graphs,åœ¨é‡å¤çš„èŠ‚ç‚¹å¤„å‰ªæ–­?ï¼Œè¾“å‡ºcontigs</p>
<h1 id="scaffolding"><a href="#scaffolding" class="headerlink" title="scaffolding"></a>scaffolding</h1><p><em><strong>e.</strong></em>  é‡æ–°ç”¨readså’Œcontigsè¿›è¡Œæ¯”å¯¹ï¼Œä½¿ç”¨<font color="red"><strong>paired-endä¿¡æ¯</strong></font>æŠŠå•ä¸€çš„contigsè¿æ¥æˆscaffoldsã€‚reads æ¯”å¯¹åˆ°contigsä¸Šï¼Œä¸´è¿‘çš„contigå»ºç«‹è¿æ¥ï¼›repeatå°†ä¼šå¼•æ¥å†²çªçŸ›ç›¾ä¿¡æ¯ï¼›<font color="red"><strong>åœ¨ç»„è£…æˆscaffoldæ—¶ï¼Œrepeat contigså°†ä¼šè¢«å±è”½</strong></font>ï¼›paired-endä¿¡æ¯çš„ä¸åŒæ’å…¥ç‰‡æ®µè¢«ç”¨æ¥ä¸€æ­¥æ­¥ä»çŸ­åˆ°é•¿çš„å»ºç«‹scaffold graph(Scaffolding iteratively from short to long insert PEs./Various insert size of paired-end information is used to build contig graph step by step from short to long)ã€‚</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/10.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/11.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/12.png" alt="img"></p>
<h1 id="Gap-Filling"><a href="#Gap-Filling" class="headerlink" title="Gap Filling:"></a>Gap Filling:</h1><p><em><strong>f.</strong></em>  ä½¿ç”¨paired-end readsæ¥å¡«è¡¥scaffoldså†…éƒ¨å¯èƒ½æ˜¯ç”±é‡å¤åºåˆ—æ‰€é€ æˆçš„Gapã€‚contig N50 é€šå¸¸æ¯”è¾ƒå°ï¼ˆ&lt;3KBï¼‰,ä½†æ˜¯ï¼Œgap fillingä¹‹åèƒ½å¤Ÿæ˜¾è‘—æé«˜N50å€¼ï¼ˆi.e.,&gt;20KBï¼‰;Most of the gaps are repeat relative sequences.;Reads locate at gaps can collected by their paired-end which uniquely map to the contig.</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/13.png" alt="img"></p>
<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>SOAPdenovoï¼ˆç›®å‰æœ€æ–°ç‰ˆæ˜¯SOAPdenovo2ï¼‰æ˜¯åˆ©ç”¨ä¸€ç§æ–°çš„ç»„è£…çŸ­readçš„æ–¹æ³•ï¼Œå®ƒä»¥kermä¸ºèŠ‚ç‚¹å•ä½ï¼Œåˆ©ç”¨<font color="green"><strong>de Bruijnå›¾</strong></font>çš„æ–¹æ³•å®ç°å…¨åŸºå› ç»„çš„ç»„è£…ï¼Œå’Œå…¶ä»–çŸ­åºåˆ—ç»„è£…è½¯ä»¶ç›¸æ¯”ï¼Œå®ƒå¯ä»¥è¿›è¡Œå¤§å‹åŸºå› ç»„æ¯”å¦‚äººç±»åŸºå› ç»„çš„ç»„è£…ï¼Œç»„è£…ç»“æœæ›´åŠ å‡†ç¡®å¯é ï¼Œå¯ä»¥é€šè¿‡ç»„è£…çš„ç»“æœéå¸¸å‡†ç¡®åœ°é‰´åˆ«å‡ºåŸºå› ç»„ä¸Šçš„åºåˆ—ç»“æ„æ€§å˜å¼‚ï¼Œä¸ºæ„å»ºå…¨åŸºå› ç»„å‚è€ƒåºåˆ—å’Œä»¥ä½æµ‹åºæˆæœ¬å¯¹æœªçŸ¥åŸºå› ç»„å®æ–½ç²¾ç¡®åˆ†æåˆ›é€ äº†å¯èƒ½ã€‚</p>
<p>SOAPdenovo aims for large plant and animal genomes, although it also works well on bacteria and fungi genomes. It runs on 64-bit Linux system with a minimum of 5G physical memory. For <strong>big genomes</strong> like human, about <strong>150 GB memory</strong> would be required.</p>
<p>ç¨‹åºçš„ä¸‹è½½åŠå®‰è£…ï¼š<br>ä¸‹è½½åœ°å€ï¼š<a href="http://soap.genomics.org.cn/soapdenovo.html">http://soap.genomics.org.cn/soapdenovo.html</a><br>å®‰è£…ï¼š<br>(a) ä¸‹è½½SOAPdenovoçš„å‹ç¼©åŒ…   </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/aquaskyline/SOAPdenovo2.git</span><br><span class="line"><span class="built_in">cd</span> SOAPdenovo2</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p>(b) è§£å‹ç¼©<br>(c)å°†å¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶SOAPdenovoå’Œä¸€ä¸ªé…ç½®æ–‡ä»¶çš„æ¨¡æ¿example.contig</p>
<p><strong>3ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</strong></p>
<ol>
<li><font color="green"><strong>SOAPdenovo-63mer</strong></font></li>
<li><font color="green"><strong>SOAPdenovo-127mer</strong></font></li>
<li><font color="green"><strong>SOAPdenovo-fusion</strong></font></li>
</ol>
<p>ç¬¬ä¸€ä¸ªæ”¯æŒæœ€å¤§k-merä¸º63ï¼Œç¬¬äºŒä¸ªæœ€å¤§kmerä¸º127ï¼Œç¬¬ä¸‰ä¸ªæ–‡ä»¶ç”¨äºå•ç»†èƒæµ‹åºå’Œå®åŸºå› ç»„æµ‹åºæ•°æ®ã€‚</p>
<h1 id="ä½¿ç”¨ç¨‹åºåŠå‚æ•°"><a href="#ä½¿ç”¨ç¨‹åºåŠå‚æ•°" class="headerlink" title="ä½¿ç”¨ç¨‹åºåŠå‚æ•°"></a>ä½¿ç”¨ç¨‹åºåŠå‚æ•°</h1><p>SOAPdenovoå¯ä»¥ä¸€æ­¥è·‘å®Œï¼Œä¹Ÿå¯ä»¥åˆ†æˆå››æ­¥å•ç‹¬è·‘<br><font color="green"><strong>ä¸€æ­¥è·‘å®Œè„šæœ¬:</strong></font><br>./ SOAPdenovo <font color="red"><strong>all</strong></font> <strong>-s</strong> lib.cfg <strong>-K</strong> 29 <strong>-D</strong> 1 <strong>-o</strong> ant &gt;&gt;ass.log<br><font color="green"><strong>å››æ­¥å•ç‹¬è·‘çš„è„šæœ¬</strong></font><br>./ SOAPdenovo <font color="red"><strong>pregraph</strong></font> <strong>-s</strong> lib.cfg <strong>-d</strong> 1  <strong>-K</strong> 29 <strong>-o</strong> ant &gt;pregraph.log<br>./ SOAPdenovo <font color="red"><strong>contig</strong></font> <strong>-g</strong> ant <strong>-D</strong> 1 <strong>-M</strong> 3 &gt;contig.log<br>./ SOAPdenovo <font color="red"><strong>map</strong></font> <strong>-s</strong> lib23.cfg <strong>-g</strong> ant &gt;map.log<br>./ SOAPdenovo <font color="red"><strong>scaff</strong></font> <strong>-g</strong> ant <strong>-F</strong> &gt;scaff.log</p>
<h1 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h1><p>ç”¨æ³•ï¼š/PathToProgram/SOAPdenovo all -s configFile [-K kmer -d KmerFreqCutOff -D EdgeCovCutoff -M mergeLevel -R -u -G gapLenDiff -L minContigLen -p n_cpu] -o Output</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-s    STR     é…ç½®æ–‡ä»¶âˆš</span><br><span class="line">-o    STR     å›¾å½¢è¾“å‡ºçš„æ–‡ä»¶åå‰ç¼€ âˆš</span><br><span class="line">-g    STR     è¾“å…¥æ–‡ä»¶çš„æ–‡ä»¶åå‰ç¼€</span><br><span class="line">-K    INT     è¾“å…¥çš„K-merå€¼å¤§å°ï¼Œé»˜è®¤å€¼23ï¼Œå–å€¼èŒƒå›´ 13-63 âˆš</span><br><span class="line">-p    INT     ç¨‹åºè¿è¡Œæ—¶è®¾å®šçš„cpuçº¿ç¨‹æ•°ï¼Œé»˜è®¤å€¼8</span><br><span class="line">-R            <span class="string">&quot;åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ&quot;</span> âˆš</span><br><span class="line">-d    INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„k-merï¼Œé»˜è®¤å€¼ä¸º0;<span class="string">&quot;æœ€å°åŒ–é”™è¯¯æµ‹åºå¸¦æ¥çš„å½±å“&quot;</span> âˆš</span><br><span class="line">-D    INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„ç”±k-merè¿æ¥çš„è¾¹ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œå³è¯¥è¾¹ä¸Šæ¯ä¸ªç‚¹çš„é¢‘æ•°éƒ½å°äºç­‰äº1æ—¶æ‰å»é™¤,æœ€å°åŒ–é”™è¯¯æµ‹åºå¸¦æ¥çš„å½±å“ ?</span><br><span class="line">-M    INT     è¿æ¥contigæ—¶åˆå¹¶ç›¸ä¼¼åºåˆ—çš„ç­‰çº§(å¼ºåº¦)ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œæœ€å¤§å€¼3ã€‚</span><br><span class="line">-F            åˆ©ç”¨<span class="built_in">read</span>å¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤ä¸æ‰§è¡Œ</span><br><span class="line">-u            æ„å»ºscaffoldå‰ä¸å±è”½é«˜è¦†ç›–åº¦çš„contigï¼Œè¿™é‡Œé«˜é¢‘ç‡è¦†ç›–åº¦æŒ‡å¹³å‡contigè¦†ç›–æ·±åº¦çš„2å€ã€‚é»˜è®¤å±è”½</span><br><span class="line">-G    INT     ä¼°è®¡gapçš„å¤§å°å’Œå®é™…è¡¥gapçš„å¤§å°çš„å·®å¼‚ï¼Œé»˜è®¤å€¼ä¸º50bpã€‚</span><br><span class="line">-L            ç”¨äºæ„å»ºscaffoldçš„contigçš„æœ€çŸ­é•¿åº¦ï¼Œé»˜è®¤ä¸ºï¼šKmerå‚æ•°å€¼ Ã—2</span><br></pre></td></tr></table></figure>

<p><font color="blue"><strong>å…¨å±€é…ç½®</strong></font></p>
<p><code>max_rd_len</code></p>
<p><font color="blue"><strong>æ–‡åº“é…ç½®</strong></font></p>
<p>æ¯ä¸ªæ–‡åº“çš„é…ç½®ä»¥<code>[LIB]</code>å¼€å¤´ï¼Œä¸»è¦æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„è·¯å¾„ï¼Œæ”¯æŒå¤šç§æ ¼å¼çš„è¾“å…¥æ–‡ä»¶ï¼Œç”¨ä¸åŒçš„å‰ç¼€è¡¨ç¤ºï¼Œ <code>q</code>ä»£è¡¨è¾“å…¥åºåˆ—ä¸ºfastqæ ¼å¼ï¼›<code>f</code>ä»£ç¬”è¾“å…¥åºåˆ—ä¸ºfastaæ ¼å¼ï¼Œ<code>b</code>ä»£è¡¨è¾“å…¥æ–‡ä»¶ä¸ºbamæ ¼å¼ï¼Œå¯¹äºåŒç«¯æ•°æ®ï¼Œåˆ†åˆ«ç”¨åç¼€<code>1</code>å’Œ<code>2</code>è¡¨ç¤ºR1ç«¯å’ŒR2ç«¯çš„readsã€‚</p>
<p><font color="blue"><strong>ä¸»è¦å‚æ•°</strong></font></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-avg_ins    This value indicates the average insert size of this library or the peak value position <span class="keyword">in</span> the <span class="string">&quot;insert size distribution figure?&quot;</span>. <span class="comment">#æ–‡åº“å¹³å‡æ’å…¥é•¿åº¦(æˆ–å–æ’å…¥å¤§å°åˆ†å¸ƒå›¾ä¸­çš„å³°å€¼ä½ç½®)ï¼Œæ ¹æ®å»ºåº“æƒ…å†µè®¾ç½®ã€‚ </span></span><br><span class="line"></span><br><span class="line">-reverse_seq    This option takes value 0 or 1. It tells the assembler <span class="keyword">if</span> the <span class="built_in">read</span> sequences need to be complementarily reversed. Illumima GA produces two types of paired-end libraries: a) <span class="string">&quot;forward-reverse&quot;</span>, generated from fragmented DNA ends with typical <span class="string">&quot;insert size less than 500 bp&quot;</span>; b) <span class="string">&quot;reverse-forward&quot;</span>, generated from <span class="string">&quot;circularizing libraries&quot;</span> with typical <span class="string">&quot;insert size greater than 2 Kb&quot;</span>. The parameter <span class="string">&quot;reverse_seq&quot;</span> should be <span class="built_in">set</span> to indicate this: 0, forward-reverse; 1, reverse-forward. </span><br><span class="line"></span><br><span class="line">-asm_flags    This indicator decides <span class="keyword">in</span> <span class="built_in">which</span> part(s) the reads are used. It takes value 1(only contig assembly), 2 (only scaffold assembly), <span class="string">&quot;3(both contig and scaffold assembly)&quot;</span><span class="string">&quot;, or 4 (only gap closure). </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-rd_len_cutof    The assembler will &quot;</span>cut the reads from the current library to this length<span class="string">&quot;.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-rank    It takes integer values and decides in which &quot;</span>order the reads are used <span class="keyword">for</span> scaffold assembly<span class="string">&quot;. Libraries with the same &quot;</span>rank<span class="string">&quot; are used at the same time during scaffold assembly.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-pair_num_cutoff    This parameter is the cutoff value of pair number for a &quot;</span>reliable connection<span class="string">&quot; between two contigs or pre-scaffolds. The minimum number for &quot;</span>paired-end reads and mate-pair reads is 3 and 5 respectively<span class="string">&quot;. </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-map_len    This takes effect in the &quot;</span>map<span class="string">&quot; step and is the minimun alignment length between a read and a contig required for a reliable read location. The minimum length for &quot;</span>paired-end reads and mate-pair reads is 32 and 35 respectively<span class="string">&quot;.</span></span><br></pre></td></tr></table></figure>

<p><font color="blue"><strong>å®ä¾‹</strong></font></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">max_rd_len=100</span><br><span class="line">[LIB]</span><br><span class="line"><span class="comment">#avg_ins æ–‡åº“æ’å…¥ç‰‡æ®µçš„å¹³å‡é•¿åº¦ï¼Œåœ¨å®é™…è®¾ç½®æ—¶ï¼Œå¯ä»¥å‚è€ƒæ–‡åº“sizeåˆ†å¸ƒå›¾ï¼Œå–å³°å€¼å³å¯???</span></span><br><span class="line">avg_ins=200</span><br><span class="line"><span class="comment">#reverse_seq æ˜¯å¦éœ€è¦å°†åºåˆ—åå‘äº’è¡¥ï¼Œpair-endæ•°æ®ï¼Œä¸éœ€åå‘äº’è¡¥ï¼Œè®¾ç½®ä¸º0ï¼›mate-pairéœ€è¦è®¾ç½®ä¸º1</span></span><br><span class="line">reverse_seq=0</span><br><span class="line"><span class="comment">#asm_flags 1åªç»„è£…contig. 2åªç»„è£…scaffold,3åŒæ—¶ç»„è£…contigå’Œscaffold,4åªè¡¥gap</span></span><br><span class="line">asm_flags=3</span><br><span class="line"><span class="comment">#åºåˆ—é•¿åº¦é˜ˆå€¼ï¼Œä½œç”¨å’Œmax_rd_lenç›¸åŒï¼Œå¤§äºè¯¥é•¿åº¦çš„åºåˆ—ä¼šè¢«åˆ‡é™¤åˆ°è¯¥é•¿åº¦</span></span><br><span class="line">rd_len_cutoff=100</span><br><span class="line"><span class="comment">#è®¾ç½®ä¸åŒæ–‡åº“æ•°æ®çš„ä¼˜å…ˆçº§é¡ºåºï¼Œå–å€¼èŒƒå›´ä¸ºæ•´æ•°ï¼Œrankå€¼ç›¸åŒçš„å¤šä¸ªæ–‡åº“ï¼Œåœ¨ç»„è£…scaffoldæ—¶ï¼Œä¼šåŒæ—¶ä½¿ç”¨ã€‚</span></span><br><span class="line">rank=1</span><br><span class="line">q1=fastq1_read_1.fq</span><br><span class="line">q2=fastq1_read_2.fq</span><br><span class="line">-pair_num_cutoff</span><br><span class="line"><span class="comment">#contigæˆ–è€…scaffoldä¹‹å‰çš„æœ€å°overlapä¸ªæ•°ï¼Œpair-endæ•°æ®é»˜è®¤ä¸º3ï¼›mate-pairdæ•°æ®é»˜è®¤ä¸º5</span></span><br><span class="line">-map_len</span><br><span class="line"><span class="comment">#æ¯”å¯¹é•¿åº¦çš„æœ€å°é˜ˆå€¼ï¼Œpair-endæ•°æ®é»˜è®¤ä¸º32ï¼›mate-pairæ•°æ®é»˜è®¤ä¸º35</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">SOAPdenovo-63mer all -s config_file -K 63 -R -o graph_prefix</span><br></pre></td></tr></table></figure>



<h1 id="ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹"><a href="#ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹"></a>ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ï¼ˆ1ï¼‰ç¤ºä¾‹</span></span><br><span class="line">SOAPdenovo all -s HCB.lib -K 25 -d -o <span class="built_in">test</span></span><br><span class="line"><span class="comment">#ï¼ˆ2ï¼‰é…ç½®æ–‡ä»¶ configFile</span></span><br><span class="line"><span class="comment">#maximal read length ï¼ˆreadçš„æœ€å¤§é•¿åº¦ï¼‰ï¼Œè¯¥å€¼ã€ä¸€èˆ¬è®¾ç½®çš„æ¯”å®é™…readè¯»é•¿ç¨å¾®çŸ­ä¸€äº›ï¼Ÿã€‘ï¼Œæˆªå»æµ‹åºæœ€åçš„éƒ¨åˆ†ï¼Œå…·ä½“é•¿åº¦çœ‹æµ‹åºè´¨é‡</span></span><br><span class="line">max_rd_len=50    </span><br><span class="line"></span><br><span class="line"><span class="comment">#[LIB]æ–‡åº“ä¿¡æ¯ä»¥æ­¤å¼€å¤´</span></span><br><span class="line"></span><br><span class="line">avg_ins=200<span class="comment">#?</span></span><br><span class="line"></span><br><span class="line">reverse_seq=0</span><br><span class="line"><span class="comment">#åºåˆ—æ˜¯å¦éœ€åè½¬ï¼Œç›®å‰æµ‹åºæŠ€æœ¯ï¼Œæ’å…¥ç‰‡æ®µå¤§äºç­‰äº2kçš„é‡‡ç”¨äº†ç¯åŒ–ï¼Œå¯¹äºæ’å…¥é•¿åº¦å¤§äºç­‰äº2kæ–‡åº“ï¼Œåºåˆ—éœ€è¦åè½¬ï¼Œreverse_seqï¼1ï¼Œå°ç‰‡æ®µè®¾ä¸º0</span></span><br><span class="line"></span><br><span class="line">asm_flags=3</span><br><span class="line"><span class="comment">#è¯¥æ–‡åº“ä¸­çš„readåºåˆ—åœ¨ç»„è£…çš„å“ªäº›è¿‡ç¨‹ï¼ˆcontig/scaff/fillï¼‰ä¸­ç”¨åˆ°</span></span><br><span class="line"><span class="comment">#çŸ­æ’å…¥ç‰‡æ®µ(&lt;2K)çš„è®¾ä¸º3ï¼ŒåŒæ—¶æ„å»ºcontigå’Œscaffoldï¼Œé•¿æ’å…¥ç‰‡æ®µ(&gt;=2k)è®¾ä¸º2ï¼Œä¸æ„å»ºcontigï¼Œåªæ„å»ºscaffoldï¼Œ454single é•¿readsåªç”¨äºè¡¥æ´ã€‚</span></span><br><span class="line"></span><br><span class="line">rank=1</span><br><span class="line"><span class="comment">#è¯¥å€¼å–æ•´æ•°ï¼Œå†³å®šäº†readsç”¨äºæ„å»ºscaffoldçš„æ¬¡åºï¼Œå€¼è¶Šä½æ•°æ®è¶Šä¼˜å…ˆç”¨äºæ„å»ºscaffoldã€‚ã€ç›¸åŒrankçš„æ–‡åº“æ•°æ®ä¼šåŒæ—¶ç”¨äºç»„è£…scaffoldã€‘ã€‚ä¸€èˆ¬å°†çŸ­æ’å…¥ç‰‡æ®µè®¾ä¸º1ï¼›2kè®¾ä¸º2ï¼›5kè®¾ä¸º3ï¼›10kè®¾ä¸º4ï¼›å½“ã€æŸä¸ªæ¡£çš„æ•°æ®é‡è¾ƒå¤§ã€‘æ—¶å¯ä»¥å°†å…¶åˆ†ä¸ºå¤šä¸ªæ¡£ï¼ŒåŒæ ·å½“ã€æŸæ¡£æ•°æ®é‡ä¸è¶³å¤Ÿã€‘æ—¶ï¼Œå¯ä»¥å°†å¤šä¸ªæ¡£çš„æ•°æ®åˆåœ¨ä¸€èµ·æ„å»ºscaffold?ã€‚è¿™é‡Œè¯´çš„æ•°æ®é‡å¤Ÿä¸ä¸å¤Ÿæ˜¯ä»è¯¥æ¡£çš„æµ‹åºè¦†ç›–åº¦å’Œç‰©ç†è¦†ç›–åº¦ä¸¤ä¸ªæ–¹é¢è€ƒè™‘ã€‚</span></span><br><span class="line"></span><br><span class="line">pair_num_cutoff=3</span><br><span class="line"><span class="comment">#ã€å¯é€‰å‚æ•°ã€‘ï¼Œè¯¥å‚æ•°è§„å®šè¿æ¥ä¸¤ä¸ªcontig æˆ–è€…æ˜¯pre-scaffold çš„å¯ä¿¡è¿æ¥çš„é˜ˆå€¼ï¼Œå½“è¿æ¥æ•°å¤§äºè¯¥å€¼ï¼Œè¿æ¥æ‰ç®—æœ‰æ•ˆã€‚çŸ­æ’å…¥ç‰‡æ®µ(&lt;2k)é»˜è®¤å€¼ä¸º3ï¼Œé•¿æ’å…¥é•¿åº¦åºåˆ—é»˜è®¤å€¼ä¸º5</span></span><br><span class="line"></span><br><span class="line">map_len=32</span><br><span class="line"><span class="comment">#map_lenè¯¥å‚æ•°è§„å®šåœ¨mapè¿‡ç¨‹ä¸­ readså’Œcontigçš„æ¯”å¯¹é•¿åº¦å¿…é¡»è¾¾åˆ°è¯¥å€¼ï¼ˆæ¯”å¯¹ä¸å®¹mismacthå’Œgapï¼‰ï¼Œè¯¥æ¯”å¯¹æ‰èƒ½ä½œä¸ºä¸€ä¸ªå¯ä¿¡çš„æ¯”å¯¹ã€‚å¯é€‰å‚æ•°ï¼ŒçŸ­æ’å…¥ç‰‡æ®µ(&lt;2k)ä¸€èˆ¬è®¾ç½®ä¸º32ï¼Œé•¿æ’å…¥ç‰‡æ®µè®¾ç½®ä¸º35ï¼Œé»˜è®¤å€¼æ˜¯Kï¼‹2ã€‚</span></span><br><span class="line"></span><br><span class="line">q1=/path/LIBNAMEA/fastq_read_1.fq<span class="comment">#read 1çš„fastq</span></span><br><span class="line">q2=/path/LIBNAMEA/fastq_read_2.fq<span class="comment">#read 2çš„fastqã€æ³¨æ„é¡ºåºã€‘</span></span><br><span class="line">f1=/path/LIBNAMEA/fasta_read_1.fa<span class="comment">#read 1çš„fa</span></span><br><span class="line">f2=/path/LIBNAMEA/fasta_read_2.fa</span><br><span class="line">q=/path/LIBNAMEA/fastq_read_single.fq<span class="comment">#å•å‘æµ‹åºfastq</span></span><br><span class="line">f=/path/LIBNAMEA/fasta_read_single.fa<span class="comment">#å•å‘æµ‹åºfa</span></span><br><span class="line">p=/path/LIBNAMEA/pairs_in_one_file.fa<span class="comment">#åŒå‘æµ‹åºä¸€ä¸ªfasta</span></span><br></pre></td></tr></table></figure>





<h1 id="è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜"><a href="#è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜" class="headerlink" title="è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜"></a>è¾“å‡ºæ–‡ä»¶åŠè¯´æ˜</h1><p>SOAPdenovo åˆ†å››éƒ¨åˆ†åˆ«å¯¹åº”çš„è¾“å‡ºæ–‡ä»¶ï¼š<br>  â— pregraph  ç”Ÿæˆ7ä¸ªæ–‡ä»¶ *.kmerFreq  *.edge  *.preArc  *.markOnEdge  *.path  *.vertex  *.preGraphBasic<br>  â— contig       ç”Ÿæˆ4ä¸ªæ–‡ä»¶ <font color="red"> ***.contig**</font>  *.ContigIndex  *.updated.edge  *.Arc<br>  â— map          ç”Ÿæˆ3ä¸ªæ–‡ä»¶ *.readOnContig  *.peGrads  *.readInGap<br>  â— scaff          ç”Ÿæˆ6ä¸ªæ–‡ä»¶ *.newContigIndex  *.links  *.scaf  *.scaf_gap  <font color="red"> ***.scafSeq**</font>  *.gapSeq</p>
<p>*.kmerFreq             #æ¯è¡Œæ˜¾ç¤ºä¸€ä¸ªæ•°ï¼Œè¿™ä¸ªæ•°æ˜¯kmerå€¼å‡ºç°çš„é¢‘ç‡ç­‰äºè¡Œå·çš„kmerä¸ªæ•°ã€‚</p>
<p><font color="red"><em><strong>.contig</strong></em></font>ï¼šæ²¡æœ‰ä½¿ç”¨mate pair ä¿¡æ¯çš„contig sequences<br><font color="red"><strong>.scafSeq</strong></font>ï¼šfastaæ ¼å¼scaffoldåºåˆ—æ–‡ä»¶ï¼Œcontigä¹‹é—´çš„gapç”¨Nå¡«å……ï¼›<br><strong>å¯¹äºå¾—åˆ°çš„.scafSeqæ–‡ä»¶è¿˜éœ€è¦ç”¨<font color="red">GapCloser</font>å»åˆå¹¶å…¶ä¸­çš„gapï¼Œæœ€åçš„contigæ–‡ä»¶åˆ™æ˜¯å¯¹è¡¥æ´ä¹‹åçš„scaffoldæ–‡ä»¶é€šè¿‡æ‰“æ–­NåŒºçš„æ–¹æ³•å¾—åˆ°?</strong><br>ä»¥ä¸Šä¸¤ä¸ªæ–‡ä»¶æ˜¯ç»„è£…ç»“æœä¸­æœ€ä¸»è¦çš„è¾“å‡ºã€‚</p>
<p><font color="red"><em><strong>.scaf</strong></em></font>ï¼šåŒ…æ‹¬scaffoldä¸­contigçš„è¯¦ç»†ä¿¡æ¯ï¼›<br>åœ¨*scaffoldè¡Œ<strong>ä¸­åŒ…æ‹¬scaffoldåå­—ã€contigé•¿åº¦å’Œè¯¥scaffoldé•¿åº¦ã€‚<br>åœ¨</strong>contigè¡Œ**åŒ…æ‹¬contigåå­—ã€contigåœ¨scaffoldä¸Šçš„èµ·å§‹ä½ç½®ã€æ­£åé“¾ã€é•¿åº¦å’Œcontigé—´çš„é“¾æ¥ä¿¡æ¯<br><font color="red"> *.links</font>ï¼šcontigé—´çš„pair-endè¿æ¥ä¿¡æ¯<br><font color="red"> *.readOnContig</font>ï¼šreadsåœ¨contigä¸Šçš„ä½ç½®<br><font color="red"> *.peGrads</font>ï¼š é€šè¿‡è°ƒæ•´æœ¬æ–‡ä»¶ä¸­å‚æ•°æ¥æ˜¾ç¤ºæ„å»ºscaffoldæ‰€ç”¨åˆ°çš„æ’å…¥ç‰‡æ®µåº“çš„ä¸ªæ•°ï¼Œæ€»å…±ç”¨åˆ°çš„readæ•°ï¼Œæœ€é•¿readï¼Œæ¯ä¸ªåº“å¯¹åº”çš„å“ªäº›readsï¼Œrankè®¾ç½®ï¼Œpair_num_cutoffè®¾ç½®ã€‚ä¾‹å¦‚ï¼š</p>
<blockquote>
<p>grads&amp;num: 10   522083934       70<br>323     104577616       1       3<br>334     180770522       1       3<br>345     226070520       1       3<br>486     361955834       2       3<br>2200    392088076       3       5<br>2290    422272580       3       5<br>2400    445522690       3       5<br>4870    475666064       4       5<br>9000    511030930       5       8<br>9110    522083934       5       5</p>
<p>è¯¥æ–‡ä»¶ä¸­å…±åˆ†æˆ4åˆ—ã€‚<strong>ç»„è£…çš„é…ç½®æ–‡ä»¶ä¸­æœ‰nä¸ªæ–‡åº“ï¼Œè¯¥æ–‡ä»¶åˆ™æœ‰n+1è¡Œï¼Œä¸”æŒ‰ç…§æ–‡åº“å¤§å°é¡ºåºæ’åˆ—ã€‚</strong><br><strong>ç¬¬1è¡Œ</strong>ï¼ŒäºŒä¸‰å››åˆ—åˆ†åˆ«æ˜¯æ‰€ç”¨æ–‡åº“æ•°ç›®ï¼Œreadsæ€»æ•°å’Œ<font color="red">ç»„è£…ä¸­ç”¨åˆ°çš„æœ€é•¿çš„readsé•¿åº¦ï¼Ÿ</font>ã€‚<br><strong>ç¬¬2è¡Œ</strong>ï¼Œå››åˆ—åˆ†åˆ«æ˜¯æ–‡åº“å¤§å°ï¼Œæ–‡åº“readsæ•°ç›®ï¼Œæ–‡åº“readsçš„rankç­‰çº§å’Œpair_num_cutoffã€‚<br><strong>ç¬¬3ï½n+1è¡Œ</strong>ï¼Œå››åˆ—åˆ†åˆ«æ˜¯æ–‡åº“å¤§å°ï¼Œæ–‡åº“readsæ•°ç›®åŠ ä¸Šå‰é¢æ–‡åº“ä¸­çš„readsæ€»æ•°ï¼Œæ–‡åº“readsçš„rankç­‰çº§pair_num_cutoffã€‚#contigæˆ–è€…scaffoldä¹‹å‰çš„æœ€å°overlapä¸ªæ•°ï¼Œpair-endæ•°æ®é»˜è®¤ä¸º3ï¼›mate-pairdæ•°æ®é»˜è®¤ä¸º5,è‹¥é…ç½®æ–‡ä»¶æ²¡è®¾ç½®pair_num_cutoffï¼Œå³ä½¿ç”¨é»˜è®¤å‚æ•°0ã€‚</p>
</blockquote>
<p><strong>å¯¹äºSOAPdenovoçš„æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ—¥å¿—æ–‡ä»¶è¾“å‡ºï¼Œè¦ä¿å­˜å¥½æ—¥å¿—æ–‡ä»¶ï¼Œæ—¥å¿—æ–‡ä»¶ä¸­åŒ…å«æœ‰å¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚</strong></p>
<p>SOAPdenovoæ—¥å¿—è¾“å‡ºè¯´æ˜ï¼š</p>
<p>1ï¼‰<font color="red">pregraph.log</font>:  å…¶ä¸­æœ‰å¾ˆå¤šçš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ„å»ºdebruijn-graphæ‰€ç”¨readsæ•°ç›®ï¼Œæ„å›¾äº§ç”Ÿå¤šå°‘uniqçš„kmerä»¥åŠè®¾ç½®-då‚æ•°åå»é™¤äº†å¤šå°‘kmerã€‚</p>
<blockquote>
<p>-R            åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ</p>
<p>-d    INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„k-merï¼Œé»˜è®¤å€¼ä¸º0</p>
</blockquote>
<p>åœ¨pregraphä¸­ï¼Œå¯é€‰å‚æ•°æœ‰ â€“R â€“K â€“d  ç»“æœå¦‚ï¼š<br>5467781332 <strong>nodes</strong> allocated, 70662750348 <strong>kmer</strong> <strong>in reads</strong>, 70662750348 <strong>kmer processed</strong><br>3283081670 <strong>kmer removed</strong><br>å…¶ä¸­Kmer æ•°å–å†³äºkå€¼å’Œæ•°æ®é‡ï¼Œnodesæ•°å³ç‰¹å¼‚æ€§kmeræ•°ï¼Œå½“nodesæ•°ç›®è¿‡é«˜<strong>ï¼ˆä¸€èˆ¬å’ŒåŸºå› ç»„å¤§å°å·®ä¸å¤šå¤§å°ï¼‰ï¼Œå¯èƒ½æ˜¯æ•°æ®çš„é”™è¯¯ç‡æ¯”è¾ƒé«˜ï¼Œä¹Ÿå¯èƒ½æ˜¯å­˜åœ¨æ‚åˆ</strong>ã€‚è‹¥nodesæ•°ç›®åå°ï¼Œä¸”kmeræ•°ç›®å¤šï¼Œåˆ™åŸºå› ç»„é‡å¤åº¦è¾ƒé«˜ã€‚</p>
<p>kå€¼çš„é€‰å–ï¼Œå½“æ•°æ®é‡å……è¶³ï¼ˆ&gt;=40Xï¼‰ï¼Œ<strong>æ¤ç‰©åŸºå› ç»„ä¸€èˆ¬é‡‡ç”¨å¤§kmeræ•ˆæœè¾ƒå¥½</strong>ï¼Œè€Œ<strong>åŠ¨ç‰©åŸºå› ç»„kå€¼ä¸€èˆ¬å–27å’Œ29è¶³å¤Ÿ</strong>ã€‚kmer removedè¡¨ç¤ºçš„ <strong>â€“d å‚æ•°æ‰€å»é™¤çš„ä½é¢‘çš„kmer</strong>ã€‚</p>
<p>2ï¼‰<font color="red">contig.log</font>: contig ä¸­ï¼Œå¯é€‰å‚æ•° â€“R â€“D â€“Mï¼Œæ³¨ï¼Œ-R å‚æ•°çš„é€‰å®šï¼Œå¿…é¡»pregraphå’Œcontigä¸­åŒæ—¶é€‰æ‹©æ‰æœ‰æ•ˆã€‚</p>
<blockquote>
<p>-R            åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ</p>
</blockquote>
<p>ç»“æœä¾‹å­ï¼š<br>16430183 pairs found, 2334584 pairs of paths compared, 1674493 pairs merged<br><strong>mergedçš„æ•°é‡å¯ä½œä¸ºä¼°è®¡æ‚åˆä»¥åŠæµ‹åºé”™è¯¯çš„ç¨‹åº¦</strong>ã€‚<br>sum up 1932549703bp, with average length 1170<br>the longest is 36165bp, contig N50 is 2871 bp,contig N90 is 553 bp<br>ç›¸å…³ç»Ÿè®¡ä¿¡æ¯ï¼Œé€šå¸¸<strong>æ¤ç‰©åŸºå› ç»„çš„contig N90åœ¨200bpå·¦å³</strong>ï¼Œè‹¥<strong>N90é«˜äº200bpåˆ™è¯¥åŸºå› ç»„scaffoldæ„å»ºä¸ä¼šæœ‰å¤ªå¤§é—®é¢˜</strong>ã€‚åŠ¨ç‰©åŸºå› ç»„scaffoldæ„å»ºå¾ˆå°‘æœ‰å‡ºé—®é¢˜çš„ã€‚</p>
<p>3ï¼‰<font color="red">map.log</font>:<br>Output 415219610 out of 1956217742 (21.2)% reads in gaps<br><strong>1661094582 out of 1956217742 (84.9)% reads mapped to contigs</strong><br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œreads in gapæ¯”ä¾‹å’Œmap to contig æ¯”ä¾‹<strong>æ€»å’Œå¤§äº1ï¼ˆ21.2%+84.9%ï¼‰</strong>ã€‚å› ä¸ºreads mapåˆ°å¤šä¸ªåœ°æ–¹éƒ½è¢«ç»Ÿè®¡ã€‚å½“map to contigçš„æ¯”ä¾‹å¾ˆé«˜ï¼ˆ80%å·¦å³æ—¶ï¼‰ï¼Œä½†ç»„è£…æ•ˆæœä¸å¥½å¯èƒ½æ˜¯é‡å¤åºåˆ—è¾ƒå¤šã€‚reads in gapæ¯”ä¾‹è¾ƒé«˜ï¼ˆå¤§äº40%ï¼‰æ˜¯å› ä¸ºåŸºå› ç»„ç»„è£…çš„è¾ƒç¢gapåŒºåŸŸè¾ƒå¤šã€‚<br>map_len é»˜è®¤å€¼=K+5ï¼ŒçŸ­æ’å…¥ç‰‡æ®µ(&lt;2k)ä¸€èˆ¬è®¾ç½®ä¸º32ï¼Œé•¿æ’å…¥ç‰‡æ®µä¸º35ã€‚å–å€¼ä¸ºmax{K+5,map_len}</p>
<p>4ï¼‰<font color="red">scaff.log</font>:<br>average contig coverage is 23, 5832270 contig masked<br>æ„å»ºscaffoldæ˜¯å¯¹é«˜é¢‘è¦†ç›–çš„contigè¿›è¡Œå±è”½ï¼ˆå³<strong>é¢‘ç‡é«˜äºaverage contig coverageçš„ä¸¤å€çš„contigä¸ç”¨äºæ„å»ºscaffold(average-dep 2å€ä»¥ä¸Šrepeat sequences)?<strong>ï¼‰ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºç»„è£…çš„åŸºå› ç»„ä¸€å®šçš„é‡å¤æƒ…å†µã€‚<br><strong>estimated PE size 162</strong>, by 40034765 pairs<br>on contigs longer than 173, 38257479 pairs found,SD=8, insert_size estimated: 163<br><font color="green"><strong>173 æ˜¯é…ç½®æ–‡ä»¶æ–‡åº“insertsize</strong></font>ï¼Œ<font color="green"><strong>163 æ˜¯reads  mapåˆ°contigä¸Šçš„è·ç¦»çš„ä¼°è®¡å€¼</strong></font>ï¼Œ8æ˜¯åˆ†å¸ƒæ ‡å‡†åå·®ã€‚ä¸€èˆ¬è€ƒè™‘æ¯”å¯¹ä¸Šå»çš„pairæ•°ç›®å’ŒSDå€¼ã€‚è‹¥pairå¯¹æ•°å¾ˆå¤šä¸”SDå€¼å¾ˆå°ï¼Ÿï¼ˆå°ç‰‡æ®µæ–‡åº“æ•°æ®ä¸è¶…è¿‡ä¸‰ä½æ•°ï¼Œå¤§ç‰‡æ®µæ–‡åº“æ•°æ®ä¸è¶…è¿‡500ï¼‰ï¼Œ<font color="green">ä¸€èˆ¬å¯å°†é…ç½®æ–‡ä»¶ä¸­</font></strong>æ–‡åº“æ’å…¥ç‰‡æ®µå€¼ä¿®æ”¹</strong>ä¸ºå¯¹çŸ­æ’å…¥ç‰‡æ®µæ–‡åº“ï¼ˆ&lt;1kï¼‰çš„å¤§å°<strong>ä¼°è®¡å€¼<strong>ï¼Œä¸‹æ¬¡</strong>ç»„è£…<strong>ä»¥åŠ</strong>è¡¥æ´<strong>æ—¶åº”æ ¹æ®ä¼°è®¡å€¼å¯¹åŸé…ç½®æ–‡ä»¶ä¸­çš„</strong>insertsizeä¿®æ­£**ã€‚å¯¹äºå¤§ç‰‡æ®µæ–‡åº“ï¼ˆ&gt;=2Kï¼‰ï¼Œå› ä¸ºæ˜¯æŠŠreads mapåˆ°contigä¸Šï¼Œè‹¥æœ€é•¿contigè¾ƒçŸ­ï¼Œå¯èƒ½æ‰¾ä¸åˆ°æˆpairæ¯”å¯¹ä¸Šå»çš„readsï¼Œæ— æ³•ä¼°è®¡æ–‡åº“å¤§å°ï¼Œéœ€è¦è‡ªå·±å°†å¤§ç‰‡æ®µä¸€çº§ä¸€çº§çš„mapåˆ°å‰ä¸€çº§çš„ç»„è£…ç»“æœä¸Šï¼Œç„¶åå†åˆ†æå¤§ç‰‡æ®µæ–‡åº“çš„æ’å…¥ç‰‡æ®µå¤§å°ã€‚æ³¨ï¼Œ</strong>éœ€è¦è°ƒæ•´insertsizeæ—¶ï¼Œåªéœ€ä¿®æ”¹* .peGradsæ–‡ä»¶ä¸­ç¬¬ä¸€åˆ—ï¼Œååˆ é™¤*.linksæ–‡ä»¶ï¼Œé‡è·‘scaffå³å¯*<em>ã€‚å³æ„å»ºscaffoldæ—¶ï¼Œä¸»è¦æ˜¯æ ¹æ®</em>.linksæ–‡ä»¶çš„ä¿¡æ¯è¿›è¡Œè¿æ¥ã€‚<br>Cutoff for number of pairs to make a reliable connection: 3<br>1124104 weak connects removed (there were 4773564 active cnnects))<br>Cutoff for numberæ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾çš„pair_num_cutoffå€¼ï¼Œweak connectsæ˜¯ä½äºè¿™ä¸ªå€¼è¢«è®¤å®šä¸ºæ— æ•ˆçš„è¿æ¥æ•°ï¼Œactive connectsæ˜¯æ»¡è¶³cutoffçš„è¿æ¥æ•°ï¼Œæ ¹æ®è¿™ä¸ªæ•°å€¼å¯å¯¹pair_num_cutoffåšè°ƒæ•´<br>Picked  25241 subgraphs,4 have conflicting connections<br>conflicting connections æ˜¯è¡¨ç¤ºæ„å»ºscaffoldæ—¶çš„çŸ›ç›¾æ•°ï¼ŒçŸ›ç›¾æ•°æ¯”è¾ƒé«˜ï¼ˆ&gt;100ï¼‰æ—¶ï¼Œå¯æ ¹æ®å‰é¢çš„æœ‰æ•ˆè¿æ¥æ•°ï¼Œé€‚å½“æé«˜pair_num_cutoffå€¼ï¼Œå³æé«˜scaffoldè¿æ¥è¦æ±‚çš„æœ€å°‘å…³ç³»æ•°<br>182483 scaffolds&amp;singleton sum up 1990259817bp, with average length 10906<br>the longest is 6561520bp,scaffold N50 is 836795 bp, scaffold N90 is 157667 bp<br>scaffold ç»Ÿè®¡ä¿¡æ¯ï¼Œå°†æ˜¯æ ¹æ®rankåˆ†æ¢¯åº¦çš„ç»Ÿè®¡<br>Done with 13301 scaffolds, 2161915 gaps finished, 2527441 gaps overall<br><strong>-F å‚æ•°è¡¥æ´çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</strong></p>
<blockquote>
<p>å‘ç°scafstatistics æ–‡ä»¶ä¸­çš„sca N50æ˜¯æ•´ä¸ªscafSeqæ–‡ä»¶ä¸­çš„N50ï¼ˆåŒ…æ‹¬ä¸å­˜åœ¨äºscafå†…çš„contigï¼‰ã€‚logæ–‡ä»¶ä¸­çš„sca N50åªåŒ…æ‹¬scaf ä¸­çš„N50.</p>
<p>sacf.seqä¸­å¯èƒ½æœ‰Nï¼Œä¹Ÿå¯èƒ½æ— Nã€‚å¤§éƒ¨åˆ†æœ‰</p>
<p>gap finishï¼Ÿ</p>
</blockquote>
<h1 id="å‚æ•°è°ƒæ•´"><a href="#å‚æ•°è°ƒæ•´" class="headerlink" title="å‚æ•°è°ƒæ•´"></a>å‚æ•°è°ƒæ•´</h1><p>ç»„è£…æ—¶éœ€è°ƒæ•´çš„å‚æ•°ï¼Œä¸»è¦åˆ†ä¸¤ç§ï¼š</p>
<p>ä¸€ç§æ˜¯è„šæœ¬ä¸­å‚æ•°æ”¹åŠ¨ï¼šå¦‚è°ƒæ•´  -K  -R  -d  -D  -M<br>-K å€¼ä¸€èˆ¬ä¸åŸºå› ç»„çš„ç‰¹æ€§å’Œæ•°æ®é‡ç›¸å…³ï¼Œç›®å‰ç”¨åˆ°çš„SOAPdenovoè½¯ä»¶ä¸»è¦æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒSOAPdenovo-63meræ˜¯å¯ä½¿ç”¨å¤§kmerç»„è£…ï¼ŒKå€¼èŒƒå›´13-63ã€‚<br>ã€<strong>ç»éªŒ</strong>ã€‘ï¼šæ¤ç‰©åŸºå› ç»„ç»„è£…é‡‡ç”¨å¤§kmeræ•ˆæœä¼šæ¯”è¾ƒå¥½ï¼ˆè¦æ±‚çŸ­ç‰‡æ®µreadsé•¿åº¦75bpï¼‰ï¼ŒåŠ¨ç‰©åŸºå› ç»„å¾ˆå°‘æœ‰ç”¨åˆ°å¤§kmeråæœ‰æ˜æ˜¾æ”¹è¿›æ•ˆæœçš„ï¼Œä¸”<strong>åŠ¨ç‰©åŸºå› ç»„ç»„è£…Kå€¼ä¸€èˆ¬è®¾ç½®ä¸º27å’Œ29è¾ƒå¤š</strong>ã€‚</p>
<p><font color="red"><strong>ç»„è£…æ‚åˆå­åŸºå› ç»„çš„K-merå€¼åº”è¯¥å°ä¸€ç‚¹ï¼›ç»„è£…å«æœ‰é«˜repeatsåŸºå› ç»„ä¸”è¦æ±‚å…¶æœ‰é«˜çš„æµ‹åºæ·±åº¦å’Œé•¿çš„reads,çš„K-meråº”è¯¥å¤§ä¸€ç‚¹ã€‚</strong></font></p>
<p>-Rå‚æ•°ï¼Œå¯¹äº<font color="green">åŠ¨ç‰©åŸºå› ç»„Rå‚æ•°ä¸€èˆ¬ä¸è®¾ç½®</font>ï¼Œ<font color="red"><strong>æ¤ç‰©åŸºå› ç»„</strong>ç”±äº<strong>è¾ƒå¤šçš„repeatåŒº</strong>åˆ™<strong>è®¾ç½®Rå‚æ•°</strong>åæ•ˆæœæ›´å¥½</font>ã€‚æ³¨æ„<strong>è®¾ç½®-Ræ—¶ï¼Œä¸€èˆ¬ä½¿ç”¨-M çš„é»˜è®¤å€¼</strong>ã€‚ï¼ˆç†ŠçŒ«åŸºå› ç»„ç»„è£…æ—¶å¾—å‡ºçš„ç»“è®ºï¼‰</p>
<p>-M å‚æ•°ï¼Œ0-3,<strong>é»˜è®¤å€¼1</strong>ã€‚ä¸€èˆ¬æ‚åˆç‡ä¸ºåƒåˆ†ä¹‹å‡ å°±è®¾ä¸ºå‡ ã€‚ç†ŠçŒ«åŸºå› ç»„ç»„è£…æ—¶-M 2 ã€‚</p>
<p>-d å‚æ•°ï¼Œå¯¹äºæ²¡æœ‰çº é”™ï¼Œæ²¡æœ‰å¤„ç†çš„è´¨é‡åˆè¾ƒå·®çš„åŸå§‹æ•°æ®ï¼Œkmeré¢‘æ•°ä¸º1æ•°æ®è¾ƒå¤šçš„ç»„è£…ï¼Œ<font color="red"><strong>è®¾ç½®ä¸º-d 1 è¶³å¤Ÿ</strong></font>ã€‚å¯¹äºå¤„ç†è¿‡æˆ–æ˜¯æµ‹åºè´¨é‡è¾ƒå¥½æ•°æ®å¯ä¸è®¾ç½®ã€‚æ•°æ®é‡è¾ƒå¤šæ—¶ï¼Œä¹Ÿå¯è®¾ç½®-d å»é™¤éƒ¨åˆ†è´¨é‡ç¨å·®æ•°æ®ã€‚</p>
<p>-D å‚æ•°ï¼Œé»˜è®¤ä¸º1ï¼Œä¸€èˆ¬ä¸ç”¨å¦è¡Œè®¾ç½®ã€‚</p>
<p>ç¬¬äºŒç§ï¼Œä»<strong>map</strong>è¿‡ç¨‹å»è°ƒèŠ‚å‚æ•°ã€‚å¯ä»¥<font color="red"> è°ƒæ•´é…ç½®æ–‡ä»¶map_lençš„å€¼å’Œè°ƒæ•´æ–‡ä»¶ * .peGrads  </font>ã€‚<br>å½“<strong>æ–‡åº“æ’å…¥ç‰‡æ®µåˆ†å¸ƒå›¾</strong>ä¸­æ–‡åº“å¤§å°ä¸<strong>å®éªŒç»™å‡ºçš„æ–‡åº“å¤§å°</strong><font color="red">å·®å¼‚å¾ˆå¤§</font>ï¼Œ<font color="red"><em><em>è°ƒæ•´</em>.peGrad</em>*s</font>æ–‡ä»¶ä¸­çš„æ’å…¥ç‰‡æ®µå¤§å°ã€‚</p>
<p>æ ¹æ®æ¯ä¸€æ¡£æ•°æ®çš„æ•°æ®é‡å»è°ƒæ•´æ–‡åº“çš„<strong>rankç­‰çº§</strong>ã€‚</p>
<p>å½“è¯¥æ–‡åº“çš„æ•°æ®é‡å¾ˆå¤šæˆ–è€…æ˜¯åœ¨æ„å»ºscaffoldçš„è¿‡ç¨‹ä¸­çš„å†²çªæ•°å¾ˆå¤šæ—¶ï¼Œå¯æ˜¯é€‚å½“çš„è°ƒå¤§ç¬¬å››åˆ—çš„<strong>pair_num_cutoff</strong>ï¼ŒæŠŠæ¡ä»¶è®¾ç½®çš„æ›´ä¸¥ã€‚</p>
<h1 id="å†…å­˜ä¼°è®¡"><a href="#å†…å­˜ä¼°è®¡" class="headerlink" title="å†…å­˜ä¼°è®¡"></a>å†…å­˜ä¼°è®¡</h1><p>SOAPdenovoå››ä¸ªæ­¥éª¤æ¶ˆè€—çš„å†…å­˜ä¸ä¸€æ ·</p>
<p>ç¬¬ä¸€æ­¥æ¶ˆè€—å†…å­˜æœ€å¤šï¼Œä½¿ç”¨æ²¡æœ‰çº é”™çš„çš„readsï¼Œ(<font color="blue"> <strong>K&lt;=31**</strong></font>)ç¬¬ä¸€æ­¥æ¶ˆè€—çš„å†…å­˜åœ¨<font color="blue"><strong>åŸºå› ç»„å¤§å°80ï¼100å€</strong>å·¦å³</font>ï¼Œ<font color="blue">çº è¿‡é”™åœ¨40ï¼50å€**å·¦å³</font></p>
<p>ç¬¬äºŒæ­¥ç›¸å¯¹æ¶ˆè€—å†…å­˜ä¼šå°‘å¾ˆå¤š</p>
<p>ç¬¬ä¸‰æ­¥æ¶ˆè€—å†…å­˜ä»…æ¬¡äºç¬¬ä¸€æ­¥ï¼Œåœ¨ç¬¬ä¸€æ­¥çš„ä¸€åŠå·¦å³</p>
<p>ç¬¬å››æ­¥æ¶ˆè€—çš„å†…å­˜ä¹Ÿä¼šæ¯”è¾ƒå°‘</p>
<p>å¯¹äºCPUçš„ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯8ä¸ªï¼Œå¦‚æœç”³è¯·å†…å­˜æ—¶ç”³è¯·ä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹çš„æ‰€æœ‰å†…å­˜, CPUå°±è®¾ç½®ä¸ºè¯¥è®¡ç®—èŠ‚ç‚¹çš„CPUä¸ªæ•°å……åˆ†åˆ©ç”¨è®¡ç®—èµ„æºï¼Œå¦‚æœä»…ç”³è¯·ä¸€ä¸ªèŠ‚ç‚¹çš„éƒ¨åˆ†å†…å­˜åˆ™æ ¹æ®å®é™…æƒ…å†µè€ƒè™‘ã€‚</p>
<p>å¯¹äº<font color="blue"><strong>å¤§kemr(K&gt;31)</strong></font>å…¶å†…å­˜ä½¿ç”¨æ˜¯<font color="blue">**(k&lt;=31)**</font>çš„<font color="blue"><strong>1.5å€</strong></font>å·¦å³ï¼Œæœ‰æ—¶ç”šè‡³æ›´å¤šï¼Œè¦å……åˆ†ä¼°è®¡å†…å­˜ä½¿ç”¨ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶è€ƒè™‘ä¸èƒ½å¤ªä¿å®ˆã€‚</p>
<h1 id="å¸¸è§é”™è¯¯"><a href="#å¸¸è§é”™è¯¯" class="headerlink" title="å¸¸è§é”™è¯¯"></a>å¸¸è§é”™è¯¯</h1><p>1ï¼‰é…ç½®æ–‡ä»¶readså­˜å‚¨è·¯å¾„é”™è¯¯<br>åªè¾“å‡ºæ—¥å¿—æ–‡ä»¶ã€‚<br>pregraph.logä¸­çš„é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open /path/LIBNAMEA/fastq_read_1.fq. Now exit to systemâ€¦â€<br>2ï¼‰-g åæ‰€è·Ÿå‚æ•°ä¸pregraphï¼ˆç¬¬ä¸€æ­¥ï¼‰ -o  åæ‰€è·Ÿå‚æ•°åä¸ä¸€è‡´ã€**-oå¯¹åº”åé¢çš„-g**ã€‘<br>contig  map  scaff è¿™ä¸‰ä¸ªæ­¥éª¤éƒ½åªæ˜¯è¾“å‡ºæ—¥å¿—æ–‡ä»¶ã€‚<br><font color="green">contig.log</font>é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open *.preGraphBasic. Now exit to systemâ€¦â€<br><font color="green">map.log</font>é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open *.contig. Now exit to systemâ€¦â€<br><font color="green">scaff.log</font>é”™è¯¯ä¿¡æ¯ï¼šâ€œCannot open *.preGraphBasic. Now exit to systemâ€¦â€<br>3ï¼‰<font color="blue">ä»mapå¼€å§‹é‡æ–°è·‘æ—¶ï¼Œéœ€è¦åˆ é™¤ *.linksæ–‡ä»¶</font>ï¼Œå¦åˆ™ä¼šç”Ÿæˆcoreæ–‡ä»¶ï¼Œç¨‹åºé€€å‡ºã€‚</p>
<hr>
<h1 id="Github-Readme-md"><a href="#Github-Readme-md" class="headerlink" title="Github-Readme.md"></a>Github-Readme.md</h1><h2 id="Configuration-file"><a href="#Configuration-file" class="headerlink" title="Configuration file"></a>Configuration file</h2><p>For big genome projects with deep sequencing, <font color="red">the data is usually organized as <strong>multiple read sequence files</strong> generated from <strong>multiple libraries</strong></font>. The configuration file: where? information? example.config</p>
<p>The configuration file has a section for <font color="red"><strong>global information</strong></font>, and then <font color="red"><strong>multiple library sections</strong></font>. Right now only â€œmax_rd_lenâ€ is included in the global information section. Any read longer than max_rd_len will be cut to this length.</p>
<p>The library information and the information of sequencing data generated from the library should be organized in the corresponding library section. <font color="red"><strong>Each library section starts with tag [LIB]</strong></font> and includes the following items:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-avg_ins</span><br><span class="line">-reverse_seq</span><br><span class="line">-asm_flags</span><br><span class="line">-rd_len_cutof</span><br><span class="line">-rank</span><br><span class="line">-pair_num_cutoff</span><br><span class="line">-map_len</span><br></pre></td></tr></table></figure>



<p>The assembler accepts read file in three kinds of formats: <font color="green">FASTA, FASTQ and BAM</font>. Mate-pair relationship could be indicated in two ways: two sequence files with reads in the same order belonging to a pair, or two adjacent reads in a single file (FASTA only) belonging to a pair. If a read in <strong>bam</strong> file <strong>fails</strong> platform/vendor <strong>quality checks</strong>(the flag field 0x0200 is set), itself and itâ€™s <strong>paired read</strong> would be <strong>ignored</strong>.</p>
<p>All the above items in each library section are optional. The assembler assigns default values for most of them. <strong>If you are not sure how to set a parameter, you can remove it from your configuration file</strong>.</p>
<h2 id="Get-started"><a href="#Get-started" class="headerlink" title="Get started"></a>Get started</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;one step&quot;</span></span><br><span class="line">SOAPdenvo all -s config_file -K 63 -R -o graph_prefix 1&gt;ass.log 2&gt;ass.err</span><br><span class="line"><span class="comment">#-R            åˆ©ç”¨readé‰´åˆ«çŸ­çš„é‡å¤åºåˆ—ï¼Œé»˜è®¤å€¼ä¸è¿›è¡Œæ­¤æ“ä½œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#step by step </span></span><br><span class="line"><span class="string">&quot;step1:&quot;</span></span><br><span class="line">SOAPdenvo pregraph -s config_file -K 63 -R -o graph_prefix 1&gt;pregraph.log 2&gt;pregraph.err</span><br><span class="line"><span class="string">&quot;OR&quot;</span></span><br><span class="line">SOAPdenvo sparse_pregraph -s config_file -K 63 -z 5000000000 -R -o graph_prefix 1&gt;pregraph.log 2&gt;pregraph.err</span><br><span class="line"><span class="comment">#-z genomize(required):estimated genome size</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;step2:&quot;</span></span><br><span class="line">SOAPdenvo contig -g graph_prefix -R 1&gt;contig.log 2&gt;contig.err</span><br><span class="line"><span class="comment">#-g    STR     è¾“å…¥æ–‡ä»¶çš„æ–‡ä»¶åå‰ç¼€</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;step3:&quot;</span></span><br><span class="line">SOAPdenvo map -s config_file -g graph_prefix 1&gt;map.log 2&gt;map.err</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;step4:&quot;</span></span><br><span class="line">SOAPdenvo scaff -g graph_prefix -F 1&gt;scaff.log 2&gt;scaff.err</span><br><span class="line"><span class="comment">#-F            åˆ©ç”¨readå¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤ä¸æ‰§è¡Œ       </span></span><br></pre></td></tr></table></figure>



<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><h3 id="Options-for-all-pregraph-contig-map-scaff"><a href="#Options-for-all-pregraph-contig-map-scaff" class="headerlink" title="Options for all (pregraph-contig-map-scaff)"></a>Options for all (<font color="red">pregraph-contig-map-scaff</font>)</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;-s&quot;</span>    configFile: the config file of solexa reads</span><br><span class="line"><span class="string">&quot;-o&quot;</span>     outputGraph: prefix of <span class="string">&quot;output graph file name&quot;</span></span><br><span class="line"><span class="string">&quot;-K&quot;</span>        kmer(min 13, max 63/127): kmer size, [23]</span><br><span class="line"><span class="string">&quot;-p&quot;</span>        n_cpu: number of cpu <span class="keyword">for</span> use, [8]</span><br><span class="line"><span class="string">&quot;-a?&quot;</span>        initMemoryAssumption: memory assumption initialized to avoid further reallocation, unit G, [0]</span><br><span class="line"><span class="string">&quot;-d&quot;</span>        KmerFreqCutoff: kmers with frequency no larger than KmerFreqCutoff will be deleted, [0]	INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„k-merï¼Œé»˜è®¤å€¼ä¸º0</span><br><span class="line"><span class="string">&quot;-R&quot;</span> (optional)  resolve repeats by reads, [NO]</span><br><span class="line"><span class="string">&quot;-D&quot;</span>        EdgeCovCutoff: edges with coverage no larger than EdgeCovCutoff will be deleted, [1]	INT     å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼çš„ç”±k-merè¿æ¥çš„è¾¹ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œå³è¯¥è¾¹ä¸Šæ¯ä¸ªç‚¹çš„é¢‘æ•°éƒ½å°äºç­‰äº1æ—¶æ‰å»é™¤</span><br><span class="line"><span class="string">&quot;-M&quot;</span>        mergeLevel(min 0, max 3): the strength of merging similar sequences during contiging, [1]	INT     è¿æ¥contigæ—¶åˆå¹¶ç›¸ä¼¼åºåˆ—çš„ç­‰çº§ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œæœ€å¤§å€¼3ã€‚</span><br><span class="line">-m        max k when using multi kmer</span><br><span class="line">-e        weight to filter arc when linearize two edges(default 0)</span><br><span class="line">-r (optional)  keep available <span class="built_in">read</span>(*.<span class="built_in">read</span>)</span><br><span class="line">-E (optional)  merge clean bubble before iterate</span><br><span class="line">-f (optional)  output gap related reads <span class="keyword">in</span> map step <span class="keyword">for</span> using SRkgf to fill gap, [NO]</span><br><span class="line">-k        kmer_R2C(min 13, max 63): kmer size used <span class="keyword">for</span> mapping <span class="built_in">read</span> to contig, [K]</span><br><span class="line">-F (optional)  fill gaps <span class="keyword">in</span> scaffold, [NO]åˆ©ç”¨<span class="built_in">read</span>å¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤ä¸æ‰§è¡Œ</span><br><span class="line">-u (optional)  un-mask contigs with high/low coverage before scaffolding, [mask]æ„å»ºscaffoldå‰ä¸å±è”½é«˜è¦†ç›–åº¦çš„contigï¼Œè¿™é‡Œé«˜é¢‘ç‡è¦†ç›–åº¦æŒ‡å¹³å‡contigè¦†ç›–æ·±åº¦çš„2å€ã€‚é»˜è®¤å±è”½</span><br><span class="line">-w (optional)  keep contigs weakly connected to other contigs <span class="keyword">in</span> scaffold, [NO]</span><br><span class="line">-G        gapLenDiff: allowed length difference between estimated and filled gap, [50]INT     ä¼°è®¡gapçš„å¤§å°å’Œå®é™…è¡¥gapçš„å¤§å°çš„å·®å¼‚ï¼Œé»˜è®¤å€¼ä¸º50bpã€‚</span><br><span class="line">-L        minContigLen: shortest contig <span class="keyword">for</span> scaffolding, [K+2]ç”¨äºæ„å»ºscaffoldçš„contigçš„æœ€çŸ­é•¿åº¦ï¼Œé»˜è®¤ä¸ºï¼šKmerå‚æ•°å€¼ Ã—2</span><br><span class="line">-c      minContigCvg: <span class="string">&quot;minimum contig coverage&quot;</span> (c*avgCvg), contigs shorter than 100bp with coverage smaller than c*avgCvg will be masked before scaffolding unless -u is <span class="built_in">set</span>, [0.1]</span><br><span class="line">-C      maxContigCvg: <span class="string">&quot;maximum contig coverage&quot;</span> (C*avgCvg), contigs with coverage larger than C*avgCvg or contigs shorter than 100bp with coverage larger than 0.8*C*avgCvg will be masked before scaffolding unless -u is <span class="built_in">set</span>, [2]</span><br><span class="line">-b      insertSizeUpperBound: (b*avg_ins) will be used as upper bound of insert size <span class="keyword">for</span> large insert size ( &gt; 1000) when handling pair-end connections between contigs <span class="keyword">if</span> b is <span class="built_in">set</span> to larger than 1, [1.5]</span><br><span class="line">-B      bubbleCoverage: remove contig with lower cvoerage <span class="keyword">in</span> bubble structure <span class="keyword">if</span> both contigs<span class="string">&#x27; coverage are smaller than bubbleCoverage*avgCvg, [0.6]</span></span><br><span class="line"><span class="string">-N        genomeSize: genome size for statistics, [0]</span></span><br><span class="line"><span class="string">-V (optional)  output visualization information of assembly, [NO]</span></span><br></pre></td></tr></table></figure>

<h3 id="Options-for-sparse-pregraph"><a href="#Options-for-sparse-pregraph" class="headerlink" title="Options for sparse_pregraph"></a>Options for sparse_pregraph</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Usage: ./SOAPdenovo2 sparse_pregraph -s configFile -K kmer -z genomeSize -o outputGraph [-g maxKmerEdgeLength -d kmerFreqCutoff -e kmerEdgeFreqCutoff -R -r runMode -p n_cpu]</span><br><span class="line">  -s      configFile: the config file of solexa reads</span><br><span class="line">  -K         kmer(min 13, max 63/127): kmer size, [23]</span><br><span class="line">  -g         maxKmerEdgeLength(min 1, max 25): number of skipped intermediate kmers, [15]</span><br><span class="line">  <span class="string">&quot;-z&quot;</span>         genomeSize(mandatory): estimated genome size</span><br><span class="line">  <span class="string">&quot;-d&quot;</span>         kmerFreqCutoff: delete kmers with frequency no larger than,[1]</span><br><span class="line">  -e         kmerEdgeFreqCutoff: delete kmers<span class="string">&#x27; related edge with frequency no larger than [1]</span></span><br><span class="line"><span class="string">  -R (optional)   output extra information for resolving repeats in contig step, [NO]</span></span><br><span class="line"><span class="string">  -r         runMode: 0 build graph &amp; build edge and preArc, 1 load graph by prefix &amp; build edge and preArc, 2 build graph only, 3 build edges only, 4 build preArcs only [0]</span></span><br><span class="line"><span class="string">  &quot;-p&quot;         n_cpu: number of cpu for use,[8]</span></span><br><span class="line"><span class="string">  -o         outputGraph: prefix of output graph file name</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">contigsï¼š</span><br><span class="line">      -g  &lt;string&gt;      è¾“å…¥graph fileæ–‡ä»¶åå‰ç¼€ </span><br><span class="line">    -R  (optional)    ç§»é™¤repeatsï¼Œä½¿ç”¨pregraphæ­¥éª¤ä¸­äº§ç”Ÿçš„ç»“æœï¼Œå¦‚æœå‚æ•°-Råœ¨pregraphæ­¥éª¤ä¸­è¢«è®¾ç½®çš„è¯ï¼Œé»˜è®¤[NO]</span><br><span class="line">    -D  &lt;int&gt;         å»é™¤é¢‘æ•°ä¸å¤§äºè¯¥å€¼ï¼ˆedgeCovCutoffï¼‰çš„ç”±k-merè¿æ¥çš„è¾¹ï¼Œé»˜è®¤å€¼[1]ï¼Œå³è¯¥è¾¹ä¸Šæ¯ä¸ªç‚¹çš„é¢‘æ•°éƒ½å°äºç­‰äº1æ—¶æ‰å»é™¤ã€‚edges with coverage no larger than EdgeCovCutoff will be deleted, [1] <span class="comment">#æœ€å°åŒ–é”™è¯¯æµ‹åºå¸¦æ¥çš„å½±å“</span></span><br><span class="line">    -M  &lt;int&gt;         åœ¨contigingæ“ä½œæ—¶ï¼Œåˆå¹¶ç›¸ä¼¼åºåˆ—çš„å¼ºåº¦ï¼Œé»˜è®¤å€¼ä¸º[1]ï¼Œæœ€å°å€¼0ï¼Œæœ€å¤§å€¼3ã€‚<span class="comment">#deal with heterozygosis</span></span><br><span class="line">    -e  &lt;int&gt;         ä¸¤è¾¹ç¼˜ä¹‹é—´çš„å¼§çš„æƒé‡å¤§äºè¯¥å€¼ï¼ˆarcWeightï¼‰ï¼Œå°†è¢«çº¿æ€§åŒ–ï¼Œé»˜è®¤å€¼[0]</span><br><span class="line">    -m  &lt;int&gt;         æœ€å¤§çš„kmer sizeï¼ˆmax 127ï¼‰ç”¨äºmulti-kmerï¼Œé»˜è®¤[NO]</span><br><span class="line">    -E  (optional)    åœ¨iterateè¿­ä»£ä¹‹å‰ï¼Œåˆå¹¶clean bubbleåŠŸèƒ½ï¼Œä»…åœ¨å½“ä½¿ç”¨multi-kmeræ—¶ä¸”è®¾ç½®-Må‚æ•°ï¼Œé»˜è®¤[NO]</span><br><span class="line"> </span><br><span class="line">mapï¼š</span><br><span class="line">    -g  &lt;string&gt;      è¾“å…¥graph fileæ–‡ä»¶åå‰ç¼€ </span><br><span class="line">    -k  &lt;int&gt;         è¯¥å€¼ï¼ˆkmer_R2Cï¼‰æ˜¯kmer sizeç”¨äºmapping readsåˆ°contigsä¸Šæ—¶çš„å€¼ï¼Œé»˜è®¤å€¼[K]</span><br><span class="line">    -f  (optional)    åœ¨mapé‚£ä¸€æ­¥ä¸­ï¼Œå¯¹äºä½¿ç”¨SRkgfå»å¡«å……gapï¼Œè¾“å‡ºä¸gapç›¸å…³çš„reads,é»˜è®¤[NO]</span><br><span class="line"> </span><br><span class="line">scaffoldï¼š</span><br><span class="line">      -F  (optional)    åˆ©ç”¨<span class="built_in">read</span>å¯¹scaffoldä¸­çš„gapè¿›è¡Œå¡«è¡¥ï¼Œé»˜è®¤[NO]</span><br><span class="line">    -u  (optional)    æ„å»ºscaffoldingå‰ä¸å±è”½é«˜/ä½è¦†ç›–åº¦çš„contigsï¼Œè¿™é‡Œé«˜é¢‘ç‡è¦†ç›–åº¦æŒ‡å¹³å‡contigè¦†ç›–æ·±åº¦çš„2å€ã€‚é»˜è®¤[mask]å±è”½</span><br><span class="line">    -w  (optional)    åœ¨scaffoldä¸­ï¼Œä¿æŒcontigså¼±è¿æ¥äºå…¶ä»–contigsï¼Œé»˜è®¤[NO]</span><br><span class="line">    -G  &lt;int&gt;         ä¼°è®¡gapçš„å¤§å°å’Œå®é™…è¡¥gapçš„å¤§å°çš„å·®å¼‚å€¼ï¼Œé»˜è®¤å€¼[50]bpã€‚</span><br><span class="line">    -L  &lt;int&gt;         ç”¨äºæ„å»ºscaffoldçš„contigçš„æœ€çŸ­é•¿åº¦(minContigLen)ï¼Œé»˜è®¤ä¸ºï¼š[Kmerå‚æ•°å€¼+2]</span><br><span class="line">    -c  &lt;<span class="built_in">float</span>&gt;       åœ¨scaffoldingä¹‹å‰ï¼Œcontigså°äº100bpï¼Œä¸”è¦†ç›–ç‡å°äºè¯¥æœ€å°contigè¦†ç›–ç‡ï¼ˆc*avgCvgï¼‰ï¼Œå°†è¢«å±è”½ï¼Œé™¤éå‚æ•°-uå·²è®¾å®šï¼Œé»˜è®¤å€¼[0.1]</span><br><span class="line">    -C  &lt;<span class="built_in">float</span>&gt;       åœ¨scaffoldingä¹‹å‰ï¼Œcontigsè¦†ç›–ç‡å¤§äºè¯¥æœ€å¤§contigsè¦†ç›–ç‡ï¼ˆC*avgCvgï¼‰ï¼Œæˆ–è€…contigså°äº100bpä¸”è¦†ç›–ç‡å¤§äº0.8*ï¼ˆC*avgCvgï¼‰ï¼Œå°†è¢«å±è”½ï¼Œé™¤éå‚æ•°-uå·²è®¾å®šï¼Œé»˜è®¤å€¼[2]</span><br><span class="line">    -b  &lt;<span class="built_in">float</span>&gt;       å½“å¤„ç†contigsé—´çš„pair-endè¿æ¥æ—¶ï¼Œå¦‚æœå‚æ•°-b&gt;1ï¼Œè¯¥æ’å…¥ç‰‡æ®µçš„ä¸Šé™å€¼ï¼ˆb*avg_insï¼‰å°†è¢«ç”¨æ¥ä½œä¸ºå¤§çš„æ’å…¥ç‰‡æ®µï¼ˆ&gt;1000ï¼‰çš„ä¸Šé™ï¼Œé»˜è®¤å€¼[1.5]</span><br><span class="line">    -B  &lt;<span class="built_in">float</span>&gt;       å¦‚æœä¸¤ä¸ªcontigsçš„è¦†ç›–ç‡éƒ½å°äºbubbleè¦†ç›–ç‡ï¼ˆbubbleCoverageï¼‰ä¹˜ä»¥contigså¹³å‡è¦†ç›–ç‡ï¼ˆbubbleCoverage*avgCvgï¼‰ï¼Œåˆ™å»é™¤åœ¨bubbleç»“æ„ä¸­çš„ä½è¦†ç›–ç‡contigï¼Œé»˜è®¤å€¼[0.6]</span><br><span class="line">    -N  &lt;int&gt;         ç»Ÿè®¡åŸºå› ç»„å¤§å°ï¼Œé»˜è®¤å€¼[0]</span><br><span class="line">    -V  (optional)    è¾“å‡ºç›¸å…³ä¿¡æ¯ä¸ºäº†å¯è§†åŒ–ç»„è£…ï¼Œé»˜è®¤[NO]</span><br></pre></td></tr></table></figure>



<h2 id="Output-files"><a href="#Output-files" class="headerlink" title="Output files"></a>Output files</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">a. <span class="string">&quot;*.contig&quot;</span></span><br><span class="line">  contig sequences without using mate pair information.</span><br><span class="line">b. <span class="string">&quot;*.scafSeq&quot;</span></span><br><span class="line">  scaffold sequences (final contig sequences can be extracted by breaking down scaffold sequences at gap regions).</span><br></pre></td></tr></table></figure>



<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="How-to-set-K-mer-size"><a href="#How-to-set-K-mer-size" class="headerlink" title="How to set K-mer size?"></a>How to set K-mer size?</h3><p>The program accepts odd numbers between 13 and 31? <strong>Larger K-mers would have higher rate of uniqueness in the genome and would make the graph simpler, but it requires deep sequencing depth and longer read length to guarantee the overlap at any genomic location.</strong> <font color="red"><strong>Balance?</strong></font></p>
<p>The <strong>sparse_pregraph</strong> module usually needs <strong>2-10bp smaller kmer</strong> length to achieve the same performance as the original <strong>pregraph</strong> module. <font color="red"><strong>Difference?</strong></font></p>
<h3 id="How-to-set-genome-size-z-for-sparse-pregraph-module"><a href="#How-to-set-genome-size-z-for-sparse-pregraph-module" class="headerlink" title="How to set genome size(-z) for sparse_pregraph module?"></a>How to set genome size(-z) for sparse_pregraph module?</h3><p>The -z parameter for sparse pregraph should be set <font color="red"><strong>a litter larger than the real genome size</strong></font>, it is used to allocate memory.</p>
<h3 id="How-to-set-library-rank"><a href="#How-to-set-library-rank" class="headerlink" title="How to set library rank?"></a>How to set library rank?</h3><p>SOAPdenovo will <font color="red">use the <strong>pair-end libraries</strong> with <strong>insert size</strong> from <strong>smaller to larger</strong> to <strong>construct</strong> scaffolds</font>. Libraries with the same rank would be used at the same time. For example, in a dataset of a human genome, we set <strong><font color="red">five ranks</font> for five libraries with insert size 200-bp, 500-bp, 2-Kb, 5-Kb and 10-Kb</strong>, separately. It is desired that the pairs in each rank provide adequate physical coverage of the genome.</p>
<h2 id="APPENDIX-A-an-example-config"><a href="#APPENDIX-A-an-example-config" class="headerlink" title="APPENDIX A: an example.config"></a>APPENDIX A: an example.config</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#maximal read length</span></span><br><span class="line">max_rd_len=100</span><br><span class="line"><span class="string">&quot;[LIB]&quot;</span></span><br><span class="line"><span class="comment">#average insert size</span></span><br><span class="line">avg_ins=200</span><br><span class="line"><span class="comment">#if sequence needs to be reversed</span></span><br><span class="line">reverse_seq=0</span><br><span class="line"><span class="comment">#in which part(s) the reads are used</span></span><br><span class="line">asm_flags=3</span><br><span class="line"><span class="comment">#use only first 100 bps of each read</span></span><br><span class="line">rd_len_cutoff=100</span><br><span class="line"><span class="comment">#in which order the reads are used while scaffolding</span></span><br><span class="line">rank=1</span><br><span class="line"><span class="comment"># cutoff of pair number for a reliable connection (at least 3 for short insert size)</span></span><br><span class="line">pair_num_cutoff=3</span><br><span class="line"><span class="comment">#minimum aligned length to contigs for a reliable read location (at least 32 for short insert size)</span></span><br><span class="line">map_len=32</span><br><span class="line"><span class="comment">#a pair of fastq file, read 1 file should always be followed by read 2 file</span></span><br><span class="line">q1=/path/**LIBNAMEA**/fastq1_read_1.fq</span><br><span class="line">q2=/path/**LIBNAMEA**/fastq1_read_2.fq</span><br><span class="line"><span class="comment">#another pair of fastq file, read 1 file should always be followed by read 2 file</span></span><br><span class="line">q1=/path/**LIBNAMEA**/fastq2_read_1.fq</span><br><span class="line">q2=/path/**LIBNAMEA**/fastq2_read_2.fq</span><br><span class="line"><span class="comment">#a pair of fasta file, read 1 file should always be followed by read 2 file</span></span><br><span class="line">f1=/path/**LIBNAMEA**/fasta1_read_1.fa</span><br><span class="line">f2=/path/**LIBNAMEA**/fasta1_read_2.fa</span><br><span class="line"><span class="comment">#another pair of fasta file, read 1 file should always be followed by read 2 file</span></span><br><span class="line">f1=/path/**LIBNAMEA**/fasta2_read_1.fa</span><br><span class="line">f2=/path/**LIBNAMEA**/fasta2_read_2.fa</span><br><span class="line"><span class="comment">#fastq file for single reads</span></span><br><span class="line">q=/path/**LIBNAMEA**/fastq1_read_single.fq</span><br><span class="line"><span class="comment">#another fastq file for single reads</span></span><br><span class="line">q=/path/**LIBNAMEA**/fastq2_read_single.fq</span><br><span class="line"><span class="comment">#fasta file for single reads</span></span><br><span class="line">f=/path/**LIBNAMEA**/fasta1_read_single.fa</span><br><span class="line"><span class="comment">#another fasta file for single reads</span></span><br><span class="line">f=/path/**LIBNAMEA**/fasta2_read_single.fa</span><br><span class="line"><span class="comment">#a single fasta file for paired reads</span></span><br><span class="line">p=/path/**LIBNAMEA**/pairs1_in_one_file.fa</span><br><span class="line"><span class="comment">#another single fasta file for paired reads</span></span><br><span class="line">p=/path/**LIBNAMEA**/pairs2_in_one_file.fa</span><br><span class="line"><span class="comment">#bam file for single or paired reads, reads 1 in paired reads file should always be followed by reads 2</span></span><br><span class="line"><span class="comment">#	<span class="doctag">NOTE:</span> If a read in bam file fails platform/vendor quality checks(the flag field 0x0200 is set), itself and it&#x27;s paired read would be ignored.</span></span><br><span class="line">b=/path/**LIBNAMEA**/reads1_in_file.bam</span><br><span class="line"><span class="comment">#another bam file for single or paired reads</span></span><br><span class="line">b=/path/**LIBNAMEA**/reads2_in_file.bam</span><br><span class="line"><span class="string">&quot;[LIB]&quot;</span></span><br><span class="line">avg_ins=2000</span><br><span class="line">reverse_seq=1</span><br><span class="line">asm_flags=2</span><br><span class="line">rank=2</span><br><span class="line"><span class="comment"># cutoff of pair number for a reliable connection (at least 5 for large insert size)</span></span><br><span class="line">pair_num_cutoff=5</span><br><span class="line"><span class="comment">#minimum aligned length to contigs for a reliable read location (at least 35 for large insert size)</span></span><br><span class="line">map_len=35</span><br><span class="line">q1=/path/**LIBNAMEB**/fastq_read_1.fq</span><br><span class="line">q2=/path/**LIBNAMEB**/fastq_read_2.fq</span><br><span class="line">f1=/path/**LIBNAMEA**/fasta_read_1.fa</span><br><span class="line">f2=/path/**LIBNAMEA**/fasta_read_2.fa</span><br><span class="line">p=/path/**LIBNAMEA**/pairs_in_one_file.fa</span><br><span class="line">b=/path/**LIBNAMEA**/reads_in_file.bam</span><br></pre></td></tr></table></figure>

<h2 id="Appendix-B-output-files"><a href="#Appendix-B-output-files" class="headerlink" title="Appendix B: output files"></a>Appendix B: output files</h2><h3 id="1-Output-files-from-the-command-â€œpregraphâ€"><a href="#1-Output-files-from-the-command-â€œpregraphâ€" class="headerlink" title="1. Output files from the command â€œpregraphâ€"></a>1. Output files from the command â€œpregraphâ€</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">a. *.kmerFreq</span><br><span class="line">   Each row shows the number of Kmers with a frequency equals the row number. Note that those peaks of frequencies <span class="built_in">which</span> are the integral multiple of 63 are due to the data structure.</span><br><span class="line">b. *.edge</span><br><span class="line">   Each record gives the information of an edge <span class="keyword">in</span> the pre-graph: length, Kmers on both ends, average kmer coverage, whether it<span class="string">&#x27;s reverse-complementarily identical and the sequence.</span></span><br><span class="line"><span class="string">c. *.markOnEdge &amp; *.path</span></span><br><span class="line"><span class="string">   These two files are for using reads to solve small repeats.</span></span><br><span class="line"><span class="string">e. *.preArc</span></span><br><span class="line"><span class="string">   Connections between edges which are established by the read paths.</span></span><br><span class="line"><span class="string">f. *.vertex</span></span><br><span class="line"><span class="string">   Kmers at the ends of edges.</span></span><br><span class="line"><span class="string">g. *.preGraphBasic</span></span><br><span class="line"><span class="string">   Some basic information about the pre-graph: number of vertex, K value, number of edges, maximum read length etc.</span></span><br></pre></td></tr></table></figure>

<h3 id="2-Output-files-from-the-command-â€œcontigâ€"><a href="#2-Output-files-from-the-command-â€œcontigâ€" class="headerlink" title="2. Output files from the command â€œcontigâ€"></a>2. Output files from the command â€œcontigâ€</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">a. *.contig</span><br><span class="line">      Contig information: corresponding edge index, length, kmer coverage, whether it<span class="string">&#x27;s tip and the sequence. Either a contig or its reverse complementry counterpart is included. Each reverse complementary contig index is indicated in the *.ContigIndex file.</span></span><br><span class="line"><span class="string">   b. *.Arc</span></span><br><span class="line"><span class="string">      Arcs coming out of each edge and their corresponding coverage by reads</span></span><br><span class="line"><span class="string">   c. *.updated.edge</span></span><br><span class="line"><span class="string">      Some information for each edge in graph: length, Kmers at both ends, index difference between the reverse-complementary edge and this one.</span></span><br><span class="line"><span class="string">   d. *.ContigIndex</span></span><br><span class="line"><span class="string">      Each record gives information about each contig in the *.contig: it&#x27;</span>s edge index, length, the index difference between its reverse-complementary counterpart and itself.</span><br></pre></td></tr></table></figure>

<h3 id="3-Output-files-from-the-command-â€œmapâ€"><a href="#3-Output-files-from-the-command-â€œmapâ€" class="headerlink" title="3. Output files from the command â€œmapâ€"></a>3. Output files from the command â€œmapâ€</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">a. *.peGrads</span><br><span class="line">      Information <span class="keyword">for</span> each <span class="built_in">clone</span> library: insert-size, <span class="built_in">read</span> index upper bound, rank and pair number cutoff <span class="keyword">for</span> a reliable link. This file can be revised manually <span class="keyword">for</span> scaffolding tuning.</span><br><span class="line">   b. *.readOnContig</span><br><span class="line">      Reads<span class="string">&#x27; locations on contigs. Here contigs are referred by their edge index. Howerver about half of them are not listed in the *.contig file for their reverse-complementary counterparts are included already.</span></span><br><span class="line"><span class="string">   c. *.readInGap</span></span><br><span class="line"><span class="string">      This file includes reads that could be located in gaps between contigs. This information will be used to close gaps in scaffolds if &quot;-F&quot; is set.</span></span><br></pre></td></tr></table></figure>

<h3 id="4-Output-files-from-the-command-â€œscaffâ€"><a href="#4-Output-files-from-the-command-â€œscaffâ€" class="headerlink" title="4. Output files from the command â€œscaffâ€"></a>4. Output files from the command â€œscaffâ€</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">a. *.newContigIndex</span><br><span class="line">      Contigs are sorted according their length before scaffolding. Their new index are listed <span class="keyword">in</span> this file.  This is useful <span class="keyword">if</span> one wants to corresponds contigs <span class="keyword">in</span> *.contig with those <span class="keyword">in</span> *.links.</span><br><span class="line">   b. *.links</span><br><span class="line">      Links between contigs <span class="built_in">which</span> are established by <span class="built_in">read</span> pairs. New index are used.</span><br><span class="line">   c. *.scaf_gap</span><br><span class="line">      Contigs <span class="keyword">in</span> gaps found by contig graph outputted by the contiging procedure. Here new index are used.</span><br><span class="line">   d. *.scaf</span><br><span class="line">      Contigs <span class="keyword">for</span> each scaffold: contig index (concordant to index <span class="keyword">in</span> *.contig),  approximate start position on scaffold, orientation, contig length, and its links to others contigs.</span><br><span class="line">   e. *.gapSeq</span><br><span class="line">      Gap sequences between contigs.</span><br><span class="line">   f. *.scafSeq</span><br><span class="line">      Sequences of each scaffolds.</span><br><span class="line">   g. *.contigPosInscaff</span><br><span class="line">      Contigs<span class="string">&#x27; positions in each scaffold.</span></span><br><span class="line"><span class="string">   h. *.bubbleInScaff</span></span><br><span class="line"><span class="string">      Contigs that form bubble structures in scaffolds. Every two contigs form a bubble and the contig with higher coverage will be kept in scaffold.</span></span><br><span class="line"><span class="string">   i. *.scafStatistics</span></span><br><span class="line"><span class="string">      Statistic information of final scaffold and contig.</span></span><br></pre></td></tr></table></figure>

<hr>
<h1 id="å°è®°1"><a href="#å°è®°1" class="headerlink" title="å°è®°1"></a>å°è®°1</h1><p> refï¼š<a href="https://www.cnblogs.com/Formulate0303/p/6879841.html">https://www.cnblogs.com/Formulate0303/p/6879841.html</a></p>
<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ç¡®å®šåŸºå› ç»„ç¼ºå¤±ä»€ä¹ˆï¼›ç¡®å®šéš¾ä»¥ç”ŸåŒ–ç ”ç©¶çš„åŸºå› å’Œpathwaysï¼›ç ”ç©¶æ„Ÿå…´è¶£pathwayé€šè·¯ä¸­æ¯ä¸€ä¸ªåŸºå› ï¼›ç ”ç©¶åŸºå› ç»„éç¼–ç åŒºï¼ˆintronsã€promotersã€telomeresç«¯ç²’ç­‰ï¼‰çš„è°ƒæ§æœºç†å’Œç»“æ„ç‰¹å¾ï¼›åŸºå› ç»„æä¾›å¯è¿›è¡Œå„ç§ç»Ÿè®¡çš„å¤§å‹æ•°æ®åº“ï¼ˆprovide large databases that are amenable to statistical methodsï¼‰;è¯†åˆ«ä¸åŒå¯èƒ½æœ‰ç»†å¾®è¡¨å‹çš„åºåˆ—ï¼›ç ”ç©¶ç‰©ç§å’ŒåŸºå› ç»„çš„è¿›åŒ–è¿‡ç¨‹ã€‚ä¸€èˆ¬éƒ½æ˜¯ç”¨ä¸åŒæ¢¯åº¦çš„æ’å…¥ç‰‡æ®µæ¥æµ‹åºï¼Œå°ç‰‡æ®µï¼ˆ200,500,800ï¼‰å’Œå¤§ç‰‡æ®µï¼ˆ1k, 2kb 5kb 10kb 20kb 40kbï¼‰ã€‚</p>
<h2 id="æµ‹åºå‰å‡†å¤‡"><a href="#æµ‹åºå‰å‡†å¤‡" class="headerlink" title="æµ‹åºå‰å‡†å¤‡"></a>æµ‹åºå‰å‡†å¤‡</h2><p>æœé›†ç‰©ç§ç›¸å…³ä¿¡æ¯ï¼ˆæŸ“è‰²ä½“çš„å€å‹ã€åŸºå› ç»„å¤§å°ã€æ‚åˆåº¦ã€é‡å¤åºåˆ—æ¯”ä¾‹ã€æ˜¯å¦æœ‰å¯ç”¨çš„é—ä¼ å›¾è°±ã€GCå«é‡ å’Œ GCåˆ†å¸ƒï¼‰ã€‚æä¾›å·²ç»å‘è¡¨çš„è¿‘æºç‰©ç§ã€‚æ ¹æ®è¿‘æºç‰©ç§åˆ†æä»¥ä¸Šä¿¡æ¯ï¼Œå°¤å…¶æ˜¯GCå«é‡ä»¥åŠå¯¹åº”çš„GCåˆ†å¸ƒï¼Œé‡å¤ç¨‹åº¦ã€‚</p>
<h3 id="1-è·å–åŸºå› ç»„å¤§å°"><a href="#1-è·å–åŸºå› ç»„å¤§å°" class="headerlink" title="1 è·å–åŸºå› ç»„å¤§å°"></a>1 è·å–åŸºå› ç»„å¤§å°</h3><ul>
<li><p>åŸºå› ç»„å¤ªå¤§ï¼ˆ&gt;10Gbï¼‰è¶…å‡ºäº†ç›®å‰denovoç»„è£…åŸºå› ç»„è½¯ä»¶å¯¹æœºå™¨å†…å­˜çš„è¦æ±‚ï¼Œåˆ™æ— æ³•å®ç°ç»„è£…ï¼›å¯¹ç»„è£…ç»“æœçš„å¤§å°çš„è¿›è¡Œæ­£ç¡®æ€§ä¸å¦åˆ¤æ–­ã€‚</p>
</li>
<li><p>åŠ¨ç‰©åŸºå› ç»„å¤§å°æ•°æ®åº“ï¼ˆANIMAL GENOME SIZE DATABASEï¼‰: <a href="http://www.genomesize.com/%EF%BC%9B%E5%AF%B9%E4%BA%8E%E6%9F%A5%E4%B8%8D%E5%88%B0%E7%9A%84%E7%89%A9%E7%A7%8D%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%A4%A7%E5%B0%8F%E7%9A%84%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E4%B8%80%E4%BA%9B%E6%96%B9%E6%B3%95%E5%8E%BB%E4%BC%B0%E8%AE%A1%E3%80%82">http://www.genomesize.com/ï¼›å¯¹äºæŸ¥ä¸åˆ°çš„ç‰©ç§åŸºå› ç»„å¤§å°çš„ï¼Œå¯ä»¥é€šè¿‡ä¸€äº›æ–¹æ³•å»ä¼°è®¡ã€‚</a></p>
</li>
<li><p>å®éªŒï¼ˆæµå¼ç»†èƒä»ªï¼‰ä¼°è®¡åŸºå› ç»„å¤§å°çš„ä¾‹å­ï¼š â€œA full-length enriched cDNA library and expressed sequence tag analysis of the parasitic weed, Striga hermonthica.â€ BMC Plant Biol (2010)</p>
</li>
<li><p>åŸºäºç¦å°”æ‘©æ ¹æŸ“è‰²ä¼°è®¡åŸºå› ç»„å¤§å°ï¼šä¹¦The evolution of the genomeã€ŠåŸºå› ç»„è¿›åŒ–ã€‹, Gregory, T. (2005).</p>
</li>
<li><p>å®šé‡PCRä¼°è®¡åŸºå› ç»„å¤§å°: â€œReal-time PCR-based method for the estimation of genome sizes.â€ Nucleic Acids Res (2003); â€œThe nuclear genome of the phytoseiid Metaseiulus occidentalis (Acari: Phytoseiidae) is among the smallest known in arthropods.â€ Exp Appl Acarol (2009)</p>
</li>
<li><p>é€šè¿‡Kmerä¼°è®¡åŸºå› ç»„å¤§å°ï¼šKim, E. B., X. Fang, et al. (2011). â€œ<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3319411/"><strong>Genome sequencing reveals insights into physiology and longevity of the naked mole rat</strong></a>.â€ Nature 479(7372): 223-227. [Obtained 2.5 G contig sequences with N50 19.3 kbp and N90 4.7 kbp, and 2.7 G scaffold sequences with N50 1.6 Mbp and N90 0.3 Mbp.]</p>
</li>
</ul>
<h3 id="2-æ‚åˆåº¦è¯„ä¼°"><a href="#2-æ‚åˆåº¦è¯„ä¼°" class="headerlink" title="2 æ‚åˆåº¦è¯„ä¼°"></a>2 æ‚åˆåº¦è¯„ä¼°</h3><ul>
<li><p>ä¸»è¦ä½“ç°åœ¨<font color="green">ä¸èƒ½åˆå¹¶å§Šå¦¹æŸ“è‰²ä½“</font>ï¼Œæ‚åˆåº¦é«˜çš„åŒºåŸŸï¼Œä¼šæŠŠä¸¤æ¡å§Šå¦¹æŸ“è‰²å•ä½“éƒ½ç»„è£…å‡ºæ¥ï¼Œé€ æˆç»„è£…çš„åŸºå› ç»„<font color="green">åå¤§</font>ã€‚</p>
</li>
<li><p><font color="red"><strong>æ‚åˆåº¦&gt;0.5%åˆ™ç»„è£…æœ‰ä¸€å®šéš¾åº¦</strong></font>ã€‚æ‚åˆåº¦&gt;1%åˆ™å¾ˆéš¾ç»„è£…å‡ºæ¥ã€‚</p>
</li>
<li><p>æ‚åˆåº¦é«˜åˆ™ç»„è£…çš„åºåˆ—ä¸é€‚åˆç”¨äºåç»­ç”Ÿç‰©å­¦åˆ†æï¼ˆeg:æ‹·è´æ•°ã€åŸºå› å®Œæ•´ç»“æ„ç­‰ï¼‰ã€‚</p>
</li>
</ul>
<h3 id="3-æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨"><a href="#3-æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨" class="headerlink" title="3 æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨"></a>3 æ˜¯å¦æœ‰é—ä¼ å›¾è°±å¯ç”¨</h3><p>éšç€æµ‹åºå¯¹è´¨é‡æé«˜å’Œç›¸å…³æŠ€æœ¯æˆç†Ÿï¼Œ<font color="red"><strong>é—ä¼ å›¾è°±ï¼Ÿ</strong></font>ä¹Ÿå¿«æˆäº†denovoåŸºå› ç»„çš„å¿…é¡»ç»„æˆã€‚</p>
<p><a href="https://cdmd.cnki.com.cn/Article/CDMD-10504-1019065822.htm">çŸ®ç‰µç‰›é—ä¼ å›¾è°±æ„å»ºåŠé‡ç“£åˆ†å­æ ‡è®°ç­›é€‰</a></p>
<p>é—ä¼ å›¾è°±æ˜¯æŸä¸€ç‰©ç§çš„æŸ“è‰²ä½“å›¾ï¼Œæ˜¾ç¤ºæ‰€çŸ¥çš„åŸºå› å’Œ/æˆ–é—ä¼ æ ‡è®°çš„ç›¸å¯¹ä½ç½®ï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¡æŸ“è‰²ä½“ä¸Šç‰¹æ®Šçš„ç‰©ç†ä½ç½®ã€‚ç”±<a href="https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E9%87%8D%E7%BB%84/6391485">é—ä¼ é‡ç»„</a>æµ‹éªŒç»“æœæ¨ç®—å‡ºæ¥çš„ã€åœ¨ä¸€æ¡æŸ“è‰²ä½“ä¸Šå¯ä»¥å‘ç”Ÿçš„çªå˜åº§ä½çš„ç›´çº¿æ’åˆ—ï¼ˆ<a href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E4%BD%8D%E7%82%B9/3613206">åŸºå› ä½ç‚¹</a>çš„æ’åˆ—ï¼‰å›¾ã€‚</p>
<p>Genetic mapï¼Œ<a href="https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E5%9B%BE/2951032">é—ä¼ å›¾</a>æˆ–é—ä¼ <a href="https://baike.baidu.com/item/%E8%BF%9E%E9%94%81%E5%9B%BE/1586423">è¿é”å›¾</a>æ˜¯ä»¥<a href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E8%BF%9E%E9%94%81/7740242">åŸºå› è¿é”</a>ã€é‡ç»„<a href="https://baike.baidu.com/item/%E4%BA%A4%E6%8D%A2%E5%80%BC/5106108">äº¤æ¢å€¼</a>æ„å»ºçš„å›¾è°±ï¼Œå›¾è·ä¸ºcMï¼ˆ<a href="https://baike.baidu.com/item/%E5%8E%98%E6%91%A9/1586351">å˜æ‘©</a>ï¼‰ï¼Œ1%äº¤æ¢å€¼ä¸º1cMï¼Œçº¦ç›¸å½“äº1000kbã€‚äººåŸºå› ç»„å…¨é•¿çº¦3300cMï¼Œå¦‚ä¸¤ä¸ªæ ‡è®°ä¹‹é—´ç›¸è·1cMï¼Œåˆ™éœ€3300ä¸ªæ ‡è®°ï¼Œå¦‚ç›¸è·2ï½5cMï¼Œåˆ™éœ€660ï½l650ä¸ªæ ‡è®°ã€‚æ ‡è®°å¯ä»¥æ˜¯ä½“è´¨æ€§çŠ¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯æ£€å‡ºçš„DNAåºåˆ—ï¼Œä¾‹å¦‚åŸºå› ã€<a href="https://baike.baidu.com/item/%E9%99%90%E5%88%B6%E7%89%87%E6%AE%B5%E9%95%BF%E5%BA%A6%E5%A4%9A%E6%80%81%E6%80%A7/3841692">é™åˆ¶ç‰‡æ®µé•¿åº¦å¤šæ€æ€§</a>ï¼ˆ<a href="https://baike.baidu.com/item/RFLP/5060944">RFLP</a>ï¼‰å’Œç‰¹å®šçš„<a href="https://baike.baidu.com/item/%E5%8D%95%E4%B8%80%E5%BA%8F%E5%88%97/1851974">å•ä¸€åºåˆ—</a>ç­‰ã€‚æ¯ä¸€ä¸ªæ ‡è®°éƒ½è¦ç”¨ä¸“ä¸€åºåˆ—ä½ç‚¹ï¼ˆSTSï¼‰ä½œé‰´å®šã€‚STSæ˜¯æŒ‡å…¶ä½ç½®åŠæ ¸è‹·é…¸åºåˆ—å‡å·²çŸ¥çš„ã€äººåŸºå› ç»„ä¸­åªæœ‰ä¸€ä»½æ‹·è´çš„DNAçŸ­ç‰‡æ®µï¼ˆä¸€èˆ¬é•¿200ï½500ç¢±åŸºå¯¹ï¼‰ï¼Œå®ƒå¾ˆå®¹æ˜“ç”¨å¤šèšé…¶é“¾ååº”ï¼ˆPCRï¼‰åŠ ä»¥éªŒè¯ã€‚å½“å„ä¸ªå®éªŒå®¤æŠ¥é“å®šä½å’Œæµ‹åºçš„æ•°æ®æ—¶ï¼Œå¯ç”¨STSæ¥ç¡®å®šè¿™äº›DNAç‰‡æ®µçš„å®šä½ä¸å–å‘ã€‚äººç±»åŸºå› ç»„è®¡åˆ’çš„ç ”ç©¶ç›®æ ‡æ˜¯ï¼Œå®Œæˆä¸€ä¸ªå®Œå…¨è¿æ¥çš„äººç±»é—ä¼ å›¾ï¼Œæ ‡è®°ä¹‹é—´å¹³å‡ç›¸è·2ï½5cMã€‚</p>
<p>é—ä¼ å›¾è°±æ„å»ºç›¸å…³æ¦‚å¿µæ¨èå‚è€ƒä¹¦ï¼š<strong>The handbook of plant genome mapping: genetic and physical mapping</strong> </p>
<h3 id="4-ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”"><a href="#4-ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”" class="headerlink" title="4 ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”"></a>4 ç”Ÿç‰©å­¦é—®é¢˜çš„è°ƒç ”</h3><h2 id="ç»„è£…"><a href="#ç»„è£…" class="headerlink" title="ç»„è£…"></a>ç»„è£…</h2><ul>
<li><p>BAC-by-BAC:æµ‹åºå’Œç»„è£…æ¯ä¸€ä¸ªBAC, åˆå¹¶BACå’Œç§»é™¤BACå†—ä½™éƒ¨åˆ†ï¼Œè·å¾—å‚è€ƒåŸºå› ç»„åºåˆ—ã€‚</p>
</li>
<li><p>whole genome shotgunï¼šå…¨åŸºå› ç»„é¸Ÿæªæ³•ï¼ŒæŸ“è‰²ä½“DNAè¢«éšæœºæ‰“æ–­æˆç‰‡æ®µï¼Œä¾æ¬¡æµ‹åºå’Œç»„è£…ã€‚</p>
</li>
</ul>
<h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><p>äºŒä»£æµ‹åºæ•°æ®ä»å¤´ç»„è£…çš„è§£å†³overlapçš„ä¸‰ç§ç®—æ³•</p>
<ul>
<li><p>overlap-layout-consensusï¼šé‡å å¸ƒå±€ä¸€è‡´OLCæ³•ï¼Œã€è½¯ä»¶ï¼šPHRAP.NEWBLER.CABOG.CELERA.SHORTY.EDENA,popular for long readsã€‘ï¼Œ1. Overlap discovery involves all-against-all, pair-wise read comparison. 2. Construction an approximate read layout according to the pair-wise alignment 3. Multiple sequence alignment determines the precise layout and the consensus.</p>
</li>
<li><p>De bruijn graph:DBGæ³•ï¼Œã€è½¯ä»¶ï¼šSOAPdenovo2.Velvet.EULER,popular for illumina ï¼Œfor short readsã€‘,1.æ‰€æœ‰çš„æµ‹åºreadséƒ½è¢«åˆ‡å‰²æˆæŸä¸€å›ºå®šKmeré•¿åº¦çš„åºåˆ—ï¼ˆ21bp=&lt;kmer&lt;=127bpï¼‰.2.ç›¸é‚»kmersé“¾æ¥æ˜¯æ¥è‡ªreadåºåˆ—ï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦æˆå¯¹åºåˆ—æ¯”å¯¹(The links between neighboring Kmers are derived from read sequences,so it doesnâ€™t need pair-wise reads alignment.ï¼‰3.å†—ä½™çš„æ•°æ®è‡ªåŠ¨è¢«å‹ç¼©ã€‚</p>
</li>
<li><p>greedy methodï¼šè´ªå©ªæ³•(use OLC or DBG)ï¼Œã€è½¯ä»¶ï¼šSSAKE.SHARCGS.VCAKEã€‘ï¼Œä»ç»™å®šçš„readså’Œcontigså¼€å§‹ï¼Œä½¿ç”¨ä¸‹ä¸€ä¸ªå¾—åˆ†æœ€é«˜çš„overlapå»åšä¸‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ ·ä¸€ç›´åšä¸‹å»ï¼Œç›´åˆ°ä¸èƒ½è¿›è¡Œä¸‹å»ä¸ºæ­¢ã€‚ </p>
</li>
</ul>
<h3 id="è¯„ä¼°"><a href="#è¯„ä¼°" class="headerlink" title="è¯„ä¼°"></a>è¯„ä¼°</h3><p>ç»„è£…short readsçš„æŒ‘æˆ˜</p>
<p>1.åŸºå› ç»„çš„å¤æ‚æ€§ï¼Œ<strong>é‡å¤åºåˆ—</strong>ã€<strong>æ‚åˆ</strong>çš„<strong>äºŒå€ä½“</strong>åŸºå› ç»„heterozygous diploid genomeã€<strong>å¤šå€æ€§</strong>polyploidy.</p>
<p>2.illumina reads çš„æ•°æ®ç‰¹å¾ï¼Œ<strong>æµ‹åºé”™è¯¯</strong>ç‡<del>1%ã€short read é•¿åº¦</del>100bpã€<del>100Xçš„é«˜æµ‹åºæ·±åº¦ã€ä¸åŒçº§åˆ«çš„æ–‡åº“æ’å…¥ç‰‡æ®µï¼ˆ200bp</del>40Kbpï¼‰ã€‚</p>
<p>3.Complexity of computation</p>
<h2 id><a href="#" class="headerlink" title></a></h2><hr>
<h1 id="å°è®°2"><a href="#å°è®°2" class="headerlink" title="å°è®°2"></a>å°è®°2</h1><p>ref <a href="https://www.jianshu.com/p/e02ecd537c83">https://www.jianshu.com/p/e02ecd537c83</a></p>
<h2 id="readsè´¨é‡æ§åˆ¶"><a href="#readsè´¨é‡æ§åˆ¶" class="headerlink" title="readsè´¨é‡æ§åˆ¶"></a>readsè´¨é‡æ§åˆ¶</h2><ul>
<li>è®¤è¯†æ•°æ®ã€‚(readç±»å‹ï¼Œreadæ•°é‡ï¼Œå…¶GCå«é‡ï¼Œå¯èƒ½çš„æ±¡æŸ“å’Œå…¶ä»–é—®é¢˜)</li>
<li>æ•°æ®æ¸…ç†ã€‚(ç»„è£…å‰æ¸…ç†åŸå§‹æ•°æ®å¯ä»¥ä½¿ç»„è£…ç»“æœæ›´å¥½,å› ä¸ºç§»é™¤äº†ä½è´¨é‡å’Œæ±¡æŸ“çš„reads)</li>
<li>ä¸ºç»„è£…è½¯ä»¶æä¾›ä¸€äº›ç»„è£…çš„å‚æ•°</li>
</ul>
<h2 id="æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡"><a href="#æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡" class="headerlink" title="æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡"></a>æ£€æŸ¥åŸå§‹readæ•°æ®çš„è´¨é‡</h2><p>(1)readé•¿åº¦:åœ¨è®¾ç½®ç»„è£…çš„æœ€å¤§k-merå€¼æ—¶å°†å¾ˆé‡è¦ã€‚</p>
<p>(2)è´¨é‡ç¼–ç ç±»å‹:å¯¹äºquality trimmingè½¯ä»¶å¾ˆé‡è¦ã€‚(Phred33ã€64)</p>
<p>(3)GCå«é‡:<strong>é«˜GCçš„ç”Ÿç‰©ä½“å¾€å¾€ç»„è£…å¾—ä¸å¥½ï¼Œå¹¶ä¸”readè¦†ç›–ç‡åˆ†å¸ƒå¯èƒ½ä¸å‡åŒ€</strong></p>
<p>(4)æ€»çš„readsæ•°:<strong>äº†è§£coverageèŒƒå›´</strong></p>
<p>(4)åœ¨readçš„å¼€å§‹ã€ä¸­é—´æˆ–ç»“å°¾é™„è¿‘è´¨é‡ä¸‹é™:ç¡®å®šå¯èƒ½çš„ä¿®æ•´/æ¸…é™¤æ–¹æ³•å’Œå‚æ•°ã€‚</p>
<p>(5)å‡ºç°<strong>é«˜åº¦é‡å¤çš„k-mers</strong>:è¯´æ˜åºåˆ—å¯èƒ½å­˜åœ¨æ±¡æŸ“ã€‚</p>
<p>(6)readsä¸­å­˜åœ¨<strong>å¤§é‡N</strong>:å¯èƒ½è¡¨æ˜æµ‹åºè´¨é‡è¾ƒå·®ã€‚ä½ éœ€è¦ä¿®å‰ªè¿™äº›readï¼Œä»¥åˆ é™¤N.</p>
<h2 id="genome-survey"><a href="#genome-survey" class="headerlink" title="genome survey"></a>genome survey</h2><p>æ­£å¼ç»„è£…å‰è¿›è¡Œkmeråˆ†æï¼Œä»¥äº†è§£ä»¥ä¸‹ä¿¡æ¯ã€‚</p>
<p>(1)åŸºå› ç»„æ‚åˆåº¦ã€‚</p>
<p>(2)é‡å¤åºåˆ—æ¯”ä¾‹ã€‚</p>
<p>(3)é¢„ä¼°åŸºå› ç»„å¤§å°ã€‚</p>
<p>(4)æµ‹åºæ·±åº¦ã€‚</p>
<p>æ‰€ç”¨è½¯ä»¶ä¸ºkmergenieï¼Œ<a href="https://links.jianshu.com/go?to=http://kmergenie.bx.psu.edu/">http://kmergenie.bx.psu.edu/</a> </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…(ä½¿ç”¨æ—¶ï¼Œç¡®ä¿æœåŠ¡å™¨è£…æœ‰Pthonä¸R)</span></span><br><span class="line">tar -xzvf kmergenie-1.7051.tar.gz &amp;&amp; <span class="built_in">cd</span> kmergenie-1.7051</span><br><span class="line">python setup.py install</span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ·»åŠ å¯æ‰§è¡Œæƒé™</span></span><br><span class="line">chmod -R 755 *</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ä»‹ç»æ€ä¹ˆç”¨ï¼Œå‚è€ƒï¼š<a href="https://links.jianshu.com/go?to=http://wap.sciencenet.cn/blog-3406804-1159967.html">http://wap.sciencenet.cn/blog-3406804-1159967.html</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">touch fq_501.txt                                 <span class="comment">#å­˜å‚¨fastqæ–‡ä»¶çš„è·¯å¾„ã€‚</span></span><br><span class="line">vim fq_501.txt                                   <span class="comment">#ç¼–è¾‘fq.txtï¼Œè¾“å…¥fastqæ–‡ä»¶è·¯å¾„ã€‚</span></span><br><span class="line">mkdir kmergenie_result     </span><br><span class="line">./tools/kmergenie-1.7051/kmergenie fq_501.list -o ./kmergenie_result/PB_501 -k 105 -</span><br><span class="line">l 15 -s 10 -t 12                               </span><br><span class="line"><span class="comment">#-o:è¾“å‡ºæ–‡ä»¶å­˜æ”¾çš„åœ°å€ã€‚</span></span><br><span class="line"><span class="comment">#-k:æœ€å¤§çš„kå€¼</span></span><br><span class="line"><span class="comment">#-l:æœ€å°çš„kå€¼</span></span><br><span class="line"><span class="comment">#-s:ä»æœ€å°çš„k----æœ€å¤§çš„kï¼Œæ¯æ¬¡å¢åŠ çš„kã€‚</span></span><br><span class="line"><span class="comment">#-t:çº¿ç¨‹æ•°ã€‚</span></span><br><span class="line"><span class="comment">#æ³¨:åˆšå¼€å§‹så¯ä»¥è®¾å¤§ç‚¹ï¼Œå¯ä»¥æ ¹æ®åˆ¤æ–­å‡ºçš„æœ€ä½³kå€¼ï¼Œç¼©å°så†è¿›è¡Œåˆ¤æ–­((ç¬¬ä¸€æ¬¡:I:15,k:105,s:10 ç¬¬äºŒæ¬¡I:85,k:140,s:6)ã€‚</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">usage:</span><br><span class="line"></span><br><span class="line">    ./kmergenie reads_file</span><br><span class="line"></span><br><span class="line">reads_file is either a single FASTA, FASTQ, FASTA.gz, FASTQ.gz file or a list of file names, one per line. For example:</span><br><span class="line">    </span><br><span class="line">    ls -1 *.fastq.gz &gt; list_files</span><br><span class="line">    ./kmergenie list_files</span><br><span class="line"></span><br><span class="line">    type ./kmergenie to see extra options</span><br><span class="line"></span><br><span class="line">input:</span><br><span class="line"></span><br><span class="line">    Input reads should be exactly those the de novo assembler will use to create contigs, i.e. the list of all single and paired-end reads.</span><br><span class="line"></span><br><span class="line">    The order does not matter, KmerGenie treats the reads as an unordered set of k-mers. Orientation of the reads also does not matter.</span><br><span class="line">    With Velvet, if you have mate-pairs, Velvet uses them to create contigs, so do include them in KmerGenie.</span><br><span class="line">    Otherwise, if the mate-pairs are used only for scaffolding (i.e. asm_flag=2 in SOAPdenovo), do not include them.</span><br><span class="line"></span><br><span class="line">tips:</span><br><span class="line"></span><br><span class="line">    * Take a look at the generated HTML report. It provides a summary of the results, and contains an Advanced Help section to help analysis.</span><br><span class="line"></span><br><span class="line">    * There is no need to use Kmergenie for a multi-k assembler, like SPAdes. Default parameters of multi-k assemblers are generally better than a single best k.</span><br><span class="line"></span><br><span class="line">    * By default, KmerGenie will perform another pass to estimate k more precisely. You may skip it by using the &quot;--one-pass&quot; option (roughly 2x faster).</span><br><span class="line"></span><br><span class="line">    * To run multiple instances of KmerGenie on the same folder, specify the &quot;-o&quot; and &quot;-t&quot; parameters (output prefix, number of threads per instance).</span><br><span class="line"></span><br><span class="line">    * The sampling value e (&quot;-e&quot; parameter) makes sure that roughly n/e k-mers are sampled out of the n distinct kmers in the dataset. The datasets are fully analyzed, though. Kmergenie samples from the set of distinct kmers, not from the set of reads.</span><br><span class="line"></span><br><span class="line">    * The diploid model should only be used for moderate-high heterozygosity rates. The haploid model works better when only one peak is visible in the histograms (indicating low heterozygosity).</span><br><span class="line"></span><br><span class="line">outputs:</span><br><span class="line"></span><br><span class="line">    histograms_report.html</span><br><span class="line">        html report of all the results</span><br><span class="line">    histograms.dat</span><br><span class="line">        file containing the raw data for the number of genomic kmers for each k value</span><br><span class="line">    histograms-k*.histo</span><br><span class="line">        files containing raw sampled histograms for each k value</span><br><span class="line">    histograms-k*.histo.pdf</span><br><span class="line">        plots of the histograms and the fits. Colors: red is the fit of the complete statistical model of the histogram (erroneous k-mers + genomic k-mers). With the diploid model, green are only the heterozygous k-mers, blue are only the homozygous k-mers.</span><br><span class="line">    &lt;stdout&gt;</span><br><span class="line">        last line is the best k value</span><br><span class="line">    &lt;return code / error code&gt;</span><br><span class="line">        0 if and only if a best k was found (note: no longer returns the best k as error code)</span><br></pre></td></tr></table></figure>



<p>ç»“æœæ–‡ä»¶ç”Ÿæˆreportã€‚æŠ¥å‘Šä»¥æŠ˜çº¿å›¾å½¢å¼ç»™å‡ºæ¯ç§é•¿åº¦çš„kmerä¸‹ï¼Œä¼°è®¡çš„åŸºå› ç»„å¤§å°ï¼ŒåŒæ—¶ç»™å‡ºäº†æœ€ä½³çš„kmer(è¯„ä¼°åŸºå› ç»„æ€»å¤§å°æœ€é«˜)</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/14.png" alt="img"></p>
<p>ç†æƒ³æ¡ä»¶è¯¥å›¾åº”è¯¥ä¸ºä¸€æ¡å¹³æ»‘çš„æ›²çº¿ï¼Œæœ‰æ˜ç¡®æœ€å¤§å€¼ã€‚ç„¶è€Œåœ¨ä¸€äº›æƒ…å†µä¸‹æœ‰å¤šä¸ªå±€éƒ¨æœ€å¤§å€¼ã€‚</p>
<p>è¿™äº›æƒ…å†µè¡¨æ˜ï¼Œå¯¹äºæŸäº›kå€¼ï¼ŒKmergenieä¸­çš„ç»Ÿè®¡æ¨¡å‹å¹¶ä¸æ€»æ˜¯æ­£ç¡®åœ°æ‹Ÿåˆè¾“å…¥æ•°æ®ã€‚å› æ­¤ç”±Kmergenieé¢„æµ‹çš„æœ€ä½³kå€¼å¯èƒ½ä¸æ˜¯æœ€ä½³çš„ã€‚åœ¨éšåçš„åˆ†æä¸­ï¼Œè¿˜å°è¯•ä½¿ç”¨æ¯”Kmergenieé¢„æµ‹çš„kå¤§çš„k(å…¶ä»–å³°å€¼)</p>
<p>è‹¥åŸºå› ç»„k-mersçš„æ•°é‡ä¸ä¼šéšç€kå€¼çš„å‡é«˜è€Œä¸‹é™ï¼Œåˆ™æ˜¯ä¸€ä¸ªé«˜è¦†ç›–ç‡(high coverage)æ•°æ®é›†çš„è¿¹è±¡ï¼Ÿ<br>ä»€ä¹ˆæ˜¯è¦†ç›–ç‡å‘¢ï¼Ÿ<br>è¦†ç›–ç‡(coverage)ï¼šæŒ‡çš„æ˜¯æµ‹åºè¿‡ç¨‹ä¸­è¯»å–å•ä¸ªç¢±åŸºçš„å¹³å‡æ¬¡æ•°ã€‚å¦‚æœè¦†ç›–åº¦ä¸º100Ã—ï¼Œè¯´æ˜å¹³å‡æ¯ä¸ªç¢±åŸºæµ‹åºäº†100æ¬¡ã€‚å¯¹ç¢±åŸºæµ‹åºçš„é¢‘ç‡è¶Šé«˜ï¼Œæ•°æ®çš„è´¨é‡è¶Šé«˜ã€‚</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/15.png" alt="img"></p>
<h2 id="soapdevovo2"><a href="#soapdevovo2" class="headerlink" title="soapdevovo2"></a>soapdevovo2</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ­£å¼ç»„è£…(kmeré€‰103,113,123,127åˆ†åˆ«è·‘)</span></span><br><span class="line"><span class="comment">#SOAPdenovo2æ—¢å¯ä»¥ä¸€æ­¥ç»„è£…ä¹Ÿå¯ä»¥åˆ†å››æ­¥ï¼Œå¦‚æœåŸºå› ç»„å¤§ä¸”å¤æ‚å»ºè®®åˆ†å››æ­¥ã€‚</span></span><br><span class="line"> nohup ./tools/SOAPdenovo2-master/SOAPdenovo-127mer all -s config_file -d 1 -R -F -K 113 -p 60 -o PB_501_113 &gt; PB_501_113.log &amp;  <span class="comment">#æ³¨:åŠ nohupå’Œ&amp;æ˜¯ä¸ºäº†è®©å®ƒåœ¨åå°è¿è¡Œ(é˜²æ­¢è¿œç¨‹è¿æ¥æ–­å¼€ç¨‹åºåœæ­¢)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åˆ†å››æ­¥(åœ¨k=103ã€113ã€123ã€åŠ127(æ”¯æŒçš„æœ€å¤§kmer)è·‘äº†åå‘ç°127åœ¨åŒæ ·å‚æ•°ä¸‹contig N50æœ€å¤§)ï¼Œä¸‹é¢æ˜¯ä¸ºäº†ä¼˜åŒ–ç»“æœè·‘çš„ã€‚</span></span><br><span class="line"><span class="comment">#pregraph(d=1,2,3,4)</span></span><br><span class="line">nohup ./tools/SOAPdenovo2-master/SOAPdenovo-127mer pregraph -s config_file -o PB_501_127_d_3 -R -K 127 -p 60 -d 2 &gt;PB_501_127_d_3_pre.log &amp;</span><br><span class="line">nohup ./tools/SOAPdenovo2-master/SOAPdenovo-127mer contig -g PB_501_127_d_3 -R -p 60 &gt;PB_501_127_d_3_con.log &amp;</span><br><span class="line">nohup ./tools/SOAPdenovo2-master/SOAPdenovo-127mer map -s config_file -g PB_501_127_d_3 -p 60 -k 127 &gt;PB_501_127_d_3_map.log &amp;  </span><br><span class="line">nohup ./tools/SOAPdenovo2-master/SOAPdenovo-127mer scaff -g PB_501_127_d_3 -F -p 60 &gt;PB_501_127_d_3_scaf.log &amp;</span><br></pre></td></tr></table></figure>

<h2 id="ç»Ÿè®¡"><a href="#ç»Ÿè®¡" class="headerlink" title="ç»Ÿè®¡"></a>ç»Ÿè®¡</h2><p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/16.png" alt="img"></p>
<h2 id="ç»„è£…è¯„ä¼°"><a href="#ç»„è£…è¯„ä¼°" class="headerlink" title="ç»„è£…è¯„ä¼°"></a>ç»„è£…è¯„ä¼°</h2><p>QUASTè½¯ä»¶ä¸‹è½½:<a href="https://links.jianshu.com/go?to=https://sourceforge.net/projects/quast/files/quast-5.0.2.tar.gz/download">https://sourceforge.net/projects/quast/files/quast-5.0.2.tar.gz/download</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è§£å‹å®‰è£…</span></span><br><span class="line">tar -zxvf quast-5.0.2.tar.gz &amp;&amp; <span class="built_in">cd</span> quast-5.0.2</span><br><span class="line">python  setup.py install_full</span><br></pre></td></tr></table></figure>

<h3 id="å‚è€ƒåŸºå› ç»„ä¸‹è½½"><a href="#å‚è€ƒåŸºå› ç»„ä¸‹è½½" class="headerlink" title="å‚è€ƒåŸºå› ç»„ä¸‹è½½"></a>å‚è€ƒåŸºå› ç»„ä¸‹è½½</h3><h3 id="QUASTä½¿ç”¨"><a href="#QUASTä½¿ç”¨" class="headerlink" title="QUASTä½¿ç”¨"></a>QUASTä½¿ç”¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./tools/quast-5.0.2/quast.py -o ./quast_results -R ./reference/IRGSP-1.0_genome.fasta.gz -t 70 ./PB_501_results/PB_501_127_d_1/PB_501_127_d_1.scafSeq ./PB_501_results/PB_501_127_d_2/PB_501_127_d_2.scafSeq ./PB_501_results/PB_501_127_d_3/PB_501_127_d_3.scafSeq ./PB_501_results/PB_501_127_d_6/PB_501_127_d_6.scafSeq</span><br><span class="line"><span class="comment">#-oè¾“å‡ºç›®å½•</span></span><br><span class="line"><span class="comment">#-Rå‚è€ƒåŸºå› ç»„åºåˆ—</span></span><br><span class="line"><span class="comment">#-tçº¿ç¨‹æ•°</span></span><br><span class="line"><span class="comment">#åé¢ä¸ºè¦æ¯”è¾ƒçš„contig/scaffoldæ‰€åœ¨ç›®å½•ã€‚</span></span><br></pre></td></tr></table></figure>

<h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><h3 id="ç»Ÿè®¡ç»“æœ"><a href="#ç»Ÿè®¡ç»“æœ" class="headerlink" title="ç»Ÿè®¡ç»“æœ"></a>ç»Ÿè®¡ç»“æœ</h3><p>å°†contig/scaffoldæ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„ä¸Šï¼Œä¸‹é¢æ˜¯æ¯”å¯¹å¾—åˆ°çš„ç»“æœã€‚</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/17.png" alt="img"></p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/18.png" alt="img"></p>
<p>ç´¯è®¡é•¿åº¦:è‹¥ä¸ç°è‰²çº¿é‡åˆè¶Šå¥½ï¼Œç»„è£…ç»“æœè¶Šå¥½ã€‚</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/19.png" alt="img"></p>
<p>é”™è¯¯ç»„è£…æƒ…å†µï¼š</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/20.png" alt="img"></p>
<p>GCå«é‡:</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/21.png" alt="img"></p>
<h3 id="contig-scaffoldå¤§å°å¯è§†åŒ–"><a href="#contig-scaffoldå¤§å°å¯è§†åŒ–" class="headerlink" title="contig/scaffoldå¤§å°å¯è§†åŒ–"></a>contig/scaffoldå¤§å°å¯è§†åŒ–</h3><p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/22.png" alt="img"></p>
<h3 id="æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ"><a href="#æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ" class="headerlink" title="æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ"></a>æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“æƒ…å†µ</h3><p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/23.png" alt="img"></p>
<p>æ¯”å¯¹åˆ°æ¯æ¡æŸ“è‰²ä½“å¯è§†åŒ–æƒ…å†µ:</p>
<p><img src="/blog/2022/02/24/2022-02-25-soapdenovo2/24.png" alt="img"></p>
]]></content>
      <categories>
        <category>assemble</category>
      </categories>
      <tags>
        <tag>SOAPdenovo2</tag>
      </tags>
  </entry>
  <entry>
    <title>seqkit</title>
    <url>/blog/2022/02/24/2022-02-24-Seqkit/</url>
    <content><![CDATA[<h1 id="SeqKit-a-cross-platform-and-ultrafast-toolkit-for-FASTA-Q-file-manipulation"><a href="#SeqKit-a-cross-platform-and-ultrafast-toolkit-for-FASTA-Q-file-manipulation" class="headerlink" title="SeqKit - a cross-platform and ultrafast toolkit for FASTA/Q file manipulation"></a>SeqKit - a cross-platform and ultrafast toolkit for FASTA/Q file manipulation</h1><span id="more"></span>

<p><a href="https://bioinf.shenwei.me/seqkit/usage/#fx2tab-tab2fx">Official doc</a></p>
<h1 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h1><ul>
<li>Basic: <a href="https://bioinf.shenwei.me/seqkit/usage/#seq">seq</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#stats">stats</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#subseq">subseq</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#sliding">sliding</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#faidx">faidx</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#watch">watch</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#sana">sana</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#scat">scat</a></li>
<li>Format conversion: <a href="https://bioinf.shenwei.me/seqkit/usage/#fq2fa">fq2fa</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#fx2tab-tab2fx">fx2tab</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#fx2tab-tab2fx">tab2fx</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#convert">convert</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#translate">translate</a></li>
<li>Searching: <a href="https://bioinf.shenwei.me/seqkit/usage/#grep">grep</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#locate">locate</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#amplicon">amplicon</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#fish">fish</a></li>
<li>Set operation: <a href="https://bioinf.shenwei.me/seqkit/usage/#sample">sample</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#rmdup">rmdup</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#common">common</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#duplicate">duplicate</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#split">split</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#split2">split2</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#head">head</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#head-genome">head-genome</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#range">range</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#pair">pair</a></li>
<li>Edit: <a href="https://bioinf.shenwei.me/seqkit/usage/#concat">concat</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#replace">replace</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#restart">restart</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#mutate">mutate</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#rename">rename</a></li>
<li>Ordering: <a href="https://bioinf.shenwei.me/seqkit/usage/#sort">sort</a>, <a href="https://bioinf.shenwei.me/seqkit/usage/#shuffle">shuffle</a></li>
<li>BAM processing: <a href="https://bioinf.shenwei.me/seqkit/usage/#bam">bam</a></li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda install -c bioconda seqkit</span><br></pre></td></tr></table></figure>

<h1 id="command"><a href="#command" class="headerlink" title="command"></a>command</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">amplicon        é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­(æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ)</span><br><span class="line">bam             æ£€æŸ¥å’Œåœ¨çº¿ç»˜åˆ¶BAMè®°å½•æ–‡ä»¶çš„ç›´æ–¹å›¾</span><br><span class="line">common          é€šè¿‡id/åç§°/åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—</span><br><span class="line">concat          è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—</span><br><span class="line">convert         è½¬æ¢FASTQè´¨é‡ç¼–ç æ ¼å¼ï¼šæ”¯æŒæ ¼å¼åŒ…æ‹¬ï¼šæ¡‘æ ¼ï¼ŒSolexaå’ŒIllumina</span><br><span class="line">duplicate       é‡å¤åºåˆ—Næ¬¡</span><br><span class="line">faidx           åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—</span><br><span class="line">fish            ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—</span><br><span class="line">fq2fa           è½¬æ¢FASTQåˆ°FASTA</span><br><span class="line">fx2tab          å°†FASTA/Qè½¬æ¢ä¸ºè¡¨æ ¼æ ¼å¼(åŒ…å«é•¿åº¦/GCå«é‡/GCåå¥½)</span><br><span class="line">genautocomplete ç”Ÿæˆshellè‡ªåŠ¨å®Œæˆè„šæœ¬</span><br><span class="line">grep            é€šè¿‡ID/name/sequence/sequence motifæœç´¢åºåˆ—ï¼Œå…è®¸é”™é…</span><br><span class="line">head            æ‰“å°ç¬¬ä¸€æ¡åºåˆ—</span><br><span class="line"><span class="built_in">help</span>            æ‰“å°å¸®åŠ©ä¿¡æ¯</span><br><span class="line">locate          å®šä½åºåˆ—ï¼Œæˆ–è€…motifsï¼Œå…è®¸é”™é…</span><br><span class="line">mutate          ç¼–è¾‘åºåˆ—(ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤)</span><br><span class="line">pair            åŒ¹é…åŒç«¯åºåˆ—æ–‡ä»¶</span><br><span class="line">range           æ‰“å°ä¸€ä¸ªèŒƒå›´å†…çš„åºåˆ—</span><br><span class="line">rename          é‡å‘½åé‡å¤åºåˆ—ID</span><br><span class="line">replace         ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹åç§°æˆ–è€…åºåˆ—</span><br><span class="line">restart         é‡ç½®ç¯çŠ¶åŸºå› ç»„çš„èµ·å§‹ä½ç½®</span><br><span class="line">rmdup           é€šè¿‡id/åç§°/åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—</span><br><span class="line">sample          æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·</span><br><span class="line">sana            æ¸…ç†æŸåçš„å•è¡Œfastqæ–‡ä»¶</span><br><span class="line">scat            real time recursive concatenation and streaming of fastx files</span><br><span class="line">seq             è½¬æ¢åºåˆ—(åå‘ï¼Œè¡¥å……ï¼Œæå–IDâ€¦)</span><br><span class="line">shuffle         éšæœºåºåˆ—</span><br><span class="line">sliding         åºåˆ—æ»‘çª—æå–ï¼Œæ”¯æŒç¯å½¢åŸºå› ç»„</span><br><span class="line">sort            æŒ‰id/åç§°/åºåˆ—/é•¿åº¦æ’åºåºåˆ—</span><br><span class="line">split           æŒ‰id/seqåŒºåŸŸ/å¤§å°/éƒ¨ä»¶å°†åºåˆ—æ‹†åˆ†ä¸ºæ–‡ä»¶(ä¸»è¦ç”¨äºFASTA)</span><br><span class="line">split2          æŒ‰åºåˆ—æ•°é‡/æ–‡ä»¶æ•°å°†åºåˆ—æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶(FASTA, PE/SE FASTQ)</span><br><span class="line">stats           FASTA/Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡</span><br><span class="line">subseq          é€šè¿‡region/gtf/bedå¾—åˆ°å­åºåˆ—ï¼ŒåŒ…æ‹¬ä¾§ç¿¼åºåˆ—</span><br><span class="line">tab2fx          è½¬æ¢è¡¨æ ¼æ ¼å¼ä¸ºFASTA/Qæ ¼å¼</span><br><span class="line">translate       ç¿»è¯‘DNA/RNAåˆ°è›‹ç™½è´¨åºåˆ—(æ”¯æŒæ­§ä¹‰ç¢±åŸº)</span><br><span class="line">version         æ‰“å°ç‰ˆæœ¬ä¿¡æ¯å¹¶æ£€æŸ¥æ˜¯å¦æ›´æ–°</span><br><span class="line">watch           åºåˆ—ç‰¹å¾çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Parameter"><a href="#Parameter" class="headerlink" title="Parameter:"></a>Parameter:</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Flags:</span><br><span class="line">      --alphabet-guess-seq-length int   seqkitæ ¹æ®ç¬¬ä¸€ä¸ªFASTAè®°å½•çŒœæµ‹åºåˆ—ç±»å‹çš„åºåˆ—å‰ç¼€çš„é•¿åº¦(0è¡¨ç¤ºæ•´ä¸ªåºåˆ—)(é»˜è®¤10000)</span><br><span class="line">  -h, --<span class="built_in">help</span>                            æ˜¾ç¤ºå¸®åŠ©</span><br><span class="line">      --id-ncbi                         FASTAå¤´æ˜¯ncbié£æ ¼çš„ï¼Œä¾‹å¦‚&gt;gi|110645304|ref|NC_002516.2 </span><br><span class="line">      --id-regexp string                ç”¨äºè§£æIDçš„æ­£åˆ™è¡¨è¾¾å¼(default <span class="string">&quot;^(\\S+)\\s?&quot;</span>)ï¼ŒåŒ¹é…ç©ºæ ¼å‰çš„éƒ¨åˆ†ä¸ºåºåˆ—å</span><br><span class="line">      --infile-list string              è¾“å…¥æ–‡ä»¶åˆ—è¡¨ä¸­çš„æ–‡ä»¶ (one file per line), <span class="keyword">if</span> given, they are appended to files from cli arguments</span><br><span class="line">  -w, --line-width int                  è¾“å‡ºFASTAæ ¼å¼æ—¶çš„è¡Œå®½ (0 <span class="keyword">for</span> no wrap) (default 60)</span><br><span class="line">  -o, --out-file string                 è¾“å‡º (<span class="string">&quot;-&quot;</span> <span class="keyword">for</span> stdout, suffix .gz <span class="keyword">for</span> gzipped out) (default <span class="string">&quot;-&quot;</span>) -ä»£è¡¨æ ‡å‡†è¾“å‡ºï¼ŒåŠ .gzå¯è¾“å‡ºå‹ç¼©æ–‡ä»¶</span><br><span class="line">      --quiet                           ä¿æŒå®‰é™ï¼Œä¸è¦æ˜¾ç¤ºé¢å¤–çš„ä¿¡æ¯</span><br><span class="line">  -t, --seq-type string                 åºåˆ—ç±»å‹ (dna|rna|protein|<span class="built_in">unlimit</span>|auto) (auto, æŒ‰ç¬¬ä¸€ä¸ªåºåˆ—è‡ªåŠ¨æ£€æµ‹) (default <span class="string">&quot;auto&quot;</span>)</span><br><span class="line">  -j, --threads int                     CPUæ•°é‡ (é»˜è®¤å•æ ¸ä¸º1ï¼Œå¤šæ ¸ä¸º2) (default 2)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="stats-FASTA-Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡"><a href="#stats-FASTA-Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡" class="headerlink" title="stats FASTA/Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡"></a>stats FASTA/Qæ–‡ä»¶çš„ç®€å•ç»Ÿè®¡</h1><p>ç»Ÿè®¡åºåˆ—æ ¼å¼fa/fqã€å†…å®¹ç±»å‹DNA/RNA/Proteinï¼Œ<font color="red">åºåˆ—æ•°é‡ã€æ€»é•¿åº¦ï¼Œæœ€å°ã€å¹³å‡å’Œæœ€å¤§é•¿åº¦</font></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># FASTA DNA</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;&gt;seq\nacgtryswkmbdhvACGTRYSWKMBDHV&quot;</span> | seqkit stats</span><br><span class="line">file  format  <span class="built_in">type</span>  num_seqs  sum_len  min_len  avg_len  max_len</span><br><span class="line">-     FASTA   DNA          1       28       28       28       28</span><br><span class="line"></span><br><span class="line"><span class="comment"># RNA </span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;&gt;seq\nACGUN\nACGUN&quot;</span> | seqkit stats</span><br><span class="line">file  format  <span class="built_in">type</span>  num_seqs  sum_len  min_len  avg_len  max_len</span><br><span class="line">-     FASTA   RNA          1       10       10       10       10</span><br><span class="line"></span><br><span class="line"><span class="comment"># Protein</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;&gt;seq\nabcdefghijklmnpqrstvwyz&quot;</span> | seqkit stats</span><br><span class="line">file  format  <span class="built_in">type</span>     num_seqs  sum_len  min_len  avg_len  max_len</span><br><span class="line">-     FASTA   Protein         1       23       23       23       23</span><br><span class="line"></span><br><span class="line"><span class="comment"># FASTQ DNA</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;@read\nACTGCN\n+\n@IICCG&quot;</span> | seqkit stats</span><br><span class="line">file  format  <span class="built_in">type</span>  num_seqs  sum_len  min_len  avg_len  max_len</span><br><span class="line">-     FASTQ   DNA          1        6        6        6        6</span><br><span class="line"></span><br><span class="line">file                             format  <span class="built_in">type</span>     num_seqs         sum_len  min_len  avg_len  max_len</span><br><span class="line">R1.fastq.gz  FASTQ   DNA   254,677,261  34,439,769,981       50    135.2      138</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä¸€èˆ¬æ¨¡å¼</span><br><span class="line">seqkit stats C1_1.fq.gz</span><br><span class="line">#--è¾“å‡ºç»“æœtabåˆ†éš”</span><br><span class="line">seqkit stats C1_1.fq.gz -T</span><br><span class="line">#--è¾“å‡ºæ–‡ä»¶è½¬åŒ–å…¶ä»–æ ¼å¼</span><br><span class="line">seqkit stats C1_1.fq.gz -T| csvtk pretty -t</span><br><span class="line">seqkit stats C1_1.fq.gz -T| csvtk csv2md -t</span><br><span class="line"># ç»Ÿè®¡æ›´å¤šä¿¡æ¯ -a</span><br><span class="line">seqkit stats C1_1.fq.gz -a</span><br><span class="line"># jå¤šçº¿ç¨‹åŠ é€Ÿï¼Œå°¤å…¶æ˜¯å¯¹äºå…·æœ‰å¤šä¸ªåºåˆ—æ–‡ä»¶ä¼šåŠ é€Ÿ</span><br><span class="line"># seqkit stats -j 2 *.fq.gz</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="seq-è½¬æ¢åºåˆ—-ï¼ˆåå‘ã€äº’è¡¥-æå–IDï¼‰"><a href="#seq-è½¬æ¢åºåˆ—-ï¼ˆåå‘ã€äº’è¡¥-æå–IDï¼‰" class="headerlink" title="seq è½¬æ¢åºåˆ— ï¼ˆåå‘ã€äº’è¡¥/æå–IDï¼‰"></a>seq è½¬æ¢åºåˆ— ï¼ˆåå‘ã€äº’è¡¥/æå–IDï¼‰</h1><p>â€œ-nâ€: æå–åºåˆ—IDï¼ŒåŒ…æ‹¬â€œ&gt;â€åé¢çš„å…¨éƒ¨å†…å®¹</p>
<p>â€œ-n -iâ€: ä»…æå–ç¬¬ä¸€ä¸ªç©ºæ ¼å‰çš„ID</p>
<h1 id="æŒ‰é•¿åº¦è¿‡æ»¤-å¸¸ç”¨"><a href="#æŒ‰é•¿åº¦è¿‡æ»¤-å¸¸ç”¨" class="headerlink" title="æŒ‰é•¿åº¦è¿‡æ»¤(å¸¸ç”¨)"></a>æŒ‰é•¿åº¦è¿‡æ»¤(å¸¸ç”¨)</h1><p>æ‰©å¢å­åˆ†ææ—¶è¦ç­›é€‰æ‰©å¢é•¿åº¦ç›¸è¿‘çš„ç‰‡æ®µï¼Œè¿‡é•¿æˆ–è¿‡çŸ­ä¸€èˆ¬éƒ½è¦åˆ é™¤ã€‚å®åŸºå› ç»„ä¸­æ¯”å¦‚ç»„è£…çš„ç»“æœï¼Œç»å¸¸è¦è¿‡æ»¤&lt;200/300bpçš„çŸ­ç‰‡æ®µï¼Œåˆ†ç®±æ—¶è¦ç­›é€‰&gt;1000/2000çš„é•¿ç‰‡æ®µä½¿ç”¨ã€‚æœ¬æ¡å‘½ä»¤éå¸¸å¤šçš„åº”ç”¨åœºæ™¯ã€‚ç­›é€‰åç»“æœå¯ç”¨ &gt; å†™å…¥æ–‡ä»¶</p>
<p>-m æŒ‰ç…§åºåˆ—é•¿åº¦è¿‡æ»¤ï¼Œè¡¨ç¤ºä¿ç•™çš„æœ€å°é•¿åº¦ï¼Œ-M æ­¤ä¸ºä¿ç•™çš„æœ€å¤§é•¿åº¦</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#--æå–åºåˆ—é•¿åº¦å¤§äº60çš„å¹¶ç»Ÿè®¡é•¿åº¦ä¿¡æ¯</span></span><br><span class="line">zcat hairpin.fa.gz | seqkit seq -m 60 | seqkit stats</span><br><span class="line"><span class="comment"># è®¾ç½®æœ€å°åºåˆ—é•¿åº¦å’Œæœ€å¤§åºåˆ—é•¿åº¦ï¼Œç”¨äºè¿‡æ»¤åºåˆ—ï¼Œå¹¶ç»Ÿè®¡</span></span><br><span class="line">zcat hairpin.fa.gz | seqkit seq -m 100 -M 1000 | seqkit stats</span><br><span class="line"><span class="comment"># ä¿å­˜&gt;100ä¸”&lt;1000é•¿åº¦çš„åºåˆ—</span></span><br><span class="line">seqkit seq -m 100 -M 1000 hairpin.fa.gz &gt; hairpin100-1000.fa</span><br><span class="line">seqkit <span class="built_in">stat</span> hairpin100-1000.fa</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="æå–ID"><a href="#æå–ID" class="headerlink" title="æå–ID"></a>æå–ID</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">head gene.fa</span><br><span class="line"><span class="comment">## åç§°å…¨è¡Œ</span></span><br><span class="line">seqkit seq gene.fa -n | head</span><br><span class="line"><span class="comment"># ä»…ä»…æ‰“å°ID</span></span><br><span class="line">seqkit seq gene.fa -n -i | head</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–åå­—ä¸­çš„ä¿¡æ¯</span></span><br><span class="line">zcat hairpin.fa.gz | head</span><br><span class="line"><span class="comment"># æå–IDä¸­ç¬¬äºŒä¸ªå­—æ®µä½œä¸ºID</span></span><br><span class="line">seqkit seq hairpin.fa.gz -n -i --id-regexp <span class="string">&quot;^[^\s]+\s([^\s]+)\s&quot;</span> | head</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="å•è¡Œ-å¤šè¡Œè½¬æ¢"><a href="#å•è¡Œ-å¤šè¡Œè½¬æ¢" class="headerlink" title="å•è¡Œ/å¤šè¡Œè½¬æ¢"></a>å•è¡Œ/å¤šè¡Œè½¬æ¢</h1><ul>
<li>-sæå–å¹¶å±•ç¤ºåºåˆ—</li>
<li>-w ä»£è¡¨æ¯è¡Œçš„ç¢±åŸºæ•°é‡ï¼Œ0ä»£è¡¨ä¸æ¢è¡Œ</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä»…ä»…æå–åºåˆ— -s</span></span><br><span class="line">seqkit seq gene.fa -s -w 0|head</span><br><span class="line"><span class="comment">#--å°†å¤šè¡Œåºåˆ—è½¬åŒ–ä¸ºæ ‡å‡†4è¡ŒFASTQ</span></span><br><span class="line">seqkit seq C1_1.fq.gz -w 0|head</span><br></pre></td></tr></table></figure>

<h1 id="åå‘-äº’è¡¥"><a href="#åå‘-äº’è¡¥" class="headerlink" title="åå‘/äº’è¡¥"></a>åå‘/äº’è¡¥</h1><ul>
<li>-r åºåˆ—åå‘</li>
<li>-påºåˆ—äº’è¡¥</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åºåˆ—åå‘äº’è¡¥,-råå‘ï¼Œ-päº’è¡¥</span></span><br><span class="line">seqkit seq hairpin.fa.gz -r -p|head</span><br></pre></td></tr></table></figure>

<h1 id="åˆ é™¤gap-å¤§å°å†™è½¬æ¢"><a href="#åˆ é™¤gap-å¤§å°å†™è½¬æ¢" class="headerlink" title="åˆ é™¤gap/å¤§å°å†™è½¬æ¢"></a>åˆ é™¤gap/å¤§å°å†™è½¬æ¢</h1><ul>
<li>-g å»é™¤åºåˆ—ä¸­çš„é—´éš”,å°†ä¸­é—´çš„æ¨ªæ å»æ‰</li>
<li>-uè½¬åŒ–åºåˆ—ä¸ºå¤§å†™å­—æ¯å±•ç¤º</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;&gt;seq\nACGT-ACTGC-acc&quot;</span> | seqkit seq -g -u</span><br></pre></td></tr></table></figure>

<h1 id="RNAè½¬ä¸ºDNA"><a href="#RNAè½¬ä¸ºDNA" class="headerlink" title="RNAè½¬ä¸ºDNA"></a>RNAè½¬ä¸ºDNA</h1><ul>
<li>â€”rna2dna å°†RNAåºåˆ—è½¬åŒ–ä¸ºDNAåºåˆ—</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;&gt;seq\nUCAUAUGCUUGUCUCAAAGAUUA&quot;</span> | seqkit seq --rna2dna</span><br></pre></td></tr></table></figure>

<h1 id="subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ"><a href="#subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ" class="headerlink" title="subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ"></a>subseqé€šè¿‡æŒ‡å®šåŒºåŸŸ</h1><ul>
<li>-r é€šè¿‡åŒºåŸŸæ¥æˆªå–åºåˆ—</li>
</ul>
<p>å¦‚1:12æå–å‰12ä¸ªç¢±åŸºï¼Œ-12:-1æå–åºåˆ—ç»“å°¾12ä¸ªç¢±åŸºï¼›<br>for last 12 bases, 13:-1 for cutting first 12 bases. type â€œseqkit subseq -hâ€ for more examples</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#-æå–åºåˆ—å‰1ï¼š12ä¸ªç¢±åŸº</span><br><span class="line">zcat C1_1.fq.gz | seqkit subseq -r 1:12 |head</span><br><span class="line">#-æå–åºåˆ—æœ€å1ï¼š12ä¸ªç¢±åŸº</span><br><span class="line">zcat C1_1.fq.gz | seqkit subseq -r -12:-1 |head</span><br><span class="line"> </span><br><span class="line">#å–ç¬¬12è‡³å€’æ•°ç¬¬12ä¸ªç¢±åŸºï¼Œå³å‰11å’Œå11ä¸ªç¢±åŸºå»æ‰</span><br><span class="line">zcat C1_1.fq.gz | seqkit subseq -r 12:-12| head</span><br></pre></td></tr></table></figure>

<p>åŸºäºgtf/bedä¿¡æ¯æŒ‘é€‰å­åºåˆ—ã€‚</p>
<p>â€”gtf  æ ¹æ®gtfæ–‡ä»¶æŒ‘é€‰åŸºå› ï¼Œè¿™éƒ¨åˆ†åŠŸèƒ½ç”¨äºæ ¹æ®åŸºå› æ³¨é‡Šå¿«é€Ÿæå–åŸºå› åºåˆ—ï¼Œåœ¨å®åŸºå› ç»„ã€è½¬å½•ç»„ã€é‡æµ‹åºä¸­å¸¸ç”¨ã€‚â€”chr é€‰æ‹©æŸ“è‰²ä½“ï¼Œâ€”feature cdsé€‰æ‹©åºåˆ—ç±»å‹</p>
<p>ä»¥æ‹Ÿå—èŠ¥åŸºå› ç»„çš„åºåˆ—å’Œæ³¨é‡Šæ•°æ®æ¼”ç¤ºï¼šæå–ç¬¬ä¸€æ¡æŸ“è‰²ä½“ä¸Šçš„CDSåŸºå› ä¿¡æ¯ï¼Œå¹¶ç»Ÿè®¡åŸºæœ¬ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">seqkit subseq --gtf Arabidopsis_thaliana.TAIR10.49.gtf.gz --chr 1 --feature cds  Arabidopsis_thaliana.TAIR10.dna.toplevel.fa.gz  &gt; chr1.gtf.cds.fa</span><br><span class="line">seqkit stats chr1.gtf.cds.fa</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>-u å¯ä»¥æå–ç›®æ ‡åŸºå› ä¸Šæ¸¸çš„åºåˆ—</li>
<li>-f ç›®æ ‡åŒºåŸŸä¸å±•ç¤º</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#--æŒ‘é€‰åºåˆ—å¹¶å¤šåŠ ä¸Šä¸Šæ¸¸çš„3ä¸ªç¢±åŸº</span><br><span class="line">seqkit subseq --gtf Arabidopsis_thaliana.TAIR10.49.gtf.gz Arabidopsis_thaliana.TAIR10.dna.toplevel.fa.gz -u 3 |head</span><br><span class="line"> </span><br><span class="line"># ä»…æå–ä¸Šæ¸¸åºåˆ—ï¼Œå¦‚æå–å¯åŠ¨å­åŒº2kï¼š-fä»…å®šä½ä¸è¾“å‡ºä½ç½®åºåˆ—ï¼Œ-uè¾“å‡ºä¸Šæ¸¸åºåˆ—ï¼Œæ­¤å¤„ç¤ºä¾‹3bp</span><br><span class="line">seqkit subseq --gtf Arabidopsis_thaliana.TAIR10.49.gtf.gz Arabidopsis_thaliana.TAIR10.dna.toplevel.fa.gz -u 3 -f |head</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="sliding-æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„"><a href="#sliding-æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„" class="headerlink" title="sliding æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„"></a>sliding æ»‘çª—æå–åºåˆ—ï¼Œæ”¯æŒç¯çŠ¶åŸºå› ç»„</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#-s æ­¥é•¿ä¸º3ï¼Œ-W åºåˆ—é•¿åº¦ä¸º6ä¸ªç¢±åŸº</span><br><span class="line">echo -e &quot;&gt;seq\nACGTacgtNN&quot; | seqkit sliding -s 3 -W 6</span><br><span class="line"># -g è´ªå©ªæ¨¡å¼ï¼Œåé¢ä¸è¶³6ä¸ªé‚£ä¹Ÿå–</span><br><span class="line">echo -e &quot;&gt;seq\nACGTacgtNN&quot; | seqkit sliding -s 3 -W 6 -g</span><br><span class="line"># ç¯çŠ¶DNAæ¨¡å¼-Cï¼Œé¦–å°¾ä¸ç®—ä¸­æ–­ï¼Œç¯çŠ¶</span><br><span class="line">echo -e &quot;&gt;seq\nACGTacgtNN&quot; | seqkit sliding -s 3 -W 6 -C</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¥é•¿ä¸º5ï¼Œå–30ä¸ªç¢±åŸºåºåˆ—ï¼Œç„¶åç»Ÿè®¡GCå«é‡</li>
</ul>
<ul>
<li>fx2tabï¼šç»Ÿè®¡fasta/fastqåºåˆ—çš„ä¿¡æ¯ä¸ºè¡¨æ ¼</li>
<li>-nä»…è¾“å‡ºIDï¼Œä¸è¾“å‡ºåºåˆ—</li>
<li>-gä¸ºGCå«é‡</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zcat hairpin.fa.gz | seqkit sliding -s 5 -W 30 | seqkit fx2tab -n -g |head</span><br></pre></td></tr></table></figure>

<h1 id="faidx-åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—"><a href="#faidx-åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—" class="headerlink" title="faidx åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—"></a>faidx åˆ›å»ºFASTAç´¢å¼•æ–‡ä»¶å¹¶æå–å­åºåˆ—</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è§£å‹</span><br><span class="line">zcat hairpin.fa.gz &gt; hairpin.fa</span><br><span class="line"> </span><br><span class="line"># å»ºç´¢å¼•*.faiæ–‡ä»¶</span><br><span class="line">seqkit faidx hairpin.fa</span><br><span class="line"> </span><br><span class="line"># IDä¿¡æ¯ï¼šhsa-let-7a-1 hsa-let-7a-2</span><br><span class="line">seqkit faidx hairpin.fa hsa-let-7a-1 hsa-let-7a-2</span><br><span class="line"># -f æ ‡é¢˜è¡Œå…¨éƒ¨æ˜¾ç¤º</span><br><span class="line">seqkit faidx hairpin.fa hsa-let-7a-1 hsa-let-7a-2 -f</span><br><span class="line"># æå–åºåˆ—å¹¶é€‰æ‹©åŒºåŸŸæ˜¾ç¤º</span><br><span class="line">seqkit faidx hairpin.fa hsa-let-7a-1:1-10</span><br><span class="line">seqkit faidx hairpin.fa hsa-let-7a-1:-10--1</span><br><span class="line">seqkit faidx hairpin.fa hsa-let-7a-1:1</span><br><span class="line"># æ£€æŸ¥hsaå¼€å¤´çš„åºåˆ—å¹¶ç»Ÿè®¡</span><br><span class="line">seqkit faidx hairpin.fa hsa -r | seqkit stats</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="watch-åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾"><a href="#watch-åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾" class="headerlink" title="watch åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾"></a>watch åºåˆ—è´¨é‡çš„ç›‘æµ‹å’Œåœ¨çº¿ç›´æ–¹å›¾</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#-å–å¯¹æ•°å±•ç¤ºç›´æ–¹å›¾</span><br><span class="line">seqkit watch -L -f ReadLen hairpin.fa</span><br><span class="line"> </span><br><span class="line"># æ¯äº”åƒä¸ªåšä¸€ä¸ªå›¾ä¿å­˜åœ¨pdfæ–‡ä»¶ä¸­</span><br><span class="line">seqkit watch -p 500000 -O qhist.pdf -f MeanQual C1_1.fq.gz</span><br></pre></td></tr></table></figure>

<p>ä»æœ‰é”™è¯¯è®°å½•çš„fastqæ–‡ä»¶ä¸­æŒ½æ•‘å¯ç”¨çš„è¯»å–</p>
<h1 id="sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶"><a href="#sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶" class="headerlink" title="sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶"></a>sanaï¼šæ¸…ç†æŸåfastqæ–‡ä»¶</h1><p>è¿™é‡Œæˆ‘ä¸“é—¨å°†C1_1.fqçš„ç¬¬ä¸€ä¸ªåºåˆ—è¿›è¡Œäº†é”™ä½ï¼Œè¿›è¡Œæµ‹è¯•ã€‚è¿™ä¸ªæ“ä½œå¾€å¾€åœ¨è¿›è¡Œæ•°æ®æ•´åˆçš„æ—¶å€™å¯ä»¥æœ‰å¾ˆå¤§ä½œç”¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zcat C1_1.fq.gz|sed &#x27;2 s/^/A/&#x27; &gt; C1_1_bad.fq</span><br><span class="line">seqkit sana C1_1_bad.fq -o rescued.fq.gz</span><br></pre></td></tr></table></figure>

<h1 id="fq2fa-å°†fqè½¬ä¸ºfaæ ¼å¼"><a href="#fq2fa-å°†fqè½¬ä¸ºfaæ ¼å¼" class="headerlink" title="fq2fa å°†fqè½¬ä¸ºfaæ ¼å¼"></a>fq2fa å°†fqè½¬ä¸ºfaæ ¼å¼</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">seqkit fq2fa C1_1.fq.gz -o C1_1.fa</span><br></pre></td></tr></table></figure>

<h1 id="fx2tab-amp-tab2fx-åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼"><a href="#fx2tab-amp-tab2fx-åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼" class="headerlink" title="fx2tab &amp; tab2fx åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼"></a>fx2tab &amp; tab2fx åºåˆ—è½¬åŒ–è¡¨æ ¼æ ¼å¼</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™ä¸€è½¬åŒ–å¾ˆæœ‰ç”¨ï¼Œå¾€å¾€ç”¨äºè¡¨æ ¼/çŸ©é˜µå¤„ç†çš„æ—¶å€™ã€‚</span><br><span class="line">seqkit fx2tab hairpin.fa.gz | head -n 2</span><br><span class="line">é€šè¿‡çŸ©é˜µæ ¼å¼çš„åºåˆ—æ–‡ä»¶ç»Ÿè®¡åºåˆ—é•¿åº¦å’Œè´¨é‡å€¼</span><br><span class="line"></span><br><span class="line">-l ç»Ÿè®¡åºåˆ—é•¿åº¦</span><br><span class="line"></span><br><span class="line">-g ç»Ÿè®¡å¹³å‡GCå«é‡</span><br><span class="line"></span><br><span class="line">-i åªæ‰“å°åç§°(ä¸æ‰“å°åºåˆ—)</span><br><span class="line"></span><br><span class="line">-H æ‰“å°æ ‡é¢˜è¡Œ</span><br><span class="line"># æ‰“å°åºåˆ—é•¿åº¦ã€GCå«é‡</span><br><span class="line">seqkit fx2tab hairpin.fa.gz -l -g -n -i -H | head</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>tab2fx å’Œè¡¨æ ¼æ ¼å¼è½¬åŒ–ä¸ºåºåˆ—æ ¼å¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># seqkit tab2fx è¡¨æ ¼å½¢å¼è½¬åŒ–ä¸ºåºåˆ—å½¢å¼</span><br><span class="line">zcat hairpin.fa.gz | seqkit fx2tab | seqkit tab2fx | head</span><br><span class="line"> </span><br><span class="line"># è½¬åŒ–ä¸ºè¡¨æ ¼ï¼Œç„¶åæ’åºï¼Œç„¶åè½¬åŒ–å›å»</span><br><span class="line">zcat hairpin.fa.gz \</span><br><span class="line">    | seqkit fx2tab -l \</span><br><span class="line">    | sort -t &quot;`echo -e &#x27;\t&#x27;`&quot; -n -k4,4 \</span><br><span class="line">    | seqkit tab2fx | head</span><br><span class="line"># ç­‰åŒäºä¸‹é¢çš„å‘½ä»¤</span><br><span class="line">seqkit sort -l hairpin.fa.gz | head</span><br><span class="line"> </span><br><span class="line"># é€šè¿‡è¿™ä¸ªè½¬åŒ–å¯ä»¥å°†å¾ˆå¤šåœ¨è¡¨æ ¼ä¸­å®ç°çš„æ•°æ®å¤„ç†æ–¹æ³•ç”¨äºåºåˆ—</span><br><span class="line">ä¾‹å¦‚ä¸‹é¢çš„æå–1000ä¸ªåºåˆ—ï¼šseqkit fx2tab hairpin.fa.gz | head -n 1000 | seqkit tab2fx | head</span><br></pre></td></tr></table></figure>

<h1 id="translate-ç¿»è¯‘DNA-RNAä¸ºè›‹ç™½è´¨åºåˆ—"><a href="#translate-ç¿»è¯‘DNA-RNAä¸ºè›‹ç™½è´¨åºåˆ—" class="headerlink" title="translate ç¿»è¯‘DNA/RNAä¸ºè›‹ç™½è´¨åºåˆ—"></a>translate ç¿»è¯‘DNA/RNAä¸ºè›‹ç™½è´¨åºåˆ—</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#--è½¬åŒ–ä¸ºè›‹ç™½åºåˆ—</span><br><span class="line">seqkit translate gene.fa|head</span><br><span class="line"> </span><br><span class="line"># å»é™¤&#x27;X&#x27; å’Œ &#x27;*&#x27;</span><br><span class="line">seqkit translate hairpin.fa </span><br><span class="line">seqkit translate hairpin.fa --trim | head</span><br></pre></td></tr></table></figure>

<h1 id="grep-åºåˆ—åŒ¹é…"><a href="#grep-åºåˆ—åŒ¹é…" class="headerlink" title="grep  åºåˆ—åŒ¹é…"></a>grep  åºåˆ—åŒ¹é…</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ç”Ÿæˆä¸€ä¸ªIDåˆ—è¡¨</span><br><span class="line">grep &#x27;&gt;&#x27; C1_1.fa|cut -c2-|head -n 10 &gt; id.txt</span><br><span class="line"> </span><br><span class="line"># ä½¿ç”¨åºåˆ—idåˆ—è¡¨è¿›è¡Œæœç´¢(ä¸åŒ…å«ç©ºæ ¼)</span><br><span class="line">seqkit grep -f id.txt C1_1.fq.gz -o result.fq.gz</span><br><span class="line"># ä½¿ç”¨åºåˆ—åç§°åˆ—è¡¨è¿›è¡Œæœç´¢(å®ƒä»¬å¯èƒ½åŒ…å«ç©ºæ ¼)</span><br><span class="line">seqkit grep -n -f id.txt C1_1.fq.gz -o result.fa.gz</span><br><span class="line">zcat  result.fa.gz</span><br><span class="line"># æå–hsaå¼€å¤´çš„åºåˆ—</span><br><span class="line">zcat hairpin.fa.gz | seqkit grep -r -p ^hsa |head</span><br><span class="line"> </span><br><span class="line"># -vå‚æ•°vç”¨äºç§»é™¤åºåˆ—</span><br><span class="line">zcat hairpin.fa.gz | seqkit grep -r -p ^hsa -p ^mmu -v | head</span><br><span class="line"> </span><br><span class="line"># æå–ID</span><br><span class="line">zcat miRNA.diff.gz | grep ^# -v | grep NEW | cut -f 2 &gt; list</span><br><span class="line">head list</span><br><span class="line"># æ ¹æ®IDæå–æ–‡ä»¶</span><br><span class="line">zcat hairpin.fa.gz | seqkit grep -f list &gt; new.fa</span><br><span class="line">head new.fa</span><br><span class="line"> </span><br><span class="line"># æå–åŒ…å«ç‰¹å®šç¢±åŸºç»„åˆçš„åºåˆ—</span><br><span class="line">cat hairpin.fa.gz | seqkit grep -s -i -p aggcg |head</span><br><span class="line"># ç»Ÿè®¡</span><br><span class="line">cat hairpin.fa.gz | seqkit grep -s -i -p aggcg | seqkit stats</span><br><span class="line"> </span><br><span class="line">#  å»é™¤ åŒ…å«ç‰¹å®šç»„åˆç¢±åŸºçš„åºåˆ—</span><br><span class="line">zcat hairpin.fa.gz | seqkit grep -s -r -i -p ^aggcg |head</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="locate-è¾“å‡ºåŒ¹é…ä½ç½®"><a href="#locate-è¾“å‡ºåŒ¹é…ä½ç½®" class="headerlink" title="locate è¾“å‡ºåŒ¹é…ä½ç½®"></a>locate è¾“å‡ºåŒ¹é…ä½ç½®</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ï¼ƒã€€å…¶ä»–ä¸¤ç§è¾“å‡ºæ ¼å¼</span><br><span class="line">zcat hairpin.fa.gz | seqkit locate -i -d -p AUGGACUN --bed</span><br><span class="line">zcat hairpin.fa.gz | seqkit locate -i -d -p AUGGACUN --gtf</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="fish-ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—"><a href="#fish-ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—" class="headerlink" title="fish ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—"></a>fish ä½¿ç”¨å±€éƒ¨æ¯”å¯¹åœ¨è¾ƒå¤§çš„åºåˆ—ä¸­å¯»æ‰¾çŸ­åºåˆ—</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo -e &#x27;&gt;seq\nACGACGACGA&#x27; \</span><br><span class="line">    | seqkit locate -p ACGA -G | csvtk -t pretty</span><br><span class="line"> </span><br><span class="line">echo -e &#x27;&gt;seq\nACGACGACGA&#x27; \</span><br><span class="line">    | seqkit fish -F ACGA -a 2&gt;&amp;1 | csvtk -t pretty</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="amplicon-é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­-æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ"><a href="#amplicon-é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­-æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ" class="headerlink" title="amplicon é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­(æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ)"></a>amplicon é€šè¿‡å¼•ç‰©æ£€ç´¢æ‰©å¢å­(æˆ–å…¶å‘¨å›´çš„ç‰¹å®šåŒºåŸŸ)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo -ne &quot;&gt;seq\nacgcccactgaaatga\n&quot; \</span><br><span class="line">    | seqkit amplicon -F ccc -R ttt</span><br><span class="line"> </span><br><span class="line"># è®¾ç½®è¾“å‡ºæ ¼å¼ä¸ºbedï¼ŒåŒ¹é…çš„ä½ç‚¹ç­‰ä¿¡æ¯</span><br><span class="line">echo -ne &quot;&gt;seq\nacgcccactgaaatga\n&quot; \</span><br><span class="line">    | seqkit amplicon -F ccc -R ttt --bed</span><br><span class="line"> </span><br><span class="line">#- ä½¿ç”¨å¼•ç‰©æ–‡ä»¶ï¼Œè¿™ç”¨äºåˆ˜è€å¸ˆç»„çš„é«˜é€šé‡åˆ†èŒçš„åºåˆ—æ‹†åˆ†é€Ÿåº¦åº”è¯¥å¾ˆå®¢è§‚</span><br><span class="line"># cat seqs4amplicon.fa | seqkit amplicon -p primers.tsv --bed</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è¾“å‡ºé™¤å»å¼•ç‰©ä¹‹å¤–çš„éƒ¨åˆ†ï¼Œ-rè¾“å‡ºå‡ ä¸ªç¢±åŸº</span><br><span class="line">echo -ne &quot;&gt;seq\nacgcccactgaaatga\n&quot; \</span><br><span class="line">    | seqkit amplicon -F ccc -R ttt -r 4:7</span><br><span class="line"># è¾“å‡ºæ ¼å¼ä¸ºbed</span><br><span class="line">echo -ne &quot;&gt;seq\nacgcccactgaaatga\n&quot; \</span><br><span class="line">    | seqkit amplicon -F ccc -R ttt -r 4:7 --bed</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="duplicate-å¯¹åºåˆ—é‡å¤Næ¬¡"><a href="#duplicate-å¯¹åºåˆ—é‡å¤Næ¬¡" class="headerlink" title="duplicate å¯¹åºåˆ—é‡å¤Næ¬¡"></a>duplicate å¯¹åºåˆ—é‡å¤Næ¬¡</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># é‡å¤åºåˆ—1æ¬¡ï¼Œä½†æ˜¯åå­—æ²¡æœ‰ä¿®æ”¹</span><br><span class="line">cat hairpin.fa | seqkit head -n 1 \</span><br><span class="line">    | seqkit duplicate -n 2</span><br><span class="line"># å¯¹é‡å¤åºåˆ—æ”¹åï¼Œä½¿å…¶ç‹¬ä¸€æ— äºŒ</span><br><span class="line">cat hairpin.fa | seqkit head -n 1 \</span><br><span class="line">    | seqkit duplicate -n 2 | seqkit rename</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="rmdup-é€šè¿‡id-åç§°-åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—"><a href="#rmdup-é€šè¿‡id-åç§°-åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—" class="headerlink" title="rmdup é€šè¿‡id/åç§°/åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—"></a>rmdup é€šè¿‡id/åç§°/åºåˆ—åˆ é™¤é‡å¤çš„åºåˆ—</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å»é™¤é‡å¤çš„åºåˆ—</span><br><span class="line">zcat hairpin.fa.gz | seqkit rmdup -s -o clean.fa.gz</span><br><span class="line"> </span><br><span class="line"># ä¿å­˜é‡å¤åºåˆ—å¾—åˆ°æ–‡ä»¶ -D duplicated.detail.txt</span><br><span class="line">zcat hairpin.fa.gz \</span><br><span class="line">    | seqkit rmdup -s -i -o clean.fa.gz -d duplicated.fa.gz -D duplicated.detail.txt</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="common-ï¼šé€šè¿‡id-åç§°-åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—"><a href="#common-ï¼šé€šè¿‡id-åç§°-åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—" class="headerlink" title="common ï¼šé€šè¿‡id/åç§°/åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—"></a>common ï¼šé€šè¿‡id/åç§°/åºåˆ—æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„å…¬å…±åºåˆ—</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># é€šè¿‡IDåŒ¹é…ï¼Œæ–‡ä»¶å¤¹ä¸‹å…¨éƒ¨çš„faåºåˆ—å…¬å…±éƒ¨åˆ†è¾“å‡ºæ¥</span><br><span class="line">seqkit common *.fq.gz</span><br><span class="line"> </span><br><span class="line"># é€šè¿‡-nå®ç°å…¨éƒ¨åå­—åŒ¹é…ï¼Œ-oè¾“å‡ºç»“æœ</span><br><span class="line">seqkit common *.fq.gz -n -o common.fq </span><br><span class="line"># é€šè¿‡-såºåˆ—åŒ¹é…</span><br><span class="line">seqkit common *.fq.gz -s -i -o common.fq</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="split-æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶"><a href="#split-æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶" class="headerlink" title="split æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶"></a>split æ‹†åˆ†åºåˆ—ä¸ºå­æ–‡ä»¶</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŒ‰åç§°IDã€ç»™å®šåŒºåŸŸçš„å­åºåˆ—ã€æ–‡ä»¶å¤§å°æˆ–åºåˆ—æ•°é‡å°†åºåˆ—æ‹†åˆ†ä¸ºæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">å¯ç”¨äºå°†å¤§æ–‡ä»¶æ‹†åˆ†åï¼Œå¹¶è¡Œå¤„ç†ï¼ŒåŠ é€Ÿåˆ†æã€‚å¦‚ä»contigä¸­é¢„æµ‹åŸºå› ã€‚</span><br><span class="line">#æŒ‰ç…§10000ä¸ªåºåˆ—ä¸ºä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ï¼Œç»“æœä¸ºhairpin.fa.gz.split/ç›®å½• ï¼Œæ–‡ä»¶åä¸ºhairpin.part_00x.fastaï¼Œ-s</span><br><span class="line">seqkit split hairpin.fa.gz -s 10000 -2</span><br><span class="line"> </span><br><span class="line"># å°†åºåˆ—æ‹†åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†(å¸¸ç”¨ï¼Œç­‰åˆ†ç„¶åå¹¶è¡Œ)</span><br><span class="line">seqkit split hairpin.fa.gz -p 5 -2</span><br><span class="line"> </span><br><span class="line"># å¤æ‚ä¸€ç‚¹çš„å°±æ˜¯æŒ‰ç…§IDåŒºåˆ†</span><br><span class="line">seqkit split hairpin.fa.gz -i --id-regexp &quot;^([\w]+)\-&quot; -2</span><br><span class="line"> </span><br><span class="line"># æŒ‰ç…§å‰ä¸‰ä¸ªåºåˆ—ç¢±åŸºæ¥åŒºåˆ†</span><br><span class="line">seqkit split hairpin.fa.gz -r 1:3 -2</span><br></pre></td></tr></table></figure>

<h1 id="split2-æ‹†åˆ†æ–‡ä»¶-å‡çº§ç‰ˆæœ¬"><a href="#split2-æ‹†åˆ†æ–‡ä»¶-å‡çº§ç‰ˆæœ¬" class="headerlink" title="split2 æ‹†åˆ†æ–‡ä»¶ å‡çº§ç‰ˆæœ¬"></a>split2 æ‹†åˆ†æ–‡ä»¶ å‡çº§ç‰ˆæœ¬</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Flags:</span><br><span class="line">  -l, --by-length string   split sequences into chunks of &gt;=N bases, supports K/M/G suffix</span><br><span class="line">  -p, --by-part int        æŒ‰ç…§æ‹†åˆ†å‡ºæ¥çš„æ•°é‡ï¼Œæ¯”å¦‚ï¼šæ‹†åˆ†æˆä¸¤ä¸ªå­æ–‡ä»¶2ã€‚-s, --by-size int        æŒ‰ç…§åºåˆ—æ•°é‡æ‹†åˆ†</span><br><span class="line">  -f, --force              å¼ºåˆ¶è¦†ç›–æ–‡ä»¶</span><br><span class="line">  -h, --help               æŸ¥çœ‹å¸®åŠ©æ–‡ä»¶</span><br><span class="line">  -O, --out-dir string     è¾“å‡ºæ–‡ä»¶å¤¹ (default value is $infile.split)</span><br><span class="line">  -1, --read1 string       (gzipped) åŒç«¯åºåˆ—ç¬¬ä¸€ä¸ª</span><br><span class="line">  -2, --read2 string       (gzipped) åŒç«¯åºåˆ—ç¬¬äºŒä¸ª</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åŒæ—¶æ”¯æŒfaå’Œfqæ–‡ä»¶ã€‚å•ç«¯å’ŒåŒç«¯åºåˆ—æ‹†åˆ†å®ä¾‹</p>
<p>-få¼ºåˆ¶è¦†ç›–ç»“æœï¼Œé€‚åˆé‡å¤è®¡ç®—æ—¶ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">seqkit split2 hairpin.fa.gz -s 10000 -f</span><br><span class="line"> </span><br><span class="line"># åŒç«¯åºåˆ—æ‹†åˆ†(é‡ç‚¹)ï¼ŒpæŒ‡å®šæ‹†åˆ†æ•°é‡ï¼Œ-OæŒ‡å®šè¾“å‡ºç›®å½•ï¼Œ-fè¦†ç›–ç»“æœï¼Œé»˜è®¤ä¸ºå‹ç¼©</span><br><span class="line">seqkit split2 -1 C1_1.fq.gz -2 C1_2.fq.gz -p 2 -O out -f</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="pair-æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶"><a href="#pair-æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶" class="headerlink" title="pair æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶"></a>pair æ‹¼æ¥ä¸¤ä¸ªfastqæ–‡ä»¶</h1><p>ç•™ä¸‹åŒ¹é…çš„ï¼Œå»é™¤ä¸åŒ¹é…çš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ‰©å¢å­çš„åŒç«¯åºåˆ—åšä¸€ä¸ªæ¼”ç¤ºï¼š</p>
<p>æ³¨æ„ï¼šåŒç«¯åºåˆ—åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„é¡ºåºæœ€å¥½æ˜¯ä¸€æ ·çš„ï¼Œå¦åˆ™ä¼šæ¶ˆè€—å¤§é‡å†…å­˜å»åŒ¹é…ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">seqkit pair -1 C1_1.fq.gz -2 C1_2.fq.gz -O result</span><br><span class="line"># -u è¾“å‡ºæœªåŒ¹é…ä¸Šçš„æ–‡ä»¶</span><br><span class="line">seqkit pair -1 C1_1.fq.gz -2 C1_2.fq.gz -O result -u -f</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="sample-æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚"><a href="#sample-æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚" class="headerlink" title="sample æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚"></a>sample æŒ‰æ•°é‡æˆ–æ¯”ä¾‹å¯¹åºåˆ—è¿›è¡ŒæŠ½æ ·ã€‚</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŒ‰ç…§ç™¾åˆ†æ¯”ä¾‹å’Œåºåˆ—æ•°é‡è¿›è¡ŒæŠ½æ ·</span><br><span class="line"># æŠ½æ ·ç™¾åˆ†ä¹‹å</span><br><span class="line">zcat C1_1.fq.gz | seqkit sample -p 0.1 -o sample.fq.gz</span><br><span class="line"># æŠ½æ ·1000æ¡</span><br><span class="line">zcat C1_1.fq.gz | seqkit sample -n 1000 -o sample.fq.gz</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼š1000æ¡å¹¶ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œå¯èƒ½æ˜¯900å¤šæ¡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿçœ‹è¿™é‡Œäº†è§£é—®é¢˜ã€‚https://bioinf.shenwei.me/seqkit/note/#effect-of-random-seed-on-results-of-seqkit-sample</span><br></pre></td></tr></table></figure>



<p>è¿™é‡Œä¸ºå¤§å®¶å±•ç¤ºä¸€ä¸‹å‡å°‘å†…å­˜çš„åºåˆ—æŠ½æ ·æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æŠ½æ · seqkit sample </span><br><span class="line">zcat hairpin.fa.gz \</span><br><span class="line">    | seqkit sample -p 0.1 \</span><br><span class="line">    | seqkit head -n 1000 -o sample.fa.gz</span><br><span class="line"> </span><br><span class="line"># è®¾ç½®éšæœºç§å­ï¼Œæ–¹ä¾¿é‡å¤ç»“æœ: -s 11</span><br><span class="line">zcat hairpin.fa.gz \</span><br><span class="line">    | seqkit sample -p 0.1 -s 11 |head</span><br><span class="line"> </span><br><span class="line"># æŠ½æ ·åæ‰“ä¹±åºåˆ— :seqkit shuffle</span><br><span class="line">zcat hairpin.fa.gz \</span><br><span class="line">    | seqkit sample -p 0.1 \</span><br><span class="line">    | seqkit shuffle -o sample.fa.gz</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="range-æ‰“å°åºåˆ—-æŒ‰ç…§ä¸€ä¸ªèŒƒå›´"><a href="#range-æ‰“å°åºåˆ—-æŒ‰ç…§ä¸€ä¸ªèŒƒå›´" class="headerlink" title="range æ‰“å°åºåˆ— æŒ‰ç…§ä¸€ä¸ªèŒƒå›´"></a>range æ‰“å°åºåˆ— æŒ‰ç…§ä¸€ä¸ªèŒƒå›´</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ‰“å°ä¸€ä¸ªèŒƒå›´å†…çš„åºåˆ—</span><br><span class="line">cat hairpin.fa | seqkit range -r 1:10</span><br><span class="line"># æ‰“å°æœ€åå‡ è¡Œçš„åºåˆ—</span><br><span class="line">cat hairpin.fa | seqkit range -r -100:-1 | seqkit stats</span><br><span class="line"># æ‰“å°ä¸­é—´èŒƒå›´çš„åºåˆ—</span><br><span class="line">cat hairpin.fa | seqkit range -r 101:150 | seqkit stats</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="repeat-ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°-åºåˆ—ã€‚"><a href="#repeat-ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°-åºåˆ—ã€‚" class="headerlink" title="repeat ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°/åºåˆ—ã€‚"></a>repeat ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢åç§°/åºåˆ—ã€‚</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä¿®æ”¹åºåˆ—åç§°ï¼šåˆ é™¤ç©ºæ ¼åå†…å­˜</span><br><span class="line">echo -e &quot;&gt;seq1 abc-123\nACGT-ACGT&quot; \</span><br><span class="line">    | seqkit replace -p &quot;\s.+&quot;</span><br><span class="line"> </span><br><span class="line"># ä¿®æ”¹åºåˆ—åï¼šæ›¿æ¢</span><br><span class="line">echo -e &quot;&gt;seq1 abc-123\nACGT-ACGT&quot; \</span><br><span class="line">    | seqkit replace -p &quot;\-&quot; -r &#x27;=&#x27;</span><br><span class="line"> </span><br><span class="line"># ä¿®æ”¹åºåˆ—ï¼šå»é™¤åºåˆ—é—´éš”</span><br><span class="line">echo -e &quot;&gt;seq1 abc-123\nACGT-ACGT&quot; \</span><br><span class="line">    | seqkit replace -p &quot; |-&quot; -s</span><br><span class="line"> </span><br><span class="line"># ä¿®æ”¹åºåˆ—ï¼šç»™æ¯ä¸€ä¸ªç¢±åŸºåŠ ä¸Šç©ºæ ¼</span><br><span class="line">echo -e &quot;&gt;seq1 abc-123\nACGT-ACGT&quot; \</span><br><span class="line">    | seqkit replace -p &quot;(.)&quot; -r &#x27;$1 &#x27; -s</span><br><span class="line"> </span><br><span class="line"># ä½¿ç”¨å­—ç¬¦åŠ æ•°æ®é‡å‘½ååºåˆ—-ç”¨äºæ‰©å¢å­ä»£è¡¨åºåˆ—æ”¹åéå¸¸ä¼˜ç§€</span><br><span class="line">echo -e &quot;&gt;abc\nACTG\n&gt;123\nATTT&quot; \</span><br><span class="line">    |  seqkit replace -p .+ -r &quot;ASV_&#123;nr&#125;&quot;</span><br><span class="line"> </span><br><span class="line">echo -e &quot;&gt;abc\nACTG\n&gt;123\nATTT&quot; \</span><br><span class="line">    |  seqkit replace -p .+ -r &quot;SAV_&#123;nr&#125;&quot; --nr-width 5</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="rename-é‡å‘½åé‡å¤çš„ID"><a href="#rename-é‡å‘½åé‡å¤çš„ID" class="headerlink" title="rename é‡å‘½åé‡å¤çš„ID"></a>rename é‡å‘½åé‡å¤çš„ID</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># é‡å‘½åï¼šç›¸åŒåºåˆ—ä¼šåœ¨åé¢åŠ ä¸Š_2 æ¥å¤„ç†</span><br><span class="line">echo -e &quot;&gt;a comment\nacgt\n&gt;b comment of b\nACTG\n&gt;a comment\naaaa&quot; \</span><br><span class="line">    | seqkit rename</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="concat-è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—"><a href="#concat-è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—" class="headerlink" title="concat è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—"></a>concat è¿æ¥å¤šä¸ªæ–‡ä»¶ä¸­å…·æœ‰ç›¸åŒIDçš„åºåˆ—</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è¿™é‡Œæ¼”ç¤ºç»„åˆå‰é¢ä¸¤ä¸ªç¢±åŸºå’Œæœ€åä¸¤ä¸ªç¢±åŸºçš„ç”¨æ³•</span><br><span class="line">seqkit concat &lt;(seqkit subseq -r 1:2 C1_1.fq.gz) &lt;(seqkit subseq -r -2:-1 C1_2.fq.gz)|head</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="shuffle-éšæœºæ‰“ä¹±åºåˆ—-é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜"><a href="#shuffle-éšæœºæ‰“ä¹±åºåˆ—-é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜" class="headerlink" title="shuffle éšæœºæ‰“ä¹±åºåˆ— é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜"></a>shuffle éšæœºæ‰“ä¹±åºåˆ— é»˜è®¤å…¨éƒ¨è¯»å…¥å†…å­˜</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">seqkit shuffle hairpin.fa.gz -2  &gt; shuffled.fa</span><br></pre></td></tr></table></figure>



<h1 id="sort-æŒ‰id-åç§°-åºåˆ—-é•¿åº¦æ’åºåºåˆ—"><a href="#sort-æŒ‰id-åç§°-åºåˆ—-é•¿åº¦æ’åºåºåˆ—" class="headerlink" title="sort æŒ‰id/åç§°/åºåˆ—/é•¿åº¦æ’åºåºåˆ—"></a>sort æŒ‰id/åç§°/åºåˆ—/é•¿åº¦æ’åºåºåˆ—</h1><p>â€”quiet å±å¹•ä¸è¾“å‡ºè¿‡ç¨‹</p>
<p>-i æ’åºå¿½ç•¥å¤§å°å†™</p>
<p>-l æŒ‰ç…§åºåˆ—é•¿åº¦æ’åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># IDæ’åº</span><br><span class="line">echo -e &quot;&gt;seq1\nACGTNcccc\n&gt;SEQ2\nacgtnAAAA&quot; \</span><br><span class="line">    | seqkit sort --quiet</span><br><span class="line"> </span><br><span class="line"># æŒ‰ç…§IDæ’åºï¼Œå¿½ç•¥å¤§å°å†™</span><br><span class="line">echo -e &quot;&gt;seq1\nACGTNcccc\n&gt;SEQ2\nacgtnAAAA&quot; \</span><br><span class="line">    | seqkit sort --quiet -i</span><br><span class="line"> </span><br><span class="line"># æŒ‰ç…§åºåˆ—é•¿åº¦æ’åºï¼Œç”±å°åˆ°å¤§</span><br><span class="line">echo -e &quot;&gt;seq1\nACGTNcccc\n&gt;SEQ2\nacgtnAAAAnnn\n&gt;seq3\nacgt&quot; \</span><br><span class="line">    | seqkit sort --quiet -l</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="mutate-ç¼–è¾‘åºåˆ—-ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤"><a href="#mutate-ç¼–è¾‘åºåˆ—-ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤" class="headerlink" title="mutate ç¼–è¾‘åºåˆ—(ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤)"></a>mutate ç¼–è¾‘åºåˆ—(ç‚¹çªå˜ã€æ’å…¥ã€åˆ é™¤)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo -ne &quot;&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n&quot;</span><br><span class="line"> </span><br><span class="line"># ä¿®æ”¹ç¬¬ä¸€ä¸ªç¢±åŸº</span><br><span class="line">echo -ne &quot;&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n&quot; \</span><br><span class="line">    | seqkit mutate -p 1:x</span><br><span class="line"> </span><br><span class="line"># ä¿®æ”¹ç¬¬äº”ä¸ªä½ç½®çš„ç¢±åŸºï¼Œè¾“å‡ºä¿¡æ¯éšè—    </span><br><span class="line">echo -ne &quot;&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n&quot; \</span><br><span class="line">    | seqkit mutate -p 5:x --quiet</span><br><span class="line"> </span><br><span class="line"># å¯ä»¥åŒæ—¶ä¿®æ”¹å¤šä¸ªç¢±åŸº</span><br><span class="line">echo -ne &quot;&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n&quot; \</span><br><span class="line">    | seqkit mutate -p 1:x -p -1:x --quiet</span><br><span class="line"> </span><br><span class="line"># åˆ é™¤ç¢±åŸº</span><br><span class="line">echo -ne &quot;&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n&quot; \</span><br><span class="line">    | seqkit mutate -d 1:1 --quiet</span><br><span class="line"> </span><br><span class="line"># åˆ é™¤å€’æ•°ä¸‰ä¸ªç¢±åŸº</span><br><span class="line">echo -ne &quot;&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n&quot; \</span><br><span class="line">    | seqkit mutate -d -3:-1 --quiet</span><br><span class="line"> </span><br><span class="line"># æ’å…¥ç¢±åŸº</span><br><span class="line">echo -ne &quot;&gt;1\nACTGNactgn\n&gt;2\nactgnACTGN\n&quot; \</span><br><span class="line">    | seqkit mutate -i 0:xx --quiet</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="head-å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—"><a href="#head-å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—" class="headerlink" title="head å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—"></a>head å±•ç¤ºå¼€å¤´Nè¡Œçš„åºåˆ—</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">seqkit head -n 1 hairpin.fa.gz</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="locate-å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®"><a href="#locate-å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®" class="headerlink" title="locate å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®"></a>locate å®šä½å­åºåˆ—æˆ–è€…ä¿å®ˆåºåˆ—ä½ç½®</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat gene.fa | seqkit locate -p ACT | csvtk pretty -t</span><br><span class="line"># è°ƒæ•´é”™é… æœ€å¤§é”™é…ä¸º1</span><br><span class="line">cat gene.fa \</span><br><span class="line">  | seqkit locate -p ACTG -m 1 \</span><br><span class="line">  | csvtk pretty -t</span><br><span class="line"> </span><br><span class="line"># ç®€å¹¶ç¢±åŸº</span><br><span class="line">zcat hairpin.fa.gz \</span><br><span class="line">    | seqkit locate -i -d -p AUGGACUN \</span><br><span class="line">    | head -n 4</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="restart-é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®"><a href="#restart-é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®" class="headerlink" title="restart é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®"></a>restart é‡ç½®å¾ªç¯åŸºå› ç»„çš„èµ·å§‹ä½ç½®</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo -e &quot;&gt;seq\nacgtnACGTN&quot;</span><br><span class="line"> </span><br><span class="line">echo -e &quot;&gt;seq\nacgtnACGTN&quot; | seqkit restart -i 2</span><br><span class="line">echo -e &quot;&gt;seq\nacgtnACGTN&quot; | seqkit restart -i -2</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="convet-äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º-Sanger"><a href="#convet-äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º-Sanger" class="headerlink" title="convet äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º Sanger"></a>convet äºŒä»£æµ‹åºè´¨é‡å€¼çš„è½¬åŒ–ä¸º Sanger</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Illumina-1.8+ -&gt; Sanger</span><br><span class="line"># seqkit convert tests/Illimina1.8.fq.gz  | seqkit head -n 1</span><br><span class="line"># 40åˆ†ä»¥ä¸Šçš„éƒ½è®¤ä¸º40 Illumina-1.8+ -&gt; Sanger</span><br><span class="line"># seqkit convert tests/Illimina1.8.fq.gz -f | seqkit head -n 1</span><br><span class="line"> </span><br><span class="line">#Illumina-1.8+ -&gt; Illumina-1.5+</span><br><span class="line"># seqkit convert tests/Illimina1.8.fq.gz --to Illumina-1.5+ | seqkit head -n 1</span><br><span class="line"> </span><br><span class="line"># Illumina-1.8+ -&gt; Illumina-1.5+ -&gt;  Sanger.</span><br><span class="line"># seqkit convert tests/Illimina1.8.fq.gz --to Illumina-1.5+ | seqkit convert | seqkit head -n 1</span><br><span class="line"> </span><br><span class="line"># Solexa -&gt; Sanger</span><br><span class="line"># seqkit convert tests/Illimina1.8.fq.gz --from Solexa</span><br><span class="line"> </span><br><span class="line"># Illumina-1.5+ -&gt; Sanger</span><br><span class="line"># seqkit convert tests/Illimina1.5.fq | seqkit head -n 1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨"><a href="#æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨" class="headerlink" title="æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨"></a>æŠ€æœ¯ç»†èŠ‚å’Œä½¿ç”¨</h1><p>seqkitå¤„ç†å‹ç¼©æ–‡ä»¶</p>
<p>pigz æˆ–è€… gzip åœ¨éƒ¨åˆ†æ“ä½œä¸­ä¸èƒ½åŠ é€Ÿï¼Œæ‰€ä»¥åœ¨v.0.8.1ç‰ˆæœ¬ä»¥ä¾¿å…³æ³¨äº†ï¼Œç„¶è€Œè¿˜æ˜¯å¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š</p>
<p>pigz -d -c seqs.fq.gz | seqkit xxx<br>å› ä¸ºseqkitä½¿ç”¨äº†pgzipå»å†™gzipã€‚è¿™æ¯”gzipå’Œpigzæ›´å¿«ã€‚ï¼ˆ10X of gzip, 4X of pigzï¼‰ï¼Œè€Œä¸”gzipå‹ç¼©æ–‡ä»¶æ¯”è¾ƒå¤§ã€‚</p>
<p>ä»æ•°æ®å¤„ç†æ ¼å¼æ¥è®²</p>
<p>seqkitæ— ç¼æ”¯æŒfaå’Œfqæ ¼å¼æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨è¯†åˆ«ã€‚é™¤äº† faidxä¹‹å¤–ï¼Œå…¨éƒ¨å‘½ä»¤éƒ½å¯ä»¥å¤„ç†è¿™ä¸¤ç§æ ¼å¼çš„æ•°æ®ã€‚</p>
<p>åªæœ‰faæ ¼å¼æ”¯æŒå‘½ä»¤(subseq, split, sortå’Œshuffle)åˆ©ç”¨FASTAç´¢å¼•(by flag -two-pass)ä¸‹æé«˜å¤§æ–‡ä»¶çš„æ€§èƒ½ã€‚</p>
<p>åºåˆ—ç±»å‹çš„æ£€æµ‹DNA/RNA/Proteinï¼Œä¼šä½¿ç”¨å­åºåˆ—è¿›è¡Œï¼Œé»˜è®¤æ£€æµ‹ç¬¬ä¸€æ¡å­åºåˆ—ï¼Œé€šè¿‡â€”alphabet-guess-seq-lengthå‚æ•°é»˜è®¤ä¸º10000ï¼Œå¦‚æœé•¿åº¦å°äº10000ï¼Œåˆ™æ£€æŸ¥æ•´æ¡åºåˆ—ã€‚</p>
<p>åºåˆ—åå­—</p>
<p>æ‰€æœ‰çš„è½¯ä»¶ï¼ŒåŒ…æ‹¬seqkitï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªç©ºæ ¼ä¹‹å‰çš„å­—ç¬¦ä½œä¸ºåºåˆ—çš„åå­—ï¼š<br>éœ€è¦æ³¨æ„çš„NCBIç­‰ä¸€äº›åºåˆ—çš„æ ¼å¼å¹¶ä¸æ˜¯å¦‚æ­¤ï¼Œä¾‹å¦‚ï¼š</p>
<blockquote>
<p>gi|110645304|ref|NC_002516.2| Pseudomona<br>æƒ³è¦åœ¨seqkitä¸­è¯†åˆ«å‡ºæ¥çš„åºåˆ—IDä¸ºï¼šNC_002516.2ã€‚</p>
</blockquote>
<p>æ­¤æ—¶ä½¿ç”¨å‚æ•°â€“id-regexp â€œ|([^|]+)| â€œï¼Œæˆ–è€…æ·»åŠ å‚æ•°â€“id-ncbiï¼Œä½†å¦‚æœæ˜¯åªè¦å‰é¢çš„giæ•°å­—ä½œä¸ºIDçš„è¯ï¼Œæ·»åŠ å‚æ•°ï¼šâ€“id-regexp â€œ^gi|([^|]+)|â€œã€‚</p>
<p>æ³¨æ„ï¼š.seqkit.faiä¸åŒäºsamtoolsäº§ç”Ÿçš„.faiæ ¼å¼æ–‡ä»¶ï¼Œseqkitä½¿ç”¨æ•´ä¸ªåºåˆ—å¼€å¤´è€Œä¸æ˜¯IDä½œä¸ºç´¢å¼•ã€‚</p>
<p>å¹¶è¡Œè¿ç®—</p>
<p>å•æ ¸CPUé»˜è®¤çº¿ç¨‹ï¼šâ€”threads 1ï¼Œå¤šä¸ªCPUï¼Œçº¿ç¨‹é»˜è®¤2.</p>
<p>å†…å­˜å ç”¨</p>
<p>seqkitè®¸å¤šçš„å‘½ä»¤éƒ½ä¸éœ€è¦å°†æ•´ä¸ªåºåˆ—è¯»å…¥åˆ°å†…å­˜ä¸­ã€‚åŒ…æ‹¬ï¼šstat, fq2fa, fx2tab, tab2fx, grep, locate, replace, seq, sliding, subseqã€‚</p>
<p>æ³¨æ„ï¼šå¦‚æœä½¿ç”¨subseq â€”gtf | â€”bedæ—¶ï¼Œå¦‚æœGTFæˆ–è€…BEDæ–‡ä»¶å¤ªå¤§ï¼Œå†…å­˜ä½¿ç”¨é‡ä¼šæš´å¢ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šæŸ“è‰²ä½“ï¼šâ€”chrï¼Œæˆ–è€…â€”featureå»é™åˆ¶ç‰¹å¾ã€‚</p>
<p>æœ‰ä¸€äº›å‘½ä»¤éœ€è¦å°†æ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œä½†æ˜¯å¯ä»¥ç”¨è¿‡rmdup å’Œ commonå‡å°‘å†…å­˜ä½¿ç”¨ã€‚</p>
<p>éšæœºâ€”æŠ½æ ·</p>
<p>æŠ½æ ·å‘½ä»¤sampleå’Œshuffleä½¿ç”¨äº†éšæœºåŠŸèƒ½ï¼Œä¸ºäº†ä¿è¯é‡ç°æ€§ï¼Œå¯ä»¥ä½¿ç”¨-sè®¾ç½®éšæœºç§å­ã€‚è¿™å¯ä»¥ä¿è¯åœ¨ä¸åŒçš„ç¯å¢ƒä¸­å¯ä»¥æœ‰ç›¸åŒçš„æŠ½æ ·ç»“æœã€‚</p>
<h1 id="åºåˆ—é•¿åº¦åˆ†å¸ƒ"><a href="#åºåˆ—é•¿åº¦åˆ†å¸ƒ" class="headerlink" title="åºåˆ—é•¿åº¦åˆ†å¸ƒ"></a>åºåˆ—é•¿åº¦åˆ†å¸ƒ</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -j æ˜¯çº¿ç¨‹æ•°</span></span><br><span class="line">seqkit fx2tab -j 30 -l  -n -i -H file.fastq.gz | cut -f 4 &gt; Length.txt</span><br><span class="line"><span class="comment"># æŸ¥çœ‹Length.txt</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library(tidyverse)</span><br><span class="line"></span><br><span class="line">length &lt;- read_tsv(<span class="string">&quot;Length.txt&quot;</span>) %&gt;% group_by(<span class="built_in">length</span>) %&gt;%</span><br><span class="line">  summarise(Count = n())</span><br><span class="line"><span class="built_in">length</span>$length &lt;- <span class="built_in">as.character</span>(<span class="built_in">length</span>$<span class="built_in">length</span>)</span><br><span class="line">sum &lt;- <span class="built_in">sum</span>(<span class="built_in">length</span>$Count)</span><br><span class="line">ggplot(<span class="built_in">length</span>) + geom_col(aes(<span class="built_in">length</span>, Count), width = <span class="number">0.8</span>) + </span><br><span class="line">  geom_line(aes(<span class="built_in">length</span>, Count), group = <span class="number">1</span>) + geom_point(aes(<span class="built_in">length</span>, Count)) + </span><br><span class="line">  scale_y_continuous(sec.axis = sec_axis(~.*<span class="number">100</span>/<span class="built_in">sum</span>, name = <span class="string">&quot;% Relative Abundance&quot;</span>)) + xlab(<span class="string">&quot;Length&quot;</span>) +</span><br><span class="line">  theme_bw() + theme(panel.grid = element_blank(), </span><br><span class="line">                     axis.title = element_text(size = <span class="number">15</span>))</span><br><span class="line"></span><br><span class="line">ggsave(<span class="string">&quot;Length.png&quot;</span>, height = <span class="number">5</span>, width = <span class="number">8</span>)</span><br><span class="line">ggsave(<span class="string">&quot;Length.pdf&quot;</span>, height = <span class="number">5</span>, width = <span class="number">8</span>)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>software</category>
      </categories>
      <tags>
        <tag>sequence-tool</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux å†…å­˜ å­˜å‚¨</title>
    <url>/blog/2022/02/24/2022-02-24-memory/</url>
    <content><![CDATA[<h1 id><a href="#" class="headerlink" title></a></h1><span id="more"></span>

<h1 id="å†…å­˜æ˜¯ä»€ä¹ˆ"><a href="#å†…å­˜æ˜¯ä»€ä¹ˆ" class="headerlink" title="å†…å­˜æ˜¯ä»€ä¹ˆ"></a>å†…å­˜æ˜¯ä»€ä¹ˆ</h1><ul>
<li><p>å†…å­˜åˆç§°ä¸»å­˜ï¼Œæ˜¯ CPU èƒ½ç›´æ¥å¯»å€çš„å­˜å‚¨ç©ºé—´ï¼Œç”±åŠå¯¼ä½“å™¨ä»¶åˆ¶æˆ</p>
</li>
<li><p>å†…å­˜çš„ç‰¹ç‚¹æ˜¯å­˜å–é€Ÿç‡å¿«</p>
</li>
<li><p>CPUã€IOã€ç£ç›˜ã€å†…å­˜å¯ä»¥è¯´æ˜¯å½±å“è®¡ç®—æœºæ€§èƒ½å…³é”®å› ç´ </p>
</li>
<li><p>å†…å­˜ä¸ºè¿›ç¨‹çš„è¿è¡Œæä¾›ç‰©ç†ç©ºé—´ï¼ŒåŒæ—¶ä½œä¸ºå¿«é€ŸCPUå’Œæ…¢é€Ÿç£ç›˜ä¹‹é—´çš„é€‚é…å™¨ï¼Œ</p>
</li>
</ul>
<h1 id="å†…å­˜çš„ä½œç”¨"><a href="#å†…å­˜çš„ä½œç”¨" class="headerlink" title="å†…å­˜çš„ä½œç”¨"></a>å†…å­˜çš„ä½œç”¨</h1><ul>
<li><p>æš‚æ—¶å­˜æ”¾ cpu çš„è¿ç®—æ•°æ®</p>
</li>
<li><p>ç¡¬ç›˜ç­‰å¤–éƒ¨å­˜å‚¨å™¨äº¤æ¢çš„æ•°æ®</p>
</li>
<li><p>ä¿éšœ cpu è®¡ç®—çš„ç¨³å®šæ€§å’Œé«˜æ€§èƒ½</p>
</li>
</ul>
<h1 id="æŸ¥çœ‹å†…å­˜æƒ…å†µ"><a href="#æŸ¥çœ‹å†…å­˜æƒ…å†µ" class="headerlink" title="æŸ¥çœ‹å†…å­˜æƒ…å†µ"></a>æŸ¥çœ‹å†…å­˜æƒ…å†µ</h1><p>freeå‘½ä»¤æ˜¯ä¸€ä¸ªå¿«é€ŸæŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µçš„æ–¹æ³•ï¼Œå®ƒæ˜¯å¯¹ /proc/meminfo æ”¶é›†åˆ°çš„ä¿¡æ¯çš„ä¸€ä¸ªæ¦‚è¿°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">free -h</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">zds@ubuntu ~ $ free -m   <span class="comment"># ä»¥ Mb ä¸ºå•ä½æ˜¾ç¤º</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line"><span class="comment"># ç‰©ç†å†…å­˜</span></span><br><span class="line">Mem:           2990        1528         383          49        1078        1217</span><br><span class="line"><span class="comment"># è™šæ‹Ÿå†…å­˜</span></span><br><span class="line">Swap:          2044           0        2044</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">zds@ubuntu ~ $ top</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">top - 23:43:07 up 32 min,  1 user,  load average: 0.17, 0.36, 0.34</span><br><span class="line">Tasks: 230 total,   1 running, 229 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu(s): 12.9 us,  5.6 sy,  0.0 ni, 81.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">KiB Mem :  2029876 total,   148224 free,   998788 used,   882864 buff/cache</span><br><span class="line">KiB Swap:  2094076 total,  2087304 free,     6772 used.   819128 avail Mem </span><br><span class="line"></span><br><span class="line">   PID è¿›ç¨‹å·    PR ä¼˜å…ˆçº§  VIRT è¿›ç¨‹å ç”¨çš„è™šæ‹Ÿå†…å­˜å€¼</span><br><span class="line">       USER è¿›ç¨‹æ‰€æœ‰è€…              RES è¿›ç¨‹å ç”¨çš„ç‰©ç†å†…å­˜å€¼</span><br><span class="line">                     NI ä¼˜å…ˆçº§ç›¸å¯¹å€¼       SHR è¿›ç¨‹ä½¿ç”¨çš„å…±äº«å†…å­˜å€¼</span><br><span class="line"></span><br><span class="line">   PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND</span><br><span class="line">   978 root      20   0  356740  84104  37752 S  8.9  4.1   0:19.39 Xorg    </span><br><span class="line">  1909 zds       20   0 1023828 118576  80360 S  4.6  5.8   0:18.36 compiz       </span><br><span class="line">  2439 zds       20   0  630364  52556  42052 S  4.3  2.6   0:08.29 gnome-terminal-   </span><br><span class="line">  1945 zds       20   0  633568  35384  28860 S  0.7  1.7   0:10.46 sogou-qimpanel- </span><br><span class="line">     7 root      20   0       0      0      0 S  0.3  0.0   0:01.94 rcu_sched   </span><br><span class="line">   845 root      20   0  187344   9684   8508 S  0.3  0.5   0:03.35 vmtoolsd  </span><br><span class="line">  1631 zds       20   0   43736   4216   2924 S  0.3  0.2   0:01.82 dbus-daemon </span><br><span class="line">  1795 zds       20   0  564648  29760  24496 S  0.3  1.5   0:01.08 unity-panel-ser</span><br><span class="line">  1958 zds       20   0 1026996  95708  27980 S  0.3  4.7   0:07.03 gnome-software</span><br><span class="line">  1966 zds       20   0  496776  28904  25224 S  0.3  1.4   0:03.52 vmtoolsd   </span><br><span class="line">  7336 zds       20   0   43652   3948   3340 R  0.3  0.2   0:01.25 top  </span><br><span class="line">     1 root      20   0  119836   5652   4024 S  0.0  0.3   0:03.27 systemd </span><br><span class="line">     2 root      20   0       0      0      0 S  0.0  0.0   0:00.00 kthreadd </span><br><span class="line">     3 root      20   0       0      0      0 S  0.0  0.0   0:00.52 ksoftirqd/0</span><br><span class="line">     5 root       0 -20       0      0      0 S  0.0  0.0   0:00.00 kworker/0:0H </span><br><span class="line">     8 root      20   0       0      0      0 S  0.0  0.0   0:00.00 rcu_bh</span><br><span class="line">     9 root      rt   0       0      0      0 S  0.0  0.0   0:00.00 migration/0</span><br><span class="line">    10 root      rt   0       0      0      0 S  0.0  0.0   0:00.01 watchdog/0</span><br><span class="line">    11 root      20   0       0      0      0 S  0.0  0.0   0:00.00 kdevtmpfs </span><br><span class="line">    12 root       0 -20       0      0      0 S  0.0  0.0   0:00.00 netns </span><br><span class="line">    13 root       0 -20       0      0      0 S  0.0  0.0   0:00.00 perf </span><br><span class="line">    14 root      20   0       0      0      0 S  0.0  0.0   0:00.00 khungtaskd  </span><br></pre></td></tr></table></figure>



<p><strong>htop</strong>å‘½ä»¤æ˜¾ç¤ºäº†æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜å®æ—¶ä½¿ç”¨ç‡ã€‚å®ƒæä¾›äº†æ‰€æœ‰è¿›ç¨‹çš„å¸¸é©»å†…å­˜å¤§å°ã€ç¨‹åºæ€»å†…å­˜å¤§å°ã€å…±äº«åº“å¤§å°ç­‰çš„æŠ¥å‘Šã€‚åˆ—è¡¨å¯ä»¥æ°´å¹³åŠå‚ç›´æ»šåŠ¨ã€‚</p>
<p><strong>top</strong>å‘½ä»¤æä¾›äº†å®æ—¶çš„è¿è¡Œä¸­çš„ç¨‹åºçš„èµ„æºä½¿ç”¨ç»Ÿè®¡ã€‚ä½ å¯ä»¥æ ¹æ®å†…å­˜çš„ä½¿ç”¨å’Œå¤§å°æ¥è¿›è¡Œæ’åºã€‚</p>
<h1 id="Core-Dump"><a href="#Core-Dump" class="headerlink" title="Core Dump"></a>Core Dump</h1><ul>
<li>Coreæ„æ€æ˜¯å†…å­˜, Dumpçš„æ„æ€æ˜¯æ‰”å‡ºæ¥, å †å‡ºæ¥ã€‚åœ¨å¼€å‘ï¼ˆæˆ–ä½¿ç”¨ï¼‰ä¸€ä¸ªç¨‹åºæ—¶ï¼Œæœ‰æ—¶ç¨‹åºè«åå…¶å¦™çš„downäº†, å´æ²¡æœ‰ä»»ä½•æç¤º(æœ‰æ—¶æç¤ºcore dumped)ã€‚è™½ç„¶ç³»ç»Ÿæ²¡äº‹ï¼Œä½†ä¸‹æ¬¡ä»å¯èƒ½é‡åˆ°ç›¸åŒé—®é¢˜ã€‚è¿™æ—¶å¯æŸ¥çœ‹æœ‰æ— å½¢å¦‚core.PIDçš„coreæ–‡ä»¶ç”Ÿæˆï¼Œè¿™ä¸ªæ–‡ä»¶ä¾¿æ˜¯æ“ä½œç³»ç»ŸæŠŠç¨‹åºdownæ‰æ—¶çš„å†…å­˜å†…å®¹æ‰”å‡ºæ¥ç”Ÿæˆçš„ï¼Œè®©debugger åšå‚è€ƒã€‚è¿™ä¸ªåŠ¨ä½œå« core dumpã€‚<ul>
<li>core dumpåˆå«<strong>æ ¸å¿ƒè½¬å‚¨</strong>, å½“ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸, ç¨‹åºå¼‚å¸¸é€€å‡ºæ—¶, ç”±æ“ä½œç³»ç»ŸæŠŠç¨‹åºå½“å‰çš„å†…å­˜çŠ¶å†µå­˜å‚¨åœ¨ä¸€ä¸ªcoreæ–‡ä»¶ä¸­, å«core dumpã€‚ç®€è€Œè¨€ä¹‹ï¼Œ<font color="red">è¿›ç¨‹å¼‚å¸¸ç»ˆæ­¢ï¼Œè¿›ç¨‹ç”¨æˆ·ç©ºé—´çš„æ•°æ®å°±ä¼šè¢«å†™åˆ°ç£ç›˜coreæ–‡ä»¶</font>ã€‚</li>
</ul>
</li>
</ul>
<h2 id="ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ-Coreæ–‡ä»¶"><a href="#ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ-Coreæ–‡ä»¶" class="headerlink" title="ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ Coreæ–‡ä»¶"></a>ä¸ºä½•æœ‰æ—¶ç¨‹åºDownäº†ï¼Œå´æ²¡ç”Ÿæˆ Coreæ–‡ä»¶</h2><ul>
<li><font color="red">æœ‰æ—¶å€™ç¨‹åºdownäº†, ä¸åƒç¼–è¯‘é”™è¯¯ä¼šæç¤ºåˆ°æ–‡ä»¶æŸä¸€è¡Œï¼Œè€Œæ˜¯æ²¡æœ‰ä»»ä½•ä¿¡æ¯</font>ã€‚ä¸€ç§åŠæ³•æ˜¯ç”¨gdbçš„stepï¼ˆlinuxä¸‹è°ƒè¯•å·¥å…·gdbæ˜¯å¾ˆå¼ºå¤§çš„è°ƒè¯•å™¨ï¼‰, ä¸€æ­¥ä¸€æ­¥å¯»æ‰¾ï¼Œä½†è¦stepä¸€ä¸ªä¸Šä¸‡è¡Œçš„ä»£ç è®©äººéš¾ä»¥æƒ³è±¡ã€‚ æ›´å¥½çš„åŠæ³•å°±æ˜¯core fileã€‚</li>
<li><font color="red">å¦‚æœcoreæ–‡ä»¶æ²¡æœ‰ç”Ÿæˆ</font>ï¼Œæ˜¯å› ä¸ºcore.PIDçš„coreæ–‡ä»¶çš„ç”Ÿæˆè·Ÿå½“å‰ç³»ç»Ÿçš„ç¯å¢ƒè®¾ç½®æœ‰å…³ç³»ï¼Œ<font color="red">ç³»ç»Ÿé»˜è®¤coreæ–‡ä»¶çš„å¤§å°ä¸º0</font>ï¼ˆæ³¨æ„core file size (blocks, -c) 0 è¿™è¡Œï¼Œè¡¨ç¤ºåˆ†é…ç»™coreæ–‡ä»¶çš„é•¿åº¦ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼Œä¸€ä¸ªå—çš„å¤§å°è¦åˆ†ç³»ç»Ÿè€Œå®šäº†ï¼‰ï¼Œä¸º0è‚¯å®šæ— coreæ–‡ä»¶ï¼Œå¯ä¿®æ”¹ä¹‹ï¼‰</li>
<li>ç”¨ulimitå‘½ä»¤æŸ¥çœ‹å’Œä¿®æ”¹coreæ–‡ä»¶çš„å¤§å°ï¼Œä½¿ç”¨<code>ulimit -a</code>æŸ¥çœ‹å¤§å°ï¼Œä½¿ç”¨ <code>ulimit -c unlimited</code>è¡¨ç¤ºå¯¹coreæ–‡ä»¶ä¸åšé™åˆ¶ æˆ– ä½¿ç”¨<code>ulimit -c 1024</code> å¯¹coreæ–‡ä»¶åˆ†é…1024ä¸ªå­—èŠ‚</li>
<li><font color="red">ç¨‹åºè¿è¡Œè¿‡ç¨‹å‡ºç°aborted(core dumped)ï¼Œulimit -aï¼Œç»“æœç¡®å® core file size (blocks, -c) 0ï¼Œæ— æ³•ç”Ÿæˆä¸­æ–­æ–‡ä»¶</font></li>
<li>è‹¥ä¿®æ”¹åå†è¿è¡Œç¨‹åºä¾¿ç”Ÿæˆ<code>core.PID</code>çš„coreæ–‡ä»¶ï¼ˆ<strong>coreæ–‡ä»¶ç”Ÿæˆçš„ä½ç½®ä¸€èˆ¬å’Œè¿è¡Œç¨‹åºçš„è·¯å¾„ç›¸åŒ, æ–‡ä»¶åä¸€èˆ¬ä¸ºcore.è¿›ç¨‹å·</strong>ï¼‰ã€‚</li>
</ul>
<h2 id="å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶"><a href="#å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶" class="headerlink" title="å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶?"></a>å¦‚ä½•ä½¿ç”¨coreæ–‡ä»¶?</h2><ul>
<li>å‘ç”Ÿcore dumpåï¼Œä½¿ç”¨gdbæŸ¥çœ‹coreæ–‡ä»¶å†…å®¹, ä»¥å®šä½æ–‡ä»¶ä¸­å¼•å‘core dumpçš„è¡Œï¼Œåœ¨Linuxä¸‹ï¼ŒæŸ¥çœ‹coreæ–‡ä»¶ä¸­çš„å‡ºé”™å †æ ˆä¿¡æ¯æœ‰äºŒç§æ–¹å¼ï¼Œä½¿ç”¨ï¼š<font color="red">gdb -c core.pid program_name</font>æˆ–gdb [program_name] [core.pid]å¯ä»¥è¿›å…¥gdbæ¨¡å¼</li>
<li>åœ¨è¿›å…¥gdbåè¾“å…¥<font color="red">whereå¹¶å›è½¦</font>ï¼Œå°±å¯ä»¥æŒ‡å‡ºæ˜¯åœ¨å“ªä¸€è¡Œè¢«Downæ‰ï¼Œåœ¨å“ªä¸ªå‡½æ•°å†…ï¼Œç”±è°è°ƒç”¨ç­‰ç­‰ã€‚</li>
<li>åœ¨è¿›å…¥gdbåè¾“å…¥<font color="red"> bt</font>ï¼Œç”¨btå‘½ä»¤æŸ¥çœ‹backtraceä»¥æ£€æŸ¥å‘ç”Ÿç¨‹åºè¿è¡Œåˆ°å“ªé‡Œï¼Œæ¥å®šä½core dumpçš„æ–‡ä»¶-&gt;è¡Œã€‚</li>
</ul>
<h2 id="core-dump-åŸå› "><a href="#core-dump-åŸå› " class="headerlink" title="core dump åŸå› "></a>core dump åŸå› </h2><ul>
<li><p><font color="red">batch_sizeè¿‡å¤§å¯¼è‡´çš„ã€‚Aborted(core dumped)</font></p>
</li>
<li><p>çº¿ç¨‹è¢«è°‹æ€ï¼Œ è¢«è°‹æ€è€…æ‰€åœ¨çº¿ç¨‹ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚Cancellation &amp; C++ Exception</p>
</li>
<li><p>pure virtual method called terminate called without an active exception è§£å†³æ–¹æ¡ˆ</p>
</li>
</ul>
<p>å¯¹äºå¤šçº¿ç¨‹çš„ç¨‹åºï¼Œè¿™ä¸ªé”™è¯¯çš„ä¸»è¦åŸå› æ˜¯å½“å‰å¯¹è±¡å·²ç»è¢«é”€æ¯æˆ–è€…æ­£åœ¨è¢«é”€æ¯ï¼Œä½†æ˜¯å…¶åˆåœ¨è¢«è°ƒç”¨ï¼Œå¯¼è‡´äº†å†²çªã€‚</p>
<ul>
<li>pure virtual method called</li>
</ul>
<hr>
<h1 id="æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š"><a href="#æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š" class="headerlink" title="æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š"></a>æŸ¥çœ‹å­˜å‚¨ç©ºé—´ï¼š</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">zds@ubuntu ~ $ df -hl</span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ         å®¹é‡   å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br><span class="line">udev            972M     0  972M    0% /dev</span><br><span class="line">tmpfs           199M  6.3M  192M    4% /run</span><br><span class="line">/dev/sda1        23G  5.3G   17G   25% /</span><br><span class="line">tmpfs           992M  212K  991M    1% /dev/shm</span><br><span class="line">tmpfs           5.0M  4.0K  5.0M    1% /run/lock</span><br><span class="line">tmpfs           992M     0  992M    0% /sys/fs/cgroup</span><br><span class="line">tmpfs           199M   60K  199M    1% /run/user/1000 </span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>technique</tag>
      </tags>
  </entry>
  <entry>
    <title>Genome Survey</title>
    <url>/blog/2022/02/23/2022-02-21-Survey/</url>
    <content><![CDATA[<h1 id><a href="#" class="headerlink" title></a></h1><span id="more"></span>

<p>åŸºå› ç»„æ‚åˆåº¦å’Œé‡å¤åºåˆ—å¯¹åç»­åŸºå› ç»„ç»„è£…æœ‰å¾ˆå¤§å½±å“ã€‚</p>
<p><strong>é«˜æ‚åˆ</strong>åŸºå› ç»„å¾€å¾€æ— æ³•åˆå¹¶å§Šå¦¹æŸ“è‰²ä½“ï¼Œå¯¼è‡´ç»„è£…ç»“æœ<strong>åå¤§</strong>ã€‚</p>
<p>è€Œ<strong>é‡å¤åºåˆ—</strong>åœ¨ç»„è£…ä¸­è¢«æŠ˜å ï¼Œä½¿ç»„è£…ä¸­å‡ºç°ç¼ºå£ã€é”™è¯¯ï¼Œå¯¼è‡´ç»„è£…ç»“æœ<strong>åå°</strong>ã€‚</p>
<p>ä¸åŒçš„ç”Ÿç‰©åŸºå› ç»„ä¹‹é—´æ‚åˆç‡å’Œé‡å¤åºåˆ—å«é‡å·®å¼‚å·¨å¤§ï¼Œå› æ­¤åœ¨åŸºå› ç»„æµ‹åºå‰éœ€è¦å¯¹åŸºå› ç»„ç‰¹å¾è¿›è¡Œè°ƒç ”ï¼Œä»¥ç¡®å®šæµ‹åºæ–¹æ¡ˆï¼Œå‘¨æœŸç­‰ã€‚</p>
<p>ç›®å‰å¸¸ç”¨çš„è°ƒç ”æ‰‹æ®µæœ‰ä¸‰ç§ï¼š</p>
<ol>
<li>ç”¨æµå¼ç»†èƒä»ªæµ‹å®šç»†èƒæ ¸å†…çš„<strong>DNAæ€»é‡</strong></li>
<li>ç”¨æ ¸å‹åˆ†ææ–¹æ³•ï¼Œè¯†åˆ«<strong>æŸ“è‰²ä½“æ•°é‡ã€å€æ€§</strong></li>
<li>ç”¨è°ƒç ”å›¾ï¼Œé€šè¿‡äºŒä»£æµ‹åºï¼Œä¼°ç®—<strong>åŸºå› ç»„å¤§å°ã€æ‚åˆåº¦ã€é‡å¤åºåˆ—æ¯”ä¾‹ã€GCå«é‡</strong>ç­‰ã€‚</li>
</ol>
<p>ä¸åŒæŠ€æœ¯æ‰‹æ®µä¸åŒä¾§é‡ï¼Œå…¶ä¸­<font color="red">è°ƒç ”å›¾</font>ä»¥<font color="green">ä½æˆæœ¬ï¼Œä½éš¾åº¦å’Œæ›´å¤šçš„è¯„ä¼°å†…å®¹</font>ä½¿ç”¨æœ€å¤šï¼ŒåŒæ—¶<font color="red"><strong>Surveyæ‰€æµ‹äºŒä»£æ•°æ®è¿˜å¯ç”¨äºå›æ¯”åŸºå› ç»„ï¼Œè¯„ä¼°ç»„è£…è´¨é‡</strong></font>ã€‚è°ƒç ”å›¾<font color="green">åŸºäºæ•°å­¦ç»Ÿè®¡å­¦æ‰‹æ®µ</font>è·å–ç‰©ç§ä¿¡æ¯çš„æ–¹å¼ï¼Œå› æ­¤å¯¹äºå·²ç»ç ”ç©¶çš„è¾ƒä¸ºæ¸…æ™°çš„ç‰©ç§â€”â€”ä¸»è¦æ˜¯<font color="green"><strong>æ™®é€šäºŒå€ä½“å’Œç®€å•å¤šå€ä½“</strong></font>ï¼Œå…¶<font color="green">æŸ“è‰²ä½“æ¡æ•°ã€å€æ€§ã€å¤§æ¦‚åŸºå› ç»„å¤§å°æ˜¯å·²çŸ¥</font>ï¼Œæ­¤æ—¶ä»…é€‰æ‹©<strong>survey</strong>è¶³ä»¥æ»¡è¶³åŸºå› ç»„ç‰¹å¾éœ€è¦ï¼Œä½†å¯¹äº<strong>å¤šå€ä½“å¤æ‚åŸºå› ç»„</strong>æ›´æ¨è<strong>è¡¥å……æ ¸å‹åˆ†æå’Œæµå¼</strong>ï¼Œä»¥å’Œè°ƒç ”å›¾ç›¸äº’å°è¯è¡¥å……ã€‚</p>
<hr>
<p><strong>Survey æ–¹æ¡ˆ</strong></p>
<p>é€šè¿‡è´¨æ§ã€NTæ¯”å¯¹ï¼Œè·å¾—é«˜è´¨é‡çš„clean dataï¼Œä¸ºåç»­åˆ†æå¥ å®šè‰¯å¥½åŸºç¡€ï¼›</p>
<p>åŸºå› ç»„SurveyåŸºäºå°ç‰‡æ®µæ–‡åº“çš„ä½æ·±åº¦æµ‹åºæ•°æ®ï¼ˆ50Xï¼‰å·¦å³ï¼›</p>
<p>é€šè¿‡K-meråˆ†æï¼Œæœ‰æ•ˆçš„è¯„ä¼°åŸºå› ç»„å¤§å°ã€GCå«é‡ã€æ‚åˆåº¦ä»¥åŠé‡å¤åºåˆ—çš„å«é‡ç­‰ä¿¡æ¯ï¼›</p>
<p>å…¨é¢äº†è§£æŸä¸€ç‰©ç§åŸºå› ç»„ç‰¹å¾çš„æœ‰æ•ˆæ–¹æ³•ï¼›</p>
<p>ä¸ºåç»­çš„å…¨åŸºå› denoveæµ‹åºçš„ç»„è£…ç­–ç•¥çš„åˆ¶å®šæä¾›ç†è®ºä¾æ®ã€‚</p>
<p><strong>åˆ†æå†…å®¹</strong>ï¼šæ±¡æŸ“ç¨‹åº¦è¯„ä¼°ï¼ŒåŸºå› ç»„å¤§å°è¯„ä¼°ï¼Œæ‚åˆåº¦è¯„ä¼°ï¼Œé‡å¤ç‡è¯„ä¼°ï¼ŒGCå«é‡è¯„ä¼°ã€‚ã€åˆæ­¥äº†è§£ä¸‰ä»£ç»„è£…éš¾åº¦å’Œé¢„æœŸå¤§å°ã€‘</p>
<p><strong>åŸºå› ç»„å¤æ‚åº¦é¢„ä¼°?</strong></p>
<blockquote>
<p>æ™®é€šåŸºå› ç»„çš„å®šä¹‰ï¼Ÿ<br>å•å€ä½“ã€çº¯åˆäºŒå€ä½“æˆ–è€…æ‚åˆåº¦&lt;0.5%ï¼Œä¸”é‡å¤åºåˆ—å«é‡&lt;50%ï¼ŒGCå«é‡ä¸º35%åˆ°65%ä¹‹é—´çš„äºŒå€ä½“ã€‚</p>
<p>å¤æ‚åŸºå› ç»„çš„å®šä¹‰ï¼Ÿ<br>æ‚åˆåº¦&gt;0.5%ï¼Œé‡å¤åºåˆ—å«é‡&gt;50%ï¼Œå¤šå€ä½“ï¼ŒGCå«é‡å¤„äºå¼‚å¸¸çš„èŒƒå›´ï¼ˆGCå«é‡&lt;35%æˆ–è€…GCå«é‡&gt;65%çš„äºŒå€ä½“ï¼‰ã€‚</p>
<p><font color="red">äºŒå€ä½“å¤æ‚åŸºå› ç»„è¿›ä¸€æ­¥ç»†åˆ†ä¸º</font><br><font color="red"> å¾®æ‚åˆåŸºå› ç»„ï¼ˆ0.5%&lt;æ‚åˆç‡&lt;=0.8%)</font><br><font color="red"> é«˜æ‚åˆåŸºå› ç»„ï¼ˆæ‚åˆç‡&gt;0.8%)</font><br> <font color="red">é«˜é‡å¤åŸºå› ç»„ï¼ˆé‡å¤åºåˆ—æ¯”ä¾‹&gt;50%ï¼‰</font></p>
<p>åŸºå› ç»„å¤§å°ï¼š<br> åŸºå› ç»„è¶Šå¤§ï¼Œæµ‹åºèŠ±é’±è¶Šå¤š</p>
</blockquote>
<blockquote>
<ul>
<li>ç®€å•åŸºå› ç»„: æ‚åˆåº¦ä½äº0.5%, GCå«é‡åœ¨35%~65%, é‡å¤åºåˆ—ä½äº50%</li>
<li>äºŒå€ä½“æ™®é€šåŸºå› ç»„: æ‚åˆåº¦åœ¨0.5%~1.2%ä¸­é—´ï¼Œé‡å¤åºåˆ—ä½äº50%ã€‚æˆ–æ‚åˆåº¦ä½äº0.5%ï¼Œé‡å¤åºåˆ—ä½äº65%</li>
<li>é«˜å¤æ‚åŸºå› ç»„: æ‚åˆåº¦&gt;1.2% æˆ– é‡å¤ç‡å¤§äº65%</li>
</ul>
</blockquote>
<hr>
<h1 id="è´¨æ§"><a href="#è´¨æ§" class="headerlink" title="è´¨æ§"></a>è´¨æ§</h1><p><img src="https://upload-images.jianshu.io/upload_images/11004598-2ca590314cf3d635.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/374/format/webp" alt="img"></p>
<p>å„æå‡º10,000å¯¹æ¯”å¯¹åˆ°<strong>NTåº“</strong>ï¼Œå¦‚æœéƒ½æ¯”å¯¹åˆ°åŒæºç‰©ç§ï¼Œè¯´æ˜æ— æ±¡æŸ“ï¼Œå¦‚æœæ¯”å¯¹åˆ°ç»†èŒçœŸèŒï¼Œå¯èƒ½æ•°æ®æœ‰æ±¡æŸ“ã€‚</p>
<h2 id="rawdata-qc"><a href="#rawdata-qc" class="headerlink" title="rawdata qc"></a>rawdata qc</h2><h2 id="trim"><a href="#trim" class="headerlink" title="trim"></a>trim</h2><h2 id="cleandata-qc"><a href="#cleandata-qc" class="headerlink" title="cleandata qc"></a>cleandata qc</h2><h2 id="NTæ•°æ®åº“æ¯”å¯¹"><a href="#NTæ•°æ®åº“æ¯”å¯¹" class="headerlink" title="NTæ•°æ®åº“æ¯”å¯¹"></a>NTæ•°æ®åº“æ¯”å¯¹</h2><p>Partially non-redundant nucleotide from all traditional divisions of GenBank, EMBL, and DDBJ excluding GSS,STS, PAT, EST, HTG, and WGS.</p>
<p><a href="https://ftp.ncbi.nih.gov/blast/db/FASTA/">NTåº“</a></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">blastn \</span><br><span class="line">-query reads_2.fa \</span><br><span class="line">-db /local_data1/public_data/database/genome_DB/nt/20190417_all/nt \</span><br><span class="line">-out reads_2.csv \</span><br><span class="line">-outfmt <span class="string">&quot;10 evalue length qseqid qlen qstart qend sacc slen sstart send pident nident sstrand qcovs qseq sseq sgi stitle&quot;</span> \</span><br><span class="line">-num_threads 4 -evalue 1e-5 -max_target_seqs 1</span><br></pre></td></tr></table></figure>



<hr>
<p><a href="https://blog.csdn.net/u012110870/article/details/82500748">https://blog.csdn.net/u012110870/article/details/82500748</a></p>
<h1 id="k-mers"><a href="#k-mers" class="headerlink" title="k-mers"></a>k-mers</h1><p>æœ€ç®€å•çš„ç­–ç•¥å°±æ˜¯åŸºäºk-merå¯¹åŸºå› ç»„åšä¸€ä¸ªç®€å•çš„äº†è§£, ä½¿ç”¨jellyfishç»Ÿè®¡k-mersï¼Œç„¶åä½œå›¾</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">jellyfish count  -m 21 -s 20G -t 20 -o 21mer_out  -C --min-qual-char=? &lt;(zcat test_1.fq.gz) &lt;(zcat test_2.fq.gz)</span><br><span class="line"><span class="comment"># -m k-mersçš„K</span></span><br><span class="line"><span class="comment"># -s Hashå¤§å°, æ ¹æ®æ–‡ä»¶å¤§å°ç¡®å®š</span></span><br><span class="line"><span class="comment"># -t çº¿ç¨‹</span></span><br><span class="line"><span class="comment"># -o è¾“å‡ºå‰ç¼€</span></span><br><span class="line"><span class="comment"># -C ç»Ÿè®¡æ­£è´Ÿé“¾</span></span><br><span class="line"><span class="comment"># --min-qual-char è¿‡æ»¤ä½è´¨é‡ç¢±åŸºã€‚ åœ¨Phred+33ä¸­,?=30</span></span><br><span class="line">jellyfish histo -o 21mer_out.histo 21mer_out</span><br></pre></td></tr></table></figure>

<p>ç”¨Rä½œå›¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pdf(&quot;21_mer.out.pdf&quot;)</span><br><span class="line">dataframe19 &lt;- read.table(&quot;21mer_out.histo&quot;)</span><br><span class="line">plot(dataframe19[1:200,], type=&quot;l&quot;)</span><br><span class="line">dev.off()</span><br></pre></td></tr></table></figure>

<p>ç”±äºåªæœ‰ä¸€ä¸ªä¸»å³°ï¼Œè¯´æ˜è¯¥ç‰©ç§çš„æ‚åˆåº¦å¹¶ä¸é«˜ï¼ŒåŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯äºŒå€ä½“ã€‚å¦‚æœå›¾ä¸­å‡ºç°å¤šä¸ªå³°ï¼Œè¯´æ˜å®ƒå¯èƒ½æ˜¯å¤šå€ä½“æˆ–è€…æ˜¯åŸºå› ç»„æ‚åˆåº¦é«˜ã€‚</p>
<p>æ¨èæ–‡çŒ®: Genomic DNA k-mer spectra: models and modalities</p>
<h1 id="åŸºäºç»„è£…"><a href="#åŸºäºç»„è£…" class="headerlink" title="åŸºäºç»„è£…"></a>åŸºäºç»„è£…</h1><p>åŸºäºK-merså¯ä»¥è¾ƒå¥½çš„é¢„æµ‹åŸºå› ç»„å¤§å°ï¼Œå¹¶å®šæ€§çš„äº†è§£åŸºå› ç»„çš„å¤æ‚æƒ…å†µï¼Œå¦‚æœæƒ³æ›´å…·ä½“çš„äº†è§£åŸºå› ç»„çš„å¤æ‚åº¦ï¼Œå¯ä»¥å…ˆå°†50Xä»¥ä¸Šçš„æ®µç‰‡æ®µè¿›è¡Œç»„è£…ï¼Œç„¶åè¿›è¡Œåˆ†æã€‚</p>
<p>ç»„è£…çš„å·¥å…·æ¯”è¾ƒå¤šï¼Œæ¨èç”¨SOAPdenovoï¼Œå› ä¸ºé€Ÿåº¦å¿«ã€‚abyss?</p>
<p>æ–°å»ºä¸€ä¸ªcontig.config, å¢åŠ å¦‚ä¸‹å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">max_rd_len=150</span><br><span class="line">[LIB]</span><br><span class="line">avg_ins=200</span><br><span class="line">reverse_seq=0</span><br><span class="line">asm_flags=3</span><br><span class="line">rd_len_cutoff=100</span><br><span class="line">rank=1</span><br><span class="line">pair_num_cutoff=3</span><br><span class="line">map_len=32</span><br><span class="line">q1=read_1.fq</span><br><span class="line">q2=read_2.fq</span><br></pre></td></tr></table></figure>

<p>ç»„è£…å‡ºå‚è€ƒåºåˆ—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">~/opt/biosoft/SOAPdenovo2/SOAPdenovo-63mer all -s contig.config -R -K 63 -p 30 -o assembly/graph</span><br></pre></td></tr></table></figure>

<p>æœ€ågraph.scafSeqæ˜¯æ‹¼æ¥åçš„åºåˆ—, æå–å‡ºå¤§äº300bpçš„åºåˆ—.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># adjust format</span><br><span class="line">bioawk -c fastx -v name=1 &#x27;&#123;if(length($seq)&gt;300) print &quot;&gt;&quot;name &quot;\n&quot; $seq;name+=1&#125;&#x27; assembly/graph.scafSeq &gt;contig.fa</span><br></pre></td></tr></table></figure>

<h1 id="æ‚åˆåº¦ä¼°è®¡"><a href="#æ‚åˆåº¦ä¼°è®¡" class="headerlink" title="æ‚åˆåº¦ä¼°è®¡"></a>æ‚åˆåº¦ä¼°è®¡</h1><p>å°†åŸæ¥çš„åºåˆ—å›è´´åˆ°contigä¸Šï¼Œå¹¶ç”¨samtools+bcftoolsè¿›è¡Œsnp calling.ç»Ÿè®¡å˜å¼‚çš„ç¢±åŸºå æ€»ä½“çš„æ¯”ä¾‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir -p index</span><br><span class="line">bwa index contig.fa -p index/contig</span><br><span class="line">bwa mem -v 2 -t 10 index/contig read_1.fq read_2.fq | samtools sort -n &gt; align.bam</span><br><span class="line">samtools mpileup -f contig align.bam | bcftools call -mv -Oz -o variants.gz</span><br></pre></td></tr></table></figure>

<p>ä¸€æ–¹é¢ç”±äºSOAPdenovoç»„è£…è¿‡ç¨‹ä¸­ä¼šå‡ºé”™, å¦ä¸€æ–¹é¢samtoolsåœ¨å˜å¼‚æ£€æµ‹ä¸Šä¹Ÿå­˜åœ¨å¾ˆé«˜çš„å‡é˜³æ€§, æ‰€ä»¥æ€»å¾—å…ˆæŒ‰ç…§æ·±åº¦å’Œè´¨é‡è¿‡æ»¤ä¸€æ‰¹å‡é˜³æ€§ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bcftools view -i &#x27; DP &gt; 30 &amp;&amp; MQ &gt; 30&#x27; -H variants.vcf.gz | wc -l</span><br><span class="line"># 325219, æ— è¿‡æ»¤æ˜¯445113</span><br></pre></td></tr></table></figure>

<p>å˜å¼‚æ•°ç›®å åŸºå› ç»„å¤§å°çš„æ¯”ä¾‹å°±æ˜¯æ‚åˆåº¦ã€‚æˆ‘çš„contigå¤§æ¦‚æ˜¯200Mï¼Œæ‰¾åˆ°0.3Må·¦å³çš„å˜å¼‚ï¼Œä¹Ÿå°±æ˜¯0.0015ï¼Œå³0.15%.</p>
<h1 id="é‡å¤åºåˆ—ä¼°è®¡"><a href="#é‡å¤åºåˆ—ä¼°è®¡" class="headerlink" title="é‡å¤åºåˆ—ä¼°è®¡"></a>é‡å¤åºåˆ—ä¼°è®¡</h1><p>åŸºäºåŒæºæ³¨é‡Šï¼Œç”¨RepeatMaskerå¯»æ‰¾é‡å¤åºåˆ—. è¿™é‡Œè¦æ³¨æ„åˆ†æçš„fastaçš„IDä¸èƒ½è¿‡é•¿ï¼Œä¹Ÿå°±æ˜¯æœ€å¥½æ˜¯<code>&gt;scaffold_1</code>è¿™ç§å½¢å¼ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">~/opt/biosoft/RepeatMsker/RepeatMasker -e ncbi -species arabidopsis -pa 10 -gff -dir ./ contig.fa</span><br><span class="line"># -e ncbi</span><br><span class="line"># -species é€‰æ‹©ç‰©ç§ ç”¨~/opt/biosoft/RepeatMasker/util/queryRepeatDatabase.pl -tree äº†è§£</span><br><span class="line"># -pa å¹¶è¡Œè®¡ç®—</span><br><span class="line"># -gff è¾“å‡ºgffæ³¨é‡Š</span><br><span class="line"># -dir è¾“å‡ºè·¯å¾„</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœä¸­ä¸»è¦å…³æ³¨å¦‚ä¸‹ä¸‰ä¸ª</p>
<ul>
<li>output.fa.masked, å°†é‡å¤åºåˆ—ç”¨Nä»£æ›¿</li>
<li>output.fa.out.gff, ä»¥gff2å½¢å¼å­˜æ”¾é‡å¤åºåˆ—å‡ºç°çš„ä½ç½®</li>
<li>output.fa.tbl, è¯¥æ–‡ä»¶è®°å½•ç€åˆ†ç±»ä¿¡æ¯</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">==================================================</span><br><span class="line">file name: anno.fasta</span><br><span class="line">sequences:         62027</span><br><span class="line">total length:  273135210 bp  (273135210 bp excl N/X-runs)</span><br><span class="line">GC level:         36.80 %</span><br><span class="line">bases masked:   79642191 bp ( 29.16 %)</span><br><span class="line">==================================================</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„ç‰©ç§æœ‰30%çš„é‡å¤åºåˆ—ï¼Œä½œä¸ºå‚è€ƒï¼Œæ‹Ÿå—èŠ¥125Mb 14%é‡å¤åºåˆ—, æ°´ç¨»389Mï¼Œ36%é‡å¤</p>
<hr>
<h1 id="Grand-Omics"><a href="#Grand-Omics" class="headerlink" title="Grand Omics"></a><font color="green">Grand Omics</font></h1><p>å¿«é€Ÿï¼šK-meråˆ†ææ–¹æ³•ï¼Œå¯å¿«é€Ÿç¡®å®šåŸºå› ç»„ç‰¹å¾</p>
<p>ä¸“ä¸šï¼šç®€å•åŸºå› ç»„å’Œå¤æ‚åŸºå› ç»„ï¼ˆé«˜æ‚åˆã€å¤šå€ä½“ç­‰ï¼‰é‡‡ç”¨ä¸åŒç®—æ³•è½¯ä»¶</p>
<p>å»ºåº“ï¼šIllumina PE150æ™®é€šæ–‡åº“ï¼›æˆ–MGI PE150 æ™®é€šæ–‡åº“ã€‚æ€»é‡ â‰¥ 1Î¼gï¼›æ¨èæ•°æ®é‡ â‰¥ 50X</p>
<p>åˆ†æå†…å®¹ï¼šåŸå§‹æ•°æ®è´¨æ§ï¼›æ•°æ®æ±¡æŸ“æ£€æµ‹ï¼›åŸºå› ç»„å¤§å°é¢„ä¼°ï¼›åŸºå› ç»„æ‚åˆåº¦é¢„ä¼°</p>
<h2 id="æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°"><a href="#æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°" class="headerlink" title="æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°"></a>æ•°æ®è´¨æ§åŠæ±¡æŸ“è¯„ä¼°</h2><p>å¯¹åŸå§‹æ•°æ®è´¨æ§è¿‡æ»¤ï¼Œç„¶åå¯¹åŸå§‹æ•°æ®ï¼ˆRaw dataï¼‰åŠè¿‡æ»¤åæ•°æ®ï¼ˆClean dataï¼‰è¿›è¡Œè´¨é‡ç»Ÿè®¡ã€‚éšæœºå–100,000æ¡è´¨æ§åçš„readsï¼Œç»Ÿè®¡readsåœ¨<font color="red">ntåº“</font>ä¸­çš„åˆ†å¸ƒæƒ…å†µåŠæ¯”å¯¹ä¸Šçš„ç‰©ç§åˆ†å¸ƒï¼Œä»¥è¯„ä¼°æ•°æ®æ±¡æŸ“æƒ…å†µã€‚</p>
<h2 id="åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡"><a href="#åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡" class="headerlink" title="åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡"></a>åŸºå› ç»„å¤§å°å’Œæ‚åˆåº¦ä¼°è®¡</h2><p>åˆ©ç”¨<font color="red">åæ­£æ€åˆ†å¸ƒæ¨¡å‹ï¼ˆskew normal distribution modelï¼‰</font>ï¼Œ<font color="red">è´ŸäºŒé¡¹å¼æ¨¡å‹ (negative binomial model)</font> å¯¹K-mer æ•°æ®è¿›è¡Œæ‹Ÿåˆåˆ†æï¼Œè¿›è¡ŒåŸºå› ç»„å¤§å°ä»¥åŠæ‚åˆåº¦çš„è¯„ä¼°ï¼Œå¹¶ç”Ÿæˆæœ€ç»ˆåŸºå› ç»„è¯„ä¼°ç»“æœã€‚</p>
<p>ä¸€èˆ¬é€‰æ‹©<strong>17-mer</strong>è¯„ä¼°åŸºå› ç»„å¤§å°ï¼ŒATCGå››ç§ç¢±åŸºç»„æˆé•¿åº¦ä¸º17çš„æ ¸è‹·é…¸ç‰‡æ®µæœ‰4(17æ¬¡æ–¹)<del>17Gï¼Œè¶³ä»¥è¦†ç›–ä¸€èˆ¬çš„æ­£å¸¸åŸºå› ç»„ï¼›15mer</del>1Gã€‚å¯¹äºæ­£å¸¸åŸºå› ç»„å¯èƒ½è¦†ç›–åº¦ä¸å¤Ÿï¼Œå¯¼è‡´ä¼°è®¡ä¸å‡†ç¡®ã€‚&gt;15Gï¼Œé‡‡ç”¨19-meræˆ–21-merã€‚K-merè¶Šå¤§ï¼ŒåŒ…å«é”™è¯¯ä½ç‚¹çš„K-merè¶Šå¤šã€‚ä¸ºäº†<strong>é¿å…å›æ–‡åºåˆ—ï¼ŒKä¸ºå¥‡æ•°</strong>ã€‚</p>
<h2 id="GC-depth-åˆ†æåŠæ±¡æŸ“è¯„ä¼°"><a href="#GC-depth-åˆ†æåŠæ±¡æŸ“è¯„ä¼°" class="headerlink" title="GC-depth åˆ†æåŠæ±¡æŸ“è¯„ä¼°"></a>GC-depth åˆ†æåŠæ±¡æŸ“è¯„ä¼°</h2><p>å¯¹<font color="red">ç»„è£…çš„åŸºå› ç»„åºåˆ—</font>ä»¥<font color="red">5kbä¸ºwindows</font>ï¼Œæ— é‡å¤è®¡ç®—ç‰‡æ®µçš„<font color="red">å¹³å‡GCå«é‡å’Œå¹³å‡æ·±åº¦</font>å¹¶ä½œå›¾ã€‚åŸºäºæ¯ä¸€ä¸ªwindowså¯¹åº”çš„å¹³å‡GCå’Œå¹³å‡æ·±åº¦è¿›è¡Œç»˜å›¾ã€‚å¯ä»¥æ ¹æ®æ­¤å›¾åˆ†ææµ‹åºæ•°æ®æ˜¯å¦å­˜åœ¨GCåå‘æ€§ä»¥åŠæ ·æœ¬æ˜¯å¦å­˜åœ¨æ±¡æŸ“ã€‚</p>
<h1 id="Biomarker"><a href="#Biomarker" class="headerlink" title="Biomarker"></a><font color="green">Biomarker</font></h1><p>åŸºå› ç»„surveyä»¥æµ‹åºæŠ€æœ¯ä¸ºåŸºç¡€ï¼ŒåŸºäºå°ç‰‡æ®µæ–‡åº“çš„ä½æ·±åº¦æµ‹åºï¼Œé€šè¿‡K-meråˆ†æï¼Œå¿«é€Ÿè·å¾—åŸºå› ç»„å¤§å°ã€æ‚åˆåº¦ã€é‡å¤åºåˆ—æ¯”ä¾‹ç­‰åŸºæœ¬ä¿¡æ¯ï¼Œä¸ºåˆ¶å®šè¯¥ç‰©ç§çš„å…¨åŸºå› ç»„de novoæµ‹åºç­–ç•¥æä¾›æœ‰æ•ˆä¾æ®ã€‚</p>
<h2 id="è°ƒç ”å›¾åˆ†æåŸç†"><a href="#è°ƒç ”å›¾åˆ†æåŸç†" class="headerlink" title="è°ƒç ”å›¾åˆ†æåŸç†"></a>è°ƒç ”å›¾åˆ†æåŸç†</h2><p><img src="http://www.biomarker.com.cn/wp-content/uploads/2017/03/5-12.png" alt="5"></p>
<p>k-merï¼Œå°†æ ¸é…¸åºåˆ—ä»¥æ»‘çª—åˆ†æˆåŒ…å«kä¸ªç¢±åŸºçš„çŸ­åºåˆ—ï¼Œâ€œmerâ€è¿™ä¸ªå•è¯çš„æ¥æº<font color="red">monomeric unitï¼Œå•ä½“å•å…ƒ</font>ã€‚Kä¸€èˆ¬ä¸ºå¥‡æ•°ï¼ˆé¿å…æ­£åé“¾æ··æ·†?ï¼‰ã€‚ç»Ÿè®¡æ‰€æœ‰readsä¸­æ‰€å‡ºç°çš„k-merç±»å‹åŠå„ç±»å‹k-merçš„æ·±åº¦ï¼ˆæˆ–è€…é¢‘ç‡ï¼‰ï¼Œç»˜åˆ¶ç‰¹å®šk-merä¸‹ä¸åŒæ·±åº¦k-merç‰‡æ®µçš„é¢‘æ•°ç»Ÿè®¡å›¾ï¼Œé€šå¸¸é€‰æ‹©K-meråˆ†å¸ƒæœ€å¤šçš„å³°ä¸ºä¸»å³°ï¼Œä»è€Œå¾—åˆ°<font color="red"><strong>åŸºå› ç»„å¤§å°=K-meræ€»æ•°/K-merä¸»å³°æ·±åº¦å€¼</strong></font>ã€‚</p>
<p>ç”±äºåŸºå› ç»„å­˜åœ¨<font color="red">æ‚åˆä½ç‚¹å’Œé‡å¤åºåˆ—</font>ï¼Œk-meræ›²çº¿ä¸æ˜¯æ ‡å‡†æ³Šæ¾åˆ†å¸ƒï¼Œåœ¨ä¸»å³°å‰åå‡ºç°å…¶ä»–çš„å³°ï¼Œå¦‚æœå­˜åœ¨ä¸€å®š<font color="red">æ‚åˆåº¦</font>ï¼Œä¼šå¯¼è‡´åœ¨<font color="red">ä¸»å³°æ¨ªåæ ‡çš„äºŒåˆ†ä¹‹ä¸€å¤„</font>å‡ºç°<font color="red">æ‚åˆå³°</font>ï¼Œè€Œä¸€å®šçš„<font color="red">é‡å¤åº¦</font>åˆ™ä¼šåœ¨<font color="red">ä¸»å³°å¯¹åº”çš„æ¨ªåæ ‡æ•´æ•°å€</font>å¤„å‡ºç°<font color="red">é‡å¤å³°</font>ã€‚</p>
<h2 id="è°ƒç ”å›¾åˆ†æå†…å®¹"><a href="#è°ƒç ”å›¾åˆ†æå†…å®¹" class="headerlink" title="è°ƒç ”å›¾åˆ†æå†…å®¹"></a>è°ƒç ”å›¾åˆ†æå†…å®¹</h2><p>è¯„ä¼°åŸºå› ç»„<font color="red">å¤§å°</font>ï¼›è¯„ä¼°åŸºå› ç»„<font color="red">æ‚åˆ</font>æƒ…å†µï¼›è¯„ä¼°<font color="red">é‡å¤åºåˆ—</font>å«é‡ï¼›è¯„ä¼°åŸºå› ç»„<font color="red">GCå«é‡</font>ï¼›ä¸ºåç»­ç²¾ç»†å›¾é˜¶æ®µçš„æ–‡åº“æ„å»ºæä¾›ç­–ç•¥å»ºè®®ã€‚</p>
<h2 id="åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰"><a href="#åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰" class="headerlink" title="åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰"></a>åŸºå› ç»„è°ƒç ”å›¾surveyçš„æ„ä¹‰</h2><p>å¯åŠ¨å…¨åŸºå› ç»„æµ‹åºçš„<font color="red">å¿…è¦å‰æ</font></p>
<p>äº†è§£ä¸<font color="red"><strong>è¿‘ç¼˜ç‰©ç§é—´</strong>çš„<strong>åŸºå› ç»„å·®å¼‚</strong>ä¿¡æ¯</font></p>
<p>è·å¾—æŸ<font color="red">ç‰©ç§åŸºå› ç»„çš„åŸºæœ¬ä¿¡æ¯åŠéš¾æ˜“ç¨‹åº¦</font></p>
<h1 id="Novogene"><a href="#Novogene" class="headerlink" title="Novogene"></a><font color="green">Novogene</font></h1><p>æ–¹æ¡ˆï¼šDNA10 ugï¼›æ–‡åº“350bpï¼›PE150æµ‹åºï¼Œæµ‹åºæ·±åº¦ä¸º50X</p>
<h2 id="åˆ†æå†…å®¹"><a href="#åˆ†æå†…å®¹" class="headerlink" title="åˆ†æå†…å®¹"></a>åˆ†æå†…å®¹</h2><ul>
<li>K-meråˆ†æ</li>
<li>é¢„ä¼°ç‰©ç§åŸºå› ç»„å¤§å°</li>
<li>GCå«é‡å’Œå¤–æºæ±¡æŸ“åˆ†æ</li>
<li>æ‚åˆåº¦è¯„ä¼°</li>
<li>é‡å¤åºåˆ—è¯„ä¼°</li>
<li>åˆæ­¥ç»„è£…</li>
<li>åŸºäºåˆæ­¥ç»„è£…çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è¿›è¡ŒSSRæ ‡è®°å¼€å‘å’ŒåŒæºæ³¨é‡Šã€highlevelã€‘simple sequence repeats</li>
</ul>
<h1 id="BerryGenomics"><a href="#BerryGenomics" class="headerlink" title="BerryGenomics"></a><font color="green">BerryGenomics</font></h1><p>åŸºäºå°ç‰‡æ®µæ–‡åº“ä½æ·±åº¦æµ‹åºæ•°æ®ï¼Œé€šè¿‡K-meråˆ†æï¼Œæœ‰æ•ˆè¯„ä¼°åŸºå› ç»„å¤§å°ã€GCå«é‡ã€æ‚åˆåº¦é«˜ä½åŠé‡å¤åºåˆ—å«é‡ç­‰ä¿¡æ¯ï¼Œä¸ºåç»­çš„ç»„è£…ç­–ç•¥çš„åˆ¶å®šæä¾›ç†è®ºä¾æ®ã€‚</p>
<p><a href="https://pdf.sciencedirectassets.com/272196/1-s2.0-S0092867419X0015X/1-s2.0-S0092867420306188/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOj//////////wEaCXVzLWVhc3QtMSJHMEUCIEP3b6JimIkwVtoSmPnQ7fbUGBl4eNBBDDnBn4Sgw6y2AiEA9ob5g/J4zQrFLsTKjhs51/F/1tP61OMYZBAruOkb0fgq+gMIQRAEGgwwNTkwMDM1NDY4NjUiDMQhUFOWJRI31LL0UyrXA4jlyI72DidSpx8zf2iw85fV3Vmv5GwQ6zAU0go3NjgbvnEQeGHSyjCD3bfuIdLxx9+JR3iu8nTJwgeiw9+Pub8vYWrjzALVOyDRYnN4C6P68gzwDtI75rViTKSOYGpm0LXGHIuNV3O6NG9GNYo9nKQUdsmQfjBcBVHGBhXgRhFbmvWhLVufPeyZIY/sw6wiX3diCmbAuE7tTj4O0tA4ht9m/9y/rMizkGh9ZPtbzZ7JDkZm0+cpNEzpq3cQrGGNFrTcYFMQLf9YYSiY5LNr+zDXEI/cud8Oj8u3J75X7AtKXVgDFx3WOLQId9J+kxO1tSZ5/glrj2Mrth4nSXKk2TcSj6sirRM7+QbGIcYbhUHe+97GuZSfy6tJSD8POUgAUJZwoh9mtVgEIgRBR3uHjlgquc2QL4w5HsPkDpKmCRjT5ZIlJKfBli2DLWB81D9uot9Aw5SNzZ+mx3uR2mpTibb5v54gw7HtVunol7a5sq4awm3L8KRSRvUwk+fwX38TdFUH7OxZaFWIlBk536NC4ceJTACy5V5Ae+f7lhfpLN5wHzi3JomqhWFjfqqDLY11VHUBE2hJ2MtKtSQwilpBH+qtouIVYoOLFsKgJGfh0HvzkymqMQdxizDUhM2QBjqlAa9D4CUBq0ExkdHUsNdoKZ3Mz+0m1f72NRgmttBXR/CcVH6PUnSta5nZU2WQy6dUTWTx6pl8YHzW/DDLcwdU82BkQOE1n6CSzHGjaKA75v3T4RWRU9wOiObTdjqpmmMKTp2xohm4N78+/ZejYhLhk1Tx/CnUl2ue4z1/Utn17JSca5oVGbePorLRmqyYs5F3oL08SP73vwHxeNaoI7f7ucpUWqEcHA==&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20220221T081720Z&X-Amz-SignedHeaders=host&X-Amz-Expires=300&X-Amz-Credential=ASIAQ3PHCVTYYN624BKH/20220221/us-east-1/s3/aws4_request&X-Amz-Signature=16e8a26f9b71e59d421ff693fe49b021ce1222b688728bb93ce93ea82fb5968d&hash=ccc160836e462b394593db49a0b599b8a106fca7b355f59e9e05635b2a62f335&host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&pii=S0092867420306188&tid=spdf-0c4aa40e-20ae-4f30-8d50-b9cee2090b93&sid=5071d2f0595c814bfc9b6e825f0c6315e333gxrqa&type=client&ua=570456075759005851&rr=6e0e89a71f5d7c4a">å¤§è±†é«˜è´¨é‡æ³›åŸºå› ç»„å›¾è°±æ„å»º</a></p>
<p>æˆ‘å›½å¤§è±†æ¶ˆè´¹å¯¹å¤–ä¾èµ–ä¸¥é‡ï¼Œè€Œæé«˜å¤§è±†äº§é‡åˆ™å¿…é¡»å¯¹å¤§è±†ç§è´¨çš„é—ä¼ å¤šæ ·æ€§è¿›è¡Œç»¼åˆè¯„ä»·ã€‚ä¸­ç§‘é™¢é—ä¼ ä¸å‘è‚²ç”Ÿç‰©å­¦ç ”ç©¶æ‰€ç­‰å•ä½ä¸è´ç‘åŸºå› åˆä½œï¼Œåˆ©ç”¨æœ€æ–°ç»„è£…ç­–ç•¥æ„å»ºäº†é«˜è´¨é‡çš„åŸºäºå›¾å½¢çš„æ³›åŸºå› ç»„ã€‚è¯¥ç ”ç©¶åˆ©ç”¨Illuminaå¹³å°å¯¹æ¥è‡ªä¸–ç•Œå¤§è±†ä¸»äº§å›½çš„2,898ä»½å¤§è±†ç§è´¨è¿›è¡Œé‡æµ‹åºï¼ˆ13Ã—ï¼‰ï¼Œåˆ©ç”¨PacBioï¼ˆ96Ã—ï¼‰ã€Bionanoå’ŒHi-CæŠ€æœ¯å¯¹26ä»½ä»£è¡¨æ€§ç§è´¨è¿›è¡ŒåŸºå› ç»„ç»„è£…å’Œæ³›åŸºå› ç»„æ„å»ºã€‚å¹¶ä»¥ZH13åŸºå› ç»„ä¸ºåŸºå‡†åŸºå› ç»„ï¼Œæ•´åˆPAVsåæ„å»ºåŸºäºåŸºå› ç»„å›¾è°±ã€‚å°†é‡æµ‹åºæ•°æ®é‡æ–°æ¯”å¯¹åˆ°è¯¥åŸºå› ç»„è¿›è¡ŒSVsæ£€æµ‹å’ŒGWASåˆ†æã€‚åœ¨å¼€èŠ±çš„ä¸»æ•ˆä½ç‚¹<em>E3</em>å‘ç°äº†5ç§ä¸åŒçš„å•å€å‹ï¼›ç§çš®é¢œè‰²ç›¸å…³åŸºå› <em>CHS</em>çš„<em>I</em>ä½ç‚¹å‘ç°5ç§ä¸»è¦å•å€å‹ï¼›14å·æŸ“è‰²ä½“ä¸Šçš„ç¼ºé“è¤ªç»¿ç—‡QTLå†…å­˜åœ¨ä¸€ä¸ªè°ƒæ§Fe2+/Zn2+è½¬è¿è›‹ç™½åŸºå› <em>SoyZH13_14G179600</em>ã€‚</p>
<hr>
<h1 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a><font color="green">Pipeline</font></h1><ul>
<li><p><strong>K-mer analysis</strong> (genome size,  repetive seq, heterozygous)</p>
<ul>
<li><p><a href="http://www.cbcb.umd.edu/software/jellyfish/">JELLYFISH</a>æ˜¯<a href="http://www.cbcb.umd.edu/">CBCB(Center for Bioinformatics and Computational Biology)</a>çš„Guillaume MarÃ§ais å’Œ <a href="http://www.cs.cmu.edu/~ckingsf/">Carl Kingsford</a> ç ”å‘çš„ä¸€æ¬¾è®¡æ•° DNA çš„ k-mers çš„è½¯ä»¶ã€‚è¯¥è½¯ä»¶è¿ç”¨ Hash è¡¨æ¥å­˜å‚¨æ•°æ®ï¼ŒåŒæ—¶èƒ½å¤šçº¿ç¨‹è¿è¡Œï¼Œé€Ÿåº¦å¿«ï¼Œå†…å­˜æ¶ˆè€—å°ã€‚è¯¥è½¯ä»¶åªèƒ½è¿è¡Œåœ¨64ä½çš„Linuxç³»ç»Ÿä¸‹ã€‚å…¶<a href="http://bioinformatics.oxfordjournals.org/content/27/6/764">æ–‡ç« </a>äº2011å¹´å‘è¡¨åœ¨æ‚å¿— <a href="http://bioinformatics.oxfordjournals.org/">Bioinformatics</a> ä¸Šã€‚<a href="https://www.cnblogs.com/zhanmaomao/p/9285582.html">https://www.cnblogs.com/zhanmaomao/p/9285582.html</a>,  <a href="https://github.com/gmarcais/Jellyfish#:~:text=Jellyfish%20Overview%20Jellyfish%20is%20a%20tool%20for%20fast%2C,central%20step%20in%20many%20analyses%20of%20DNA%20sequence">https://github.com/gmarcais/Jellyfish#:~:text=Jellyfish%20Overview%20Jellyfish%20is%20a%20tool%20for%20fast%2C,central%20step%20in%20many%20analyses%20of%20DNA%20sequence</a>.</p>
</li>
<li><pre><code class="sh">$ wget æœ€æ–°targz
$ tar zxvf .tar.gz
$ mkdir jellyfish
$ cd jellyfish-2.3.0
$ ./configure --prefix=Your/Path/to/jellyfish
å¦‚æœå®‰è£…åœ¨å½“å‰ç›®å½•ä¸­ï¼Œä¼šæŠ¥é”™ã€‚
$ make -j 8
$ make install
</code></pre>
</li>
</ul>
<table>
<thead>
<tr>
<th>jellyfish</th>
<th>Kmer</th>
<th>Clean</th>
<th>Insert</th>
<th>Depth</th>
<th>Kpeak</th>
<th>HetP</th>
<th>Heter</th>
<th>repeatP</th>
<th>Repeat</th>
<th>Size</th>
</tr>
</thead>
<tbody><tr>
<td>[4]</td>
<td>17</td>
<td>30.29G</td>
<td>220 bp</td>
<td>62.99X</td>
<td>54.98X</td>
<td>26X</td>
<td>0.18%</td>
<td>106X</td>
<td>291.49Mb?(60.60%)</td>
<td>480.97 Mb</td>
</tr>
<tr>
<td>[5]</td>
<td>21</td>
<td>54.23G</td>
<td>270bp</td>
<td>83.69Ã—</td>
<td>69 Ã—</td>
<td>34 Ã—</td>
<td>0.72%</td>
<td>139 Ã—</td>
<td>43.22%</td>
<td>648.07 Mb</td>
</tr>
<tr>
<td>[6]?</td>
<td>17</td>
<td>89G</td>
<td>350bp</td>
<td></td>
<td>48x</td>
<td>24x</td>
<td>0.69%</td>
<td>96x</td>
<td><strong>91.05%</strong></td>
<td>1.86G</td>
</tr>
<tr>
<td>[7]</td>
<td>19[21,23,25,27]</td>
<td>54.99G</td>
<td>270bp</td>
<td>45.37x</td>
<td>38x</td>
<td>19x</td>
<td>0.33%</td>
<td>76x</td>
<td><strong>70.62%</strong></td>
<td>1.2G</td>
</tr>
<tr>
<td>[8]è‡ªæºå››å€</td>
<td>17</td>
<td>27G</td>
<td>220</td>
<td></td>
<td>57</td>
<td>28</td>
<td><strong>1.37%</strong></td>
<td>114</td>
<td>42.81%</td>
<td>800M</td>
</tr>
<tr>
<td>[9]</td>
<td>17</td>
<td></td>
<td></td>
<td></td>
<td>52</td>
<td>26</td>
<td><strong>2.28%</strong></td>
<td>104</td>
<td><strong>89.2%</strong></td>
<td>4159 M</td>
</tr>
</tbody></table>
<ul>
<li>[6] : K-mer analysis:1.8G; flow cytometry: 8.50 Â± 0.38 Gb. å·¨å¤§åå·®ï¼Ÿæ‚åˆåº¦0.69%ï¼Œé‡å¤ratio 91.05%</li>
</ul>
</li>
<li><p><strong>assembly</strong></p>
<ul>
<li><p>[4] : soap devovo, abyss. </p>
<ul>
<li>K-mer 31, 54, 63, 70, 77 ,83. ç»“æœåªæœ‰77ï¼Œ105 Kmer soapdenovoï¼› AByss K43</li>
<li>optimal k-mer size was selected from the N50 length</li>
<li>usable reads &gt; 200 bases were selected to realign the contig </li>
<li>paired-end relationship between reads was coincident between contigs</li>
<li>scaffolds were constructed using insert size paired-ends</li>
</ul>
</li>
<li><p>[5] :</p>
</li>
<li><p>[8] :conduct de novo assembly. K-mer sizes of 20, 37, 55, 63, 71, 77, 83, and 95 were examined using default parameters. Assembly with k-mer 63 by SOAP de novo was selected because it has the optimal reading for N50</p>
<table>
<thead>
<tr>
<th>SOAPdenovo2</th>
<th>K-mer</th>
<th>ConN50</th>
<th>N90</th>
<th>TotalCon</th>
<th>ScaN50</th>
<th>N90</th>
<th>TotalSca</th>
<th>Genome</th>
</tr>
</thead>
<tbody><tr>
<td>[4]</td>
<td>77</td>
<td>1.48k</td>
<td>236</td>
<td>405M</td>
<td>3.55k</td>
<td>375</td>
<td>409M</td>
<td>480.97 M</td>
</tr>
<tr>
<td>[5]</td>
<td>65</td>
<td>1.59k</td>
<td>379</td>
<td>449M</td>
<td>3.5k</td>
<td>1262</td>
<td>543M</td>
<td>648.07 M</td>
</tr>
<tr>
<td>[6]?</td>
<td>41</td>
<td>287</td>
<td>127</td>
<td></td>
<td>1138</td>
<td>150</td>
<td></td>
<td></td>
</tr>
<tr>
<td>[7]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>191bp</td>
<td></td>
<td>1.37G</td>
<td>1.2G</td>
</tr>
<tr>
<td>[8]</td>
<td>63</td>
<td>1.08k</td>
<td>219</td>
<td>170M</td>
<td>1.96k</td>
<td>1110</td>
<td>173M</td>
<td>800M</td>
</tr>
<tr>
<td>[9]</td>
<td></td>
<td>533</td>
<td></td>
<td></td>
<td>778</td>
<td>119</td>
<td>4.5G</td>
<td>4159M</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>GC</p>
<ul>
<li>[4] mid GC: 38%,  too high (&gt;65%) and too low (&lt;25%)</li>
<li>[4] GC depth two layer: only one of the two sets of homologous chromosomes in the diploid was assembled, which resulted in the emergence of the lower layer</li>
<li>[5] GC depth map was divided into 2 layers (Fig. 2), which was mainly due to the high heterozygosity.</li>
<li><font color="red"><strong>æ‰¾è¿‘ç¼˜çš„GCåšæ¯”è¾ƒï¼›çœ‹æ˜¯å¦GCåˆ†å±‚</strong></font></li>
<li>[8] the GC depth was slightly blocked into 4 layers (Fig. 2), which was in part caused by the polyploidy and the 1.37% high heterozygosity rate. è‡ªæºå››å€ä½“</li>
</ul>
</li>
<li><p><strong>Repetitive sequences</strong></p>
<ul>
<li>[4] :<strong>LTR_FINDER, MITE-Hunter, RepeatScout, and PILER-DF, PASTEClassifier, Repeat Masker, SciRoKo</strong> <ul>
<li>repetitive sequences ~147.89 Mb, 47.55% of the genome,</li>
<li>class I transposable element; class II transposable element</li>
<li>SSR(167,859SSR);  motif types</li>
</ul>
</li>
<li>[5] : total of 851,957 SSRs were identified,<strong>MISA</strong>. <ul>
<li>245 motif types</li>
</ul>
</li>
<li>[7] : <strong>MIcro-SAtellite(MISA)</strong><ul>
<li>Identification and characterisation of SSR motifs.</li>
<li>SSR marker verification</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Gene predition &amp; annotation</strong></p>
</li>
</ul>
<hr>
<p>ref</p>
<p><a href="https://www.jianshu.com/p/092103a24ce4">https://www.jianshu.com/p/092103a24ce4</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/366933242">https://zhuanlan.zhihu.com/p/366933242</a></p>
<p>[4] Genome Survey Sequencing for the Characterization of the Genetic Background of Rosa roxburghii Tratt and Leaf Ascorbate Metabolism Genes [Plos one]</p>
<p>[5] Genome survey sequencing and genetic diversity of cultivated <em>Akebia trifoliata</em> assessed via phenotypes and SSR markers [Molecular Biology Reports <strong>2.3IF</strong>]</p>
<p>[6] : Genome survey sequencing of red swamp crayfish <em>Procambarus clarkii</em> [<strong>2.3IF</strong>] </p>
<p>[7] Genome survey sequencing and characterization of simple sequence repeat (SSR) markers in Platostoma palustre (Blume) A.J.Paton (Chinese mesona) [scientific reports <strong>4.3IF</strong>]</p>
<p>[8] Genome survey sequencing of *Dioscorea zingiberensis [genome <strong>2.1IF</strong>]</p>
<p>[9]Genome survey sequencing of Atractylodes lancea and identification of its SSR markers[Bioscience Reports, IF3.84]</p>
]]></content>
      <categories>
        <category>assemble</category>
      </categories>
      <tags>
        <tag>survey</tag>
      </tags>
  </entry>
  <entry>
    <title>jellyfish &amp; Genomescope</title>
    <url>/blog/2022/02/23/2022-02-23-jellyfish-genomescope/</url>
    <content><![CDATA[<h1 id="A-fast-lock-free-approach-for-efficient-parallel-counting-of-occurrences-of-k-mers"><a href="#A-fast-lock-free-approach-for-efficient-parallel-counting-of-occurrences-of-k-mers" class="headerlink" title="A fast, lock-free approach for efficient parallel counting of occurrences of k-mers"></a>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</h1><span id="more"></span>

<h1 id="1-Paper-2011"><a href="#1-Paper-2011" class="headerlink" title="1. Paper-2011 :"></a><a href="https://pubmed.ncbi.nlm.nih.gov/21217122/">1. Paper-2011</a> :</h1><ul>
<li><p><font color="red">Counting the number of occurrences of every k-mer</font> </p>
</li>
<li><p> <font color="green">genome assembly</font></p>
</li>
<li><p><font color="purple">error correction</font> of sequencing reads</p>
</li>
<li><p><font color="daekred">fast multiple sequence alignment</font> </p>
</li>
<li><p><font color="blue">repeat detection</font></p>
</li>
<li><p><strong>current</strong> k-mer counting tools <strong>too slow</strong> , <strong>memory intensive</strong></p>
</li>
<li><p>multicore computers facilities <strong>parallel computational paradigm</strong></p>
</li>
<li><p>multithreaded, <font color="red">lock-free hash table</font> </p>
</li>
<li><p><strong>k-mers up to 31</strong> </p>
</li>
<li><p><strong>suffix arrays</strong> </p>
</li>
</ul>
<hr>
<h1 id="2-github-doc"><a href="#2-github-doc" class="headerlink" title="2. github-doc :"></a><font color="red"><a href="https://github.com/gmarcais/Jellyfish/tree/master/doc">2. github-doc</a></font> :</h1><h2 id="2-1-Counting-k-mers-in-sequencing-reads"><a href="#2-1-Counting-k-mers-in-sequencing-reads" class="headerlink" title="2.1 Counting k-mers in sequencing reads"></a>2.1 Counting k-mers in sequencing reads</h2><ul>
<li><p>The <code>-C</code> switch instructs to save in the hash only canonicalè§„èŒƒ k-mers, while the count is the number of occurrences of both a k-mer and it reverse complement.</p>
</li>
<li><p><font color="green"><strong>-s</strong></font> é¢„ä¼°å€¼è®¾ç½®ï¼šThe size parameter (given with <font color="red">-s</font>) is an indication of <font color="red">the number k-mers [N*(L-K+1)]</font> that will be <font color="red"><strong>stored in the hash</strong></font>. For sequencing reads, this size should be the size of <font color="red">the genome plus the k-mers generated by sequencing errors</font>. For example, if the error rate is <font color="red">e</font> (e.g.Illumina reads, usually e~<font color="red">1%</font>), with an estimated genome size of G and a coverage of <font color="red">c</font>, the number of expected k-mers is <font color="red"><strong>G+Gcek</strong></font>.</p>
</li>
</ul>
<blockquote>
<p>NOTE: unlike in Jellyfish 1, this <code>-s</code> parameter is <font color="red">only an estimation</font>. <font color="red">If the size given is too small to fit all the k-mers, the hash size will be increased automatically or partial results will be written to disk and finally merged automatically</font>. Running <code>jellyfish merge</code> should never be necessary, as now jellyfish now takes care of this task on its own. </p>
</blockquote>
<ul>
<li><font color="green"><strong>-s é¢„ä¼°kmerä»¥hashè¡¨å­˜å‚¨æ‰€éœ€å†…å­˜å¤§å°ï¼Œè®¾ç½®å°äº†ä¼šè‡ªåŠ¨æ‰©å¤§ï¼Œå¹¶è‡ªåŠ¨merge</strong></font>ã€‚</li>
<li>If the low frequency k-mers (k-mers occurring only once), which are mostly due to sequencing errors, are not of interest, one might consider counting only high-frequency k-mers (see section <a href="https://github.com/gmarcais/Jellyfish/tree/master/doc#Counting-high-frequency-k-mers">Counting high frequency k-mers</a>), which uses less memory and is potentially faster. <font color="green"><strong>ä½é¢‘k-mersç”±æµ‹åºé”™è¯¯å¯¼è‡´ï¼Œåªè€ƒè™‘é«˜é¢‘å‡å°‘å†…å­˜ä½¿ç”¨æé«˜é€Ÿåº¦</strong></font>ã€‚</li>
</ul>
<h2 id="2-2-Counting-k-mers-in-a-genome"><a href="#2-2-Counting-k-mers-in-a-genome" class="headerlink" title="2.2 Counting k-mers in a genome"></a>2.2 Counting k-mers in a genome</h2><ul>
<li>In an ã€actual genome or finished sequenceï¼Ÿã€‘, a k-mer and its reverse complement are not equivalent, hence using the <code>-C</code> switch does not make sense. In addition, the size for the hash can be set directly to the size of the genome.</li>
<li>-Cæ²¡æœ‰æ„ä¹‰ï¼Ÿå“ˆå¸Œè¡¨çš„sizeç›´æ¥è®¾ç½®ä¸ºåŸºå› ç»„å¤§å°ï¼Ÿä¸å¤Ÿè‡ªåŠ¨è°ƒæ•´ï¼Ÿ</li>
</ul>
<h2 id="2-3-Counting-high-frequency-k-mers"><a href="#2-3-Counting-high-frequency-k-mers" class="headerlink" title="2.3 Counting high-frequency k-mers"></a>2.3 Counting high-frequency k-mers</h2><p>Jellyfish offers <font color="red">two way</font> to count only high-frequency k-mers (<font color="red"><strong>count &gt;1</strong></font>), which reduces significantly the memory usage. Both methods are based on using <font color="red">Bloom filters</font>. The first method is a one pass method, which <font color="red">provides approximate count for some percentage of the k-mers</font>. The second method is a two pass method which <font color="red">provides exact count</font>. In both methods, most of the low-frequency k-mers are not reported.</p>
<h3 id="2-3-1-One-pass-method"><a href="#2-3-1-One-pass-method" class="headerlink" title="2.3.1 One pass method"></a>2.3.1 One pass method</h3><h3 id="2-3-2-Two-passes-method"><a href="#2-3-2-Two-passes-method" class="headerlink" title="2.3.2 Two passes method"></a>2.3.2 Two passes method</h3><h2 id="2-4-Counting-a-subset-of-k-mers"><a href="#2-4-Counting-a-subset-of-k-mers" class="headerlink" title="2.4 Counting a subset of k-mers"></a>2.4 Counting a subset of k-mers</h2><ul>
<li>It is possible to count the number of occurrences of <font color="red">only a subset of</font> predefined k-mers, using the <font color="red"><strong>â€“if</strong></font> switch. Only count the 20-mers of chromosome 20 in chromosome 1 of human </li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">jellyfish count -m 20 -s 100M -C -t 10 -o 20and1.jf --<span class="keyword">if</span> chr20.fa chr1.fa</span><br></pre></td></tr></table></figure>

<ul>
<li><p>This <strong>reads all the canonical 20-mers from the file chr20.fa</strong> (<font color="green"><strong>but donâ€™t count them</strong></font>) and <font color="green"><strong>loads them in memory</strong></font>. Then it <strong>reads chr1.fa and counts the number of occurrences of the 20-mers</strong> <font color="green"><strong>only of the k-mers already loaded in memory</strong></font>.</p>
</li>
<li><p>æŠŠchr20çš„kmerï¼Œå­˜å‚¨ã€‚ç»Ÿè®¡chr1çš„20-meråœ¨ä¸Šä¸€æ­¥å­˜å‚¨ä¸­å·²å­˜åœ¨çš„éƒ¨åˆ†çš„æ•°ç›®ã€‚ï¼Ÿchr1å’Œ20çš„å…³è”ï¼Ÿ</p>
</li>
<li><p>Now, the histogram will also report k-mers with a <font color="green"><strong>0 count</strong></font> (<font color="green"><strong>the 20-mers of chr20</strong></font> which <font color="green"><strong>do not exists in chr1</strong></font>):</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ jellyfish histo 20and1.jf | head </span><br><span class="line">0 49401674</span><br><span class="line">1 1116213</span><br><span class="line">2 425471</span><br></pre></td></tr></table></figure>

<p>Note that the file given to <code>--if</code> is a fasta file. If a list of k-mers is available instead (say one per line in a text file), it can be transformed into a fasta file with one k-mer per line using the following one liner Perl command:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">perl -ne <span class="string">&#x27;print(&quot;&gt;\n$_&quot;)&#x27;</span></span><br><span class="line"><span class="comment">#kmer lineè½¬faï¼Œä¸€è¡Œ&gt;å·ï¼Œä¸€è¡Œkmer</span></span><br></pre></td></tr></table></figure>

<h2 id="2-5-å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶"><a href="#2-5-å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶" class="headerlink" title="2.5 å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶"></a>2.5 å¦‚ä½•è¯»å–å‹ç¼©æ–‡ä»¶</h2><p> jellyfishåªè¯»å…¥fqæˆ–fa</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">zcat *.fastq.gz | jellyfish count /dev/fd/0 ...</span><br><span class="line"><span class="comment">#using the &lt;() redirection provided by the shell (e.g. bash, zsh):</span></span><br><span class="line"><span class="comment">#!/usr/bin/bash</span></span><br><span class="line">jellyfish count &lt;(zcat file1.fastq.gz) &lt;(zcat file2.fasta.gz) ...</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="3-Jellyfishä»‹ç»"><a href="#3-Jellyfishä»‹ç»" class="headerlink" title="3. Jellyfishä»‹ç»"></a>3. Jellyfishä»‹ç»</h1><p><a href="http://www.cbcb.umd.edu/software/jellyfish/">JELLYFISH</a>æ˜¯<a href="http://www.cbcb.umd.edu/">CBCB(Center for Bioinformatics and Computational Biology)</a>çš„Guillaume MarÃ§ais å’Œ <a href="http://www.cs.cmu.edu/~ckingsf/">Carl Kingsford</a> ç ”å‘çš„ä¸€æ¬¾è®¡æ•° DNA çš„ k-mers çš„è½¯ä»¶ã€‚è¯¥è½¯ä»¶è¿ç”¨ Hash è¡¨æ¥å­˜å‚¨æ•°æ®ï¼ŒåŒæ—¶èƒ½å¤šçº¿ç¨‹è¿è¡Œï¼Œé€Ÿåº¦å¿«ï¼Œå†…å­˜æ¶ˆè€—å°ã€‚è¯¥è½¯ä»¶åªèƒ½è¿è¡Œåœ¨64ä½çš„Linuxç³»ç»Ÿä¸‹ã€‚å…¶<a href="http://bioinformatics.oxfordjournals.org/content/27/6/764">æ–‡ç« </a>äº2011å¹´å‘è¡¨åœ¨æ‚å¿— <a href="http://bioinformatics.oxfordjournals.org/">Bioinformatics</a> ä¸Šã€‚</p>
<h1 id="4-Jellyfishå®‰è£…"><a href="#4-Jellyfishå®‰è£…" class="headerlink" title="4. Jellyfishå®‰è£…"></a>4. Jellyfishå®‰è£…</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ wget æœ€æ–°targz</span><br><span class="line">$ tar zxvf .tar.gz</span><br><span class="line">$ mkdir jellyfish</span><br><span class="line">$ <span class="built_in">cd</span> jellyfish-2.3.0</span><br><span class="line">$ ./configure --prefix=Your/Path/to/jellyfish</span><br><span class="line">å¦‚æœå®‰è£…åœ¨å½“å‰ç›®å½•ä¸­ï¼Œä¼šæŠ¥é”™ã€‚</span><br><span class="line">$ make -j 8</span><br><span class="line">$ make install</span><br></pre></td></tr></table></figure>

<h1 id="5-Jellyfishä½¿ç”¨"><a href="#5-Jellyfishä½¿ç”¨" class="headerlink" title="5. Jellyfishä½¿ç”¨"></a>5. Jellyfishä½¿ç”¨</h1><h2 id="jellyfish-count-ã€count-kmers-to-estimate-genome-sizeã€‘"><a href="#jellyfish-count-ã€count-kmers-to-estimate-genome-sizeã€‘" class="headerlink" title="jellyfish count ã€count kmers to estimate genome sizeã€‘"></a>jellyfish count ã€count kmers to estimate genome sizeã€‘</h2><p>Theory:</p>
<ul>
<li>If k is large enough so that each kmer found is unique in the genome,</li>
<li>and if the genome length (e.g. 1,000,000) is much larger than the kmer length (e.g. 21),</li>
<li>and if no PCR or sequencing errors,</li>
<li>then the number of kmers will be approximately equal to the length of the genome.</li>
</ul>
<p>ï¼ï¼ï¼ï¼<font color="red">Kmer counting tutorial</font>: <a href="https://bioinformatics.uconn.edu/genome-size-estimation-tutorial/#">https://bioinformatics.uconn.edu/genome-size-estimation-tutorial/#</a></p>
<ul>
<li>Jellyfish: <a href="https://github.com/gmarcais/Jellyfish">https://github.com/gmarcais/Jellyfish</a></li>
<li>Further jellyfish steps : <a href="https://github.com/gmarcais/Jellyfish/tree/master/doc">https://github.com/gmarcais/Jellyfish/tree/master/doc</a></li>
</ul>
<p>Note: Aug 2019: conda install seems to work only with: conda install jellyfish=2.2.3</p>
<p>Steps:</p>
<ul>
<li><font color="green">â€œ&gt;Go through</font> the sequencing reads</li>
<li>For each <font color="green">new kmer seen</font>, <font color="green">add to table with count</font>.</li>
<li>If kmer <font color="green">seen before</font>, <font color="green">increment count</font>.</li>
<li>Find the <font color="green">average kmer frequency</font> (sequencing depth), e.g. 50</li>
<li><font color="green">Exclude kmers with a count of ~ 1</font>, as these are likely from <font color="green">errors</font></li>
<li>Add all the other kmers, and <font color="green"><strong>divide by average kmer frequency</strong></font> =&gt; This is the approx genome length</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jellyfish count -m 21 -s 100M -t 10 -C reads.fasta</span><br></pre></td></tr></table></figure>

<p>To use gzipped files: and <font color="green">paired-end reads</font>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jellyfish count -m 21 -s 100M -t 10 -C &lt;zcat R1.fq.gz) &lt;(zcat R2.fq.gz)</span><br></pre></td></tr></table></figure>

<ul>
<li>-m: kmer length, 21 is commonly used, <strong>17</strong></li>
<li>-s: size of hash table: should be genome size + extra kmers from seq errors. <font color="green">However, it does say that hash size <strong>will be increased automatically if needed</strong>.</font></li>
<li>-C: canonical. <font color="green">Reverse complement kmers are considered to be identical and are counted as the same thing</font>. <font color="green"><strong>This is recommended</strong></font>.</li>
<li>-t: number of threads</li>
<li>output: mer_counts.jf</li>
</ul>
<p>Plot the histogram:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jellyfish histo -t 10 mer_counts.jf &gt; reads.histo</span><br></pre></td></tr></table></figure>

<p><strong>???Plot the histogram with an x axis of one million instead of default 10,000</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jellyfish histo -t 10 --high=1000000 mer_counts.jf &gt; reads.histo</span><br></pre></td></tr></table></figure>

<ul>
<li>Discussion on setting to 1 million: <a href="https://github.com/schatzlab/genomescope/issues/22">https://github.com/schatzlab/genomescope/issues/22</a></li>
<li>There may be very high counts of some kmers due to chloroplast sequences, spike-in sequences, etc.</li>
</ul>
<blockquote>
<p>ä½¿ç”¨fastqæ–‡ä»¶åœ¨é»˜è®¤å‚æ•°ä¸Šå’Œfastaæ–‡ä»¶æ²¡æœ‰åŒºåˆ«ã€‚ç”Ÿæˆçš„hashç»“æœä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-m | --mer-len=&lt;num&gt;</span><br><span class="line"> ä½¿ç”¨çš„k-merçš„é•¿åº¦ã€‚å¦‚æœåŸºå› ç»„å¤§å°ä¸ºGï¼Œåˆ™k-meré•¿åº¦é€‰æ‹©ä¸º: k ~= <span class="built_in">log</span>(200G)</span><br><span class="line">/<span class="built_in">log</span>(4)ã€‚</span><br><span class="line">-s | --size=&lt;num&gt;</span><br><span class="line"> Hash çš„å¤§å°ã€‚æœ€å¥½è®¾ç½®çš„å€¼å¤§äºæ€»çš„ç‹¬ç‰¹çš„(distinct)k-meræ•°,è¿™æ ·ç”Ÿæˆçš„æ–‡ä»¶åª</span><br><span class="line">æœ‰ä¸€ä¸ªã€‚è‹¥è¯¥å€¼ä¸å¤Ÿå¤§ï¼Œåˆ™ä¼šç”Ÿæˆå¤šä¸ª<span class="built_in">hash</span>æ–‡ä»¶ï¼Œä»¥æ•°å­—åŒºåˆ†æ–‡ä»¶åã€‚è¯¥å€¼è¯†åˆ« </span><br><span class="line">M å’Œ Gã€‚</span><br><span class="line">-t | --threads=&lt;num&gt;  default: 1</span><br><span class="line"> ä½¿ç”¨çš„CPUçº¿ç¨‹æ•°</span><br><span class="line">-o | --output=&lt;string&gt;  default: mer_counts.jf</span><br><span class="line"> è¾“å‡ºçš„ç»“æœæ–‡ä»¶å‰ç¼€</span><br><span class="line">-c | --counter-len=&lt;num&gt;  default:7</span><br><span class="line"> k-merçš„è®¡æ•°ç»“æœæ‰€å çš„æ¯”ç‰¹æ•°,é»˜è®¤æ”¯æŒçš„æœ€å¤§æ•°å­—æ˜¯2^7=128ã€‚å¯¹äºåŸºå› ç»„æµ‹åºè¦†ç›–</span><br><span class="line">åº¦ä¸ºNï¼Œåˆ™è¦ä½¿è®¾ç½®çš„è¯¥å€¼è¦å¤§äºNã€‚è¯¥å€¼è¶Šå¤§ï¼Œæ¶ˆè€—å†…å­˜è¶Šå¤§ã€‚</span><br><span class="line">-out-counter-len=&lt;num&gt;  default:4</span><br><span class="line"> è¾“å‡ºçš„äºŒè¿›åˆ¶<span class="built_in">hash</span>æ–‡ä»¶ä¸­çš„è®¡æ•°ç»“æœæ‰€å çš„å­—èŠ‚æ•°,ä¸€ä¸ªå­—èŠ‚æ˜¯8æ¯”ç‰¹ã€‚åˆ™é»˜è®¤æ”¯æŒçš„æœ€å¤§</span><br><span class="line">æ•°å­—æ˜¯2^32=4.3G</span><br><span class="line"><span class="comment">#The count of k-mers which cannot be represented with the given number of bytes will have a value equal to the maximum value that can be represented. Meaning, if the counter field uses 1 byte, any k-mers with count greater or equal to 255 will be reported of having a count of 255.</span></span><br><span class="line">-C | --both-strand  default: <span class="literal">false</span></span><br><span class="line"> ã€å¯¹æ­£ä¹‰é“¾å’Œåä¹‰é“¾éƒ½è¿›è¡Œè®¡æ•°ã€‘</span><br><span class="line">-q | --quake  default: <span class="literal">false</span></span><br><span class="line"> quakeå…¼å®¹æ¨¡å¼</span><br><span class="line">--quality-start=&lt;num&gt;  default: 64</span><br><span class="line"> èµ·å§‹ç¢±åŸºè´¨é‡çš„ASCIIå€¼ï¼Œé»˜è®¤ä¸ºPHRED64</span><br><span class="line">--min-quality=&lt;num&gt;  default: 0</span><br><span class="line"> æ”¯æŒçš„æœ€å°çš„ç¢±åŸºè´¨é‡å€¼ï¼Œä½äºæ­¤å€¼çš„ç¢±åŸºå°†ç”±Nä»£æ›¿</span><br><span class="line">-L | --lower-count=&lt;num&gt;</span><br><span class="line"> ã€ä¸è¾“å‡ºæ•°ç›®ä½äºæ­¤å€¼çš„k-merã€‘</span><br><span class="line">-U | --upper-count=&lt;num&gt;</span><br><span class="line"> ã€ä¸è¾“å‡ºæ•°ç›®é«˜äºæ­¤å€¼çš„k-merã€‘</span><br><span class="line"><span class="comment">#low frequency and high frequency k-mers can be skipped using the --L and --U` switches respectively. Although it might be more appropriate to filter out the low frequency $k$-mers using Bloom filters, as shown in section Counting-high-frequency-k-mers.</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="jellyfish-merge-åˆå¹¶"><a href="#jellyfish-merge-åˆå¹¶" class="headerlink" title="jellyfish merge åˆå¹¶"></a>jellyfish merge åˆå¹¶</h2><p>Countçš„è¾“å‡ºç»“æœä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½è¾“å‡ºå¤šä¸ªhashæ–‡ä»¶ï¼Œéœ€è¦hashæ–‡ä»¶åˆå¹¶ä¸€ä¸ªæ–‡ä»¶, merge å‘½ä»¤ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#The merge subcommand is of little direct use with version version 2 of Jellyfish</span></span><br><span class="line"><span class="comment">#The count subcommand will merge intermediary files automatically as needed.</span></span><br><span class="line">jellyfish merge -o mer_counts_merged.jf hash1 hash2 ...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>-o | â€“output=<string>  default: mer_counts_merged.jf<br>    è¾“å‡ºçš„ç»“æœæ–‡ä»¶<br>â€“out-counter-len=<num>  default: 4<br>è¾“å‡ºçš„äºŒè¿›åˆ¶hashæ–‡ä»¶ä¸­çš„è®¡æ•°ç»“æœæ‰€å çš„å­—èŠ‚æ•°,ä¸€ä¸ªå­—èŠ‚æ˜¯8æ¯”ç‰¹ã€‚åˆ™é»˜è®¤æ”¯æŒçš„æœ€å¤§æ•°å­—æ˜¯2^32=4.3G</num></string></p>
</blockquote>
<h2 id="jellyfish-stats-ç»Ÿè®¡"><a href="#jellyfish-stats-ç»Ÿè®¡" class="headerlink" title="jellyfish stats ç»Ÿè®¡"></a>jellyfish stats ç»Ÿè®¡</h2><p>k-merçš„ç»“æœä»¥hashçš„äºŒè¿›åˆ¶æ–‡ä»¶ç»“æœç»™å‡ºï¼Œéœ€è¦ç»Ÿè®¡å‡ºk-meræ€»æ•°ï¼Œç‰¹å¼‚çš„k-meræ•°ç›®ï¼Œåªå‡ºç°è¿‡ä¸€æ¬¡çš„kmeræ•°ï¼Œå‡ºç°äº†æœ€å¤šçš„k-merçš„æ•°ç›®ç­‰ä¿¡æ¯ã€‚ä»¥statså‘½ä»¤æ¥è¿è¡Œã€‚ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Although these statistics could be computed from the histogram, it provides quick summary information</span></span><br><span class="line">$ jellyfish stats <span class="built_in">hash</span></span><br><span class="line">ç¤ºä¾‹ç»“æœä¸ºï¼š</span><br><span class="line">Unique:    32355544    <span class="comment">#åªå‡ºç°è¿‡ä¸€æ¬¡çš„k-merçš„æ•°ç›®</span></span><br><span class="line">Distinct:  88414020    <span class="comment">#ç‰¹å¼‚æ€§çš„k-meræ•°ç›®ï¼ŒåŒ…å«ä¸Šä¸€ä¸ªçš„æ•°æ®</span></span><br><span class="line">Total:     432232807   <span class="comment">#æ€»çš„k-meræ•°ç›®</span></span><br><span class="line">Max_count: 85348       <span class="comment">#åŒä¸€ä¸ªk-merå‡ºç°çš„æœ€å¤šçš„æ•°ç›®</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>-L | â€“lower-count=<num><br>    ä¸ç»Ÿè®¡æ•°ç›®ä½äºæ­¤å€¼çš„k-mer<br>-U | â€“upper-count=<num><br>    ä¸ç»Ÿè®¡æ•°ç›®é«˜äºæ­¤å€¼çš„k-mer</num></num></p>
</blockquote>
<h2 id="jellyfish-histo-ç»˜å›¾"><a href="#jellyfish-histo-ç»˜å›¾" class="headerlink" title="jellyfish histo ç»˜å›¾"></a>jellyfish histo ç»˜å›¾</h2><p>å¯¹k-merçš„è®¡æ•°ç»“æœæœ‰ä¸ªç›´è§‚çš„è®¤è¯†ï¼Œåˆ™éœ€è¦ç»Ÿè®¡å‡ºç°äº†x(x=1,2,3â€¦)æ¬¡çš„kmerçš„æ•°ç›®y,ä»¥xï¼Œyä¸ºæ¨ªçºµåæ ‡ç”»å‡ºç›´æ–¹å›¾ã€‚ä½¿ç”¨ histo å‘½ä»¤èƒ½ç»™å‡º x å’Œ y å¯¹åº”çš„å€¼ï¼Œå°†ç»“æœé»˜è®¤è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚å…¶ä½¿ç”¨æ–¹æ³•ä¸º</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">jellyfish histo -l 1 -h 1000 <span class="built_in">hash</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>-l | â€“low=<num>  default: 1<br>    æœ€ä½çš„ x è½´çš„å€¼ã€‚åŒæ—¶ç»“æœä¼šå°†ä½äºæ­¤å€¼çš„æ‰€æœ‰çš„k-merçš„æ•°ç›®ä½œä¸º (x-1) çš„å€¼ã€‚å› <br>æ­¤è¯¥å€¼ä¸º 2 å’Œ 1 çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚<br>-h | â€“high=<num>  ã€default: 10000ï¼Ÿï¼Ÿã€‘<br>    æœ€é«˜çš„ x è½´çš„å€¼ã€‚åŒæ—¶ç»“æœä¼šå°†é«˜äºæ­¤å€¼çš„æ‰€æœ‰çš„k-merçš„æ•°ç›®çš„å’Œä½œä¸º (x+1) çš„å€¼ã€‚<br>-i | â€“increment=<num>  default: 1<br>    x è½´å–å€¼æ˜¯æ¯éš”è¯¥æ•°å€¼å–å€¼<br>-t | â€“threads=<num>  default: 1<br>    ä½¿ç”¨çš„CPUçº¿ç¨‹æ•°<br>-f | â€“full  default: false<br>    å…¨éƒ¨çš„ç›´æ–¹å›¾</num></num></num></num></p>
</blockquote>
<h2 id="jellyfish-dump-ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢"><a href="#jellyfish-dump-ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢" class="headerlink" title="jellyfish dump ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢"></a>jellyfish dump ç»“æœæ–‡ä»¶æ ¼å¼è½¬æ¢</h2><p>ç”±äºcountå‘½ä»¤ç”Ÿæˆçš„ç»“æœä¸ºäºŒè¿›åˆ¶çš„ï¼Œå¦‚æœ‰éœ€è¦ï¼Œåˆ™å¯ä»¥è½¬æ¢æˆå¯è¯»æ–‡æœ¬æ–‡ä»¶ã€‚ä½¿ç”¨ dump å‘½ä»¤ï¼Œä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">jellyfish dump -c -t -U 1000 <span class="built_in">hash</span></span><br><span class="line"><span class="comment">#To output all the counts for all the k-mers in the file</span></span><br><span class="line"><span class="comment">#By default, the output is in FASTA format</span></span><br><span class="line">jellyfish dump mer_counts.jf &gt; mer_counts_dumps.fa</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-c | --colum  default: <span class="literal">false</span></span><br><span class="line"> ç”Ÿæˆç»“æœä¸º2åˆ—ï¼Œç¬¬ä¸€åˆ—ä¸ºk-meråºåˆ—ï¼Œç¬¬äºŒåˆ—ä¸ºå¯¹åº”çš„æ•°ç›®ã€‚é»˜è®¤æƒ…å†µä¸‹æ˜¯æ˜¯fastaæ ¼</span><br><span class="line">å¼ï¼Œfastaçš„å¤´ä¸ºk-merçš„æ•°ç›®ï¼Œfastaçš„åºåˆ—ä¸ºk-merçš„åºåˆ—ã€‚</span><br><span class="line">-t | --tab  default: <span class="literal">false</span></span><br><span class="line"> å½“ -c å‚æ•°å­˜åœ¨æ—¶ï¼Œä»¥tabæ¥è¿›è¡Œåˆ†éš”ä¸¤è¡Œã€‚é»˜è®¤æ˜¯ä»¥ç©ºæ ¼æ¥åˆ†å¼€çš„ã€‚</span><br><span class="line"><span class="comment"># Low frequency and high frequency k-mers can be skipped with the `-L` and `-U` switches respectively.</span></span><br><span class="line">-L | --lower-count=&lt;num&gt;</span><br><span class="line"> ä¸è¾“å‡ºå°äºè¯¥å€¼çš„k-mer</span><br><span class="line">-U | --upper-count=&lt;num&gt;</span><br><span class="line"> ä¸è¾“å‡ºé«˜äºè¯¥å€¼çš„k-mer</span><br><span class="line">-o | --output=&lt;file&gt;</span><br><span class="line"> è¾“å‡ºæ–‡ä»¶çš„è·¯å¾„å’Œåç§°</span><br></pre></td></tr></table></figure>



<h2 id="jellyfish-query-æŸ¥è¯¢"><a href="#jellyfish-query-æŸ¥è¯¢" class="headerlink" title="jellyfish query æŸ¥è¯¢"></a>jellyfish query æŸ¥è¯¢</h2><p>å¦‚æœéœ€è¦ä»Hashç»“æœä¸­æŸ¥è¯¢æŒ‡å®šçš„k-merå‡ºç°çš„æ¬¡æ•°ï¼Œåˆ™è¦æ˜¯ç”¨ query å‘½ä»¤ã€‚ä»æ ‡å‡†è¾“å…¥è¯»å–k-merçš„åºåˆ—ï¼Œä»æ ‡å‡†è¾“å‡ºå¾—åˆ°k-merå¯¹åº”çš„æ•°ç›®ã€‚ä½¿ç”¨æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jellyfish query hash</span><br></pre></td></tr></table></figure>

<blockquote>
<p>-C | â€“both-strands  default: false<br>   åŒæ—¶æŸ¥è¯¢k-meråºåˆ—çš„æ­£è´Ÿé“¾<br>-i | â€“input=<file><br>   è¾“å…¥çš„æ–‡ä»¶<br>-o | â€“output=<file><br>   è¾“å‡ºçš„æ–‡ä»¶</file></file></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jellyfish query mer_counts.jf AACGTTG</span><br></pre></td></tr></table></figure>



<h2 id="jellyfish-info"><a href="#jellyfish-info" class="headerlink" title="jellyfish info"></a>jellyfish info</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#To get some information on ã€how, when and whereã€‘ this jellyfish file was ã€generatedã€‘, use the info subcommand</span></span><br><span class="line"><span class="comment">#outputs some information about the jellyfish file and the command used to generated it, in which directory and at what time the command was run</span></span><br><span class="line">jellyfish info mer_counts.jf</span><br></pre></td></tr></table></figure>

<h2 id="jellyfish-mem"><a href="#jellyfish-mem" class="headerlink" title="jellyfish mem"></a>jellyfish mem</h2><p>The <code>mem</code> subcommand shows how much memory a count subcommand will need or conversely how large of a hash size will fit in a given amount of memory.</p>
<hr>
<p>refï¼š</p>
<p><a href="https://www.annasyme.com/docs/jellyfish.html">https://www.annasyme.com/docs/jellyfish.html</a></p>
<hr>
<h1 id="Genomescope"><a href="#Genomescope" class="headerlink" title="Genomescope"></a>Genomescope</h1><p>å®‰è£…githubæœ€æ–°</p>
<p><font color="red">githubdoc</font>  : <a href="https://github.com/schatzlab/genomescope">https://github.com/schatzlab/genomescope</a></p>
<p><font color="red">paperlink</font> : <a href="https://doi.org/10.1093/bioinformatics/btx153">https://doi.org/10.1093/bioinformatics/btx153</a></p>
<h2 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><p>å°†paired-endæ•°æ®æ•´åˆï¼Ÿå°†read2æ•°æ®çš„åºåˆ—åå‘é‡å¤åä¸read1æ–‡ä»¶åˆå¹¶ï¼Ÿä½¿ç”¨Trinityé™„å¸¦çš„fastoolç¨‹åºå®Œæˆè½¬æ¢ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ zcat read_1.clean.fq.gz | <span class="variable">$Trinity_Home</span>/trinity-plugins/fastool/fastool --illumina-trinity --to-fasta &gt; reads_1.fasta</span><br><span class="line">$ zcat read_2.clean.fq.gz | <span class="variable">$Trinity_Home</span>/trinity-plugins/fastool/fastool --rev --illumina-trinity --to-fasta &gt; reads_2.fasta</span><br><span class="line">$ cat reads_1.fasta reads_2.fasta &gt; both.fasta</span><br></pre></td></tr></table></figure>

<h2 id="ç»Ÿè®¡kmer"><a href="#ç»Ÿè®¡kmer" class="headerlink" title="ç»Ÿè®¡kmer"></a>ç»Ÿè®¡kmer</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">jellyfish count -C -m [] -s [] -t [] s.fasta -o s.jf</span><br></pre></td></tr></table></figure>

<h2 id="ç»˜ç›´æ–¹å›¾"><a href="#ç»˜ç›´æ–¹å›¾" class="headerlink" title="ç»˜ç›´æ–¹å›¾"></a>ç»˜ç›´æ–¹å›¾</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jellyfish histo -t 10 s.jf &gt; s.histo</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">-s é¢„ä¼°å“ˆå¸Œè¡¨çš„å¤§å°ï¼Œå³G+Gce*kã€‚Gæ˜¯Genome Sizeï¼›cæ˜¯coverageï¼ˆgenome surveyæµ‹åºé€šå¸¸ä½äº100xï¼‰ï¼›eæ˜¯æµ‹åºé”™è¯¯ç‡ï¼ˆilluminaä¸º1%ï¼‰ï¼›kæ˜¯kmerå¤§å°ã€‚</span><br><span class="line">-C è¡¨ç¤ºè€ƒè™‘DNAæ­£ä¹‰ä¸åä¹‰é“¾ï¼Œé‡åˆ°åä¹‰kmeræ—¶ï¼Œè®¡å…¥æ­£ä¹‰kmeré¢‘æ•°ä¸­ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="ç»˜å›¾"><a href="#ç»˜å›¾" class="headerlink" title="ç»˜å›¾"></a>ç»˜å›¾</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Rscript genomescope.R histogram_file k-mer_length read_length output_dir [kmer_max] [verbose]</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>assemble</category>
      </categories>
      <tags>
        <tag>survey</tag>
      </tags>
  </entry>
  <entry>
    <title>HiFi-2-SMRT Sequencing - HiFi Reads [High fidelity reads]</title>
    <url>/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/</url>
    <content><![CDATA[<h1 id="ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford-çš„-Nanoporeï¼ŒPacific-Biosciencesï¼ˆ-PacBioï¼‰çš„-Single-Molecule-Real-Timeï¼ˆSMRTï¼‰Sequencing"><a href="#ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford-çš„-Nanoporeï¼ŒPacific-Biosciencesï¼ˆ-PacBioï¼‰çš„-Single-Molecule-Real-Timeï¼ˆSMRTï¼‰Sequencing" class="headerlink" title="ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford çš„ Nanoporeï¼ŒPacific Biosciencesï¼ˆ PacBioï¼‰çš„ Single Molecule Real-Timeï¼ˆSMRTï¼‰Sequencing"></a>ä¸»æµä¸‰ä»£æµ‹åºå¹³å°Oxford çš„ Nanoporeï¼ŒPacific Biosciencesï¼ˆ PacBioï¼‰çš„ Single Molecule Real-Timeï¼ˆSMRTï¼‰Sequencing</h1><span id="more"></span>

<p>Ref:<a href="https://zhuanlan.zhihu.com/p/339875837">https://zhuanlan.zhihu.com/p/339875837</a></p>
<p><a href="http://pacbiofileformats.readthedocs.io/en/5.0/">http://pacbiofileformats.readthedocs.io/en/5.0/</a></p>
<p>PacBioä¼˜åŠ¿ï¼š</p>
<ul>
<li>åœ¨ä¸å½±å“ååé‡å’Œå‡†ç¡®æ€§å‰æä¸‹ï¼Œæä¾›ç›®å‰<font color="green">æœ€é•¿çš„è¯»å–é•¿åº¦</font></li>
</ul>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/1.png" alt="img"></p>
<ul>
<li>å¦‚æœä¸å«ç³»ç»Ÿè¯¯å·®ï¼Œå‡†ç¡®åº¦å¯è¾¾<font color="green"> 99.999ï¼…</font></li>
</ul>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/2.png" alt="img"></p>
<ul>
<li>å¯æµ‹å–å¯Œ<font color="green">å«ATæˆ–GCåŒºåŸŸ</font>ï¼Œ<font color="green">é«˜åº¦é‡å¤åºåˆ—</font>ï¼Œ<font color="green">å›æ–‡åºåˆ—</font>ç­‰ï¼Œä¸ä¼šäº§ç”ŸGCçš„è¾ƒå¤§åå·®</li>
<li>å¯ä»¥ç›´æ¥<font color="green">æµ‹å–åŒ–å­¦ä¿®é¥°</font>ï¼Œåœ¨<font color="green">è¡¨è§‚é—ä¼ å­¦</font>ä¸­æœ‰é‡è¦åº”ç”¨</li>
</ul>
<h1 id="æ–‡åº“æ„å»º"><a href="#æ–‡åº“æ„å»º" class="headerlink" title="æ–‡åº“æ„å»º"></a>æ–‡åº“æ„å»º</h1><p>å°†æ ·æœ¬ä¸­çš„DNAæˆ–RNAåˆ†å­æå–åï¼Œæ„å»º<font color="green">å“‘é“ƒçŠ¶åˆ†å­ç»“æ„<strong>SMRTbell</strong></font>ï¼š</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/3.png" alt="img"></p>
<p>é»„è‰²ï¼Œç´«è‰²ï¼šåŒé“¾DNAåˆ†å­; è“è‰²ï¼šæ¥å¤´ï¼ˆAdapterï¼‰</p>
<p>æ–‡åº“åˆ†å­å±•å¼€ï¼Œä¸€ä¸ªå®Œæ•´çš„<font color="green">åœ†ç¯</font>ï¼š</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/4.png" alt="img"></p>
<p>åœ†ç¯ç»“æ„æœ‰åˆ©äºå‘¨è€Œå¤å§‹çš„æ»šç¯å¤åˆ¶ï¼Œåˆ©äºçº é”™ã€‚</p>
<p>å°†æ ·æœ¬ä¸­æ‰€æœ‰çš„DNAç‰‡æ®µéƒ½æ„å»ºå“‘é“ƒçŠ¶åˆ†å­ç»“æ„ï¼Œç»„æˆçš„é›†åˆå«<font color="green">æ–‡åº“</font>ï¼ˆSMRTbell Libraryï¼‰ï¼Œéšåè¢«æ”¾åˆ°æµ‹åºèŠ¯ç‰‡ä¸­ã€‚</p>
<p>ä»¥åŸºå› ç»„HiFiæ–‡åº“ä¸ºä¾‹ï¼ˆ15-20Kæ–‡åº“ï¼‰ã€‚å½“å¾—åˆ°gDNAåï¼Œå…ˆåˆ©ç”¨G-tubeç®¡æˆ–Megaruptor Systemå°†åŸºå› ç»„<strong>ç‰‡æ®µåŒ–</strong>è‡³åˆé€‚å¤§å°ï¼Œè€Œåé€šè¿‡<strong>å»é™¤å•é“¾æ‚¬çª</strong>ã€<strong>æŸä¼¤ä¿®å¤</strong>å’Œ<strong>æœ«ç«¯ä¿®å¤</strong>ç­‰æ­¥éª¤ï¼Œå¾—åˆ°å®Œæ•´çš„åŒé“¾æ’å…¥ç‰‡æ®µã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡å°†<strong>æ¥å¤´è¿æ¥</strong>è‡³åŒé“¾DNAæ¥åˆ›å»ºSMRTbellæ–‡åº“ï¼Œä»è€Œå¾—åˆ°ç¯çŠ¶æ¨¡æ¿ã€‚å®Œæˆæ¥å¤´è¿æ¥åï¼Œéœ€è¦å¯¹è¿æ¥äº§ç‰©è¿›è¡Œçº¯åŒ–ï¼Œåˆ©ç”¨<strong>é…¶å¤„ç†</strong>æ¥æ¶ˆåŒ–çº¿æ€§æˆ–å†…éƒ¨æŸä¼¤ç¯å½¢DNAåˆ†å­ï¼ˆæ¸¸ç¦»çš„Hairpin Adapterã€ä¸¤ç«¯æœªè¿æ¥Adapterçš„DNAæ¨¡æ¿ã€å·²æˆç¯ä½†å†…éƒ¨æœ‰æŸä¼¤çš„DNAæ¨¡æ¿ï¼‰ï¼Œé…¶å¤„ç†å®Œæ¯•åï¼Œä¸€èˆ¬ä¼šåˆ©ç”¨<strong>Bulepippin</strong>æˆ–Sage ELF Systemåˆ‡èƒ¶<strong>å›æ”¶ç›®æ ‡å¤§å°èŒƒå›´</strong>å†…çš„æ–‡åº“ã€‚æ–‡åº“è´¨æ£€</p>
<h1 id="æµ‹åºèŠ¯ç‰‡"><a href="#æµ‹åºèŠ¯ç‰‡" class="headerlink" title="æµ‹åºèŠ¯ç‰‡"></a>æµ‹åºèŠ¯ç‰‡</h1><p>ä»¥ RSII æµ‹åºå¹³å°ä¸ºä¾‹ï¼Œæµ‹åºä»ªèŠ¯ç‰‡ï¼ˆSMRT Cellï¼‰ï¼š</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/5.png" alt="img"></p>
<p>æ”¾å¤§ï¼šä¸Šé¢æ•´é½æ’åˆ—ç€<font color="green">15ä¸‡ä¸ª</font>ç›´å¾„ä¸º<font color="green">70çº³ç±³çš„æµ‹åºå¾®å­”</font>ï¼ˆ<font color="red">Zero-Model Waveguidesï¼ŒZMWs</font>ï¼‰ã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/6.png" alt="img"></p>
<h1 id="ä¸Šæœºæµ‹åº"><a href="#ä¸Šæœºæµ‹åº" class="headerlink" title="ä¸Šæœºæµ‹åº"></a>ä¸Šæœºæµ‹åº</h1><h2 id="1-æ„å»ºæµ‹åºå¤åˆç‰©"><a href="#1-æ„å»ºæµ‹åºå¤åˆç‰©" class="headerlink" title="1. æ„å»ºæµ‹åºå¤åˆç‰©"></a>1. <strong>æ„å»ºæµ‹åºå¤åˆç‰©</strong></h2><p>æµ‹åºå¤åˆç‰©ï¼šèšåˆé…¶ï¼Œæµ‹åºæ¨¡æ¿ï¼Œæµ‹åºå¼•ç‰©</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/7.png" alt="img"></p>
<h2 id="2-å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”"><a href="#2-å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”" class="headerlink" title="2. å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”"></a>2. <strong>å¤åˆç‰©æ’’å…¥æµ‹åºå°å­”</strong></h2><p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/8.png" alt="img"></p>
<h2 id="3-å›ºå®šæµ‹åºå¤åˆç‰©"><a href="#3-å›ºå®šæµ‹åºå¤åˆç‰©" class="headerlink" title="3. å›ºå®šæµ‹åºå¤åˆç‰©"></a>3. <strong>å›ºå®šæµ‹åºå¤åˆç‰©</strong></h2><p>ç”±äº<font color="green">èšåˆé…¶åŠ äº†<strong>ç”Ÿç‰©ç´ </strong></font>ï¼Œåœ¨<font color="green">èŠ¯ç‰‡ç»ç’ƒåº•æ¿æœ‰<strong>é“¾é…¶äº²å’Œç´ </strong></font>ã€‚åˆ©ç”¨ç”Ÿç‰©ç´ å’Œé“¾é…¶äº²å’Œç´ çš„äº²å’ŒåŠ›ï¼ŒåŒ…å«èšåˆé…¶çš„<strong>æµ‹åºå¤åˆç‰©ä¼šè¢«<font color="green">å›ºå®š</font>åœ¨ç»ç’ƒåº•æ¿ã€‚</strong></p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/9.png" alt="img"></p>
<h2 id="4-æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP"><a href="#4-æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP" class="headerlink" title="4. æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP"></a>4. <strong>æ„å»ºå¸¦æœ‰è§å…‰åŸºå›¢çš„dNTP</strong></h2><p>åœ¨èŠ¯ç‰‡æº¶æ¶²ä¸­å«æœ‰è®¸å¤šæ¸¸ç¦»dNTPï¼Œæ‰€è°“æ¸¸ç¦»dNTPå°±æ˜¯éšæœºé£˜åœ¨æº¶æ¶²ä¸­çš„dNTPã€‚</p>
<p>ATGCå››ç§ç¢±åŸºçš„dNTPï¼Œåœ¨ç£·é…¸åŸºå›¢ä¸Šåˆ†åˆ«å¸¦æœ‰<font color="green">å››ç§é¢œè‰²çš„è§å…‰åŸºå›¢</font>ã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/10.png" alt="img"></p>
<h2 id="5-è¾¹åˆæˆè¾¹æµ‹åº"><a href="#5-è¾¹åˆæˆè¾¹æµ‹åº" class="headerlink" title="5. è¾¹åˆæˆè¾¹æµ‹åº"></a>5. <strong>è¾¹åˆæˆè¾¹æµ‹åº</strong></h2><p>åœ¨åˆæˆæ—¶ï¼Œæ¸¸ç¦»çš„dNTPè¢«å›ºå®šåœ¨åº•æ¿ä¸Šçš„é…¶æ•è·ï¼Œ<font color="green">æ¿€å‘å…‰ä¼šä»ç»ç’ƒæ¿åº•éƒ¨å‘å‡º</font>ã€‚</p>
<p><video src="2022-02-20-SMRT-sequencing/11.mp4"></video><br><strong>æ€ä¹ˆä¿è¯æ¯æ¬¡æµ‹å–ä¸€ä¸ªç¢±åŸºï¼Ÿ</strong></p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/12.png" alt="img"></p>
<p>ç”±äºæµ‹åºå°å­”ç›´å¾„å¾ˆå°ï¼Œæ¿€å‘å…‰çš„ç©¿é€èƒ½åŠ›ä¼šé€æ¸è¡°å‡ï¼Œåªèƒ½åœ¨å°å­”ä¸­ä¼ è¾“å¾ˆçŸ­çš„è·ç¦»ï¼Œæ‰€ä»¥<font color="green">åªæœ‰å½“dNTPè¶³å¤Ÿé è¿‘åº•éƒ¨ï¼Œè§å…‰åŸºå›¢æ‰ä¼šè¢«æ¿€å‘å…‰ç…§åˆ°ï¼Œå‘å‡ºè§å…‰</font>ã€‚å…¶ä»–æ¸¸ç¦»dNTPè™½ç„¶ä¹Ÿæœ‰å¯èƒ½é£˜åˆ°å°å­”åº•éƒ¨è¢«æ¿€å‘å…‰ç…§åˆ°ï¼Œä½†è¿™ç§æƒ…å†µæå°‘ã€‚<br>åœ¨ä¸€ä¸ªç¢±åŸºåˆæˆç»“æŸåï¼Œå¸¦æœ‰è§å…‰åŸºå›¢çš„ç£·é…¸åŸºå›¢ä¼šä»dNTPä¸Šæ‰è½ï¼Œå‘ç”ŸçŒç­ï¼Œä¸å½±å“å…¶ä»–ç¢±åŸºçš„ä¿¡å·æ£€æµ‹ã€‚ åœ¨å‘ç”Ÿæµ‹åºçš„å°å­”æœ‰å„è‡ªçš„DNAç‰‡æ®µå’Œæµ‹åºå¤åˆç‰©ï¼ŒåŒä¸€æ—¶é—´å‘å‡ºä¸åŒé¢œè‰²çš„æ¿€å‘å…‰ï¼Œæœºå™¨ä¼šæ£€æµ‹åˆ°å¦‚ä¸‹çš„å…‰ä¿¡å·ï¼Œå®é™…åŒæ—¶ä¼šå¾—åˆ°å¤šè¾¾å‡ ä¸‡ä¸ªå…‰ç‚¹ã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/13.png" alt="img"></p>
<p>é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç»è¿‡è®¡ç®—æœºåˆ†æå…‰è°±ï¼Œæœ€ç»ˆæˆ‘ä»¬æ‹¿åˆ°æ ·æœ¬çš„æµ‹åºæ–‡ä»¶ã€‚SMRT Sequencing æµ‹åºè¿‡ç¨‹ä¸­ï¼Œ<font color="green">æ¯ç§’è¯»å–ä¸‰ä¸ªç¢±åŸº</font>ï¼Œä¸€ä¸ªå°æ—¶å¯æ£€æµ‹å¤§çº¦ä¸€ä¸‡å¤šç¢±åŸºã€‚</p>
<h2 id="6-æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–"><a href="#6-æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–" class="headerlink" title="6. æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–"></a>6. <strong>æ£€æµ‹ç¢±åŸºç”²åŸºåŒ–</strong></h2><p>åœ¨SMRT Sequencingæµ‹åºè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥<font color="green">ç›´æ¥æµ‹åˆ°ç¢±åŸºè¢«ä¿®é¥°çŠ¶æ€</font>ï¼Œèšåˆé…¶é‡åˆ°ç¢±åŸºä¸Šå¸¦æœ‰ç”²åŸºåŒ–çš„ç¢±åŸºï¼Œ<font color="green">åˆæˆé€Ÿåº¦æ˜æ˜¾å˜æ…¢</font>ï¼Œè€Œä¸”<font color="green">å…‰è°±ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜</font>ã€‚SMRT Sequencing å¯ä»¥æ£€æµ‹åˆ°ç¢±åŸºçš„ç”²åŸºåŒ–ä¿®é¥°ã€‚</p>
<h1 id="æµ‹åºæ¨¡å‹"><a href="#æµ‹åºæ¨¡å‹" class="headerlink" title="æµ‹åºæ¨¡å‹"></a>æµ‹åºæ¨¡å‹</h1><h2 id="1-Circular-Consensus-Sequencing-CCS-â€“-HiFi"><a href="#1-Circular-Consensus-Sequencing-CCS-â€“-HiFi" class="headerlink" title="1. Circular Consensus Sequencing (CCS) â€“ HiFi"></a>1. Circular Consensus Sequencing (CCS) â€“ HiFi</h2><p>è¯´è¿™ç§æµ‹åºæ¨¡å‹å‰ï¼Œå°±ä¸å¾—ä¸æä¸‰ä»£æµ‹åºæœ€å¤§çš„ç¼ºç‚¹ï¼š<font color="green">ç¢±åŸºè¯»å–ä¸å‡†ï¼Œé”™è¯¯ç‡åœ¨12.5%</font>ã€‚æ¯å…«ä¸ªç¢±åŸºè¯»é”™ä¸€ä¸ªã€‚</p>
<p>ç¢±åŸºè¯»å–<font color="green">é”™è¯¯éšæœº</font>ï¼Œé‡è¯»ä¸€éåŒæ ·ä½ç½®çš„ç¢±åŸºï¼Œä¸ä¸€å®šå‘ç”Ÿç›¸åŒé”™è¯¯ã€‚</p>
<p>å¯¹åŒä¸€ä¸ªåºåˆ—ï¼Œå¤šæµ‹å‡ éï¼Œ<font color="red">çŸ«æ­£</font>è¯»é”™ç¢±åŸºã€‚</p>
<p>æ»šç¯å¤åˆ¶çš„ä¼˜åŠ¿: åˆ©ç”¨æµ‹åºå¤åˆç‰©åœ¨<font color="red">ç¯çŠ¶æ–‡åº“åˆ†å­å¾ªç¯æµ‹åº</font><strong>åŒä¸€ä¸ªç‰‡æ®µ</strong>æ¥<font color="green">æ¶ˆé™¤é”™è¯¯ç‡</font>ã€‚</p>
<p>HiFi readsï¼ˆHigh Fidelity readsï¼‰æ˜¯2019å¹´ç”±PacBioæ¨å‡ºçš„åŸºäº<font color="red">ç¯åŒ–å…±æœ‰åºåˆ—ï¼ˆCircular Consensus Sequencingï¼ŒCCSï¼‰</font>æ¨¡å¼äº§ç”Ÿçš„æ—¢å…¼é¡¾é•¿è¯»é•¿ï¼ˆ<font color="red">10-20kb</font>é•¿åº¦ï¼‰åˆå…·æœ‰é«˜ç²¾åº¦ï¼ˆ&gt;99%å‡†ç¡®ç‡ï¼‰çš„æµ‹åºç»“æœã€‚</p>
<p>è¶…é•¿é…¶è¯»é•¿ä¸­ï¼Œå»æ‰æ¥å¤´åºåˆ—ï¼Œå³å¯è·å¾—å¤šæ¡subreadsã€‚å¤šæ¡subreadsåˆå¹¶ç”Ÿæˆé«˜åº¦ä¸€è‡´æ€§çš„hifi readsã€‚</p>
<p><video src="2022-02-20-SMRT-sequencing/14.mp4"></video><br>è¿™ç§æµ‹åºæ¨¡å‹ï¼Œå¤åˆ¶å‡ºçš„ Readså« <font color="red">HiFi Reads [High fidelity reads]</font>ï¼Œæµ‹åºå‡†ç¡®ç‡ &gt; 99%ã€‚</p>
<p>HiFi reads are a <strong>type of data produced using the circular consensus sequencing (CCS) mode on one of the PacBio Sequel Systems</strong>.</p>
<p>HiFi readsï¼ˆHigh fidelity readsï¼‰æ˜¯ <font color="red">Sequel II</font>ä¸‰ä»£æµ‹åºå¹³å°æ¨å‡ºçš„å…¼é¡¾é•¿è¯»é•¿å’Œé«˜å‡†ç¡®åº¦çš„æµ‹åºåºåˆ—ï¼Œä¸€èˆ¬é‡‡ç”¨CCSï¼ˆCircular Consensus Sequencingï¼‰æ¨¡å¼æµ‹åºã€‚</p>
<p>åœ¨å•æ¬¡æµ‹åºä¸­å¾—åˆ°æ›´å¤šçš„HiFi readså¾€å¾€éœ€è¦<strong>å¹³è¡¡</strong>æµ‹åºçš„ <font color="red">é…¶è¯»é•¿</font>å’Œ <font color="red">æ’å…¥ç‰‡æ®µçš„é•¿åº¦</font>ï¼Œæ’å…¥ç‰‡æ®µå¤ªé•¿ä¼šå¯¼è‡´é…¶æ— æ³•è¿›è¡Œæ»šç¯æµ‹åºï¼Œæ’å…¥ç‰‡æ®µå¤ªçŸ­åˆç‰ºç‰²äº†ä¸‰ä»£é•¿è¯»é•¿æµ‹åºçš„ä¼˜åŠ¿ã€‚</p>
<p>æ ¹æ®å‰æœŸçš„å®˜æ–¹ç»éªŒæ¨èï¼Œç›®å‰HiFiæ–‡åº“æ„å»ºçš„<font color="red">æ’å…¥ç‰‡æ®µä¸€èˆ¬ä¸º8-13 kb</font>å·¦å³ã€‚å®‰è¯ºä¼˜è¾¾æ„å»ºçº¦10 kbçš„HiFiæ–‡åº“åœ¨<font color="red">Sequel II</font>å¹³å°è¿›è¡Œæµ‹åºã€‚åŸå§‹ä¸‹æœºæ•°æ®å•celläº§å‡º268 Gbæ•°æ®ï¼Œå…¶ä¸­<font color="red">é…¶å¹³å‡è¯»é•¿51 kb</font>ï¼Œ<font color="red">é…¶è¯»é•¿N50 124 kb</font>ï¼Œ<font color="red">subreadså¹³å‡è¯»é•¿11 kb</font>ï¼Œ<font color="red">subreads N50 13 kb</font>ã€‚</p>
<ul>
<li>ä¸‹æœºæ•°æ®äº§å‡ºç»Ÿè®¡è¡¨</li>
</ul>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/15.png" alt="1562200674629303.png"></p>
<p>è¿›ä¸€æ­¥åˆ©ç”¨å®˜æ–¹è½¯ä»¶è°ƒå–CCSï¼Œè®¾ç½®æœ€å°passæ•°ä¸º3ï¼Œç»è¿‡è°ƒå–è·å¾—CCSæ€»æ•°æ®é‡ä¸º<strong>22.43 Gb</strong>ï¼ŒCCS åºåˆ—æ•°ç›®ä¸º<strong>172.5ä¸‡</strong>æ¡<strong>ï¼Œå¹³å‡é•¿åº¦</strong>13 kb<strong>ã€‚ä¸ä¸‹æœºæ€»æ•°æ®é‡ç›¸æ¯”ï¼Œ</strong>ç›®å‰CCS readsçš„å¾—ç‡çº¦ä¸º8%ï¼Œå¹¶ä¸”èƒ½å¤Ÿå…¼é¡¾readsçš„è¯»é•¿ï¼Œè¾¾åˆ°å¹³å‡13 kbå·¦å³ï¼Œæ•°æ®è´¨é‡ç›¸å½“ä¸é”™??</p>
<ul>
<li>CCSæ•°æ®äº§å‡ºç»Ÿè®¡è¡¨</li>
</ul>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/16.png" alt="1562200759526715.png"></p>
<p>å¯¹æ‹¿åˆ°çš„HiFi readsè¿›è¡Œè¿›ä¸€æ­¥çš„<font color="red">è´¨é‡è¯„ä¼°</font>ï¼Œæˆ‘ä»¬å‘ç°å¤§éƒ¨åˆ†HiFi readsçš„<font color="red">å‡†ç¡®åº¦?</font>éƒ½åœ¨0.95ä»¥ä¸Šï¼Œå…¶ä¸­çº¦35%çš„readsï¼ˆpassâ‰¥10ï¼‰è´¨é‡å€¼è¾¾åˆ°QV30ï¼ˆ99.9%ï¼‰ï¼Œè¿™æ ·é«˜è´¨é‡çš„readséå¸¸æœ‰åŠ©äºç ”ç©¶è€…å¼€å±•ä¸‹æ¸¸æ·±å…¥çš„ç ”ç©¶ã€‚</p>
<ul>
<li>CCSè´¨é‡åˆ†å¸ƒå›¾</li>
</ul>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/17.png" alt="1562200823347872.png"></p>
<p>åŒæ—¶å…¼é¡¾é•¿è¯»é•¿å’Œé«˜å‡†ç¡®åº¦çš„HiFi readsç©¶ç«Ÿæœ‰ä½•ç”¨å¤„å‘¢ï¼Ÿ2019å¹´<em>BioRxiv</em>é¢˜ä¸ºâ€œ<strong>Highly-accurate long-read sequencing improves variant detection and assembly of a human genome</strong>â€çš„æ–‡ç« ã€‚åœ¨è¿™ç¯‡æ–‡ç« é‡Œç ”ç©¶è€…åˆ©ç”¨çº¦30Xçš„CCS readsç»„è£…äººåŸºå› ç»„ï¼Œé€šè¿‡<font color="green">FALCONã€Canu3å’Œ wtdbg2</font>ç­‰ä¸åŒè½¯ä»¶è¿›è¡Œç»„è£…ï¼Œ<font color="red">contig N50è¾¾åˆ°15.43-28.95 Mb</font>ã€‚ä»ç»„è£…è¿ç»­æ€§æ¥çœ‹ï¼Œ<strong>CCS readsèƒ½å¤Ÿåšåˆ°ä¸<font color="red">ä¼ ç»Ÿçš„CLR reads</font>ç»„è£…ç›¸å½“çš„ç»“æœï¼Œé‡è¦çš„æ˜¯åŸºå› ç»„ç¢±åŸºå‡†ç¡®åº¦å¾—åˆ°äº†æ˜æ˜¾æå‡ï¼ŒåŸºå› ç»„ç»„è£…æ¶ˆè€—çš„è®¡ç®—èµ„æºå’Œæ—¶é—´å¤§å¹…ä¸‹é™</strong>ã€‚è¿›ä¸€æ­¥åˆ©ç”¨CCS readsè¿›è¡Œ<font color="red">SNPã€InDelç­‰å˜å¼‚æ£€æµ‹</font>ï¼Œå‘ç°CCS readsåœ¨å°çš„å˜å¼‚æ£€å‡ºç‡å’Œå‡†ç¡®åº¦ä¸Šéƒ½æœ‰æ˜¾è‘—æå‡ï¼Œæ•°æ®ç»“æœä¸30Xçš„Illuminaæ•°æ®åˆ†æç»“æœåŸºæœ¬æ¥è¿‘ã€‚</p>
<ul>
<li>æ–‡ç« ä¸­CCS readsè¿›è¡ŒSNVå’ŒInDel callingç»Ÿè®¡è¡¨</li>
</ul>
<p><img src="/blog/./18.png" alt="1562200919110586.png"></p>
<p>ç»¼ä¸Šï¼ŒHiFi readsæ— è®ºåœ¨<font color="red">åŸºå› ç»„å…¨å˜å¼‚æ£€æµ‹ï¼ˆSNVã€InDelã€SVï¼‰</font>è¿˜æ˜¯<font color="red">åŸºå› ç»„<em>de novo</em></font>é¢†åŸŸéƒ½é€‚ç”¨ã€‚ç›®å‰<font color="red">å”¯ä¸€çš„é™åˆ¶å› ç´ </font>æ˜¯è¦è·å¾—è¶³å¤Ÿçš„HiFi readsï¼Œæµ‹åºæˆæœ¬æŠ•å…¥æ¯”è¾ƒ<font color="red">æ˜‚è´µ</font>ï¼Œä»ç»„è£…<strong>è®¡ç®—èµ„æºèŠ‚çœ</strong>å’Œ<strong>é¡¹ç›®æ—¶é—´ç¼©çŸ­</strong>çš„è§’åº¦çœ‹ï¼ŒHiFi readsæœªå°ä¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚<strong>å¯¹äºåŸºå› ç»„<font color="red">é‡å¤åºåˆ—è¾ƒå¤šçš„å¤æ‚åŸºå› ç»„</font>ï¼Œç›®å‰å¸‚åœºä¸Š<font color="red">ä¼ ç»Ÿé•¿è¯»é•¿æµ‹åºå‡†ç¡®åº¦ä¸é«˜</font>çš„ç‰¹ç‚¹ç»™ç»„è£…é€ æˆäº†ä¸€å®šçš„å›°éš¾ï¼Œé«˜å‡†ç¡®åº¦çš„HiFi readsæœªæ¥å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</strong>è€Œå¯¹äºæ˜†è™«ã€ä¸­è‰è¯ã€è—»ç±»ç­‰é‡å¤åºåˆ—è¾ƒé«˜ã€åŸºå› ç»„è¾ƒå°çš„ç‰©ç§ï¼ˆï¼œ700 Mbï¼‰ï¼Œç›®å‰åˆ©ç”¨ä¸€ä¸ª8 M SMRT Cell äº§å‡ºçš„æ•°æ®é‡åŸºæœ¬è¶³ä»¥æ”¯æŒCCSç»„è£…ï¼Œæ€§ä»·æ¯”æ›´é«˜ã€‚éœ€è¦å®Œå–„çš„HiFiæ–‡åº“å»ºåº“æµç¨‹å’ŒåŸºäºCCS readsç»„è£…çš„ç”Ÿä¿¡æµç¨‹ï¼</p>
<h2 id="2-Continuous-Long-Read-CLR-Sequencing"><a href="#2-Continuous-Long-Read-CLR-Sequencing" class="headerlink" title="2. Continuous Long Read (CLR) Sequencing"></a>2. Continuous Long Read (CLR) Sequencing</h2><p>è¿™ç§æµ‹åºçš„ä¼˜åŠ¿åœ¨äºå¯ä»¥è¯»å–æ›´é•¿çš„ Readsã€‚<font color="red">ï¼Ÿä¸ºä»€ä¹ˆæ›´é•¿</font></p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/19.gif" alt="img"></p>
<h1 id="å…¶ä»–å½±å“å› ç´ "><a href="#å…¶ä»–å½±å“å› ç´ " class="headerlink" title="å…¶ä»–å½±å“å› ç´ "></a>å…¶ä»–å½±å“å› ç´ </h1><h2 id="1-GC-bias-å½±å“"><a href="#1-GC-bias-å½±å“" class="headerlink" title="1. GC bias å½±å“"></a>1. <font color="red">GC bias å½±å“</font></h2><blockquote>
<p>ä»€ä¹ˆæ˜¯ GC biasï¼Ÿ<br>PCR æ—¶ï¼Œå¦‚æœæ¨¡æ¿é‡Œçš„<font color="red">Gã€Cç¢±åŸºå«é‡é«˜ï¼ŒPCRæ•ˆç‡ä½</font>ï¼ŒAã€Tç¢±åŸºå«é‡é«˜ï¼ŒPCRæ•ˆç‡é«˜ã€‚ä¸€èˆ¬æµ‹åºè¿‡ç¨‹ï¼Œå¦‚äºŒä»£æµ‹åºï¼Œéƒ½ä¼šæœ‰å¤§é‡çš„PCRè¿‡ç¨‹ã€‚è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œ<font color="red">Gã€Cå«é‡é«˜çš„ç‰‡æ®µï¼Œè¯»åˆ°çš„ Reads æ•°å°‘</font>ã€‚</p>
</blockquote>
<p>SMRT æ²¡æœ‰ PCR ï¼Œå› æ­¤GCå«é‡é«˜ä½çš„ Reads ç‰‡æ®µéƒ½ä¼šæœ‰ç›¸ä¼¼çš„æ¦‚ç‡è¢«æµ‹åºï¼Œ GC Bias å½±å“å°ã€‚</p>
<h2 id="2-è¯»é•¿çš„é™åˆ¶å› ç´ "><a href="#2-è¯»é•¿çš„é™åˆ¶å› ç´ " class="headerlink" title="2. è¯»é•¿çš„é™åˆ¶å› ç´ "></a>2. è¯»é•¿çš„é™åˆ¶å› ç´ </h2><ul>
<li><strong>DNAæ¨¡æ¿æ–­è£‚</strong>ï¼Œç”¨æ¿€å‘å…‰é•¿æ—¶é—´ç…§å°„DNAé“¾æ—¶ï¼Œä¼šå‘ç”Ÿæ–­è£‚ï¼ŒDNAé“¾ä¼šä»é…¶ä¸Šæ‰ä¸‹æ¥ï¼Œæµ‹åºç»ˆæ­¢ã€‚</li>
<li><strong>é…¶å˜æ€§</strong>ï¼Œé…¶è¢«é•¿æ—¶é—´ç…§å°„æ—¶ï¼Œé…¶ä¼šå˜æ€§ï¼Œå¤±å»èšåˆé…¶æ´»æ€§ï¼Œæµ‹åºç»ˆæ­¢ã€‚</li>
<li><strong>æ–‡åº“åºåˆ—çŸ­</strong>ï¼Œå¦‚æœåšæ–‡åº“åºåˆ—ç‰‡æ®µå¤§äº 20~30 K ï¼Œä¸”ä¿è¯è´¨é‡çš„æ–‡åº“æ˜¯æœ‰æŠ€æœ¯éš¾åº¦çš„</li>
</ul>
<h2 id="3-æµ‹åºé€šé‡"><a href="#3-æµ‹åºé€šé‡" class="headerlink" title="3. æµ‹åºé€šé‡"></a>3. æµ‹åºé€šé‡</h2><p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/20.png" alt="img"></p>
<p>ç›®å‰ï¼Œä¸»æµçš„æµ‹åºå¹³å°æœ‰ä¸‰ç§ï¼Œå„æœ‰åˆ©å¼Šï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„è¯¾é¢˜æ¥é€‰æ‹©ã€‚</p>
<p>ä»¥RSIIä¸ºä¾‹ï¼Œå°†æµ‹åºå¤åˆç‰©ï¼Œéšæœºæ’’åˆ°15ä¸‡ä¸ªå°å­”ä¸­ï¼Œæ­£å¥½æœ‰ä¸€ä¸ª<font color="red">å¤åˆç‰©è¿›å…¥åˆ°å•ä¸ªå°å­”çš„æ¦‚ç‡ç¬¦åˆæ³Šæ¾åˆ†å¸ƒ</font>ã€‚ç†è®ºæƒ…å†µæ˜¯</p>
<ul>
<li>1/3 çš„å°å­”ä¸­æœ‰<font color="red">ä¸€ä¸ª</font>æµ‹åºå¤åˆç‰©ï¼Œæ­£å¸¸ä¿¡å·</li>
<li>1/3 çš„å°å­”ä»€ä¹ˆéƒ½<font color="red">æ²¡æœ‰</font>ï¼Œæ— ä¿¡å·</li>
<li>1/3 çš„å°å­”ä¸­æœ‰<font color="red">ä¸¤ä¸ªä»¥ä¸Šçš„æµ‹åºå¤åˆç‰©</font>ï¼Œæ‚ä¹±ä¿¡å·</li>
</ul>
<p>äº”ä¸‡ä¸ªå°å­” * 10kbï¼Œæ‰€ä»¥ä¸€å¼ èŠ¯ç‰‡å¤§çº¦ä¼šäº§å‡º500Mçš„æ•°æ®ã€‚</p>
<hr>
<h1 id="ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel-å¹³å°ä¸ºä¸»ï¼‰"><a href="#ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel-å¹³å°ä¸ºä¸»ï¼‰" class="headerlink" title="ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel å¹³å°ä¸ºä¸»ï¼‰"></a>ä¸‰ä»£ä¸‹æœºæ•°æ®ï¼ˆä»¥sequel å¹³å°ä¸ºä¸»ï¼‰</h1><h2 id="æµ‹åºè¿‡ç¨‹"><a href="#æµ‹åºè¿‡ç¨‹" class="headerlink" title="æµ‹åºè¿‡ç¨‹"></a>æµ‹åºè¿‡ç¨‹</h2><ul>
<li><font color="green">A adapter</font>é€šç”¨æ¥å¤´ï¼Œä¸¤ç«¯çš„æ¥å¤´å¯ä»¥ä¸€æ ·ä¹Ÿå¯ä»¥ä¸ä¸€æ ·</li>
<li><font color="green">B barcode</font>(å®¢æˆ·è‡ªå·±è®¾è®¡)</li>
<li><font color="green">I insert </font>æ’å…¥ç‰‡æ®µï¼Œå³æˆ‘ä»¬æµ‹åºçš„ç›®çš„ç‰‡æ®µ</li>
<li>ç”±äºSMRTbellæ˜¯ç¯çŠ¶çš„ï¼Œæµ‹åºè¿‡ç¨‹æ˜¯è¾¹åˆæˆè¾¹æµ‹åºï¼Œå› æ­¤å¯ä»¥æ²¿ç€æ–°é“¾åˆæˆçš„æ–¹å‘ä¸åœåœ°è¯»å–åºåˆ—ï¼Œè¯»å–ä¸€åœˆåˆä¸€åœˆ</li>
</ul>
<h2 id="æµ‹åºç»“æœ"><a href="#æµ‹åºç»“æœ" class="headerlink" title="æµ‹åºç»“æœ"></a>æµ‹åºç»“æœ</h2><ul>
<li>æ ¹æ®SMRTbellçš„å½¢çŠ¶ä»¥åŠæµ‹åºçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å®¹æ˜“çŸ¥é“ï¼Œæµ‹åºå‡ºæ¥çš„readså¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç”±æ¥å¤´åºåˆ—, æ¡ç åºåˆ—, æ’å…¥åºåˆ—é—´éš”çº¿æ€§åˆ†å¸ƒï¼Œå³ABIB-ABIBâ€”ABIB-ABIBâ€”â€¦ï¼ˆA: adapter, B: barcode, I: insertï¼‰</li>
<li> <font color="green">ZMW read</font> æ˜¯æµ‹åºå‡ºæ¥çš„å®Œæ•´ç»“æœï¼Œä¹Ÿå³æ˜¯<font color="green">polymerase read</font>ï¼Œèšåˆé…¶åˆæˆè¿‡çš„æ‰€æœ‰çš„åºåˆ—ã€‚</li>
<li> PostPrimary åˆ†æåè¾“å‡º<font color="green">HQ region</font>ï¼Œç”±ZMW read <font color="green">å»é™¤ä¸¤ç«¯ä½è´¨é‡</font>åŒºåŸŸå¾—åˆ°ã€‚</li>
</ul>
<h2 id="æµ‹åºæ–‡ä»¶"><a href="#æµ‹åºæ–‡ä»¶" class="headerlink" title="æµ‹åºæ–‡ä»¶"></a>æµ‹åºæ–‡ä»¶</h2><ul>
<li><p>RS IIï¼š<a href="https://www.itdaan.com/blog/2017/05/26/6e59c682169d236cb41a2b6ba146125e.html">https://www.itdaan.com/blog/2017/05/26/6e59c682169d236cb41a2b6ba146125e.html</a></p>
</li>
<li><p>Sequel</p>
<ul>
<li>åœ¨ä¸‹æœºæ–‡ä»¶ä¸­ï¼Œä¸»è¦æœ‰ä¸‰ç±»æ–‡ä»¶ï¼Œ<font color="red">bam æ–‡ä»¶</font>ï¼Œ<font color="red">bam.pbi æ–‡ä»¶</font>ï¼Œä»¥åŠ<font color="red">xmlæ–‡ä»¶</font>ã€‚</li>
<li>æ— fastqæ–‡ä»¶ï¼Œsequelå¹³å°ä¸­bam æ–‡ä»¶æˆä¸ºäº†fqçš„æ›¿ä»£è€…ï¼Œæ›´èŠ‚çº¦å‚¨å­˜ç©ºé—´ã€‚è¿™æ˜¯æ–‡ä»¶æ ¼å¼çš„ä¸€ä¸ªé‡å¤§æ›´æ–°ã€‚</li>
<li> ç”¨äºåç»­åˆ†æçš„æ–‡ä»¶ä¸€èˆ¬æ˜¯<font color="red">.subreads.bam</font>ï¼Œè¿™ç­‰åŒäº<font color="red">RS II </font>ä¸­çš„<font color="red">.subreads.fastq</font></li>
<li>ä¸‹é¢ä»‹ç»ä¸‰ç±»ä¸»è¦æ–‡ä»¶çš„å…·ä½“æ ¼å¼</li>
</ul>
</li>
</ul>
<h3 id="BAM"><a href="#BAM" class="headerlink" title="BAM"></a>BAM</h3><ul>
<li><p><font color="green">æ™®é€šbam</font>æ–‡ä»¶å¤§å¤šæ˜¯<font color="green">æ¯”å¯¹ç»“æœæ–‡ä»¶</font>ï¼Œä¾‹å¦‚ç”¨é‡æµ‹åºåˆ†æä¸­BWAç”Ÿæˆçš„bamæ–‡ä»¶å°±æ˜¯readsä¸åŸºå› ç»„çš„æ¯”å¯¹æ–‡ä»¶ã€‚ä½†<font color="red">pacbioçš„ä¸‹æœºæ–‡ä»¶æ˜¯æ²¡æœ‰ä¸åŸºå› ç»„è¿›è¡Œè¿‡æ¯”å¯¹è¿‡</font>çš„ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯<font color="red">å‚¨å­˜åºåˆ—</font>ã€‚</p>
</li>
<li><p>Bamæ–‡ä»¶ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¤´ä¸€éƒ¨åˆ†æ˜¯<font color="red">Header</font>ï¼Œå‚¨å­˜æµ‹åºçš„ç›¸å…³ä¿¡æ¯ï¼Œå¦ä¸€éƒ¨åˆ†ä¹Ÿå³æ˜¯æ–‡ä»¶çš„ä¸»è¦éƒ¨åˆ†æ˜¯recordsï¼Œä¿å­˜<font color="red">åºåˆ—ä¿¡æ¯</font>ã€‚å°±ä»¥subreads.bamæ–‡ä»¶ä¸ºä¾‹ï¼Œåˆ†æä¸‹bamæ–‡ä»¶çš„å…·ä½“æ ¼å¼ã€‚</p>
</li>
<li><p>å¯ä»¥ç”¨samtools view å‘½ä»¤æŸ¥çœ‹bamæ–‡ä»¶</p>
<blockquote>
<p>ç¬¬ä¸€åˆ—ï¼šreadsä¿¡æ¯</p>
<p>{movieName}/{holeNumber}/{qStart}_{qEnd}<br>[å¯¹äºCCSï¼š{movieName}/{holeNumber}/ccs]<br>MovieName æ˜¯cellçš„åå­—ï¼ŒholeNumeræ˜¯ZMWå­”çš„ç¼–å·ï¼ŒqStartå’ŒqEndæ˜¯subreadsç›¸å¯¹äºZMW readsçš„ä½ç½®ã€‚<br>ç¬¬äºŒåˆ— (sum of flags)ï¼šæ¯”å¯¹ä¿¡æ¯ å‡ä¸º4 ä»£è¡¨æ²¡æœ‰æ¯”å¯¹ä¸Šï¼Œä¹Ÿè¡¨æ˜äº†bamæ–‡ä»¶åªå‚¨å­˜äº†åºåˆ—ä¿¡æ¯ï¼Œè€Œæ²¡æœ‰æ¯”å¯¹ä¿¡æ¯ã€‚<br>ç¬¬ä¸‰åˆ— (RNAM)ï¼šå‚è€ƒåºåˆ— å€¼ä¸º ï¼Œä»£è¡¨æ— å‚è€ƒåºåˆ—<br>ç¬¬å››åˆ— (position) : æ¯”å¯¹ä¸Šçš„ç¬¬ä¸€ä¸ªç¢±åŸºä½ç½® 0<br>ç¬¬äº”åˆ— (Mapping quality) : æ¯”å¯¹è´¨é‡åˆ†æ•° 255<br>ç¬¬å…­åˆ— (CIGARå€¼) : æ¯”å¯¹çš„å…·ä½“æƒ…å†µ<br>ç¬¬ä¸ƒåˆ— (MRNM, ) : mate å¯¹åº”çš„æŸ“è‰²ä½“<br>ç¬¬å…«åˆ— (mate position) : mateå¯¹åº”çš„ä½ç½® 0<br>ç¬¬ä¹åˆ— (ISIZE, Inferred fragment size) : æ¨æ–­çš„æ’å…¥ç‰‡æ®µå¤§å° 0</p>
<p>ç¬¬ååˆ— (Sequence) : åºåˆ—ä¿¡æ¯ å…·ä½“çš„ATCG<br>ç¬¬åä¸€åˆ— (ASCIIç ) : ç¢±åŸºè´¨é‡åˆ†æ•° ASCII+33<br>ç¬¬åäºŒåˆ—: å¯é€‰åŒºåŸŸ è®°å½•Reads çš„æ€»ä½“å±æ€§åŒ…æ‹¬ä¿¡å·é•¿åº¦ï¼Œä¿¡å·å¼ºåº¦ç­‰ä¿¡æ¯ã€‚</p>
</blockquote>
</li>
</ul>
<ol>
<li>zmws.bam ä»¥åŠccs.bamä¼¼ä¹å…¬å¸å¹¶ä¸ä¸€å®šä¼šæä¾›</li>
<li>ç»è¿‡æ£€æŸ¥ï¼Œä¸€æ¡zmw reads å¯ä»¥äº§ç”Ÿå¤šæ¡ subreadsï¼Œä¹Ÿå°±æ˜¯è¯´subreads.bam ä¸­ï¼Œåºåˆ—åªæ˜¯è¢«å‰ªä¸‹æ¥äº†ã€‚</li>
<li>scraps.bam æ ¼å¼ä¿å­˜çš„æ˜¯è·å–subreadsæ—¶åºŸå¼ƒçš„åºåˆ—ï¼ŒåŒ…æ‹¬adapterï¼Œä»¥åŠä¸€äº›ä½è´¨é‡çš„åºåˆ—</li>
<li><strong>CCS.bamä¿å­˜çš„æ˜¯çŸ«æ­£åçš„ä¸€è‡´æ€§åºåˆ—</strong>ã€‚</li>
</ol>
<h3 id="BAM-pbi"><a href="#BAM-pbi" class="headerlink" title="BAM.pbi"></a>BAM.pbi</h3><ul>
<li><p>æ˜¯bamæ–‡ä»¶çš„<font color="red">ç´¢å¼•æ–‡ä»¶</font>(PacBio BAM index)ï¼Œä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ˆ<font color="red">RS II</font>ï¼‰çš„<font color="red">*cmp.h5</font>æ–‡ä»¶<font color="red">å…¼å®¹</font>ï¼Œå…¶æ ¼å¼ç±»ä¼¼äº<font color="red">HDF5</font>ï¼Œ é€šè¿‡<font color="red"><strong>BGZFæ ¼å¼å‹ç¼©</strong></font>ã€‚</p>
</li>
<li><p> å…¶å­˜åœ¨ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨</p>
</li>
<li><h5 id="éšæœºè®¿é—®"><a href="#éšæœºè®¿é—®" class="headerlink" title="éšæœºè®¿é—®"></a><font color="red">éšæœº</font>è®¿é—®</h5><p>é€šè¿‡å‚è€ƒåºåˆ—ï¼ŒåŸºå› ç»„åŒºåŸŸï¼›é€šè¿‡read ç»„åˆ«ï¼›é€šè¿‡qurey nameï¼›é€šè¿‡ZMWï¼›é€šè¿‡barcodeï¼›å…¶ä»–</p>
</li>
<li><h5 id="åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯"><a href="#åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯" class="headerlink" title="åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯"></a>åœ¨æ— éœ€å®Œå…¨è®¿é—®BAMæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œè·å–ä¿¡æ¯</h5></li>
</ul>
<p>   è·å–<font color="red">ç»Ÿè®¡ä¿¡æ¯</font>ï¼›é€šè¿‡æä¾›indexè®¿é—®è®°å½•ä¿¡æ¯</p>
<h3 id="xml"><a href="#xml" class="headerlink" title="xml"></a>xml</h3><ul>
<li>MetaData, å‚¨å­˜æ•°æ®æè¿°ã€‚å¯ç”¨äº<strong>filter</strong> æˆ–è€…<strong>subset</strong>ç­‰åŠŸèƒ½ã€‚</li>
<li> sts.xml å‚¨å­˜æ•°æ®çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</li>
<li> SMRT Link CL tools in 5.0.0 datasetå‘½ä»¤å¯ä»¥è¿›è¡Œæ–¹ä¾¿çš„æ“ä½œã€‚</li>
</ul>
<hr>
<h1 id="Pacbio-Sequel-ä¸‹æœºæ•°æ®å®ä¾‹"><a href="#Pacbio-Sequel-ä¸‹æœºæ•°æ®å®ä¾‹" class="headerlink" title="Pacbio Sequel ä¸‹æœºæ•°æ®å®ä¾‹"></a>Pacbio Sequel ä¸‹æœºæ•°æ®å®ä¾‹</h1><blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;m54134_180724_220656.scraps.bam</span><br><span class="line">&gt;m54134_180724_220656.subreads.bam</span><br><span class="line">&gt;m54134_180724_220656.scraps.bam.pbi</span><br><span class="line">&gt;m54134_180724_220656.subreads.bam.pbi</span><br><span class="line">&gt;m54134_180724_220656.baz2bam_1.log</span><br><span class="line">&gt;m54134_180724_220656.sts.xml</span><br><span class="line">&gt;m54134_180724_220656.subreadset.xml</span><br><span class="line">&gt;m54134_180724_220656.transferdone</span><br><span class="line">&gt;m54134_180724_220656.adapters.fasta</span><br></pre></td></tr></table></figure>
</blockquote>
<p>m54134_180724_220656.subreads.bam</p>
<p><font color="red">m: æ˜¯movie çš„ç¼©å†™</font></p>
<p><font color="red">54134ï¼š æ˜¯è®¾å¤‡çš„ç¼–å·</font></p>
<p><font color="red">180724_220656ï¼š æ˜¯æµ‹åºè¿è¡Œçš„å¼€å§‹æ—¶é—´ï¼Œä¸º2018å¹´07æœˆ24æ—¥22æ—¶06åˆ†56ç§’</font></p>
<p><font color="red">subreads: è¿™éƒ¨åˆ†æ˜¯ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¸€èˆ¬æœ‰scrapsï¼Œ subreadsç­‰</font></p>
<p><font color="red">bam: è¿™æ˜¯æ•°æ®çš„æ ¼å¼ï¼Œä¸€èˆ¬æœ‰bamæ ¼å¼ï¼Œxmlï¼Œfastaæ ¼å¼ç­‰</font></p>
<p>BAMæ–‡ä»¶å®˜ç½‘ï¼š<a href="https://pacbiofileformats.readthedocs.io/en/3.0/BAM.html">https://pacbiofileformats.readthedocs.io/en/3.0/BAM.html</a></p>
<p><a href="https://github.com/PacificBiosciences/PacBioFileFormats/blob/3.0/BAM.rst">https://github.com/PacificBiosciences/PacBioFileFormats/blob/3.0/BAM.rst</a></p>
<h1 id="CLR-HiFi-é€‰æ‹©"><a href="#CLR-HiFi-é€‰æ‹©" class="headerlink" title="CLR HiFi é€‰æ‹©"></a>CLR HiFi é€‰æ‹©</h1><p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/29.png" alt="img"></p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-2-SMRT/30.png" alt="img"></p>
]]></content>
      <categories>
        <category>biology</category>
      </categories>
      <tags>
        <tag>technique</tag>
      </tags>
  </entry>
  <entry>
    <title>HiFi-1-three-generation-sequencing-techniqie</title>
    <url>/blog/2022/02/20/2022-02-20-HiFi-1/</url>
    <content><![CDATA[<h1 id="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚"><a href="#ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚" class="headerlink" title="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚"></a>ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æŒ‡å•åˆ†å­æµ‹åºæŠ€æœ¯ã€‚ä¸éœ€è¦PCRæ‰©å¢ï¼Œå®ç°å¯¹æ¯ä¸€æ¡DNAåˆ†å­å•ç‹¬æµ‹åºã€‚ä¹Ÿå«ä»å¤´æµ‹åºæŠ€æœ¯ï¼Œå³å•åˆ†å­å®æ—¶DNAæµ‹åºã€‚</h1><span id="more"></span>

<h1 id="æŠ€æœ¯åŸç†"><a href="#æŠ€æœ¯åŸç†" class="headerlink" title="æŠ€æœ¯åŸç†"></a>æŠ€æœ¯åŸç†</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><font color="green">å•åˆ†å­è§å…‰æµ‹åº</font>ï¼Œä»£è¡¨æ€§æŠ€æœ¯ä¸º<font color="green">ç¾å›½èºæ—‹ç”Ÿç‰©(Helicos)</font>çš„<font color="green">SMSæŠ€æœ¯</font>å’Œ<font color="green">ç¾å›½å¤ªå¹³æ´‹ç”Ÿç‰©(Pacific Bioscience)</font>çš„<font color="green">SMRTæŠ€æœ¯</font>ã€‚è„±æ°§æ ¸è‹·é…¸è§å…‰æ ‡è®°ï¼Œæ˜¾å¾®é•œå®æ—¶è®°å½•è§å…‰å¼ºåº¦å˜åŒ–ã€‚å½“è§å…‰æ ‡è®°è„±æ°§æ ¸è‹·é…¸è¢«æºå…¥DNAé“¾æ—¶ï¼Œè§å…‰åŒæ—¶åœ¨DNAé“¾ä¸Šæµ‹åˆ°ã€‚å½“å®ƒä¸DNAé“¾å½¢æˆåŒ–å­¦é”®æ—¶ï¼Œè§å…‰åŸºå›¢è¢«DNAèšåˆé…¶åˆ‡é™¤ï¼Œè§å…‰æ¶ˆå¤±ã€‚è§å…‰æ ‡è®°è„±æ°§æ ¸è‹·é…¸ä¸å½±å“DNAèšåˆé…¶æ´»æ€§ï¼Œè§å…‰åŸºå›¢åˆ‡é™¤åï¼Œåˆæˆçš„DNAé“¾å’Œå¤©ç„¶DNAé“¾å®Œå…¨ä¸€æ ·ã€‚</p>
<p>PacBioé‡‡ç”¨<font color="green">è¾¹åˆæˆè¾¹æµ‹åº</font>æ–¹å¼ï¼Œä»¥å…¶ä¸­ä¸€æ¡DNAé“¾ä¸ºæ¨¡æ¿ï¼Œé€šè¿‡DNAèšåˆé…¶åˆæˆå¦å¤–ä¸€æ¡é“¾ï¼Œè¿›ä¸€æ­¥å°†è§å…‰ä¿¡å·è½¬å˜ä¸ºç¢±åŸºä¿¡å·ã€‚åŒæ—¶PacBioå·²å‡çº§<font color="green">CCSæµ‹åºæ¨¡å¼</font>ä»¥è·å¾—<font color="green">é•¿è¯»é•¿é«˜ä¿çœŸï¼ˆHiFiï¼‰15 kb reads</font>ï¼Œç”±æ­¤æå‡åŸºå› ç»„ç»„è£…å‡†ç¡®æ€§ã€‚</p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><font color="green">çº³ç±³å­”æµ‹åº</font>ï¼Œ<font color="green">è‹±å›½ç‰›æ´¥çº³ç±³å­”å…¬å¸</font>ã€‚æ–°å‹çº³ç±³å­”æµ‹åºæ³•ï¼ˆnanopore sequencingï¼‰æ˜¯é‡‡ç”¨ç”µæ³³æŠ€æœ¯ï¼Œå€ŸåŠ©<font color="green">ç”µæ³³é©±åŠ¨å•ä¸ªåˆ†å­é€ä¸€é€šè¿‡çº³ç±³å­”</font>å®ç°æµ‹åºã€‚çº³ç±³å­”ç›´å¾„éå¸¸ç»†å°ï¼Œä»…å…è®¸å•ä¸ªæ ¸é…¸èšåˆç‰©é€šè¿‡ï¼Œè€ŒATCG<font color="green">å•ä¸ªç¢±åŸºå¸¦ç”µæ€§è´¨</font>ä¸ä¸€æ ·ï¼Œé€šè¿‡<font color="green">ç”µä¿¡å·å·®å¼‚</font>æ£€æµ‹å‡ºé€šè¿‡ç¢±åŸºç±»åˆ«ï¼Œå®ç°æµ‹åºã€‚</p>
<p>Nanoporeå½“å•é“¾DNAåˆ†å­ç©¿è¿‡çº³ç±³å­”ï¼Œç›¸å¯¹äºæ¯ä¸ªæ ¸è‹·é…¸ï¼Œè·å¾—ä¸åŒç”µæµä¿¡å·ã€‚è®°å½•æ¯ä¸ªå­”çš„ç¦»å­ç”µæµå˜åŒ–ï¼Œå¹¶åŸºäº<font color="red">é©¬å°”å¯å¤«æ¨¡å‹</font>æˆ–<font color="red">é€’å½’ç¥ç»ç½‘ç»œ</font>çš„æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºç¢±åŸºåºåˆ—ã€‚æ­¤å¤–ï¼Œ<font color="green">Ultra-long reads (ULRs) </font>æ˜¯ONTå¹³å°çš„å¦ä¸€é‡è¦ç‰¹å¾ï¼Œå¹¶å…·æœ‰ä¿ƒè¿›<font color="green">å¤§å‹åŸºå› ç»„ç»„è£…</font>æ½œåŠ›ã€‚</p>
<table>
<thead>
<tr>
<th>De novoç ”ç©¶</th>
<th>ç ”ç©¶å†…å®¹</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>åŸºå› ç»„ç»„è£…</td>
<td>å¤šè½¯ä»¶ç»„è£…ã€ç»„è£…ç»“æœè¯„ä¼°</td>
<td></td>
</tr>
<tr>
<td>åŸºå› é¢„æµ‹ä¸æ³¨é‡Š</td>
<td>ç¼–ç åŸºå› é¢„æµ‹ï¼›é‡å¤åºåˆ—æ³¨é‡Šå’Œè½¬åº§å…ƒä»¶åˆ†ç±»ï¼›éç¼–ç RNAæ³¨é‡Šï¼›å‡åŸºå› æ³¨é‡Šç­‰</td>
<td></td>
</tr>
<tr>
<td>Hi-Cè¾…åŠ©åŸºå› ç»„ç»„è£…</td>
<td>æœ‰æ•ˆæ•°æ®è¯„ä¼°ï¼›Contigèšç±»ã€æ’åºåŠå®šå‘åˆ†æï¼›æŒ‚è½½ç»“æœè¯„ä¼°</td>
<td></td>
</tr>
<tr>
<td>ç”Ÿç‰©å­¦é—®é¢˜è§£æ</td>
<td>æ¯”è¾ƒåŸºå› ç»„å­¦ç ”ç©¶</td>
<td>åŸºå› å®¶æ—èšç±»ï¼›</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ç³»ç»Ÿå‘è‚²æ ‘çš„æ„å»ºï¼›</td>
</tr>
<tr>
<td></td>
<td></td>
<td>åŸºå› å®¶æ—æ‰©å¼ ä¸æ”¶ç¼©åˆ†æï¼›</td>
</tr>
<tr>
<td></td>
<td></td>
<td>ç‰©ç§åˆ†åŒ–æ—¶é—´æ¨ç®—ï¼›</td>
</tr>
<tr>
<td></td>
<td></td>
<td>LTRå½¢æˆæ—¶é—´ä¼°ç®—ï¼›</td>
</tr>
<tr>
<td></td>
<td></td>
<td>å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶ï¼›</td>
</tr>
<tr>
<td></td>
<td></td>
<td>é€‰æ‹©å‹åŠ›åˆ†æ</td>
</tr>
<tr>
<td></td>
<td>ç‰¹å®šç”Ÿç‰©å­¦é—®é¢˜å‰–æ</td>
<td>ç»“åˆç»„å­¦ç ”ç©¶æ–¹æ³•ï¼Œæ·±å…¥å¯¹æŸç‰©ç§ç”Ÿç‰©å­¦é—®é¢˜è¿›è¡Œè§£æ</td>
</tr>
</tbody></table>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/13.png" alt="33"></p>
<p>è‰è“åŸºå› å®¶æ—èšç±»åˆ†æ</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/14.png" alt="44"></p>
<p>è–è‹¡å…¨åŸºå› ç»„å¤åˆ¶äº‹ä»¶åˆ†æ</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/15.png" alt="img"></p>
<p>å¼€å¿ƒæœç³»ç»Ÿè¿›åŒ–æ ‘ä¸åŸºå› å®¶æ—æ”¶ç¼©æ‰©å¼ åˆ†æ</p>
<p><img src="/blog/./16.png" alt="img"></p>
<p>é™†åœ°æ£‰äºšåŸºå› ç»„å…±çº¿æ€§åˆ†æ</p>
<h1 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h1><p>ç¬¬ä¸€ï¼š<font color="green">æ˜¾å¾®é•œ</font>å®æ—¶è®°å½•DNAé“¾è§å…‰æ—¶ï¼Œ<font color="green">DNAé“¾å‘¨å›´ä¼—å¤šè§å…‰æ ‡è®°è„±æ°§æ ¸è‹·é…¸</font>å½¢æˆéå¸¸å¼ºå¤§çš„<font color="green">è§å…‰èƒŒæ™¯</font>ã€‚å¼ºå¤§è§å…‰èƒŒæ™¯é˜»ç¢å•åˆ†å­è§å…‰æ¢æµ‹ã€‚Pacific Bioscienceså…¬å¸å‘æ˜äº†ä¸€ç§<font color="green">ç›´å¾„åªæœ‰å‡ åçº³ç±³çš„çº³ç±³å­”</font>[zero-mode waveguides (ZMWs)]ï¼Œå•åˆ†å­çš„<font color="green">DNAèšåˆé…¶</font>è¢«å›ºå®šåœ¨å­”å†…ã€‚åœ¨å°å­”å†…ï¼ŒDNAé“¾<font color="green">å‘¨å›´è§å…‰æ ‡è®°</font>çš„è„±æ°§æ ¸è‹·é…¸<font color="green">æœ‰é™</font>ï¼Œè€Œä¸”ç”±äºAï¼ŒTï¼ŒCï¼ŒGè¿™å››ç§è§å…‰æ ‡è®°çš„è„±æ°§æ ¸è‹·é…¸éå¸¸å¿«é€Ÿåœ°ä»å¤–é¢è¿›å…¥åˆ°å­”å†…åˆå‡ºå»ï¼Œå½¢æˆäº†éå¸¸<font color="green">ç¨³å®šçš„èƒŒæ™¯è§å…‰ä¿¡å·</font>ã€‚å½“æŸä¸€ç§è§å…‰æ ‡è®°çš„è„±æ°§æ ¸è‹·é…¸è¢«æºå…¥åˆ°DNAé“¾æ—¶ï¼Œç‰¹å®šé¢œè‰²çš„<font color="green">è§å…‰ä¼šæŒç»­ä¸€å°æ®µæ—¶é—´</font>ï¼Œç›´åˆ°æ–°çš„åŒ–å­¦é”®å½¢æˆï¼Œè§å…‰åŸºå›¢è¢«DNAèšåˆé…¶åˆ‡é™¤ä¸ºæ­¢ã€‚</p>
<p>ç¬¬äºŒï¼š<font color="green">å…±èšç„¦æ˜¾å¾®é•œ</font>å®æ—¶å¿«é€Ÿåœ°å¯¹é›†æˆåœ¨<font color="green">æ¿ä¸Šçš„æ— æ•°çº³ç±³å°å­”åŒæ—¶è®°å½•</font>ã€‚</p>
<h1 id="æŠ€æœ¯ç‰¹ç‚¹"><a href="#æŠ€æœ¯ç‰¹ç‚¹" class="headerlink" title="æŠ€æœ¯ç‰¹ç‚¹"></a>æŠ€æœ¯ç‰¹ç‚¹</h1><p>1ã€å®ç°DNAèšåˆé…¶å†…åœ¨è‡ªèº«çš„<font color="green">ååº”é€Ÿåº¦</font>ï¼Œä¸€ç§’æµ‹10ä¸ªç¢±åŸºï¼Œæµ‹åºé€Ÿåº¦æ˜¯<font color="green">åŒ–å­¦æ³•æµ‹åº2ä¸‡å€</font>ã€‚</p>
<p>2ã€å®ç°äº†DNAèšåˆé…¶å†…åœ¨è‡ªèº«çš„<font color="green">å»¶ç»­æ€§</font>ï¼Œä¸€ä¸ªååº”å¯æµ‹éå¸¸é•¿çš„åºåˆ—ã€‚äºŒä»£æµ‹åºå¯ä»¥æµ‹åˆ°ä¸Šç™¾ä¸ªç¢±åŸºï¼Œä½†æ˜¯ä¸‰ä»£æµ‹åºå¯æµ‹å‡ åƒä¸ªç¢±åŸºã€‚</p>
<p>3ã€<font color="green">ç²¾åº¦</font>éå¸¸é«˜ï¼Œè¾¾åˆ°<font color="green">99.9999%</font>ã€‚</p>
<p>4ã€ç›´æ¥æµ‹<font color="green">RNAåºåˆ—</font> (<strong>ISO</strong>)ã€‚æ—¢ç„¶<font color="green">DNAèšåˆé…¶</font>èƒ½å¤Ÿå®æ—¶è§‚æµ‹ï¼Œé‚£ä¹ˆä»¥RNAä¸ºæ¨¡æ¿å¤åˆ¶<font color="green">DNAçš„é€†è½¬å½•é…¶</font>ä¹ŸåŒæ ·å¯ä»¥ã€‚RNAç›´æ¥æµ‹åºï¼Œå°†å¤§å¤§é™ä½ä½“å¤–é€†è½¬å½•äº§ç”Ÿçš„ç³»ç»Ÿè¯¯å·®ã€‚</p>
<p>5ã€ç¬¬äºŒä¸ªæ˜¯ç›´æ¥æµ‹<font color="green">ç”²åŸºåŒ–DNAåºåˆ—</font>ã€‚å®é™…ä¸ŠDNAèšåˆé…¶<font color="red"><strong>å¤åˆ¶Aã€Tã€Cã€Gçš„é€Ÿåº¦ä¸ä¸€æ ·</strong></font>ã€‚<font color="red"><strong>æ­£å¸¸çš„Cæˆ–è€…ç”²åŸºåŒ–çš„Cä¸ºæ¨¡æ¿ï¼ŒDNAèšåˆé…¶åœé¡¿çš„æ—¶é—´ä¸åŒ</strong></font>ã€‚æ ¹æ®æ—¶é—´ä¸åŒï¼Œå¯ä»¥<font color="red"><strong>åˆ¤æ–­æ¨¡æ¿çš„Cæ˜¯å¦ç”²åŸºåŒ–</strong></font>ã€‚</p>
<h1 id="å¹³å°æ¯”è¾ƒ"><a href="#å¹³å°æ¯”è¾ƒ" class="headerlink" title="å¹³å°æ¯”è¾ƒ"></a>å¹³å°æ¯”è¾ƒ</h1><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>æµ‹åºæ–¹æ³•/å¹³å°</td>
<td>å…¬å¸</td>
<td>æ–¹æ³•/é…¶</td>
<td>æµ‹åºé•¿åº¦</td>
<td>æ¯ä¸ªå¾ªç¯çš„æ•°æ®äº§å‡ºé‡</td>
<td>æ¯ä¸ªå¾ªç¯è€—æ—¶</td>
<td>ä¸»è¦é”™è¯¯æ¥æº</td>
<td></td>
</tr>
<tr>
<td>ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯</td>
<td>Heliscope/HelicosGenetic AnalysisSystem</td>
<td>Helicos</td>
<td>è¾¹åˆæˆè¾¹æµ‹åº/DNAèšåˆé…¶</td>
<td>30-35 bp</td>
<td>21-28 Gb</td>
<td>8 d</td>
<td>æ›¿æ¢</td>
</tr>
<tr>
<td>SMRT</td>
<td>Pacific Biosciences</td>
<td>è¾¹åˆæˆè¾¹æµ‹åº/DNAèšåˆé…¶</td>
<td>100000 bp</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>çº³ç±³å­”å•åˆ†å­</td>
<td>Oxford Nanopore</td>
<td>ç”µä¿¡å·æµ‹åº/æ ¸é…¸å¤–åˆ‡é…¶</td>
<td>æ— é™é•¿</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><h2 id="åŸºå› ç»„æµ‹åº"><a href="#åŸºå› ç»„æµ‹åº" class="headerlink" title="åŸºå› ç»„æµ‹åº"></a>åŸºå› ç»„æµ‹åº</h2><p>ç”±äºå…·æœ‰è¯»é•¿é•¿çš„ç‰¹ç‚¹ï¼ŒSMRTæµ‹åºå¹³å°åœ¨åŸºå› ç»„æµ‹åºä¸­èƒ½<font color="green"><strong>é™ä½æµ‹åºåçš„Contigæ•°é‡</strong></font>ï¼Œæ˜æ˜¾<font color="green"><strong>å‡å°‘</strong></font>åç»­åŸºå› ç»„<font color="green"><strong>æ‹¼æ¥å’Œæ³¨é‡Šå·¥ä½œé‡</strong></font>ï¼ŒèŠ‚çœå¤§é‡æ—¶é—´ã€‚Christophernç­‰ä»…ä»…ç”¨0.5çš„Pacbio RSç³»ç»Ÿé•¿åº¦çš„æ•°æ®ä¸äºŒä»£æµ‹åº(NGS)çš„æµ‹åºæ•°æ®ï¼Œå¯¹<strong>é©¬è¾¾åŠ æ–¯åŠ æŒ‡çŒ´</strong>åŸºå› ç»„è¿›è¡Œæ‹¼è£…ï¼Œå¤§å¹…åº¦<font color="green">æé«˜</font>æ•°æ®çš„<font color="green">è´¨é‡å’Œå®Œæ•´åº¦</font>ï¼ŒåŒæ—¶å€ŸåŠ©Pacbio RSå°†åŸæœ‰<font color="green">Contigæ•°é‡å‡å°‘10å€</font>ã€‚DavidAï¼ç­‰åˆ©ç”¨Pachio RSå¹³å°C2è¯•å‰‚é€šè¿‡å…¨çƒåˆä½œå‡ å¤©å†…å°±å®Œæˆäº†ä»<font color="green"><strong>å¾·å›½å¤§è‚ æ†èŒç–«æƒ…</strong></font>ä¸­è·å¾—çš„<font color="green">å¤§è‚ æ†èŒæ ·å“</font>ä»¥åŠ<font color="green">è¿‘ä¼¼èŒæ ª</font>çš„æµ‹åºå’Œæ•°æ®åˆ†æï¼Œæœ€ç»ˆè·å¾—<font color="green">2900bpå¹³å‡è¯»é•¿</font>ä»¥åŠ<font color="green">99.998%ä¸€è‡´æ€§å‡†ç¡®åº¦</font>ã€‚åœ¨å¯¹<font color="green"><strong>éœä¹±ç—…èŒ</strong></font>çš„ç ”ç©¶ä¸­ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯å·²åˆç°é”‹èŠ’ã€‚ç ”ç©¶äººå‘˜å¯¹<font color="green">5æ ªéœä¹±èŒæ ª</font>çš„åŸºå› ç»„è¿›è¡Œäº†æµ‹åºç ”ç©¶ï¼Œå¹¶ä¸å…¶ä»–<font color="green">23æ ªéœä¹±å¼§èŒ</font>çš„<font color="green">åŸºå› ç»„è¿›è¡Œå¯¹æ¯”</font>ã€‚ç»“æœå‘ç°æµ·åœ°éœä¹±èŒæ ªä¸2002å¹´å’Œ2008å¹´å­ŸåŠ æ‹‰å›½å˜å¼‚éœä¹±å¼§èŒElTorO1èŒæ ªä¹‹é—´å…³ç³»å¯†åˆ‡ï¼Œè€Œä¸1991å¹´æ‹‰ä¸ç¾æ´²éœä¹±åˆ†ç¦»æ ªçš„å…³ç³»è¾ƒè¿œã€‚ç›¸å¯¹NGSçš„ä¼˜åŠ¿å°±æ˜¯èƒ½<font color="red">æ›´å¿«è·å¾—ç»“æœ</font>ï¼Œå› æ­¤è¯¥ç³»ç»Ÿåœ¨<font color="red">é‰´å®šæ–°çš„ç—…åŸä½“å’Œç»†èŒ</font>çš„åŸºå› ç»„æµ‹åºæ–¹é¢å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚</p>
<h2 id="ç”²åŸºåŒ–ç ”ç©¶"><a href="#ç”²åŸºåŒ–ç ”ç©¶" class="headerlink" title="ç”²åŸºåŒ–ç ”ç©¶"></a>ç”²åŸºåŒ–ç ”ç©¶</h2><p><strong>SMRTæŠ€æœ¯</strong>å¯¹DNA<strong>èšåˆé…¶</strong>çš„å·¥ä½œçŠ¶æ€<strong>å®æ—¶ç›‘æµ‹</strong>ï¼Œèšåˆé…¶<strong>åˆæˆæ¯ä¸€ä¸ªç¢±åŸº</strong>ï¼Œéƒ½æœ‰<strong>ä¸€ä¸ªæ—¶é—´æ®µ</strong>ï¼Œè€Œå½“æ¨¡æ¿ç¢±åŸº<strong>å¸¦æœ‰ä¿®é¥°æ—¶</strong>ï¼Œèšåˆé…¶ä¼š<strong>æ…¢ä¸‹æ¥</strong>ï¼Œä½¿<strong>å¸¦æœ‰ä¿®é¥°çš„ç¢±åŸºä¸¤ä¸ªç›¸é‚»çš„è„‰å†²å³°</strong>ä¹‹é—´çš„<strong>è·ç¦»</strong>å’Œ<strong>å‚è€ƒåºåˆ—çš„è·ç¦»ä¹‹é—´çš„æ¯”å€¼</strong>ç»“æœ<strong>å¤§äº1</strong>ï¼Œç”±æ­¤å°±å¯ä»¥æ¨æ–­è¿™ä¸ªä½ç½®æœ‰ä¿®é¥°ã€‚ç”²åŸºåŒ–ç ”ç©¶ä¸­å…³äº<strong>5mCå’Œ5hmC</strong>ï¼ˆ5mCçš„ç¾ŸåŸºåŒ–å½¢å¼ï¼‰æ˜¯ç”²åŸºåŒ–ç ”ç©¶ä¸­çš„çƒ­ç‚¹ã€‚ä½†<strong>ç°æœ‰æµ‹åºæ–¹æ³•æ— æ³•åŒºåˆ†</strong>5mCå’Œ5hmCã€‚<strong>ç¾å›½èŠåŠ å“¥å¤§å­¦</strong>åˆ©ç”¨<strong>SMRT</strong>æµ‹åºæŠ€æœ¯å’Œ<strong>5hmCçš„é€‰æ‹©æ€§åŒ–å­¦æ ‡è®°æ–¹æ³•</strong>æ¥é«˜é€šé‡æ£€æµ‹5hmCã€‚é€šè¿‡èšåˆé…¶åŠ¨åŠ›å­¦æä¾›çš„ä¿¡æ¯ï¼Œå¯ç›´æ¥æ£€æµ‹åˆ°<font color="green">DNAç”²åŸºåŒ–</font>ï¼ŒåŒ…æ‹¬<font color="red">N6ç”²åŸºè…ºå˜Œå‘¤ã€5mCå’Œ5hmC</font>ï¼Œä¸ºè¡¨è§‚é—ä¼ å­¦ç ”ç©¶æ‰“å¼€äº†ä¸€æ¡é€šè·¯ã€‚</p>
<h2 id="çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰"><a href="#çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰" class="headerlink" title="çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰"></a>çªå˜é‰´å®šï¼ˆSNPæ£€æµ‹ï¼‰</h2><p>å•åˆ†å­æµ‹åºçš„åˆ†è¾¨ç‡å…·æœ‰ä¸å¯æ¯”æ‹Ÿçš„ä¼˜åŠ¿ï¼Œè€Œä¸”æ²¡æœ‰PCRæ‰©å¢ï¼Œå°±<font color="green">æ²¡æœ‰æ‰©å¢å¼•å…¥çš„ç¢±åŸºé”™è¯¯</font>ï¼Œè¯¥ä¼˜åŠ¿ä½¿å…¶åœ¨<font color="green">ç‰¹å®šåºåˆ—çš„SNPæ£€æµ‹</font>ï¼Œ<font color="green">ç¨€æœ‰çªå˜åŠå…¶é¢‘ç‡æµ‹å®š</font>ä¸­å¤§æ˜¾èº«æ‰‹ã€‚ä¾‹å¦‚åœ¨åŒ»å­¦ç ”ç©¶ä¸­ï¼Œå¯¹äºFLT3åŸºå› æ˜¯å¦æ˜¯æ€¥æ€§é«“ç»†èƒç™½è¡€ç—…ï¼ˆAMLï¼‰çš„æœ‰æ•ˆæ²»ç–—é¶æ ‡ä¸€ç›´å­˜åœ¨è´¨ç–‘ã€‚ç ”ç©¶äººå‘˜ç”¨å•åˆ†å­æµ‹åºåˆ†æè€è¯æ€§æ‚£è€…åŸºå› ï¼Œæ„å¤–å‘ç°è€è¯æ€§ä¸FLT3åŸºå› ä¸‹æ¸¸å‡ºç°çš„ç¨€æœ‰æ–°çªå˜æœ‰å…³ï¼Œé‡æ–°è¯æ˜äº†FLT3åŸºå› æ˜¯è¿™ç§æœ€å¸¸è§ç™½è¡€ç—…â€”æ€¥æ€§é«“ç»†èƒç™½è¡€ç—…ï¼ˆAMLï¼‰çš„æœ‰æ•ˆæ²»ç–—é¶æ ‡ï¼Œæ‰“ç ´äº†ä¸€ç›´ä»¥æ¥å¯¹äºè¿™ä¸€åŸºå› é¶æ ‡çš„ç–‘æƒ‘ã€‚å‡­å€ŸPacBioå¹³å‡3000bpçš„è¯»é•¿ï¼Œè·å¾—äº†æ›´å¤šåŸºå› ä¸‹æ¸¸çš„å®è´µä¿¡æ¯ï¼Œè€ŒåŸºäºå•æ ¸é…¸åˆ†å­çš„æµ‹åºèƒ½å¤Ÿ<font color="red"><strong>æ£€æµ‹åˆ°ä½é¢‘ç‡ï¼ˆä½è‡³1%ï¼‰ç½•è§çªå˜</strong></font>ï¼Œæ­£æ˜¯è¿™é¡¹æˆæœçš„å…³é”®æ‰€åœ¨ã€‚</p>
<hr>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/1.png" alt="img"></p>
<h1 id="ç¬¬ä¸€ä»£æµ‹åº"><a href="#ç¬¬ä¸€ä»£æµ‹åº" class="headerlink" title="ç¬¬ä¸€ä»£æµ‹åº"></a>ç¬¬ä¸€ä»£æµ‹åº</h1><p>ç¬¬ä¸€ä»£DNAæµ‹åºæŠ€æœ¯ç”¨çš„æ˜¯1975å¹´ç”±æ¡‘æ ¼ï¼ˆSangerï¼‰å’Œè€ƒå°”æ£®ï¼ˆCoulsonï¼‰å¼€åˆ›çš„é“¾ç»ˆæ­¢æ³•æˆ–è€…æ˜¯1976-1977å¹´ç”±é©¬å…‹è¥¿å§†ï¼ˆMaxamï¼‰å’Œå‰å°”ä¼¯ç‰¹ï¼ˆGilbertï¼‰å‘æ˜çš„åŒ–å­¦æ³•ï¼ˆé“¾é™è§£ï¼‰. å¹¶åœ¨1977å¹´ï¼Œæ¡‘æ ¼æµ‹å®šäº†ç¬¬ä¸€ä¸ªåŸºå› ç»„åºåˆ—ï¼Œæ˜¯å™¬èŒä½“X174çš„ï¼Œå…¨é•¿5375ä¸ªç¢±åŸº1ã€‚è‡ªæ­¤ï¼Œäººç±»è·å¾—äº†çª¥æ¢ç”Ÿå‘½é—ä¼ å·®å¼‚æœ¬è´¨çš„èƒ½åŠ›ï¼Œå¹¶ä»¥æ­¤ä¸ºå¼€ç«¯æ­¥å…¥åŸºå› ç»„å­¦æ—¶ä»£ã€‚ç ”ç©¶äººå‘˜åœ¨Sangeræ³•çš„å¤šå¹´å®è·µä¹‹ä¸­ä¸æ–­å¯¹å…¶è¿›è¡Œæ”¹è¿›ã€‚åœ¨2001å¹´ï¼Œå®Œæˆçš„é¦–ä¸ªäººç±»åŸºå› ç»„å›¾è°±å°±æ˜¯ä»¥æ”¹è¿›äº†çš„Sangeræ³•ä¸ºå…¶æµ‹åºåŸºç¡€ï¼ŒSangeræ³•æ ¸å¿ƒåŸç†æ˜¯ï¼šç”±äºddNTPçš„2â€™å’Œ3â€™éƒ½ä¸å«ç¾ŸåŸºï¼Œå…¶åœ¨DNAçš„åˆæˆè¿‡ç¨‹ä¸­ä¸èƒ½å½¢æˆç£·é…¸äºŒé…¯é”®ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥ä¸­æ–­DNAåˆæˆååº”ï¼Œåœ¨4ä¸ªDNAåˆæˆååº”ä½“ç³»ä¸­åˆ†åˆ«åŠ å…¥ä¸€å®šæ¯”ä¾‹å¸¦æœ‰æ”¾å°„æ€§åŒä½ç´ æ ‡è®°çš„ddNTPï¼ˆåˆ†ä¸ºï¼šddATP,ddCTP,ddGTPå’ŒddTTPï¼‰ï¼Œé€šè¿‡å‡èƒ¶ç”µæ³³å’Œæ”¾å°„è‡ªæ˜¾å½±åå¯ä»¥æ ¹æ®ç”µæ³³å¸¦çš„ä½ç½®ç¡®å®šå¾…æµ‹åˆ†å­çš„DNAåºåˆ—ï¼ˆå›¾2ï¼‰ã€‚è¿™ä¸ª<a href="http://smcg.cifn.unam.mx/enp-unam/03-EstructuraDelGenoma/animaciones/secuencia.swf">ç½‘å€</a>ä¸ºsangeræµ‹åºæ³•åˆ¶ä½œäº†ä¸€ä¸ªå°çŸ­ç‰‡ï¼Œå½¢è±¡è€Œç”ŸåŠ¨ã€‚</p>
<p>ã€€ã€€å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå°±åœ¨æµ‹åºæŠ€æœ¯èµ·æ­¥å‘å±•çš„è¿™ä¸€æ—¶æœŸä¸­ï¼Œé™¤äº†Sangeræ³•ä¹‹å¤–è¿˜å‡ºç°äº†ä¸€äº›å…¶ä»–çš„æµ‹åºæŠ€æœ¯ï¼Œå¦‚ç„¦ç£·é…¸æµ‹åºæ³•ã€é“¾æ¥é…¶æ³•ç­‰ã€‚å…¶ä¸­ï¼Œç„¦ç£·é…¸æµ‹åºæ³•æ˜¯åæ¥Rocheå…¬å¸454æŠ€æœ¯æ‰€ä½¿ç”¨çš„æµ‹åºæ–¹æ³•2â€“4ï¼Œè€Œè¿æ¥é…¶æµ‹åºæ³•æ˜¯åæ¥ABIå…¬å¸SOLIDæŠ€æœ¯ä½¿ç”¨çš„æµ‹åºæ–¹æ³•2,4ï¼Œä½†ä»–ä»¬çš„å…±åŒæ ¸å¿ƒæ‰‹æ®µéƒ½æ˜¯åˆ©ç”¨äº†Sanger1ä¸­çš„å¯ä¸­æ–­DNAåˆæˆååº”çš„dNTPã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/2.png" alt="img"></p>
<h1 id="ç¬¬äºŒä»£æµ‹åº"><a href="#ç¬¬äºŒä»£æµ‹åº" class="headerlink" title="ç¬¬äºŒä»£æµ‹åº"></a>ç¬¬äºŒä»£æµ‹åº</h1><p>æ€»çš„è¯´æ¥ï¼Œç¬¬ä¸€ä»£æµ‹åºæŠ€æœ¯çš„ä¸»è¦ç‰¹ç‚¹æ˜¯æµ‹åºè¯»é•¿å¯è¾¾1000bpï¼Œå‡†ç¡®æ€§é«˜è¾¾99.999%ï¼Œä½†å…¶æµ‹åºæˆæœ¬é«˜ï¼Œé€šé‡ä½ç­‰æ–¹é¢çš„ç¼ºç‚¹ï¼Œä¸¥é‡å½±å“äº†å…¶çœŸæ­£å¤§è§„æ¨¡çš„åº”ç”¨ã€‚å› è€Œç¬¬ä¸€ä»£æµ‹åºæŠ€æœ¯å¹¶ä¸æ˜¯æœ€ç†æƒ³çš„æµ‹åºæ–¹æ³•ã€‚ç»è¿‡ä¸æ–­çš„æŠ€æœ¯å¼€å‘å’Œæ”¹è¿›ï¼Œä»¥Rocheå…¬å¸çš„454æŠ€æœ¯ã€illuminaå…¬å¸çš„Solexaï¼ŒHiseqæŠ€æœ¯å’ŒABIå…¬å¸çš„SolidæŠ€æœ¯ä¸ºæ ‡è®°çš„ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯è¯ç”Ÿäº†ã€‚ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯å¤§å¤§é™ä½äº†æµ‹åºæˆæœ¬çš„åŒæ—¶ï¼Œè¿˜å¤§å¹…æé«˜äº†æµ‹åºé€Ÿåº¦ï¼Œå¹¶ä¸”ä¿æŒäº†é«˜å‡†ç¡®æ€§ï¼Œä»¥å‰å®Œæˆä¸€ä¸ªäººç±»åŸºå› ç»„çš„æµ‹åºéœ€è¦3å¹´æ—¶é—´ï¼Œè€Œä½¿ç”¨äºŒä»£æµ‹åºæŠ€æœ¯åˆ™ä»…ä»…éœ€è¦1å‘¨ï¼Œä½†åœ¨åºåˆ—è¯»é•¿æ–¹é¢æ¯”èµ·ç¬¬ä¸€ä»£æµ‹åºæŠ€æœ¯åˆ™è¦çŸ­å¾ˆå¤šã€‚è¡¨1å’Œå›¾3å¯¹ç¬¬ä¸€ä»£å’Œç¬¬äºŒä»£æµ‹åºæŠ€æœ¯å„è‡ªçš„ç‰¹ç‚¹ä»¥åŠæµ‹åºæˆæœ¬ä½œäº†ä¸€ä¸ªç®€å•çš„æ¯”è¾ƒ5ï¼Œä»¥ä¸‹æˆ‘å°†å¯¹è¿™ä¸‰ç§ä¸»è¦çš„ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯çš„ä¸»è¦åŸç†å’Œç‰¹ç‚¹ä½œä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚ </p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/3.png" alt="img"></p>
<h2 id="Illumina"><a href="#Illumina" class="headerlink" title="Illumina"></a>Illumina</h2><p>ã€€ã€€Illuminaå…¬å¸çš„Solexaå’ŒHiseqåº”è¯¥è¯´æ˜¯ç›®å‰å…¨çƒä½¿ç”¨é‡æœ€å¤§çš„ç¬¬äºŒä»£æµ‹åºæœºå™¨ï¼Œè¿™ä¸¤ä¸ªç³»åˆ—çš„æŠ€æœ¯æ ¸å¿ƒåŸç†æ˜¯ç›¸åŒçš„2,4ã€‚è¿™ä¸¤ä¸ªç³»åˆ—çš„æœºå™¨é‡‡ç”¨çš„éƒ½æ˜¯è¾¹åˆæˆè¾¹æµ‹åºçš„æ–¹æ³•ï¼Œå®ƒçš„æµ‹åºè¿‡ç¨‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹4æ­¥ï¼Œå¦‚å›¾4.</p>
<p>â€‹     ï¼ˆ1ï¼‰DNAå¾…æµ‹æ–‡åº“æ„å»º</p>
<p>ã€€ã€€åˆ©ç”¨è¶…å£°æ³¢æŠŠå¾…æµ‹çš„DNAæ ·æœ¬æ‰“æ–­æˆå°ç‰‡æ®µï¼Œç›®å‰é™¤äº†ç»„è£…ä¹‹å¤–å’Œä¸€äº›å…¶ä»–çš„ç‰¹æ®Šè¦æ±‚ä¹‹å¤–ï¼Œä¸»è¦æ˜¯æ‰“æ–­æˆ200-500bpé•¿çš„åºåˆ—ç‰‡æ®µï¼Œå¹¶åœ¨è¿™äº›å°ç‰‡æ®µçš„ä¸¤ç«¯æ·»åŠ ä¸Šä¸åŒçš„æ¥å¤´ï¼Œæ„å»ºå‡ºå•é“¾DNAæ–‡åº“ã€‚</p>
<p>â€‹     ï¼ˆ2ï¼‰Flowcell</p>
<p>ã€€ã€€Flowcellæ˜¯ç”¨äºå¸é™„æµåŠ¨DNAç‰‡æ®µçš„æ§½é“ï¼Œå½“æ–‡åº“å»ºå¥½åï¼Œè¿™äº›æ–‡åº“ä¸­çš„DNAåœ¨é€šè¿‡flowcellçš„æ—¶å€™ä¼šéšæœºé™„ç€åœ¨flowcellè¡¨é¢çš„channelä¸Šã€‚æ¯ä¸ªFlowcellæœ‰8ä¸ªchannelï¼Œæ¯ä¸ªchannelçš„è¡¨é¢éƒ½é™„æœ‰å¾ˆå¤šæ¥å¤´ï¼Œè¿™äº›æ¥å¤´èƒ½å’Œå»ºåº“è¿‡ç¨‹ä¸­åŠ åœ¨DNAç‰‡æ®µä¸¤ç«¯çš„æ¥å¤´ç›¸äº’é…å¯¹ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆflowcellèƒ½å¸é™„å»ºåº“åçš„DNAçš„åŸå› ï¼‰ï¼Œå¹¶èƒ½æ”¯æŒDNAåœ¨å…¶è¡¨é¢è¿›è¡Œæ¡¥å¼PCRçš„æ‰©å¢ã€‚</p>
<p>â€‹     ï¼ˆ3ï¼‰æ¡¥å¼PCRæ‰©å¢ä¸å˜æ€§</p>
<p>ã€€ã€€æ¡¥å¼PCRä»¥Flowcellè¡¨é¢æ‰€å›ºå®šçš„æ¥å¤´ä¸ºæ¨¡æ¿ï¼Œè¿›è¡Œæ¡¥å½¢æ‰©å¢ï¼Œå¦‚å›¾4.aæ‰€ç¤ºã€‚ç»è¿‡ä¸æ–­çš„æ‰©å¢å’Œå˜æ€§å¾ªç¯ï¼Œæœ€ç»ˆæ¯ä¸ªDNAç‰‡æ®µéƒ½å°†åœ¨å„è‡ªçš„ä½ç½®ä¸Šé›†ä¸­æˆæŸï¼Œæ¯ä¸€ä¸ªæŸéƒ½å«æœ‰å•ä¸ªDNAæ¨¡æ¿çš„å¾ˆå¤šåˆ†æ‹·è´ï¼Œè¿›è¡Œè¿™ä¸€è¿‡ç¨‹çš„ç›®çš„åœ¨äºå®ç°å°†ç¢±åŸºçš„ä¿¡å·å¼ºåº¦æ”¾å¤§ï¼Œä»¥è¾¾åˆ°æµ‹åºæ‰€éœ€çš„ä¿¡å·è¦æ±‚ã€‚ </p>
<p>ï¼ˆ4ï¼‰æµ‹åº</p>
<p>ã€€ã€€æµ‹åºæ–¹æ³•é‡‡ç”¨è¾¹åˆæˆè¾¹æµ‹åºçš„æ–¹æ³•ã€‚å‘ååº”ä½“ç³»ä¸­åŒæ—¶æ·»åŠ DNAèšåˆé…¶ã€æ¥å¤´å¼•ç‰©å’Œå¸¦æœ‰ç¢±åŸºç‰¹å¼‚è§å…‰æ ‡è®°çš„4ä¸­dNTPï¼ˆå¦‚åŒSangeræµ‹åºæ³•ï¼‰ã€‚è¿™äº›dNTPçš„3â€™-OHè¢«åŒ–å­¦æ–¹æ³•æ‰€ä¿æŠ¤ï¼Œå› è€Œæ¯æ¬¡åªèƒ½æ·»åŠ ä¸€ä¸ªdNTPã€‚åœ¨dNTPè¢«æ·»åŠ åˆ°åˆæˆé“¾ä¸Šåï¼Œæ‰€æœ‰æœªä½¿ç”¨çš„æ¸¸ç¦»dNTPå’ŒDNAèšåˆé…¶ä¼šè¢«æ´—è„±æ‰ã€‚æ¥ç€ï¼Œå†åŠ å…¥æ¿€å‘è§å…‰æ‰€éœ€çš„ç¼“å†²æ¶²ï¼Œç”¨æ¿€å…‰æ¿€å‘è§å…‰ä¿¡å·ï¼Œå¹¶æœ‰å…‰å­¦è®¾å¤‡å®Œæˆè§å…‰ä¿¡å·çš„è®°å½•ï¼Œæœ€ååˆ©ç”¨è®¡ç®—æœºåˆ†æå°†å…‰å­¦ä¿¡å·è½¬åŒ–ä¸ºæµ‹åºç¢±åŸºã€‚è¿™æ ·è§å…‰ä¿¡å·è®°å½•å®Œæˆåï¼Œå†åŠ å…¥åŒ–å­¦è¯•å‰‚æ·¬ç­è§å…‰ä¿¡å·å¹¶å»é™¤dNTP 3â€™-OHä¿æŠ¤åŸºå›¢ï¼Œä»¥ä¾¿èƒ½è¿›è¡Œä¸‹ä¸€è½®çš„æµ‹åºååº”ã€‚Illuminaçš„è¿™ç§æµ‹åºæŠ€æœ¯æ¯æ¬¡åªæ·»åŠ ä¸€ä¸ªdNTPçš„ç‰¹ç‚¹èƒ½å¤Ÿå¾ˆå¥½çš„åœ°è§£å†³åŒèšç‰©é•¿åº¦çš„å‡†ç¡®æµ‹é‡é—®é¢˜ï¼Œå®ƒçš„ä¸»è¦æµ‹åºé”™è¯¯æ¥æºæ˜¯ç¢±åŸºçš„æ›¿æ¢ï¼Œç›®å‰å®ƒçš„æµ‹åºé”™è¯¯ç‡åœ¨1%-1.5%ä¹‹é—´ï¼Œæµ‹åºå‘¨æœŸä»¥äººç±»åŸºå› ç»„é‡æµ‹åºä¸ºä¾‹ï¼Œ30xæµ‹åºæ·±åº¦å¤§çº¦ä¸º1å‘¨ã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/4.png" alt="img"></p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/5.png" alt="img"></p>
<h2 id="Roche-454"><a href="#Roche-454" class="headerlink" title="Roche 454"></a>Roche 454</h2><p>Roche 454æµ‹åºç³»ç»Ÿæ˜¯ç¬¬ä¸€ä¸ªå•†ä¸šåŒ–è¿è¥äºŒä»£æµ‹åºæŠ€æœ¯çš„å¹³å°ã€‚å®ƒçš„ä¸»è¦æµ‹åºåŸç†æ˜¯ï¼ˆå›¾5 abcï¼‰2ï¼š</p>
<p>ï¼ˆ1ï¼‰DNAæ–‡åº“åˆ¶å¤‡</p>
<p>ã€€ã€€454æµ‹åºç³»ç»Ÿçš„æ–‡ä»¶æ„å»ºæ–¹å¼å’Œilluminaçš„ä¸åŒï¼Œå®ƒæ˜¯åˆ©ç”¨å–·é›¾æ³•å°†å¾…æµ‹DNAæ‰“æ–­æˆ300-800bpé•¿çš„å°ç‰‡æ®µï¼Œå¹¶åœ¨ç‰‡æ®µä¸¤ç«¯åŠ ä¸Šä¸åŒçš„æ¥å¤´ï¼Œæˆ–å°†å¾…æµ‹DNAå˜æ€§åç”¨æ‚äº¤å¼•ç‰©è¿›è¡ŒPCRæ‰©å¢ï¼Œè¿æ¥è½½ä½“ï¼Œæ„å»ºå•é“¾DNAæ–‡åº“ï¼ˆå›¾5aï¼‰ã€‚</p>
<p>ï¼ˆ2ï¼‰Emulsion PCR ï¼ˆä¹³æ¶²PCRï¼Œå…¶å®æ˜¯ä¸€ä¸ªæ³¨æ°´åˆ°æ²¹çš„ç‹¬ç‰¹è¿‡ç¨‹ï¼‰</p>
<p>454å½“ç„¶DNAæ‰©å¢è¿‡ç¨‹ä¹Ÿå’Œilluminaçš„æˆªç„¶ä¸åŒï¼Œå®ƒå°†è¿™äº›å•é“¾DNAç»“åˆåœ¨æ°´æ²¹åŒ…è¢«çš„ç›´å¾„çº¦28umçš„ç£ç ä¸Šï¼Œå¹¶åœ¨å…¶ä¸Šé¢å­µè‚²ã€é€€ç«ã€‚</p>
<p>ã€€ã€€ä¹³æ¶²PCRæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¯ä»¥å½¢æˆæ•°ç›®åºå¤§çš„ç‹¬ç«‹ååº”ç©ºé—´ä»¥è¿›è¡ŒDNAæ‰©å¢ã€‚å…¶å…³é”®æŠ€æœ¯æ˜¯â€œæ³¨æ°´åˆ°æ²¹â€ï¼ˆæ°´åŒ…æ²¹ï¼‰ï¼ŒåŸºæœ¬è¿‡ç¨‹æ˜¯åœ¨PCRååº”å‰ï¼Œå°†åŒ…å«PCRæ‰€æœ‰ååº”æˆåˆ†çš„æ°´æº¶æ¶²æ³¨å…¥åˆ°é«˜é€Ÿæ—‹è½¬çš„çŸ¿ç‰©æ²¹è¡¨é¢ï¼Œæ°´æº¶æ¶²ç¬é—´å½¢æˆæ— æ•°ä¸ªè¢«çŸ¿ç‰©æ²¹åŒ…è£¹çš„å°æ°´æ»´ã€‚è¿™äº›å°æ°´æ»´å°±æ„æˆäº†ç‹¬ç«‹çš„PCRååº”ç©ºé—´ã€‚ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæ¯ä¸ªå°æ°´æ»´åªå«ä¸€ä¸ªDNAæ¨¡æ¿å’Œä¸€ä¸ªç£ç ã€‚</p>
<p>ã€€ã€€è¿™äº›è¢«å°æ°´æ»´åŒ…è¢«çš„ç£ç è¡¨é¢å«æœ‰ä¸æ¥å¤´äº’è¡¥çš„DNAåºåˆ—ï¼Œå› æ­¤è¿™äº›å•é“¾DNAåºåˆ—èƒ½å¤Ÿç‰¹å¼‚åœ°ç»“åˆåœ¨ç£ç ä¸Šã€‚åŒæ—¶å­µè‚²ä½“ç³»ä¸­å«æœ‰PCRååº”è¯•å‰‚ï¼Œæ‰€ä»¥ä¿è¯äº†æ¯ä¸ªä¸ç£ç ç»“åˆçš„å°ç‰‡æ®µéƒ½èƒ½ç‹¬ç«‹è¿›è¡ŒPCRæ‰©å¢ï¼Œå¹¶ä¸”æ‰©å¢äº§ç‰©ä»å¯ä»¥ç»“åˆåˆ°ç£ç ä¸Šã€‚å½“ååº”å®Œæˆåï¼Œå¯ä»¥ç ´åå­µè‚²ä½“ç³»å¹¶å°†å¸¦æœ‰DNAçš„ç£ç å¯Œé›†ä¸‹æ¥ã€‚è¿›è¿‡æ‰©å¢ï¼Œæ¯ä¸ªå°ç‰‡æ®µéƒ½å°†è¢«æ‰©å¢çº¦100ä¸‡å€ï¼Œä»è€Œè¾¾åˆ°ä¸‹ä¸€æ­¥æµ‹åºæ‰€è¦æ±‚çš„DNAé‡ã€‚</p>
<p>ï¼ˆ3ï¼‰ç„¦ç£·é…¸æµ‹åº</p>
<p>ã€€ã€€æµ‹åºå‰éœ€è¦å…ˆç”¨ä¸€ç§èšåˆé…¶å’Œå•é“¾ç»“åˆè›‹ç™½å¤„ç†å¸¦æœ‰DNAçš„ç£ç ï¼Œæ¥ç€å°†ç£ç æ”¾åœ¨ä¸€ç§PTPå¹³æ¿ä¸Šã€‚è¿™ç§å¹³æ¿ä¸Šç‰¹åˆ¶æœ‰è®¸å¤šç›´å¾„çº¦ä¸º44umçš„å°å­”ï¼Œæ¯ä¸ªå°å­”ä»…èƒ½å®¹çº³ä¸€ä¸ªç£ç ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•æ¥å›ºå®šæ¯ä¸ªç£ç çš„ä½ç½®ï¼Œä»¥ä¾¿æ£€æµ‹æ¥ä¸‹æ¥çš„æµ‹åºååº”è¿‡ç¨‹ã€‚ã€€ã€€</p>
<p>ã€€ã€€æµ‹åºæ–¹æ³•é‡‡ç”¨ç„¦ç£·é…¸æµ‹åºæ³•ï¼Œå°†ä¸€ç§æ¯”PTPæ¿ä¸Šå°å­”ç›´å¾„æ›´å°çš„ç£ç æ”¾å…¥å°å­”ä¸­ï¼Œå¯åŠ¨æµ‹åºååº”ã€‚æµ‹åºååº”ä»¥ç£ç ä¸Šå¤§é‡æ‰©å¢å‡ºçš„å•é“¾DNAä¸ºæ¨¡æ¿ï¼Œæ¯æ¬¡ååº”åŠ å…¥ä¸€ç§dNTPè¿›è¡Œåˆæˆååº”ã€‚å¦‚æœdNTPèƒ½ä¸å¾…æµ‹åºåˆ—é…å¯¹ï¼Œåˆ™ä¼šåœ¨åˆæˆåé‡Šæ”¾ç„¦ç£·é…¸åŸºå›¢ã€‚é‡Šæ”¾çš„ç„¦ç£·é…¸åŸºå›¢ä¼šä¸ååº”ä½“ç³»ä¸­çš„ATPç¡«é…¸åŒ–å­¦é…¶ååº”ç”ŸæˆATPã€‚ç”Ÿæˆçš„ATPå’Œè§å…‰ç´ é…¶å…±åŒæ°§åŒ–ä½¿æµ‹åºååº”ä¸­çš„è§å…‰ç´ åˆ†å­å¹¶å‘å‡ºè§å…‰ï¼ŒåŒæ—¶ç”±PTPæ¿å¦ä¸€ä¾§çš„CCDç…§ç›¸æœºè®°å½•ï¼Œæœ€åé€šè¿‡è®¡ç®—æœºè¿›è¡Œå…‰ä¿¡å·å¤„ç†è€Œè·å¾—æœ€ç»ˆçš„æµ‹åºç»“æœã€‚ç”±äºæ¯ä¸€ç§dNTPåœ¨ååº”ä¸­äº§ç”Ÿçš„è§å…‰é¢œè‰²ä¸åŒï¼Œå› æ­¤å¯ä»¥æ ¹æ®è§å…‰çš„é¢œè‰²æ¥åˆ¤æ–­è¢«æµ‹åˆ†å­çš„åºåˆ—ã€‚ååº”ç»“æŸåï¼Œæ¸¸ç¦»çš„dNTPä¼šåœ¨åŒç£·é…¸é…¶çš„ä½œç”¨ä¸‹é™è§£ATPï¼Œä»è€Œå¯¼è‡´è§å…‰æ·¬ç­ï¼Œä»¥ä¾¿ä½¿æµ‹åºååº”è¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ã€‚ç”±äº454æµ‹åºæŠ€æœ¯ä¸­ï¼Œæ¯ä¸ªæµ‹åºååº”éƒ½åœ¨PTPæ¿ä¸Šç‹¬ç«‹çš„å°å­”ä¸­è¿›è¡Œï¼Œå› è€Œèƒ½å¤§å¤§é™ä½ç›¸äº’é—´çš„å¹²æ‰°å’Œæµ‹åºåå·®ã€‚454æŠ€æœ¯æœ€å¤§çš„ä¼˜åŠ¿åœ¨äºå…¶èƒ½è·å¾—è¾ƒé•¿çš„æµ‹åºè¯»é•¿ï¼Œå½“å‰454æŠ€æœ¯çš„å¹³å‡è¯»é•¿å¯è¾¾400bpï¼Œå¹¶ä¸”454æŠ€æœ¯å’Œilluminaçš„Solexaå’ŒHiseqæŠ€æœ¯ä¸åŒï¼Œå®ƒæœ€ä¸»è¦çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯æ— æ³•å‡†ç¡®æµ‹é‡åŒèšç‰©çš„é•¿åº¦ï¼Œå¦‚å½“åºåˆ—ä¸­å­˜åœ¨ç±»ä¼¼äºPolyAçš„æƒ…å†µæ—¶ï¼Œæµ‹åºååº”ä¼šä¸€æ¬¡åŠ å…¥å¤šä¸ªTï¼Œè€Œæ‰€åŠ å…¥çš„Tçš„ä¸ªæ•°åªèƒ½é€šè¿‡è§å…‰å¼ºåº¦æ¨æµ‹è·å¾—ï¼Œè¿™å°±æœ‰å¯èƒ½å¯¼è‡´ç»“æœä¸å‡†ç¡®ã€‚ä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸€åŸå› ï¼Œ454æŠ€æœ¯ä¼šåœ¨æµ‹åºè¿‡ç¨‹ä¸­å¼•å…¥æ’å…¥å’Œç¼ºå¤±çš„æµ‹åºé”™è¯¯ã€‚ </p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/6.png" alt="img"></p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/7.png" alt="img"></p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/8.png" alt="img"></p>
<h2 id="SolidæŠ€æœ¯"><a href="#SolidæŠ€æœ¯" class="headerlink" title="SolidæŠ€æœ¯"></a>SolidæŠ€æœ¯</h2><p>Solidæµ‹åºæŠ€æœ¯æ˜¯ABIå…¬å¸äº2007å¹´å¼€å§‹æŠ•å…¥ç”¨äºå•†ä¸šæµ‹åºåº”ç”¨çš„ä»ªå™¨ã€‚å®ƒåŸºäºè¿æ¥é…¶æ³•ï¼Œå³åˆ©ç”¨DNAè¿æ¥é…¶åœ¨è¿æ¥è¿‡ç¨‹ä¹‹ä¸­æµ‹åºï¼ˆå›¾6ï¼‰2,4ã€‚å®ƒçš„åŸç†æ˜¯ï¼š</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/9.png" alt="img"></p>
<p>ã€€ï¼ˆ1ï¼‰DNAæ–‡åº“æ„å»º</p>
<p>â€‹              ã€€ã€€ç‰‡æ®µæ‰“æ–­å¹¶åœ¨ç‰‡æ®µä¸¤ç«¯åŠ ä¸Šæµ‹åºæ¥å¤´ï¼Œè¿æ¥è½½ä½“ï¼Œæ„å»ºå•é“¾DNAæ–‡åº“ã€‚</p>
<p>â€‹           ï¼ˆ2ï¼‰Emulsion PCR</p>
<p>ã€€ã€€Solidçš„PCRè¿‡ç¨‹ä¹Ÿå’Œ454çš„æ–¹æ³•ç±»ä¼¼ï¼ŒåŒæ ·é‡‡ç”¨å°æ°´æ»´emulsion PCRï¼Œä½†è¿™äº›å¾®ç æ¯”èµ·454ç³»ç»Ÿæ¥è¯´åˆ™è¦å°å¾—å¤šï¼Œåªæœ‰1umã€‚åœ¨æ‰©å¢çš„åŒæ—¶å¯¹æ‰©å¢äº§ç‰©çš„3â€™ç«¯è¿›è¡Œä¿®é¥°ï¼Œè¿™æ˜¯ä¸ºä¸‹ä¸€æ­¥çš„æµ‹åºè¿‡ç¨‹ä½œçš„å‡†å¤‡ã€‚3â€™ä¿®é¥°çš„å¾®ç ä¼šè¢«æ²‰ç§¯åœ¨ä¸€å—ç»ç‰‡ä¸Šã€‚åœ¨å¾®ç ä¸Šæ ·çš„è¿‡ç¨‹ä¸­ï¼Œæ²‰ç§¯å°å®¤å°†æ¯å¼ ç»ç‰‡åˆ†æˆ1ä¸ªã€4ä¸ªæˆ–8ä¸ªæµ‹åºåŒºåŸŸï¼ˆå›¾6-aï¼‰ã€‚Solidç³»ç»Ÿæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯æ¯å¼ ç»ç‰‡èƒ½å®¹çº³æ¯”454æ›´é«˜å¯†åº¦çš„å¾®ç ï¼Œåœ¨åŒä¸€ç³»ç»Ÿä¸­è½»æ¾å®ç°æ›´é«˜çš„é€šé‡ã€‚</p>
<p>â€‹           ï¼ˆ3ï¼‰è¿æ¥é…¶æµ‹åº</p>
<p>ã€€ã€€è¿™ä¸€æ­¥æ˜¯Solidæµ‹åºçš„ç‹¬ç‰¹ä¹‹å¤„ã€‚å®ƒå¹¶æ²¡æœ‰é‡‡ç”¨ä»¥å‰æµ‹åºæ—¶æ‰€å¸¸ç”¨çš„DNAèšåˆé…¶ï¼Œè€Œæ˜¯é‡‡ç”¨äº†è¿æ¥é…¶ã€‚Solidè¿æ¥ååº”çš„åº•ç‰©æ˜¯8ç¢±åŸºå•é“¾è§å…‰æ¢é’ˆæ··åˆç‰©ï¼Œè¿™é‡Œå°†å…¶ç®€å•è¡¨ç¤ºä¸ºï¼š3â€™-XXnnnzzz-5â€™ã€‚è¿æ¥ååº”ä¸­ï¼Œè¿™äº›æ¢é’ˆæŒ‰ç…§ç¢±åŸºäº’è¡¥è§„åˆ™ä¸å•é“¾DNAæ¨¡æ¿é“¾é…å¯¹ã€‚æ¢é’ˆçš„5â€™æœ«ç«¯åˆ†åˆ«æ ‡è®°äº†CY5ã€Texas Redã€CY3ã€6-FAMè¿™4ç§é¢œè‰²çš„è§å…‰æŸ“æ–™ï¼ˆå›¾6-aï¼‰ã€‚è¿™ä¸ª8ç¢±åŸºå•é“¾è§å…‰æ¢é’ˆä¸­ï¼Œç¬¬1å’Œç¬¬2ä½ç¢±åŸºï¼ˆXXï¼‰ä¸Šçš„ç¢±åŸºæ˜¯ç¡®å®šçš„ï¼Œå¹¶æ ¹æ®ç§ç±»çš„ä¸åŒåœ¨6-8ä½ï¼ˆzzzï¼‰ä¸ŠåŠ ä¸Šäº†ä¸åŒçš„è§å…‰æ ‡è®°ã€‚è¿™æ˜¯Solidçš„ç‹¬ç‰¹æµ‹åºæ³•ï¼Œä¸¤ä¸ªç¢±åŸºç¡®å®šä¸€ä¸ªè§å…‰ä¿¡å·ï¼Œç›¸å½“äºä¸€æ¬¡èƒ½å†³å®šä¸¤ä¸ªç¢±åŸºã€‚è¿™ç§æµ‹åºæ–¹æ³•ä¹Ÿç§°ä¹‹ä¸ºä¸¤ç¢±åŸºæµ‹åºæ³•ã€‚å½“è§å…‰æ¢é’ˆèƒ½å¤Ÿä¸DNAæ¨¡æ¿é“¾é…å¯¹è€Œè¿æ¥ä¸Šæ—¶ï¼Œå°±ä¼šå‘å‡ºä»£è¡¨ç¬¬1ï¼Œ2ä½ç¢±åŸºçš„è§å…‰ä¿¡å·ï¼Œå›¾6-aå’Œå›¾6-bä¸­çš„æ¯”è‰²ç‰ˆæ‰€è¡¨ç¤ºçš„æ˜¯ç¬¬1ï¼Œ2ä½ç¢±åŸºçš„ä¸åŒç»„åˆä¸è§å…‰é¢œè‰²çš„å…³ç³»ã€‚åœ¨è®°å½•ä¸‹è§å…‰ä¿¡å·åï¼Œé€šè¿‡åŒ–å­¦æ–¹æ³•åœ¨ç¬¬5å’Œç¬¬6ä½ç¢±åŸºä¹‹é—´è¿›è¡Œåˆ‡å‰²ï¼Œè¿™æ ·å°±èƒ½ç§»é™¤è§å…‰ä¿¡å·ï¼Œä»¥ä¾¿è¿›è¡Œä¸‹ä¸€ä¸ªä½ç½®çš„æµ‹åºã€‚ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡è¿™ç§æµ‹åºæ–¹æ³•ï¼Œæ¯æ¬¡æµ‹åºçš„ä½ç½®éƒ½ç›¸å·®5ä½ã€‚å³ç¬¬ä¸€æ¬¡æ˜¯ç¬¬1ã€2ä½ï¼Œç¬¬äºŒæ¬¡æ˜¯ç¬¬6ã€7ä½â€¦â€¦åœ¨æµ‹åˆ°æœ«å°¾åï¼Œè¦å°†æ–°åˆæˆçš„é“¾å˜æ€§ï¼Œæ´—è„±ã€‚æ¥ç€ç”¨å¼•ç‰©n-1è¿›è¡Œç¬¬äºŒè½®æµ‹åºã€‚å¼•ç‰©n-1ä¸å¼•ç‰©nçš„åŒºåˆ«æ˜¯ï¼ŒäºŒè€…åœ¨ä¸æ¥å¤´é…å¯¹çš„ä½ç½®ä¸Šç›¸å·®ä¸€ä¸ªç¢±åŸºï¼ˆå›¾6-a. 8ï¼‰ã€‚ä¹Ÿå³æ˜¯ï¼Œé€šè¿‡å¼•ç‰©n-1åœ¨å¼•ç‰©nçš„åŸºç¡€ä¸Šå°†æµ‹åºä½ç½®å¾€3â€™ç«¯ç§»åŠ¨ä¸€ä¸ªç¢±åŸºä½ç½®ï¼Œå› è€Œå°±èƒ½æµ‹å®šç¬¬0ã€1ä½å’Œç¬¬5ã€6ä½â€¦â€¦ç¬¬äºŒè½®æµ‹åºå®Œæˆï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´è‡³ç¬¬äº”è½®æµ‹åºï¼Œæœ€ç»ˆå¯ä»¥å®Œæˆæ‰€æœ‰ä½ç½®çš„ç¢±åŸºæµ‹åºï¼Œå¹¶ä¸”æ¯ä¸ªä½ç½®çš„ç¢±åŸºå‡è¢«æ£€æµ‹äº†ä¸¤æ¬¡ã€‚è¯¥æŠ€æœ¯çš„è¯»é•¿åœ¨2Ã—50bpï¼Œåç»­åºåˆ—æ‹¼æ¥åŒæ ·æ¯”è¾ƒå¤æ‚ã€‚ç”±äºåŒæ¬¡æ£€æµ‹ï¼Œè¿™ä¸€æŠ€æœ¯çš„åŸå§‹æµ‹åºå‡†ç¡®æ€§é«˜è¾¾99.94%ï¼Œè€Œ15xè¦†ç›–ç‡æ—¶çš„å‡†ç¡®æ€§æ›´æ˜¯è¾¾åˆ°äº†99.999%ï¼Œåº”è¯¥è¯´æ˜¯ç›®å‰ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯ä¸­å‡†ç¡®æ€§æœ€é«˜çš„äº†ã€‚ä½†åœ¨è§å…‰è§£ç é˜¶æ®µï¼Œé‰´äºå…¶æ˜¯åŒç¢±åŸºç¡®å®šä¸€ä¸ªè§å…‰ä¿¡å·ï¼Œå› è€Œä¸€æ—¦å‘ç”Ÿé”™è¯¯å°±å®¹æ˜“äº§ç”Ÿè¿é”çš„è§£ç é”™è¯¯ã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/10.png" alt="img"></p>
<h1 id="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯"><a href="#ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯" class="headerlink" title="ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯"></a>ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯</h1><p>ä»¥PacBioå…¬å¸çš„<font color="red">SMRT</font>å’Œ<font color="red">Oxford Nanopore Technologiesçº³ç±³å­”å•åˆ†å­æµ‹åºæŠ€æœ¯</font>ï¼Œè¢«ç§°ä¹‹ä¸ºç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯ã€‚ä¸å‰ä¸¤ä»£ç›¸æ¯”ï¼Œæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å•åˆ†å­æµ‹åºï¼Œæµ‹åºè¿‡ç¨‹<font color="red">æ— éœ€PCR</font>æ‰©å¢ã€‚</p>
<p>ã€€ã€€PacBio SMRTæŠ€æœ¯ä¹Ÿåº”ç”¨äº†è¾¹åˆæˆè¾¹æµ‹åºæ€æƒ³ï¼Œå¹¶ä»¥SMRTèŠ¯ç‰‡ä¸ºæµ‹åºè½½ä½“ã€‚åŸºæœ¬åŸç†ï¼š DNAèšåˆé…¶å’Œæ¨¡æ¿ç»“åˆ,4è‰²è§å…‰æ ‡è®° 4 ç§ç¢±åŸºï¼ˆå³æ˜¯dNTPï¼‰,åœ¨ç¢±åŸºé…å¯¹é˜¶æ®µ,ä¸åŒç¢±åŸºåŠ å…¥,å‘ä¸åŒå…‰,æ ¹æ®<font color="green">å…‰çš„æ³¢é•¿ä¸å³°å€¼</font>åˆ¤æ–­è¿›å…¥ç¢±åŸºç±»å‹ã€‚ DNA èšåˆé…¶æ˜¯å®ç°è¶…é•¿è¯»é•¿çš„å…³é”®ä¹‹ä¸€,è¯»é•¿ä¸»è¦è·Ÿ<font color="red">é…¶çš„æ´»æ€§ä¿æŒ</font>æœ‰å…³,å®ƒä¸»è¦å—æ¿€å…‰å¯¹å…¶é€ æˆçš„æŸä¼¤æ‰€å½±å“ã€‚</p>
<p>â€‹        PacBio SMRTæŠ€æœ¯çš„ä¸€ä¸ªå…³é”®æ˜¯æ€æ ·å°†ååº”ä¿¡å·ä¸å‘¨å›´æ¸¸ç¦»ç¢±åŸºçš„<font color="red">å¼ºå¤§è§å…‰èƒŒæ™¯</font>åŒºåˆ«ã€‚<font color="red"><strong>ZMWï¼ˆé›¶æ¨¡æ³¢å¯¼å­”ï¼‰åŸç†</strong></font>ï¼šå¦‚åŒå¾®æ³¢ç‚‰å£ä¸Šå¯çœ‹åˆ°çš„å¾ˆå¤šå¯†é›†å°å­”ã€‚å°å­”ç›´å¾„æœ‰è€ƒç©¶,å¦‚æœç›´å¾„å¤§äºå¾®æ³¢æ³¢é•¿,èƒ½é‡å°±ä¼šåœ¨è¡å°„æ•ˆåº”çš„ä½œç”¨ä¸‹ç©¿é€é¢æ¿è€Œæ³„éœ²å‡ºæ¥ï¼Œä»è€Œä¸å‘¨å›´å°å­”ç›¸äº’å¹²æ‰°ã€‚å¦‚æœå­”å¾„å°äºæ³¢é•¿,èƒ½é‡ä¸ä¼šè¾å°„åˆ°å‘¨å›´ï¼Œè€Œæ˜¯ä¿æŒç›´çº¿çŠ¶æ€ï¼ˆå…‰è¡å°„çš„åŸç†ï¼‰,ä»è€Œå¯èµ·ä¿æŠ¤ä½œç”¨ã€‚åŒç†,åœ¨ä¸€ä¸ªååº”ç®¡(SMRTCell:å•åˆ†å­å®æ—¶ååº”å­”)ä¸­æœ‰è®¸å¤šè¿™æ ·çš„åœ†å½¢çº³ç±³å°å­”, å³ ZMW(é›¶æ¨¡æ³¢å¯¼å­”),å¤–å¾„ 100å¤šçº³ç±³,æ¯”æ£€æµ‹æ¿€å…‰æ³¢é•¿å°(æ•°ç™¾çº³ç±³),æ¿€å…‰ä»åº•éƒ¨æ‰“ä¸Šå»åä¸èƒ½ç©¿é€å°å­”è¿›å…¥ä¸Šæ–¹æº¶æ¶²åŒº,èƒ½é‡è¢«é™åˆ¶åœ¨ä¸€ä¸ªå°èŒƒå›´(ä½“ç§¯20X 10-21 L)é‡Œ,æ­£å¥½è¶³å¤Ÿè¦†ç›–éœ€è¦æ£€æµ‹çš„éƒ¨åˆ†,ä½¿å¾—ä¿¡å·ä»…æ¥è‡ªè¿™ä¸ªå°ååº”åŒºåŸŸ,å­”å¤–è¿‡å¤šæ¸¸ç¦»æ ¸è‹·é…¸å•ä½“ä¾ç„¶ç•™åœ¨é»‘æš—ä¸­,ä»è€Œå®ç°å°†èƒŒæ™¯é™åˆ°æœ€ä½ã€‚å¦å¤–ï¼Œå¯ä»¥é€šè¿‡æ£€æµ‹ç›¸é‚»ä¸¤ä¸ªç¢±åŸºä¹‹é—´çš„æµ‹åºæ—¶é—´ï¼Œæ¥æ£€æµ‹ä¸€äº›ç¢±åŸºä¿®é¥°æƒ…å†µï¼Œæ—¢å¦‚æœç¢±åŸºå­˜åœ¨ä¿®é¥°ï¼Œåˆ™é€šè¿‡èšåˆé…¶æ—¶çš„é€Ÿåº¦ä¼šå‡æ…¢ï¼Œç›¸é‚»ä¸¤å³°ä¹‹é—´çš„è·ç¦»å¢å¤§ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ¥ä¹‹é—´æ£€æµ‹ç”²åŸºåŒ–ç­‰ä¿¡æ¯ï¼ˆå›¾7ï¼‰ã€‚SMRTæŠ€æœ¯çš„æµ‹åºé€Ÿåº¦å¾ˆå¿«ï¼Œæ¯ç§’çº¦10ä¸ªdNTPã€‚ä½†æ˜¯ï¼ŒåŒæ—¶å…¶æµ‹åº<font color="red">é”™è¯¯ç‡æ¯”è¾ƒé«˜</font>ï¼ˆè¿™å‡ ä¹æ˜¯ç›®å‰å•åˆ†å­æµ‹åºæŠ€æœ¯çš„é€šç—…ï¼‰ï¼Œè¾¾åˆ°<font color="red">15%</font>,ä½†å¥½åœ¨å®ƒçš„å‡ºé”™æ˜¯éšæœºçš„ï¼Œå¹¶ä¸ä¼šåƒç¬¬äºŒä»£æµ‹åºæŠ€æœ¯é‚£æ ·å­˜åœ¨æµ‹åºé”™è¯¯çš„åå‘ï¼Œå› è€Œå¯ä»¥é€šè¿‡<font color="red">å¤šæ¬¡æµ‹åºæ¥è¿›è¡Œæœ‰æ•ˆçš„çº é”™</font>ã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/11.png" alt="img"></p>
<p>Oxford Nanopore Technologieså…¬å¸æ‰€å¼€å‘çš„çº³ç±³å•åˆ†å­æµ‹åºæŠ€æœ¯ä¸ä»¥å¾€çš„æµ‹åºæŠ€æœ¯çš†ä¸åŒï¼Œå®ƒæ˜¯åŸºäºç”µä¿¡å·è€Œä¸æ˜¯å…‰ä¿¡å·çš„æµ‹åºæŠ€æœ¯ã€‚è¯¥æŠ€æœ¯çš„å…³é”®ä¹‹ä¸€æ˜¯ï¼Œä»–ä»¬è®¾è®¡äº†ä¸€ç§ç‰¹æ®Šçš„çº³ç±³å­”ï¼Œå­”å†…å…±ä»·ç»“åˆæœ‰åˆ†å­æ¥å¤´ã€‚å½“DNAç¢±åŸºé€šè¿‡çº³ç±³å­”æ—¶ï¼Œå®ƒä»¬ä½¿ç”µè·å‘ç”Ÿå˜åŒ–ï¼Œä»è€ŒçŸ­æš‚åœ°å½±å“æµè¿‡çº³ç±³å­”çš„ç”µæµå¼ºåº¦ï¼ˆæ¯ç§ç¢±åŸºæ‰€å½±å“çš„ç”µæµå˜åŒ–å¹…åº¦æ˜¯ä¸åŒçš„ï¼‰ï¼Œçµæ•çš„ç”µå­è®¾å¤‡æ£€æµ‹åˆ°è¿™äº›å˜åŒ–ä»è€Œé‰´å®šæ‰€é€šè¿‡çš„ç¢±åŸºã€‚</p>
<p>ã€€ã€€è¯¥å…¬å¸åœ¨å»å¹´åŸºå› ç»„ç”Ÿç‰©å­¦æŠ€æœ¯è¿›å±•å¹´ä¼š(AGBT)ä¸Šæ¨å‡ºç¬¬ä¸€æ¬¾å•†ä¸šåŒ–çš„çº³ç±³å­”æµ‹åºä»ªï¼Œå¼•èµ·äº†ç§‘å­¦ç•Œçš„æå¤§å…³æ³¨ã€‚çº³ç±³å­”æµ‹åºï¼ˆå’Œå…¶ä»–ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯ï¼‰æœ‰æœ›è§£å†³ç›®å‰æµ‹åºå¹³å°çš„ä¸è¶³ï¼Œçº³ç±³å­”æµ‹åºçš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šè¯»é•¿å¾ˆé•¿ï¼Œå¤§çº¦åœ¨å‡ åkbï¼Œç”šè‡³100 kb;é”™è¯¯ç‡ç›®å‰ä»‹äº1%è‡³4%ï¼Œä¸”æ˜¯éšæœºé”™è¯¯ï¼Œè€Œä¸æ˜¯èšé›†åœ¨è¯»å–çš„ä¸¤ç«¯;æ•°æ®å¯å®æ—¶è¯»å–;é€šé‡å¾ˆé«˜(30xäººç±»åŸºå› ç»„æœ‰æœ›åœ¨ä¸€å¤©å†…å®Œæˆ);èµ·å§‹DNAåœ¨æµ‹åºè¿‡ç¨‹ä¸­ä¸è¢«ç ´å;ä»¥åŠæ ·å“åˆ¶å¤‡ç®€å•åˆä¾¿å®œã€‚ç†è®ºä¸Šï¼Œå®ƒä¹Ÿèƒ½ç›´æ¥æµ‹åºRNAã€‚</p>
<p>ã€€ã€€çº³ç±³å­”å•åˆ†å­æµ‹åºè®¡ç®—è¿˜æœ‰å¦ä¸€å¤§ç‰¹ç‚¹ï¼Œå®ƒèƒ½å¤Ÿç›´æ¥è¯»å–å‡ºç”²åŸºåŒ–çš„èƒå˜§å•¶ï¼Œè€Œä¸å¿…åƒä¼ ç»Ÿæ–¹æ³•é‚£æ ·å¯¹åŸºå› ç»„è¿›è¡Œbisulfiteå¤„ç†ã€‚è¿™å¯¹äºåœ¨åŸºå› ç»„æ°´å¹³ç›´æ¥ç ”ç©¶è¡¨è§‚é—ä¼ ç›¸å…³ç°è±¡æœ‰æå¤§çš„å¸®åŠ©ã€‚å¹¶ä¸”æ”¹æ–¹æ³•çš„æµ‹åºå‡†ç¡®æ€§å¯è¾¾99.8%ï¼Œè€Œä¸”ä¸€æ—¦å‘ç°æµ‹åºé”™è¯¯ä¹Ÿèƒ½è¾ƒå®¹æ˜“åœ°è¿›è¡Œçº æ­£ã€‚ä½†ç›®å‰ä¼¼ä¹è¿˜æ²¡æœ‰åº”ç”¨è¯¥æŠ€æœ¯çš„ç›¸å…³æŠ¥é“ã€‚</p>
<p><img src="/blog/2022/02/20/2022-02-20-HiFi-1/12.png" alt="img"></p>
<h1 id="å…¶ä»–æµ‹åºæŠ€æœ¯"><a href="#å…¶ä»–æµ‹åºæŠ€æœ¯" class="headerlink" title="å…¶ä»–æµ‹åºæŠ€æœ¯"></a>å…¶ä»–æµ‹åºæŠ€æœ¯</h1><p>ç›®å‰è¿˜æœ‰ä¸€ç§åŸºäºåŠå¯¼ä½“èŠ¯ç‰‡çš„æ–°ä¸€ä»£é©å‘½æ€§æµ‹åºæŠ€æœ¯â€”â€”Ion Torrent6ã€‚è¯¥æŠ€æœ¯ä½¿ç”¨äº†ä¸€ç§å¸ƒæ»¡å°å­”çš„é«˜å¯†åº¦åŠå¯¼ä½“èŠ¯ç‰‡ï¼Œ ä¸€ä¸ªå°å­”å°±æ˜¯ä¸€ä¸ªæµ‹åºååº”æ± ã€‚å½“DNAèšåˆé…¶æŠŠæ ¸è‹·é…¸èšåˆåˆ°å»¶ä¼¸ä¸­çš„DNAé“¾ä¸Šæ—¶ï¼Œä¼šé‡Šæ”¾å‡ºä¸€ä¸ªæ°¢ç¦»å­ï¼Œååº”æ± ä¸­çš„PHå‘ç”Ÿæ”¹å˜ï¼Œä½äºæ± ä¸‹çš„ç¦»å­æ„Ÿå—å™¨æ„Ÿå—åˆ°H+ç¦»å­ä¿¡å·ï¼ŒH+ç¦»å­ä¿¡å·å†ç›´æ¥è½¬åŒ–ä¸ºæ•°å­—ä¿¡å·ï¼Œä»è€Œè¯»å‡ºDNAåºåˆ—ï¼ˆå›¾9ï¼‰ã€‚è¿™ä¸€æŠ€æœ¯çš„å‘æ˜äººåŒæ—¶ä¹Ÿæ˜¯454æµ‹åºæŠ€æœ¯çš„å‘æ˜äººä¹‹ä¸€â€”â€”Jonathan Rothbergï¼Œå®ƒçš„æ–‡åº“å’Œæ ·æœ¬åˆ¶å¤‡è·Ÿ454æŠ€æœ¯å¾ˆåƒï¼Œç”šè‡³å¯ä»¥è¯´å°±æ˜¯454çš„ç¿»ç‰ˆï¼Œåªæ˜¯æµ‹åºè¿‡ç¨‹ä¸­ä¸æ˜¯é€šè¿‡æ£€æµ‹ç„¦ç£·é…¸è§å…‰æ˜¾è‰²ï¼Œè€Œæ˜¯é€šè¿‡æ£€æµ‹H+ä¿¡å·çš„å˜åŒ–æ¥è·å¾—åºåˆ—ç¢±åŸºä¿¡æ¯ã€‚Ion Torrentç›¸æ¯”äºå…¶ä»–æµ‹åºæŠ€æœ¯æ¥è¯´ï¼Œä¸éœ€è¦æ˜‚è´µçš„ç‰©ç†æˆåƒç­‰è®¾å¤‡ï¼Œå› æ­¤ï¼Œæˆæœ¬ç›¸å¯¹æ¥è¯´ä¼šä½ï¼Œä½“ç§¯ä¹Ÿä¼šæ¯”è¾ƒå°ï¼ŒåŒæ—¶æ“ä½œä¹Ÿè¦æ›´ä¸ºç®€å•ï¼Œé€Ÿåº¦ä¹Ÿç›¸å½“å¿«é€Ÿï¼Œé™¤äº†2å¤©æ–‡åº“åˆ¶ä½œæ—¶é—´ï¼Œæ•´ä¸ªä¸Šæœºæµ‹åºå¯åœ¨2-3.5å°æ—¶å†…å®Œæˆï¼Œä¸è¿‡æ•´ä¸ªèŠ¯ç‰‡çš„é€šé‡å¹¶ä¸é«˜ï¼Œç›®å‰æ˜¯10Gå·¦å³ï¼Œä½†éå¸¸é€‚åˆå°åŸºå› ç»„å’Œå¤–æ˜¾å­éªŒè¯çš„æµ‹åºã€‚    </p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä»¥ä¸Šï¼Œå¯¹å„ä»£æµ‹åºæŠ€æœ¯çš„åŸç†åšäº†ç®€è¦çš„é˜è¿°ï¼Œè¿™ä¸‰ä»£æµ‹åºæŠ€æœ¯çš„ç‰¹ç‚¹æ¯”è¾ƒæ±‡æ€»åœ¨ä»¥ä¸‹è¡¨1å’Œè¡¨2ä¸­ã€‚å…¶ä¸­æµ‹åºæˆæœ¬ï¼Œè¯»é•¿å’Œé€šé‡æ˜¯è¯„ä¼°è¯¥æµ‹åºæŠ€æœ¯å…ˆè¿›ä¸å¦çš„ä¸‰ä¸ªé‡è¦æŒ‡æ ‡ã€‚ç¬¬ä¸€ä»£å’Œç¬¬äºŒä»£æµ‹åºæŠ€æœ¯é™¤äº†é€šé‡å’Œæˆæœ¬ä¸Šçš„å·®å¼‚ä¹‹å¤–ï¼Œå…¶æµ‹åºæ ¸å¿ƒåŸç†ï¼ˆé™¤Solidæ˜¯è¾¹è¿æ¥è¾¹æµ‹åºä¹‹å¤–ï¼‰éƒ½æ˜¯åŸºäºè¾¹åˆæˆè¾¹æµ‹åºçš„æ€æƒ³ã€‚ç¬¬äºŒä»£æµ‹åºæŠ€æœ¯çš„ä¼˜ç‚¹æ˜¯æˆæœ¬è¾ƒä¹‹ä¸€ä»£å¤§å¤§ä¸‹é™ï¼Œé€šé‡å¤§å¤§æå‡ï¼Œä½†ç¼ºç‚¹æ˜¯æ‰€å¼•å…¥PCRè¿‡ç¨‹ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ æµ‹åºçš„é”™è¯¯ç‡ï¼Œå¹¶ä¸”å…·æœ‰ç³»ç»Ÿåå‘æ€§ï¼ŒåŒæ—¶è¯»é•¿ä¹Ÿæ¯”è¾ƒçŸ­ã€‚ç¬¬ä¸‰ä»£æµ‹åºæŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³ç¬¬äºŒä»£æ‰€å­˜åœ¨çš„ç¼ºç‚¹è€Œå¼€å‘çš„ï¼Œå®ƒçš„æ ¹æœ¬ç‰¹ç‚¹æ˜¯å•åˆ†å­æµ‹åºï¼Œä¸éœ€è¦ä»»ä½•PCRçš„è¿‡ç¨‹ï¼Œè¿™æ˜¯ä¸ºäº†èƒ½æœ‰æ•ˆé¿å…å› PCRåå‘æ€§è€Œå¯¼è‡´çš„ç³»ç»Ÿé”™è¯¯ï¼ŒåŒæ—¶æé«˜è¯»é•¿ï¼Œå¹¶è¦ä¿æŒäºŒä»£æŠ€æœ¯çš„é«˜é€šé‡ï¼Œä½æˆæœ¬çš„ä¼˜ç‚¹ã€‚</p>
<table>
<thead>
<tr>
<th><strong>ç¬¬<strong><strong>X</strong></strong>ä»£</strong></th>
<th><strong>å…¬å¸</strong></th>
<th><strong>å¹³å°åç§°</strong></th>
<th><strong>æµ‹åºæ–¹æ³•</strong></th>
<th><strong>æ£€æµ‹æ–¹æ³•</strong></th>
<th><strong>å¤§çº¦è¯»é•¿</strong><strong>(<strong><strong>ç¢±åŸºæ•°</strong></strong>)</strong></th>
<th><strong>ä¼˜ç‚¹</strong></th>
<th><strong>ç›¸å¯¹å±€é™æ€§</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ç¬¬ä¸€ä»£</td>
<td>ABI/ç”Ÿå‘½æŠ€æœ¯å…¬å¸</td>
<td>3130xL-3730xL</td>
<td>æ¡‘æ ¼-æ¯›ç»†ç®¡ç”µæ³³æµ‹åºæ³•</td>
<td>è§å…‰/å…‰å­¦</td>
<td>600-1000</td>
<td>é«˜è¯»é•¿ï¼Œå‡†ç¡®åº¦ä¸€æ¬¡æ€§è¾¾æ ‡ç‡é«˜ï¼Œèƒ½å¾ˆå¥½å¤„ç†é‡å¤åºåˆ—å’Œå¤šèšåºåˆ—</td>
<td>é€šé‡ä½ï¼›æ ·å“åˆ¶å¤‡æˆæœ¬é«˜ï¼Œä½¿ä¹‹éš¾ä»¥åšå¤§é‡çš„å¹³è¡Œæµ‹åº</td>
</tr>
<tr>
<td>ç¬¬ä¸€ä»£</td>
<td>è´å…‹æ›¼</td>
<td>GeXPé—ä¼ åˆ†æç³»ç»Ÿ</td>
<td>æ¡‘æ ¼-æ¯›ç»†ç®¡ç”µæ³³æµ‹åºæ³•</td>
<td>è§å…‰/å…‰å­¦</td>
<td>600-1000</td>
<td>é«˜è¯»é•¿ï¼Œå‡†ç¡®åº¦ä¸€æ¬¡æ€§è¾¾æ ‡ç‡é«˜ï¼Œèƒ½å¾ˆå¥½å¤„ç†é‡å¤åºåˆ—å’Œå¤šèšåºåˆ—ï¼›æ˜“å°å‹åŒ–</td>
<td>é€šé‡ä½ï¼›å•ä¸ªæ ·å“çš„åˆ¶å¤‡æˆæœ¬ç›¸å¯¹è¾ƒé«˜</td>
</tr>
<tr>
<td>ç¬¬äºŒä»£</td>
<td>Roche/454</td>
<td>åŸºå› ç»„æµ‹åºä»ªFLXç³»ç»Ÿ</td>
<td>ç„¦ç£·é…¸æµ‹åºæ³•</td>
<td>å…‰å­¦</td>
<td>230-400</td>
<td>åœ¨ç¬¬äºŒä»£ä¸­æœ€é«˜è¯»é•¿ï¼›æ¯”ç¬¬ä¸€ä»£çš„æµ‹åºé€šé‡å¤§</td>
<td>æ ·å“åˆ¶å¤‡è¾ƒéš¾ï¼›éš¾äºå¤„ç†é‡å¤å’ŒåŒç§ç¢±åŸºå¤šèšåŒºåŸŸï¼›è¯•å‰‚å†²æ´—å¸¦æ¥é”™è¯¯ç´¯ç§¯ï¼›ä»ªå™¨æ˜‚è´µ</td>
</tr>
<tr>
<td>ç¬¬äºŒä»£</td>
<td>Illumina</td>
<td>HiSeq2000,HiSeq2500/MiSeq</td>
<td>å¯é€†é“¾ç»ˆæ­¢ç‰©å’Œåˆæˆæµ‹åºæ³•</td>
<td>è§å…‰/å…‰å­¦</td>
<td><strong>2x150</strong></td>
<td>å¾ˆé«˜æµ‹åºé€šé‡</td>
<td>ä»ªå™¨æ˜‚è´µï¼›ç”¨äºæ•°æ®åˆ èŠ‚å’Œåˆ†æçš„è´¹ç”¨å¾ˆé«˜</td>
</tr>
<tr>
<td>ç¬¬äºŒä»£</td>
<td>ABI/Solid</td>
<td>5500xlSolidç³»ç»Ÿ</td>
<td>è¿æ¥æµ‹åºæ³•</td>
<td>è§å…‰/å…‰å­¦</td>
<td>25-35</td>
<td>å¾ˆé«˜æµ‹åºé€šé‡ï¼›åœ¨å¹¿ä¸ºæ¥å—çš„å‡ ç§ç¬¬äºŒä»£å¹³å°ä¸­ï¼Œæ‰€è¦æ‹¼æ¥å‡ºäººç±»åŸºå› ç»„çš„è¯•å‰‚æˆæœ¬æœ€ä½</td>
<td>æµ‹åºè¿è¡Œæ—¶é—´é•¿ï¼›è¯»é•¿çŸ­ï¼Œé€ æˆæˆæœ¬é«˜ï¼Œæ•°æ®åˆ†æå›°éš¾å’ŒåŸºå› ç»„æ‹¼æ¥å›°éš¾ï¼›ä»ªå™¨æ˜‚è´µ</td>
</tr>
<tr>
<td>ç¬¬äºŒä»£</td>
<td>èµ«åˆ©å…‹æ–¯</td>
<td>Heliscope</td>
<td>å•åˆ†å­åˆæˆæµ‹åºæ³•</td>
<td>è§å…‰/å…‰å­¦</td>
<td>25-30</td>
<td>é«˜é€šé‡ï¼›åœ¨ç¬¬äºŒä»£ä¸­å±äºå•åˆ†å­æ€§è´¨çš„æµ‹åºæŠ€æœ¯</td>
<td>è¯»é•¿çŸ­ï¼Œæ¨é«˜äº†æµ‹åºæˆæœ¬ï¼Œé™ä½äº†åŸºå› ç»„æ‹¼æ¥çš„è´¨é‡ï¼›ä»ªå™¨éå¸¸æ˜‚è´µ</td>
</tr>
<tr>
<td>ç¬¬ä¸‰ä»£</td>
<td>å¤ªå¹³æ´‹ç”Ÿç‰©ç§‘å­¦å…¬å¸</td>
<td>PacBio RS</td>
<td>å®æ—¶å•åˆ†å­DNAæµ‹åº</td>
<td>è§å…‰/å…‰å­¦</td>
<td>~1000</td>
<td>é«˜å¹³å‡è¯»é•¿ï¼Œæ¯”ç¬¬ä¸€ä»£çš„æµ‹åºæ—¶é—´é™ä½ï¼›ä¸éœ€è¦æ‰©å¢ï¼›æœ€é•¿å•ä¸ªè¯»é•¿æ¥è¿‘3000ç¢±åŸº</td>
<td>å¹¶ä¸èƒ½é«˜æ•ˆåœ°å°†DNAèšåˆé…¶åŠ åˆ°æµ‹åºé˜µåˆ—ä¸­ï¼›å‡†ç¡®æ€§ä¸€æ¬¡æ€§è¾¾æ ‡çš„æœºä¼šä½ï¼ˆ81-83%ï¼‰ï¼›DNAèšåˆé…¶åœ¨é˜µåˆ—ä¸­é™è§£ï¼›æ€»ä½“ä¸Šæ¯ä¸ªç¢±åŸºæµ‹åºæˆæœ¬é«˜ï¼ˆä»ªå™¨æ˜‚è´µï¼‰ï¼›</td>
</tr>
<tr>
<td>ç¬¬ä¸‰ä»£</td>
<td>å…¨åŸºå› ç»„å­¦å…¬å¸</td>
<td>GeXPé—ä¼ åˆ†æç³»ç»Ÿ</td>
<td>å¤åˆæ¢é’ˆé”šæ‚äº¤å’Œè¿æ¥æŠ€æœ¯</td>
<td>è§å…‰/å…‰å­¦</td>
<td>10</td>
<td>åœ¨ç¬¬ä¸‰ä»£ä¸­é€šé‡æœ€é«˜ï¼›åœ¨æ‰€æœ‰æµ‹åºæŠ€æœ¯ä¸­ï¼Œç”¨äºæ‹¼æ¥ä¸€ä¸ªäººåŸºå› ç»„çš„è¯•å‰‚æˆæœ¬æœ€ä½ï¼›æ¯ä¸ªæµ‹åºæ­¥éª¤ç‹¬ç«‹ï¼Œä½¿é”™è¯¯çš„ç´¯ç§¯å˜å¾—æœ€ä½</td>
<td>ä½è¯»é•¿ï¼› æ¨¡æ¿åˆ¶å¤‡å¦¨ç¢é•¿é‡å¤åºåˆ—åŒºåŸŸæµ‹åºï¼›æ ·å“åˆ¶å¤‡è´¹äº‹ï¼›å°šæ— å•†ä¸šåŒ–ä¾›åº”çš„ä»ªå™¨</td>
</tr>
<tr>
<td>ç¬¬ä¸‰ä»£</td>
<td>Ion Torrent/ç”Ÿå‘½æŠ€æœ¯å…¬å¸</td>
<td>ä¸ªäººåŸºå› ç»„æµ‹åºä»ªï¼ˆPGMï¼‰</td>
<td>åˆæˆæµ‹åºæ³•</td>
<td>ä»¥ç¦»å­æ•æ„Ÿåœºæ•ˆåº”æ™¶ä½“ç®¡æ£€æµ‹pHå€¼å˜åŒ–</td>
<td>100-200</td>
<td>å¯¹æ ¸é…¸ç¢±åŸºçš„æºå…¥å¯ç›´æ¥æµ‹å®šï¼›åœ¨è‡ªç„¶æ¡ä»¶ä¸‹è¿›è¡ŒDNAåˆæˆï¼ˆä¸éœ€è¦ä½¿ç”¨ä¿®é¥°è¿‡çš„ç¢±åŸºï¼‰</td>
<td>ä¸€æ­¥æ­¥çš„æ´—è„±è¿‡ç¨‹å¯å¯¼è‡´é”™è¯¯ç´¯ç§¯ï¼›é˜…è¯»é«˜é‡å¤å’ŒåŒç§å¤šèšåºåˆ—æ—¶æœ‰æ½œåœ¨å›°éš¾ï¼›</td>
</tr>
<tr>
<td>ç¬¬ä¸‰ä»£</td>
<td>ç‰›æ´¥çº³ç±³å­”å…¬å¸</td>
<td>gridION</td>
<td>çº³ç±³å­”å¤–åˆ‡é…¶æµ‹åº</td>
<td>ç”µæµ</td>
<td>å°šæœªå®šé‡</td>
<td>æœ‰æ½œåŠ›è¾¾åˆ°é«˜è¯»é•¿ï¼›å¯ä»¥æˆæœ¬ç”Ÿäº§çº³ç±³å­”ï¼›æ— éœ€è§å…‰æ ‡è®°æˆ–å…‰å­¦æ‰‹æ®µ</td>
<td>åˆ‡æ–­çš„æ ¸è‹·é…¸å¯èƒ½è¢«è¯»é”™æ–¹å‘ï¼›éš¾äºç”Ÿäº§å‡ºå¸¦å¤šé‡å¹³è¡Œå­”çš„è£…ç½®</td>
</tr>
</tbody></table>
<hr>
<p>ref</p>
<p><a href="https://www.cnblogs.com/huangshujia/p/3233693.html">https://www.cnblogs.com/huangshujia/p/3233693.html</a></p>
<p><a href="http://www.biomarker.com.cn/technology-services/denovo3">http://www.biomarker.com.cn/technology-services/denovo3</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/339875837">https://zhuanlan.zhihu.com/p/339875837</a></p>
]]></content>
      <categories>
        <category>biology</category>
      </categories>
      <tags>
        <tag>technique</tag>
      </tags>
  </entry>
  <entry>
    <title>assemble</title>
    <url>/blog/2022/02/19/2022-02-19_assembly/</url>
    <content><![CDATA[<p>Pacbio</p>
<span id="more"></span>

<p><a href="https://www.bilibili.com/video/BV1pD4y1R7nK">https://www.bilibili.com/video/BV1pD4y1R7nK</a></p>
<h1 id="1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ "><a href="#1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ " class="headerlink" title="1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ "></a>1ç›®æ ‡ï¼Œç°çŠ¶å’Œå½±å“å› ç´ </h1><h2 id="è¿½æ±‚"><a href="#è¿½æ±‚" class="headerlink" title="è¿½æ±‚"></a>è¿½æ±‚</h2><p>åŸºå› ç»„ç»„è£…ï¼šè¿ç»­åº¦contigN50ï¼Œå‡†ç¡®åº¦ï¼Œé€Ÿåº¦ã€‚</p>
<p>ä»ªå™¨ï¼šPacbio</p>
<p>å®éªŒï¼šCLRï¼ŒCCSæ–‡åº“</p>
<p>è½¯ä»¶ï¼šCanuï¼ŒFalconï¼ŒSmartdenovoï¼ŒWTDBG</p>
<h2 id="æŒ‘æˆ˜"><a href="#æŒ‘æˆ˜" class="headerlink" title="æŒ‘æˆ˜"></a>æŒ‘æˆ˜</h2><p>å¤æ‚åº¦ï¼šåŸºå› ç»„é‡å¤åº¦ï¼Œæ‚åˆåº¦ã€‚<strong>Survey</strong></p>
<p>æ•°æ®é‡ï¼šCLRï¼š100Xå·¦å³ï¼›HIFIï¼š25Xï¼ˆçº é”™åï¼‰</p>
<p>ç®—æ³•æ˜¯å¦åˆé€‚ï¼šOLCï¼ŒDBG</p>
<p>æ•°æ®è´¨é‡ï¼šPacbioï¼šç¢±åŸºè´¨é‡ï¼ˆçº é”™CDSï¼ŸQ40ï¼Ÿï¼‰ï¼›ONTï¼šåºåˆ—é•¿åº¦</p>
<h1 id="2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•"><a href="#2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•" class="headerlink" title="2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•"></a>2åŸºå› ç»„ç»„è£…çš„è½¯ä»¶ä½¿ç”¨æ–¹æ³•</h1><h2 id="ç»„è£…è½¯ä»¶"><a href="#ç»„è£…è½¯ä»¶" class="headerlink" title="ç»„è£…è½¯ä»¶"></a>ç»„è£…è½¯ä»¶</h2><ul>
<li>Canuï¼šä¸‰ä»£æ•°æ®ä¸»æµè½¯ä»¶ï¼Œå…·æœ‰çº é”™ï¼Œä¿®æ­£å’Œç»„è£…åŠŸèƒ½</li>
</ul>
<p>æ¯”è¾ƒæ…¢ï¼Œå‡†ç¡®åº¦é«˜ï¼Œè¿ç»­åº¦è¡¨ç°ä¼˜ç§€çš„æ¦‚ç‡é«˜</p>
<ul>
<li>Falconï¼šPBå…¬å¸æ¨èï¼Œå¯ç”¨äºæ‚åˆåº¦è¾ƒé«˜æˆ–äº²ç¼˜å…³ç³»è¾ƒè¿œç‰©ç§ç»„è£…</li>
</ul>
<p>é€‚åˆä¸€å®šçš„æ‚åˆåŸºå› ç»„ï¼Œå¯ä»¥è£…å‡ºhaplotypeåŒºåŸŸï¼Œä¸€å®šæ‚åˆçš„åŸºå› å¯ä»¥åˆ©ç”¨hicæ•°æ®è¿›è¡ŒMbçº§åˆ«çš„phasing</p>
<ul>
<li>Smart Denovoé€‚ç”¨PBå’ŒONTï¼Œæ— çº é”™</li>
<li>WTDBGï¼šå†…å­˜åŠå­˜å‚¨å ç”¨å°‘ï¼Œé€Ÿåº¦å¿«</li>
</ul>
<p>é€Ÿåº¦å¿«ï¼Œå¯¹é‡å¤åºåˆ—æ•æ„Ÿï¼Œç®€å•åŸºå› ç»„ç»„è£…æ•ˆæœæ¯”è¾ƒå¥½</p>
<ul>
<li>Hifiasmï¼šé€‚ç”¨HiFiã€‚é€Ÿåº¦å¿«ï¼Œè¿ç»­åº¦é«˜ï¼Œå®Œæ•´æ€§é«˜</li>
<li>HiCanuï¼šé€‚ç”¨HiFi</li>
<li>æ ¹æ®åŸºå› ç»„ç‰¹å¾ï¼Œé€‰æ‹©åˆé€‚è½¯ä»¶è¿›è¡Œç»„è£…æˆ–è€…å¤šè½¯ä»¶é…åˆä½¿ç”¨ç»„è£…è·å¾—é«˜è´¨é‡ç‰©ç§åŸºå› ç»„</li>
</ul>
<h2 id="è¯„ä¼°è½¯ä»¶"><a href="#è¯„ä¼°è½¯ä»¶" class="headerlink" title="è¯„ä¼°è½¯ä»¶"></a>è¯„ä¼°è½¯ä»¶</h2><ul>
<li>BUSCO</li>
<li></li>
</ul>
<h1 id="3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ"><a href="#3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ" class="headerlink" title="3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ"></a>3è¶…å¤§åŸºå› ç»„çš„ç»„è£…ç»éªŒ</h1><p>æ•°æ®é‡å¤§ï¼šè¿ç®—é‡å¤§ï¼Œè½¯ä»¶é€‚åº”æ€§ï¼Œç»„è£…ç»“æœï¼Œå­˜å‚¨éœ€æ±‚</p>
<h1 id="4åŸºå› ç»„ç»„è£…å±•æœ›"><a href="#4åŸºå› ç»„ç»„è£…å±•æœ›" class="headerlink" title="4åŸºå› ç»„ç»„è£…å±•æœ›"></a>4åŸºå› ç»„ç»„è£…å±•æœ›</h1><p>CSSç»„è£…ï¼Œæœªæ¥è¶‹åŠ¿ã€‚</p>
<hr>
<h1 id="ä¸‰ä»£æ•°æ®é¢„å¤„ç†"><a href="#ä¸‰ä»£æ•°æ®é¢„å¤„ç†" class="headerlink" title="ä¸‰ä»£æ•°æ®é¢„å¤„ç†"></a>ä¸‰ä»£æ•°æ®é¢„å¤„ç†</h1><h2 id="äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®"><a href="#äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®" class="headerlink" title="äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®"></a>äº†è§£ä¸‰ä»£æ•°æ®é¢„å¤„ç†ä¸­çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®</h2><h2 id="ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹"><a href="#ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹" class="headerlink" title="ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹"></a>ä¸‰ä»£ä¸Šæœºæ–‡åº“ç®€ä»‹</h2><h2 id="äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•"><a href="#äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•" class="headerlink" title="äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•"></a>äº†è§£æ•°æ®è´¨é‡çŸ«æ­£çš„æ–¹æ³•</h2><h2 id="å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”"><a href="#å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”" class="headerlink" title="å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”"></a>å¦‚ä½•è¯„ä»·æ•°æ®è´¨é‡å’Œæœ‰æ•ˆäº§å‡ºæ¯”</h2>]]></content>
      <categories>
        <category>assemble</category>
      </categories>
      <tags>
        <tag>technique</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>/blog/2022/02/18/20220218-ggplot2/</url>
    <content><![CDATA[<h1 id><a href="#" class="headerlink" title></a></h1><p>reorderé™åºå®ç°(åŠ **<font color="red">-</font>**å·)ï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">ggplot(data,aes(x=reorder(v1,v2),y=v2))+genom_bar(stat = <span class="string">&quot;identity&quot;</span>)</span><br><span class="line"></span><br><span class="line">ggplot(data,aes(x=reorder(v1,-v2),y=v2))+genom_bar(stat = <span class="string">&quot;identity&quot;</span>)</span><br></pre></td></tr></table></figure>



]]></content>
  </entry>
  <entry>
    <title>æŸ“è‰²è´¨ä¸‰ç»´ç»“æ„å›¾è°± Hi-C</title>
    <url>/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/</url>
    <content><![CDATA[<h1 id="Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚"><a href="#Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚" class="headerlink" title="Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚"></a>Hi-CæŠ€æœ¯ï¼Œä»¥é«˜é€šé‡æµ‹åºä¸ºæ‰‹æ®µï¼Œä»¥3CæŠ€æœ¯ä¸ºåŸºç¡€çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯ã€‚-ä¸‰ç»´åŸºå› ç»„ã€‚</h1><span id="more"></span>

<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/0.png" alt="img"></p>
<h1 id="1-CæŠ€æœ¯"><a href="#1-CæŠ€æœ¯" class="headerlink" title="1. CæŠ€æœ¯"></a>1. CæŠ€æœ¯</h1><h2 id="1-1-3Cï¼ˆä¸€å¯¹ä¸€ï¼‰"><a href="#1-1-3Cï¼ˆä¸€å¯¹ä¸€ï¼‰" class="headerlink" title="1.1 3Cï¼ˆä¸€å¯¹ä¸€ï¼‰"></a>1.1 3Cï¼ˆä¸€å¯¹ä¸€ï¼‰</h2><ul>
<li><p>åŸºå› ç»„æ•è·æŠ€æœ¯ï¼ˆChromosome conformation captureï¼Œ3Cï¼‰æ˜¯æœ€æ—©ç ”ç©¶ä¸‰ç»´åŸºå› ç»„çš„æŠ€æœ¯ï¼Œéœ€è¦<font color="green">æå‰çŸ¥é“äº’ä½œåŒºåŸŸ</font>ï¼Œæ‰èƒ½<font color="green">é‡åŒ–ä¸€å¯¹åŸºå› ç»„åŸºå› åº§ä¹‹é—´çš„äº’ä½œ</font>ã€‚</p>
</li>
<li><p>3CæŠ€æœ¯2002å¹´Dekeræå‡ºï¼Œç›®çš„æ•è·æŸ“è‰²ä½“çš„interactionï¼Œå‡è®¾æŸ“è‰²ä½“ä¸­çš„interactionä»¥è›‹ç™½ä¸ºä»‹å¯¼ã€‚é€šè¿‡é™åˆ¶é…¶é…¶åˆ‡ï¼Œè¡¥å¹³ï¼Œè¿æ¥ï¼Œæ‰“æ–­ï¼ŒPCRåï¼Œè‹¥æŸ“è‰²ä½“Aï¼ŒBä¸¤ç‚¹ç›¸äº’ä½œç”¨ï¼Œæ ¹æ®è¿™ä¸¤ç‚¹ç‰¹å¼‚åºåˆ—çš„å¼•ç‰©èƒ½PCRå‡ºäº§ç‰©ï¼ŒéªŒè¯interactionã€‚æ¯<font color="green">ä¸€å¯¹ä½ç‚¹çš„éªŒè¯</font>éœ€è¦<font color="green">è®¾è®¡ä¸€å¯¹ç‰¹å¼‚æ€§å¼•ç‰©</font>ã€‚</p>
</li>
</ul>
<h2 id="1-2-4Cï¼ˆä¸€å¯¹å¤šï¼‰"><a href="#1-2-4Cï¼ˆä¸€å¯¹å¤šï¼‰" class="headerlink" title="1.2 4Cï¼ˆä¸€å¯¹å¤šï¼‰"></a>1.2 4Cï¼ˆä¸€å¯¹å¤šï¼‰</h2><ul>
<li><p>æŸ“è‰²ä½“æ„è±¡æ•è·èŠ¯ç‰‡ï¼ˆChromosome conformation capture-on-chipï¼Œ4C ï¼‰ï¼Œå¯ä»¥æ•è·<font color="green">ä¸€ä¸ªåŸºå› åŒºåŸŸ</font>å’Œå…¶ä»–åŒºåŸŸé—´çš„äº’ç›¸ä½œç”¨ã€‚è¯¥æŠ€æœ¯ä¸éœ€è¦çŸ¥é“ä½œç”¨åŒºåŸŸçš„å…ˆéªŒçŸ¥è¯†å°±å¯ä»¥ä½¿ç”¨ã€‚</p>
</li>
<li><p>3Cè¾ƒéº»çƒ¦ï¼Œåè®¾è®¡åŒé…¶åˆ‡ä½ç‚¹ï¼Œç„¶å<font color="green">æˆç¯</font>ï¼Œä¿è¯åªéœ€è¦è®¾è®¡ä¸€å¯¹å¼•ç‰©å°±å¯ä»¥æ£€æµ‹ä¸€ä¸ªä½ç‚¹å¯¹å¤šä¸ªä½ç‚¹çš„ç›¸äº’ä½œç”¨ï¼Œ4Cæœ‰circleçš„æ„æ€ã€‚</p>
</li>
</ul>
<h2 id="1-3-5Cï¼ˆå¤šå¯¹å¤šï¼‰"><a href="#1-3-5Cï¼ˆå¤šå¯¹å¤šï¼‰" class="headerlink" title="1.3 5Cï¼ˆå¤šå¯¹å¤šï¼‰"></a>1.3 5Cï¼ˆå¤šå¯¹å¤šï¼‰</h2><p>æŸ“è‰²ä½“æ„è±¡æ•è·ç¢³æ‹·è´ï¼ˆChromosome conformation capture carbon copyï¼Œ5Cï¼‰ ï¼Œå¯ä»¥æ£€æµ‹<font color="green">æŸæ®µåŒºåŸŸå†…æ‰€æœ‰çš„äº’ä½œ</font>ï¼Œä½†æ˜¯è¯¥<font color="red">åŒºåŸŸä¸€èˆ¬&lt;1 Mb</font>ã€‚è¦†ç›–åº¦é—®é¢˜é€ æˆè¯¥æŠ€æœ¯<font color="green">ä¸é€‚ç”¨äºå…¨åŸºå› ç»„æµ‹åº</font>ã€‚</p>
<h2 id="1-4-Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰"><a href="#1-4-Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰" class="headerlink" title="1.4 Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰"></a>1.4 <font color="red">Hi-Cï¼ˆå…¨éƒ¨äº’ä½œï¼‰</font></h2><ul>
<li><p>é«˜é€šé‡åŸºå› ç»„æ•è·æŠ€æœ¯ï¼ˆHigh-throughput/resolution chromosome conformation captureï¼‰ï¼ŒåŸºæœ¬è§£å†³äº†ä¸Šè¿°æŠ€æœ¯çš„ç¼ºç‚¹ï¼Œå¯ä»¥å®ç°<font color="green">å…¨åŸºå› ç»„è¦†ç›–</font>æ£€æµ‹<font color="green">å…¨éƒ¨æœªçŸ¥äº’ä½œåŒºåŸŸ</font>ã€‚</p>
</li>
<li><p>Hi-CåŸºæœ¬æ­¥éª¤ï¼Œç”²é†›äº¤è”ï¼Œé™åˆ¶é…¶åˆ‡ï¼Œæœ«ç«¯è¡¥å¹³åŠ biotinï¼Œå¹³æœ«ç«¯è¿æ¥ï¼Œè¶…å£°ç ´ç¢ï¼Œbiotinå¯Œé›†ï¼Œå»ºåº“æµ‹åºã€‚æ•´ä¸ªè¿‡ç¨‹æ²¡æœ‰ç‰¹å¼‚å¼•ç‰©å­˜åœ¨ã€‚</p>
</li>
<li><p>å°†çº¿æ€§è·ç¦»è¿œï¼Œç©ºé—´ç»“æ„è¿‘çš„DNAç‰‡æ®µè¿›è¡Œäº¤è”ï¼Œå¹¶å°†äº¤è”çš„DNAç‰‡æ®µå¯Œé›†ï¼Œé«˜é€šé‡æµ‹åºï¼Œå¯¹æµ‹åºæ•°æ®åˆ†æå¯ä»¥æ­ç¤ºæŸ“è‰²è´¨çš„è¿œç¨‹äº’ä½œï¼Œæ¨å¯¼å‡ºåŸºå› ç»„çš„ä¸‰ç»´ç©ºé—´ç»“æ„çš„å¯èƒ½çš„è®°å¿†ä¹‹é—´çš„è°ƒæ§å…³ç³»ã€‚</p>
</li>
<li><p>\1. é€šè¿‡Scaffoldé—´çš„äº¤äº’é¢‘ç‡å¤§å°ï¼Œå¯ä»¥å¯¹å·²ç»„è£…çš„åŸºå› ç»„åºåˆ—è¿›è¡Œçº é”™ï¼ˆåŸºå› ç»„æ›´å‡†ç¡®ï¼‰ã€‚</p>
<p>\2. åŸºå› ä¿¡æ¯ä¸å†ä»…ä»…æ˜¯contigç‰‡æ®µï¼Œè€Œæ˜¯è¢«åˆ’åˆ†è‡³æŸ“è‰²ä½“ä¸Šï¼Œæˆä¸ºæŸ“è‰²ä½“æ°´å¹³ã€‚</p>
<p>\3. æ— éœ€è¾›è‹¦çš„æ„å»ºç¾¤ä½“ï¼Œå•ä¸€ä¸€ä¸ªä½“å°±èƒ½å®ç°æŸ“è‰²ä½“å®šä½ã€‚</p>
<p>\4. ç›¸æ¯”é—ä¼ å›¾è°±ï¼Œæ ‡è®°å¯†åº¦æ›´å¤§ï¼Œåºåˆ—å®šä½æ›´å®Œæ•´ï¼ˆèƒ½æŠŠæ›´å¤šçš„contigæŒ‚è‡³æŸ“è‰²ä½“ä¸Š!ä¿¡æ¯æ›´å…¨é¢ï¼ï¼‰</p>
<p>\5. æŸ“è‰²ä½“é‡æ’ç­‰ç»“æ„å˜å¼‚ç ”ç©¶å¯ä»¥å¼€å±•å•¦~(ç ”ç©¶å¯ä»¥æ›´æ·±å…¥ï¼ï¼‰</p>
<p>\6. QTLã€GWASå¯ä»¥å®šä½åŒºé—´åˆ°æŸä¸ªæŸ“è‰²ä½“å•¦~ï¼ˆè¿½è¸ªå˜å¼‚ï¼ï¼‰</p>
<p>\7. è¯¥ç‰©ç§çš„ä¸‰ç»´åŸºå› ç»“æ„ã€æŸ“è‰²ä½“äº’ä½œåŠåŠ¨æ€å˜åŒ–å¯ä»¥è§£æå•¦~ï¼ˆä»åŸºå› åˆ°è¡¨è§‚ï¼å…¨æ–¹ä½è§£æï¼‰</p>
</li>
</ul>
<h2 id="1-5-ChIP-loop-åŸºäºå…ç–«æ²‰æ·€"><a href="#1-5-ChIP-loop-åŸºäºå…ç–«æ²‰æ·€" class="headerlink" title="1.5 ChIP-loop (åŸºäºå…ç–«æ²‰æ·€)"></a>1.5 ChIP-loop (åŸºäºå…ç–«æ²‰æ·€)</h2><p>è¯¥æŠ€æœ¯å°† 3C ä¸ ChIP-seq ç»“åˆï¼Œå¯ä»¥æ£€æµ‹<font color="red">ç›®çš„è›‹ç™½è´¨ä»‹å¯¼</font>çš„<font color="red">ä¸¤ä¸ªç›®çš„åŸºå› åŒºåŸŸäº’ä½œ</font>ã€‚</p>
<h2 id="1-6-ChIA-PET-åŸºäºå…ç–«æ²‰æ·€"><a href="#1-6-ChIA-PET-åŸºäºå…ç–«æ²‰æ·€" class="headerlink" title="1.6 ChIA-PET (åŸºäºå…ç–«æ²‰æ·€)"></a>1.6 ChIA-PET (åŸºäºå…ç–«æ²‰æ·€)</h2><p>è¯¥æŠ€æœ¯å°† HiC ä¸ ChIP-seq ç»“åˆï¼Œå¯ä»¥æ£€æµ‹<font color="red">ç›®çš„è›‹ç™½è´¨çš„æ‰€æœ‰äº’ç›¸ä½œç”¨</font>ã€‚ ç”¨ç‰¹å¼‚æ€§æŠ—ä½“å¯Œé›†interactionä¿¡æ¯ï¼Œæ¯”å¦‚CTCFï¼Œpol IIæŠ—ä½“ï¼Œç±»ä¼¼æ­¥éª¤å»ºåº“æµ‹åºã€‚<font color="red">ChIA-PETæ•°æ®æ˜¯Hi-Cæ•°æ®çš„å­é›†</font>ã€‚</p>
<hr>
<table>
<thead>
<tr>
<th></th>
<th>äº’ä½œ</th>
<th>è¦†ç›–</th>
<th>ä½œç”¨</th>
<th>ç ”ç©¶åº”ç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>3C</td>
<td>å•å¯¹å•</td>
<td>&lt;1Mb</td>
<td>æ£€æµ‹å·²çŸ¥<font color="red">åŸºå› ç»„åŸºå› åŒºåŸŸä¹‹é—´</font>çš„äº’ä½œ</td>
<td>ç¡®å®šå·²çŸ¥å¯åŠ¨å­å’Œå¢å¼ºå­ä¹‹é—´çš„äº’ä½œ</td>
</tr>
<tr>
<td>4C</td>
<td>ä¸€å¯¹å¤š</td>
<td>å…¨åŸºå› ç»„</td>
<td>ç¡®å®š<font color="red">åŸºå› æŸç»„åŒºåŸŸ</font>ä¸<font color="red">å…¶ä»–åŒºåŸŸçš„äº’ä½œ</font></td>
<td>ä¸å·²çŸ¥LCR(locus control regions)åŒºäº’ä½œçš„å…¨éƒ¨åŸºå› å’Œå…ƒä»¶</td>
</tr>
<tr>
<td>5C</td>
<td>å¤šå¯¹å¤š</td>
<td>&lt;1Mb</td>
<td>ç¡®å®š<font color="red">æŸ“è‰²ä½“ç‰¹å®šåŒºåŸŸ</font>çš„å…¨éƒ¨é«˜çº§ç»“æ„</td>
<td>ç¡®å®šæŸ“è‰²ä½“ç‰¹å®šåŒºåŸŸçš„å…¨éƒ¨é«˜çº§ç»“æ„</td>
</tr>
<tr>
<td>Hi-C</td>
<td>å…¨éƒ¨äº’ä½œ</td>
<td>å…¨åŸºå› ç»„</td>
<td>æ£€æµ‹<font color="red">å…¨åŸºå› ç»„</font>èŒƒå›´çš„<font color="red">å…¨éƒ¨é«˜çº§ç»“æ„</font></td>
<td>å…¨åŸºå› ç»„èŒƒå›´æ‰€æœ‰æŸ“è‰²ä½“äº’ä½œ</td>
</tr>
<tr>
<td>ChIP-loop</td>
<td>ä¸€å¯¹ä¸€</td>
<td>&lt;1Mb</td>
<td>æ£€æµ‹ç›®çš„è›‹ç™½ä»‹å¯¼çš„<font color="red">ä¸¤ä¸ªç›®çš„åŸºå› åŒºåŸŸäº’ä½œ</font></td>
<td></td>
</tr>
<tr>
<td>ChIA-PET</td>
<td>å…¨éƒ¨äº’ä½œ</td>
<td>å…¨åŸºå› ç»„</td>
<td>æ£€æµ‹<font color="red">ç›®çš„è›‹ç™½è´¨çš„æ‰€æœ‰äº’ä½œ</font></td>
<td>æ„å»ºå·²çŸ¥è½¬å½•å› å­ä»‹å¯¼çš„æŸ“è‰²è´¨äº’ä½œ</td>
</tr>
</tbody></table>
<hr>
<h1 id="2-æŠ€æœ¯åŸç†"><a href="#2-æŠ€æœ¯åŸç†" class="headerlink" title="2. æŠ€æœ¯åŸç†"></a>2. æŠ€æœ¯åŸç†</h1><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/1.png" alt="img"></p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/8.png" alt="img"></p>
<h2 id="2-1-ç”²é†›å›ºå®š"><a href="#2-1-ç”²é†›å›ºå®š" class="headerlink" title="2.1 ç”²é†›å›ºå®š"></a>2.1 ç”²é†›å›ºå®š</h2><p>å…ˆåŠ å…¥ç”²é†›å°†åŸºå› ç»„ä¸­å‚ä¸<font color="red">æŸ“è‰²è´¨äº’ä½œçš„è›‹ç™½è´¨å‡å›º</font>ã€‚ä¸€èˆ¬å°†æ´»ä½“æ ·æœ¬åœ¨å®¤æ¸©ç”¨ 1-3%çš„ç”²é†›å¤„ç† 10-30minï¼Œä½†æ˜¯æ­¤æ­¥éª¤ä¼š<font color="green">å‡å°‘é™åˆ¶å†…åˆ‡é…¶</font>å¯¹DNAåºåˆ—çš„æ¶ˆåŒ–<font color="green">æ•ˆç‡</font>ï¼Œéœ€è¦ä¸¥æ ¼æ§åˆ¶ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/2.png" alt="img"></p>
<h2 id="2-2-é…¶åˆ‡åºåˆ—"><a href="#2-2-é…¶åˆ‡åºåˆ—" class="headerlink" title="2.2 é…¶åˆ‡åºåˆ—"></a>2.2 é…¶åˆ‡åºåˆ—</h2><p>ç”¨é™åˆ¶æ€§å†…åˆ‡é…¶åˆ‡å‰²åŸºå› ç»„ï¼Œæ‰“æ–­åçš„ç‰‡æ®µå¤§å°ä¼šå½±å“æµ‹åºåˆ†è¾¨ç‡ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§é…¶å¯ä¾›é€‰æ‹©ï¼š6bp çš„é™åˆ¶æ€§å†…åˆ‡é…¶ï¼Œ4bp çš„é™åˆ¶æ€§å†…åˆ‡é…¶ã€‚åè€…å…·æœ‰æ›´é«˜çš„åˆ†è¾¨ç‡ã€‚EcoR1 æˆ– HindIII ç”¨äºæ¯4000bpåˆ‡å‰²ä¸€æ¬¡åŸºå› ç»„ï¼Œåœ¨äººç±»åŸºå› ç»„ä¸­äº§ç”Ÿçº¦100ä¸‡ä¸ªç‰‡æ®µã€‚<br><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/3.png" alt="img"></p>
<h2 id="2-3-æœ«ç«¯ä¿®å¤"><a href="#2-3-æœ«ç«¯ä¿®å¤" class="headerlink" title="2.3 æœ«ç«¯ä¿®å¤"></a>2.3 æœ«ç«¯ä¿®å¤</h2><p>å¾—åˆ°çš„ç‰‡æ®µå…·æœ‰å¹³æœ«ç«¯æˆ–ç²˜æ€§æœ«ç«¯ï¼Œç„¶åå°†<font color="red">æœ«ç«¯è¡¥å¹³ä¿®å¤ï¼ŒåŠ å…¥ç”Ÿç‰©ç´ </font>ã€‚ã€ç”Ÿç‰©ç´ pull-downä¿è¯åªæœ‰è¿æ¥çš„éƒ¨åˆ†ç”¨äºåˆ†æã€‚è¯»é•¿readsè¢«å®šä½åˆ°åŸºå› ç»„ä¸Šï¼Œå½“è¿™ä¸€å¯¹è¯»é•¿å‘ç°åœ¨ä¸åŒç‰‡æ®µä¸Šçš„æ—¶å€™ï¼Œå¯¹<font color="red">äº’ä½œç‰‡æ®µè¿›è¡Œç›¸åº”è¯„åˆ†</font>ã€‚ä¸€ä¸ªåŒ…å«åŸºå› ç»„æ‰€æœ‰ç‰‡æ®µçš„<font color="red">è¿æ¥é¢‘ç‡çŸ©é˜µè¢«æ„å»º</font>ã€‚ã€‘</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/4.png" alt="img"></p>
<h2 id="2-4-è¿æ¥åŠè§£äº¤è”"><a href="#2-4-è¿æ¥åŠè§£äº¤è”" class="headerlink" title="2.4 è¿æ¥åŠè§£äº¤è”"></a>2.4 è¿æ¥åŠè§£äº¤è”</h2><p>ä½¿ç”¨ <font color="red">T4 DNAè¿æ¥é…¶è¿æ¥äº’ä½œç‰‡æ®µå½¢æˆç¯çŠ¶</font>ã€‚å°†è¿æ¥DNAç‰‡æ®µçš„<font color="red">è›‹ç™½è´¨æ¶ˆåŒ–æ‰</font>ï¼Œå¾—åˆ°äº¤è”ç‰‡æ®µã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/5.png" alt="img"></p>
<h2 id="2-5-åºåˆ—æ‰“æ–­"><a href="#2-5-åºåˆ—æ‰“æ–­" class="headerlink" title="2.5 åºåˆ—æ‰“æ–­"></a>2.5 åºåˆ—æ‰“æ–­</h2><p>ä½¿ç”¨è¶…å£°æ³¢æˆ–å…¶ä»–æ–¹å¼ï¼Œå†æ¬¡æ‰“æ–­ç‰‡æ®µã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/6.png" alt="img"></p>
<h2 id="2-6-ä¸Šæœºæµ‹åº"><a href="#2-6-ä¸Šæœºæµ‹åº" class="headerlink" title="2.6 ä¸Šæœºæµ‹åº"></a>2.6 ä¸Šæœºæµ‹åº</h2><p>ç”¨<font color="red">ç£ç å°†å¸¦ç”Ÿç‰©ç´ çš„æ•è·</font>ï¼Œåˆ¶ä½œæ–‡åº“ï¼Œä¸Šæœºæµ‹åºã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/7.png" alt="img"></p>
<h1 id="3-Hi-Cåº”ç”¨"><a href="#3-Hi-Cåº”ç”¨" class="headerlink" title="3. Hi-Cåº”ç”¨"></a>3. Hi-Cåº”ç”¨</h1><ul>
<li><font color="red">é‡åŒ–</font>åœ¨ä¸‰ç»´ç©ºé—´ä¸­åŸºå› ç»„çš„<font color="red">æŸ“è‰²è´¨é—´äº¤è”</font>ï¼ˆcross-linked chromatin ï¼‰</li>
<li>è§£æ<font color="red">å…¨åŸºå› ç»„äº’ä½œ<strong>æ¨¡å¼</strong></font>ï¼Œå¦‚<font color="red">å¯åŠ¨å­å’Œå¢å¼ºå­äº’ä½œ</font></li>
<li>æ„å»º<font color="red">ä¸‰ç»´ç©ºé—´ç»“æ„<strong>æ¨¡å‹</strong></font>ï¼Œå¦‚ç ”ç©¶åŸºå› ç»„ä¸‰ç»´ç»“æ„ç‰¹å¾ï¼š<strong>compartmentï¼ŒTADï¼Œloop</strong>ç­‰</li>
<li>æ„å»º<font color="red">å…¨åŸºå› ç»„äº’ä½œ<strong>å›¾è°±</strong></font></li>
<li><font color="red">è¾…åŠ©æå‡<strong>åŸºå› ç»„ç»„è£…</strong></font></li>
<li>æ„å»º<font color="red">åŸºå› ç»„<strong>å•ä½“å‹å›¾è°±</strong></font></li>
</ul>
<h1 id="4-åˆ†ææµç¨‹"><a href="#4-åˆ†ææµç¨‹" class="headerlink" title="4. åˆ†ææµç¨‹"></a>4. åˆ†ææµç¨‹</h1><h2 id="4-1-åŸºæœ¬åˆ†æ"><a href="#4-1-åŸºæœ¬åˆ†æ" class="headerlink" title="4.1 åŸºæœ¬åˆ†æ"></a>4.1 åŸºæœ¬åˆ†æ</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/9.png" alt="img"></p>
<p>Ferhat Ay et al;2015</p>
<ul>
<li>(a)é¦–å…ˆæ˜¯<font color="green">è´¨æ§</font>ï¼Œè¿‡æ»¤åé«˜è´¨é‡çš„FASTQæ•°æ®ï¼ˆPEï¼Œ150bpï¼‰ï¼Œå¦‚æœæ¯”å¯¹è½¯ä»¶<font color="red">ä¸æ”¯æŒsplit mapping</font>ï¼Œä¸€èˆ¬é€‰ç”¨<font color="red">è¿­ä»£æ¯”å¯¹</font>ï¼Œå› ä¸ºè¿æ¥å¤„ç”±äºæ˜¯åŸºå› ç»„å¤–çš„ç¢±åŸºï¼Œå¯èƒ½æ¯”å¯¹ä¸ä¸Šã€‚<strong>ä»åºåˆ—å·¦ç«¯25bpå¼€å§‹æ¯”å¯¹ï¼Œå¦‚æœæœ‰å”¯ä¸€æ¯”å¯¹ï¼Œåˆ™åœæ­¢ï¼Œå¦‚æœå¤šä¸ªæ¯”å¯¹ä½ç½®ï¼Œåˆ™å†ç»§ç»­å»¶ä¼¸5bpï¼Œç›´åˆ°å‡ºç°å”¯ä¸€æ¯”å¯¹</strong>ã€‚æˆ–é€‰æ‹©<strong>æ”¯æŒsplit mappingçš„è½¯ä»¶è¿›è¡Œæ¯”å¯¹</strong>ï¼Œå¯ä»¥é€šè¿‡<strong>åˆ†æ®µæ¯”å¯¹å¤„ç†</strong>ã€‚</li>
<li>(b)é€‰æ‹©é«˜è´¨é‡çš„æ¯”å¯¹æ•°æ®</li>
<li>(c)HiCç‰¹å¼‚çš„<font color="green">æ¯”å¯¹æ ‡å‡†</font></li>
<li>(d)å¯¹Vaild pairsè¿›è¡Œ<font color="green">çŸ«æ­£</font>ã€‚çŸ«æ­£å®Œå¯ä»¥å¾—åˆ°<font color="green">äº’ä½œçŸ©é˜µ</font>ã€‚</li>
</ul>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/10.png" alt="img"></p>
<p>Bryan R. Lajoie et al;2014</p>
<h2 id="4-2-Hi-Cå¯è§†åŒ–"><a href="#4-2-Hi-Cå¯è§†åŒ–" class="headerlink" title="4.2 Hi-Cå¯è§†åŒ–"></a>4.2 Hi-Cå¯è§†åŒ–</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/11.png" alt="img"></p>
<h2 id="4-3-åºåˆ—è¿‡æ»¤"><a href="#4-3-åºåˆ—è¿‡æ»¤" class="headerlink" title="4.3 åºåˆ—è¿‡æ»¤"></a>4.3 åºåˆ—è¿‡æ»¤</h2><p>â€‹    <img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/12.png" alt="img"></p>
<h2 id="4-4-æ•°æ®çŸ«æ­£"><a href="#4-4-æ•°æ®çŸ«æ­£" class="headerlink" title="4.4 æ•°æ®çŸ«æ­£"></a>4.4 æ•°æ®çŸ«æ­£</h2><p>â€‹    <img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/13.png" alt="img"></p>
<p>Eitan Yaffe &amp; Amos Tanayï¼›2011</p>
<p>â€‹    <img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/14.png" alt="img"></p>
<h1 id="5-åˆ†æ"><a href="#5-åˆ†æ" class="headerlink" title="5. åˆ†æ"></a>5. åˆ†æ</h1><h2 id="5-1-cis-transäº’ä½œæ¯”ä¾‹"><a href="#5-1-cis-transäº’ä½œæ¯”ä¾‹" class="headerlink" title="5.1 cis/transäº’ä½œæ¯”ä¾‹"></a>5.1 cis/transäº’ä½œæ¯”ä¾‹</h2><p>â€‹    <img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/15.png" alt="img"></p>
<h2 id="5-2-äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³"><a href="#5-2-äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³" class="headerlink" title="5.2 äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³"></a>5.2 äº’ä½œé¢‘ç‡ä¸è·ç¦»æœ‰å…³</h2><p>â€‹    <img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/16.png" alt="img"></p>
<h2 id="5-3-compartmentåˆ†æ"><a href="#5-3-compartmentåˆ†æ" class="headerlink" title="5.3 compartmentåˆ†æ"></a>5.3 compartmentåˆ†æ</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/17.png" alt="img"></p>
<h2 id="5-4-TADåˆ†æ"><a href="#5-4-TADåˆ†æ" class="headerlink" title="5.4 TADåˆ†æ"></a>5.4 TADåˆ†æ</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/18.png" alt="img"></p>
<p>Hi-Cè¾…åŠ©TADç»“æ„ç ”ç©¶ï¼ˆ<em>Wang et al</em>., Nature Commuications 2018ï¼‰</p>
<h2 id="5-5-æ˜¾è‘—äº’ä½œåˆ†æ"><a href="#5-5-æ˜¾è‘—äº’ä½œåˆ†æ" class="headerlink" title="5.5 æ˜¾è‘—äº’ä½œåˆ†æ"></a>5.5 æ˜¾è‘—äº’ä½œåˆ†æ</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/19.png" alt="img"></p>
<h1 id="6-åº”ç”¨"><a href="#6-åº”ç”¨" class="headerlink" title="6. åº”ç”¨"></a>6. åº”ç”¨</h1><h2 id="6-1-è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼"><a href="#6-1-è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼" class="headerlink" title="6.1 è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼"></a>6.1 è§£æå…¨åŸºå› ç»„äº’ä½œæ¨¡å¼</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/20.png" alt="img"></p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/21.png" alt="img"></p>
<h2 id="6-2-è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…"><a href="#6-2-è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…" class="headerlink" title="6.2 è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…"></a>6.2 è¾…åŠ©æå‡åŸºå› ç»„ç»„è£…</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/22.png" alt="img"></p>
<ul>
<li><p>Hi-Cè¾…åŠ©é™†åœ°æ£‰ä¸æµ·å²›æ£‰åŸºå› ç»„æŸ“è‰²ä½“æ°´å¹³ç»„è£…ï¼ˆ<em>Wang et al</em>.,Nature Genetics 2018ï¼‰</p>
</li>
<li><p>Hi-Cæ— éœ€ç¾¤ä½“ï¼Œå•ä¸€ä¸ªä½“å°±èƒ½å®ç°æŸ“è‰²ä½“å®šä½ã€‚å¾ˆå¤šç‰©ç§éƒ½æ— æ³•æ„å»ºé—ä¼ ç¾¤ä½“ï¼ŒåŒ…æ‹¬å¤§éƒ¨åˆ†é«˜ç­‰åŠ¨ç‰©ã€é‡ç”ŸåŠ¨æ¤ç‰©ã€æ—æœ¨ã€æœæ ‘ç­‰ç­‰ã€‚Hi-Cæ˜¯é€šè¿‡æŸ“è‰²ä½“ä¸Šç©ºé—´è·ç¦»ã€çº¿æ€§è·ç¦»çš„ä¸åŒè€Œå¯¼è‡´çš„äº¤äº’é¢‘ç‡çš„ä¸åŒæ¥å®ŒæˆæŸ“è‰²ä½“çš„å®šä½ï¼Œæ‰€ä»¥ä¸éœ€è¦æ„å»ºç¾¤ä½“ã€‚</p>
</li>
<li><p>æ ‡è®°å¯†åº¦æ›´å¤§ï¼Œåºåˆ—å®šä½æ›´å®Œæ•´ã€‚ç›¸æ¯”é—ä¼ å›¾è°±ï¼ŒæŸ“è‰²è´¨ä¹‹é—´çš„äº¤äº’é¢‘ç‡å…·æœ‰æ›´é«˜çš„æ ‡è®°å¯†åº¦ï¼Œå¦‚æ­¤é«˜å¯†åº¦çš„å›¾è°±ä¸ä»…å¯ä»¥æŒ‚è½½ä¸Šé•¿çš„Scaffoldï¼Œè¾ƒçŸ­çš„Scaffoldä¹Ÿå¯ä»¥è¢«å®šä½ï¼Œæ‰€ä»¥é€šè¿‡Hi-CæŠ€æœ¯ï¼Œä¸€èˆ¬å¯ä»¥å°†90%ä»¥ä¸ŠåŸºå› ç»„åºåˆ—å®šä½åˆ°æŸ“è‰²ä½“ã€‚</p>
</li>
<li><p>å¯ä»¥å¯¹å·²ç»„è£…çš„åŸºå› ç»„è¿›è¡Œçº é”™ã€‚é€šè¿‡Scaffoldé—´çš„äº¤äº’é¢‘ç‡å¤§å°ï¼Œå¯ä»¥å¯¹å·²ç»„è£…çš„åŸºå› ç»„åºåˆ—è¿›è¡Œçº é”™ã€‚</p>
</li>
</ul>
<h3 id="6-2-1-æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›"><a href="#6-2-1-æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›" class="headerlink" title="6.2.1 æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›"></a>6.2.1 æ•°æ®ç»Ÿè®¡å’Œè¿‡æ»¤ï¼›</h3><h3 id="6-2-2-Hi-Cæ–‡åº“è¯„ä¼°ï¼›"><a href="#6-2-2-Hi-Cæ–‡åº“è¯„ä¼°ï¼›" class="headerlink" title="6.2.2 Hi-Cæ–‡åº“è¯„ä¼°ï¼›"></a>6.2.2 Hi-Cæ–‡åº“è¯„ä¼°ï¼›</h3><h3 id="6-2-3Hi-CæŸ“è‰²ä½“å®šä½ï¼›"><a href="#6-2-3Hi-CæŸ“è‰²ä½“å®šä½ï¼›" class="headerlink" title="6.2.3Hi-CæŸ“è‰²ä½“å®šä½ï¼›"></a>6.2.3Hi-CæŸ“è‰²ä½“å®šä½ï¼›</h3><p>â€‹    âœ“ ç»„è£…åºåˆ—æŸ“è‰²ä½“ç¾¤ç»„åˆ’åˆ†ï¼›</p>
<p>   âœ“  ç»„è£…åºåˆ—å„ç¾¤ç»„å†…æ’åºï¼›</p>
<p>   âœ“  ç»„è£…åºåˆ—å„ç¾¤ç»„å†…å®šå‘ï¼›</p>
<h3 id="6-2-4-Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›"><a href="#6-2-4-Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›" class="headerlink" title="6.2.4 Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›"></a>6.2.4 Hi-Cå®šä½åç»Ÿè®¡è¯„ä¼°ï¼›</h3><p>â€‹    âœ“  è¿‘ç¼˜ç‰©ç§å‚è€ƒåŸºå› ç»„è¯„ä¼°ï¼›</p>
<p>â€‹    âœ“  é—ä¼ æ ‡è®°è¯„ä¼°ï¼›</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/24.png" alt="img"></p>
<h2 id="6-3-æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±"><a href="#6-3-æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±" class="headerlink" title="6.3 æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±"></a>6.3 æ„å»ºåŸºå› ç»„å•ä½“å‹å›¾è°±</h2><p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/23.png" alt="img"></p>
<h1 id="7-æ–‡çŒ®æ¡ˆä¾‹"><a href="#7-æ–‡çŒ®æ¡ˆä¾‹" class="headerlink" title="7. æ–‡çŒ®æ¡ˆä¾‹"></a>7. æ–‡çŒ®æ¡ˆä¾‹</h1><h2 id="7-1"><a href="#7-1" class="headerlink" title="7.1"></a>7.1</h2><p><strong>ç‰©ç§ï¼šæ£‰èŠ±</strong></p>
<p><strong>é¢˜ç›®ï¼š</strong>Genome sequence of<em>Gossypium herbaceum</em>and genome updates of<em>Gossypium arboreum</em>and<em>Gossypium hirsutum</em>provide insights into cotton A-genome evolution</p>
<p><strong>æœŸåˆŠï¼š</strong>Nature genetics</p>
<p><strong>å½±å“å› å­ï¼š</strong>25.455</p>
<p><strong>ç ”ç©¶å•ä½ï¼š</strong>æ­¦æ±‰å¤§å­¦</p>
<p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p>
<p>2020å¹´4æœˆ13æ—¥ï¼Œæ­¦æ±‰å¤§å­¦æœ±ç‰è´¤é™¢å£«å›¢é˜Ÿå…³äºè‰æ£‰ã€äºšæ´²æ£‰å’Œé™†åœ°æ£‰åŸºå› ç»„ç ”ç©¶æˆæœå‘è¡¨åœ¨å›½é™…è‘—åæœŸåˆŠNature geneticsã€‚è¯¥ç ”ç©¶åˆ©ç”¨äº†PacBioä¸‰ä»£åˆ†å­æµ‹åºå’ŒåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯ç»˜åˆ¶äº†ä¸‰ä¸ªé«˜è´¨é‡æ£‰èŠ±åŸºå› å›¾è°±ï¼Œå‘ç°äº†ä¸‰ç§æ£‰èŠ±ä¸­å¤šä¸ªæŸ“è‰²ä½“æ˜“ä½ä¸å€’ä½äº‹ä»¶ï¼Œè§£å†³äº†å›´ç»•AåŸºå› ç»„èµ·æºçš„ç°æœ‰äº‰è®®æ€§æ¦‚å¿µï¼Œç¡®å®šäº†ä¸æ£‰èŠ±çº¤ç»´é•¿åº¦è¿™ä¸€é‡è¦å†œè‰ºæ€§çŠ¶ç›¸å…³çš„ä¸°å¯Œçš„å€™é€‰åŸºå› ï¼Œå¹¶ä¸ºæ£‰èŠ±é—ä¼ æ”¹è‰¯æä¾›äº†å®è´µçš„åŸºå› ç»„èµ„æºã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/25.png" alt="è‰æ£‰ä¸äºšæ´²æ£‰åŸºå› ç»„Hi-Cçƒ­å›¾"></p>
<h2 id="7-2"><a href="#7-2" class="headerlink" title="7.2"></a>7.2</h2><p><strong>ç‰©ç§ï¼šç™æ¡</strong></p>
<p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/31970919">Genomic analyses of a â€œliving fossilâ€: The endangered dove-tree</a></p>
<p><strong>æœŸåˆŠï¼š</strong>Molecular Ecology Resources</p>
<p><strong>å½±å“å› å­ï¼š</strong>7.049</p>
<p><strong>ç ”ç©¶å•ä½ï¼š</strong>å››å·å¤§å­¦</p>
<p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong>2020å¹´1æœˆå››å·å¤§å­¦åˆ˜å»ºå…¨å›¢é˜Ÿç ´è¯‘äº†ä¸­å›½ç‰¹æœ‰çš„æ¿’å±ç‰©ç§ç™æ¡ï¼ˆ<em>Davidia involucrata</em>ï¼‰åŸºå› ç»„ï¼Œç›¸å…³æˆæœå‘è¡¨åœ¨è‘—åæœŸåˆŠMolecular Ecology Resourcesä¸Šã€‚å››å·å¤§å­¦åˆ˜å»ºå…¨æ•™æˆå’Œæ¨å‹‡å¿—åšå£«ä¸ºè¯¥è®ºæ–‡çš„é€šè®¯ä½œè€…ï¼Œé™ˆé˜³å’Œé©¬æ¶›æ•™æˆä¸ºå¹¶åˆ—ä¸€ä½œã€‚è¯¥ç ”ç©¶åˆ©ç”¨å•åˆ†å­å®æ—¶æµ‹åºSMRTå’ŒåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯ç»„è£…äº†ä¸€ä¸ªé«˜è´¨é‡ã€æŸ“è‰²ä½“ä½“æ°´å¹³çš„ç™æ¡åŸºå› ç»„ï¼Œç ”ç©¶å‘ç°è‹ç‰‡ä¸­å…‰åˆä½œç”¨ç›¸å…³åŸºå› å‡ ä¹ç¼ºå¤±æˆ–è¡¨è¾¾å‡å°‘ï¼Œè€ŒæŠ—èŒã€æŠ—å†·ã€æŠ—æ°´ç­‰æŠ—é€†ç›¸å…³åŸºå› åœ¨è‹ç‰‡ä¸­é«˜åº¦è¡¨è¾¾ï¼Œçªå‡ºäº†è‹ç‰‡åœ¨ä¿æŠ¤èŠ±å’Œå¸å¼•æˆç²‰è€…ä¸­çš„é‡è¦ä½œç”¨ã€‚æœ‰æ•ˆç¾¤ä½“å¤§å°ç­‰ç ”ç©¶åˆ†æäº†ç™æ¡çš„ç”Ÿå­˜æœºåˆ¶å’Œæ¿’å±åŸå› ã€‚åœ¨æœªæ¥æ°”å€™æŒç»­å˜æš–çš„èƒŒæ™¯ä¸‹ï¼Œç ”ç©¶ç»“æœä¸ºä¿æŠ¤è¿™ç‹¬ç‰¹çš„æ¿’å±ç‰©ç§æä¾›äº†ä¾æ®ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/26.png" alt="ç™æ¡åŸºå› ç»„Hi-Cçƒ­å›¾"></p>
<h2 id="7-3"><a href="#7-3" class="headerlink" title="7.3"></a>7.3</h2><p><strong>ç‰©ç§ï¼šäºŒå€ä½“è‰è“</strong></p>
<p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32003918">The high-quality genome of diploid strawberry (Fragaria nilgerrensis) provides new insights into anthocyanin accumulation</a></p>
<p><strong>æœŸåˆŠï¼š</strong>Plant Biotechnology Journal</p>
<p><strong>å½±å“å› å­ï¼š</strong>6.84</p>
<p><strong>ç ”ç©¶å•ä½ï¼š</strong>æ²ˆé˜³å†œä¸šå¤§å­¦</p>
<p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p>
<p>2020å¹´1æœˆ31æ—¥æ²ˆé˜³å†œä¸šå¤§å­¦å¼ å¿—å®ç ”ç©¶å›¢é˜Ÿä¸åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸åˆä½œï¼ŒåŸºäºå•åˆ†å­å®æ—¶æµ‹åºPacBioå’ŒæŸ“è‰²ä½“æ„è±¡æ•è·Hi-CæŠ€æœ¯ï¼ŒæˆåŠŸæ„å»ºäºšæ´²ä¸œéƒ¨å’Œä¸œå—éƒ¨åœ°åŒºç‰¹æœ‰çš„é‡ç”ŸäºŒå€ä½“è‰è“â€”â€”é»„æ¯›è‰è“ï¼ˆ<em>Fragaria nilgerrensis</em>ï¼‰é«˜è´¨é‡åŸºå› å›¾è°±ï¼Œç›¸å…³ç ”ç©¶æˆæœå‘è¡¨åœ¨çŸ¥åæœŸåˆŠPlant Biotechnology Journalä¸Šã€‚æ–‡ä¸­é€šè¿‡æ¯”è¾ƒåŸºå› ç»„å­¦ç­‰ç³»åˆ—åˆ†ææ‰¾å¯»åˆ°å¯èƒ½ä¸é»„æ¯›è‰è“ç‰¹å¼‚è¡¨å‹ä»¥åŠç¯å¢ƒé€‚åº”æ€§ç›¸å…³çš„æ‰©å¼ åŸºå› ï¼Œä»¥åŠå¯èƒ½ä¸å…¶ç™½è‰²æœå®ç›¸å…³çš„å˜å¼‚ã€‚è¯¥ç ”ç©¶ä¸ºè‰è“å±ç‰©ç§çš„ç”Ÿç‰©å­¦ä»¥åŠæ¯”è¾ƒåŸºå› ç»„å­¦ç ”ç©¶æä¾›äº†å®è´µçš„é—ä¼ èµ„æºã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/27.png" alt="é»„æ¯›è‰è“åŸºå› ç»„Hi-Cçƒ­å›¾"></p>
<h2 id="7-4"><a href="#7-4" class="headerlink" title="7.4"></a>7.4</h2><p><strong>ç‰©ç§ï¼šæ²¹æ¡</strong></p>
<p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32224189">Tung Tree (Vernicia fordii) Genome Provides A Resource for Understanding Genome Evolution and Improved Oil Production</a></p>
<p><strong>æœŸåˆŠï¼š</strong>Genomics Proteomics &amp; Bioinformatics</p>
<p><strong>å½±å“å› å­ï¼š</strong>6.597</p>
<p><strong>ç ”ç©¶å•ä½ï¼š</strong>ä¸­å—æ—ä¸šç§‘æŠ€å¤§å­¦</p>
<p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p>
<p>2020å¹´4æœˆ7æ—¥ï¼ŒGenomics Proteomics &amp; Bioinformatics åœ¨çº¿å‘è¡¨äº†ç”±ä¸­å—æ—ä¸šç§‘æŠ€å¤§å­¦è°­æ™“é£å›¢é˜Ÿç‰µå¤´å®Œæˆçš„æ²¹æ¡åŸºå› ç»„ç ”ç©¶è®ºæ–‡ã€‚è¯¥ç ”ç©¶åˆ©ç”¨Illumina+PacBioç»„è£…äº†1.12Gbæ²¹æ¡åŸºå› ç»„ï¼Œå¹¶é€šè¿‡åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯å°†95.15%çš„åºåˆ—æŒ‚è½½åˆ°11æ¡æŸ“è‰²ä½“ä¸Šã€‚åŸºäºæ¯”è¾ƒåŸºå› ç»„ç­‰ç³»åˆ—ç›¸å…³ç ”ç©¶è§£æäº†æ²¹æ¡åŸºå› ç»„è¿›åŒ–å’Œæ¡æ²¹ç”Ÿç‰©åˆæˆçš„åˆ†å­æœºåˆ¶ã€‚è¯¥ç ”ç©¶ä¸ºç†è§£åŸºå› ç»„æ¼”åŒ–ã€ä»¥åŠæ²¹è„‚äº§é‡çš„åˆ†å­è‚²ç§ä¸é—ä¼ æ”¹è‰¯éƒ½æä¾›äº†å®è´µçš„é—ä¼ èµ„æºï¼Œä¸ºæ²¹æ¡ç§è´¨èµ„æºä¿æŠ¤ã€åˆ†å­é—ä¼ å­¦ç ”ç©¶ã€è‰¯ç§é€‰è‚²åŠåŠ å·¥åˆ©ç”¨ï¼Œå¥ å®šäº†é‡è¦çš„ç§‘å­¦åŸºç¡€ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/28.png" alt="æ²¹æ¡åŸºå› ç»„circoså›¾"></p>
<h2 id="7-5"><a href="#7-5" class="headerlink" title="7.5"></a>7.5</h2><p><strong>ç‰©ç§ï¼šäºšéº»</strong></p>
<p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32240956">Genomic Comparison and Population Diversity Analysis Provide Insights into the Domestication and Improvement of Flax</a></p>
<p><strong>æœŸåˆŠï¼š</strong>iScience</p>
<p><strong>å½±å“å› å­ï¼š</strong>â€”â€”</p>
<p><strong>ç ”ç©¶å•ä½ï¼š</strong>ç”˜è‚ƒçœå†œä¸šç§‘å­¦é™¢</p>
<p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p>
<p>2020å¹´4æœˆ24æ—¥ï¼Œç”±ç”˜è‚ƒçœå†œç§‘é™¢å’ŒåŒ—äº¬ç™¾è¿ˆå®¢ç­‰å•ä½åˆä½œçš„äºšéº»åŸºå› ç»„ç ”ç©¶æˆæœè£ç™»iScience, å…¶ä¸­å¼ å»ºå¹³ç ”ç©¶å‘˜ï¼Œå…šå æµ·ç ”ç©¶å‘˜ï¼Œåˆ˜å¤´æ˜ç ”ç©¶å‘˜ï¼Œç™¾è¿ˆå®¢CEOéƒ‘æ´ªå¤ä¸ºæœ¬æ–‡é€šè®¯ä½œè€…ã€‚è¯¥ç ”ç©¶ä½¿ç”¨IlluminaæŠ€æœ¯å¯¹æ²¹ç”¨äºšéº»å“ç§Longya-10ã€çº¤ç»´äºšéº»å“ç§Heiya-14å’Œpale flaxåˆ†åˆ«è¿›è¡Œæµ‹åºä¸ç»„è£…ï¼ŒåæœŸåˆ©ç”¨HiCæŠ€æœ¯ä¸é—ä¼ å›¾è°±è¾…åŠ©Longya-10åŸºå› ç»„ç»„è£…ï¼Œå°†434 scaffoldsç»„è£…è‡³æŸ“è‰²ä½“æ°´å¹³ã€‚é€šè¿‡æ¯”è¾ƒåŸºå› ç»„åŠç¾¤ä½“è¿›åŒ–ç­‰ç ”ç©¶æ¢ç´¢æ²¹ç”¨åŠçº¤ç»´ç”¨äºšéº»åœ¨é©¯åŒ–ä¸­å—åˆ°çš„é€‰æ‹©ä½œç”¨ï¼Œä»¥åŠå¯èƒ½åœ¨é‡å¡‘äºšéº»å½¢æ€ç»“æ„ä¸­èµ·ç€è‡³å…³é‡è¦ä½œç”¨çš„ç›¸å…³åŸºå› ã€‚è¯¥ç ”ç©¶æ­ç¤ºäº†å¯¹äºšéº»é©¯åŒ–å’Œæ”¹è‰¯æœ‰é‡è¦å½±å“çš„åŸºå› ï¼Œè¿™å°†æœ‰åŠ©äºä»Šåçš„åˆ†å­è‚²ç§ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/29.png" alt="äºšéº»åŸºå› ç»„Hi-Cçƒ­å›¾"></p>
<h2 id="7-6"><a href="#7-6" class="headerlink" title="7.6"></a>7.6</h2><p><strong>ç‰©ç§ï¼šæ‡æ·</strong></p>
<p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32141509">Chromosome-level genome assembly and annotation of the loquat (Eriobotrya japonica) genome</a></p>
<p><strong>æœŸåˆŠ</strong>ï¼šGigascience</p>
<p><strong>å½±å“å› å­ï¼š</strong>4.688</p>
<p><strong>ç ”ç©¶å•ä½ï¼š</strong>ä¸Šæµ·å¸‚å†œä¸šç§‘å­¦é™¢</p>
<p><strong>ä¸»è¦ç ”ç©¶å†…å®¹ï¼š</strong></p>
<p>2020å¹´2æœˆ6æ—¥ï¼Œä¸Šæµ·å¸‚å†œä¸šç§‘å­¦é™¢å¼ å­¦è‹±ç ”ç©¶å‘˜å›¢é˜ŸäºçŸ¥åæœŸåˆŠGigascienceä¸Šé¦–æ¬¡å‘è¡¨æ‡æ·åŸºå› ç»„ç›¸å…³ç ”ç©¶è®ºæ–‡ï¼Œè¯¥ç ”ç©¶ä¸­åŸºäºåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸çš„Nanoporeæµ‹åºå’ŒHi-CæŸ“è‰²ä½“æ„è±¡æ•è·æŠ€æœ¯ï¼Œæ„å»ºäº†é«˜è´¨é‡çš„æ‡æ·åŸºå› ç»„ã€‚æ–‡ä¸­é€šè¿‡ä¸è‹¹æœã€æ°´èœœæ¡ƒã€æ¢¨ã€è¦†ç›†è“ã€æœˆå­£å’Œé‡è‰è“çš„è›‹ç™½è´¨åºåˆ—æ¯”è¾ƒï¼Œæ¢ç´¢äº†æ‡æ·çš„å…¨åŸºå› ç»„å¤åˆ¶ä¸è¿›åŒ–äº‹ä»¶ï¼Œå¹¶è¿›è¡Œäº†æŸ“è‰²ä½“é‡æ’åˆ†æã€‚è¯¥ç ”ç©¶æä¾›äº†å®è´µçš„æŸ“è‰²ä½“æ°´å¹³åŸºå› ç»„æ•°æ®ï¼Œä¸ºç ”ç©¶æ‡æ·æ€§çŠ¶æä¾›äº†é‡è¦çš„åŸºå› ç»„æ•°æ®ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/30.png" alt="æ‡æ·åŸºå› ç»„circoså›¾"></p>
<h2 id="7-7"><a href="#7-7" class="headerlink" title="7.7"></a>7.7</h2><p><strong>ç‰©ç§ï¼šæ¿è“æ ¹ï¼ˆè˜è“ï¼‰</strong></p>
<p><strong>é¢˜ç›®ï¼š</strong><a href="https://link.zhihu.com/?target=http://tour.biocloud.net/article/v1/into/articleDetail/32025321">A chromosome-scale genome assembly of Isatis indigotica, an important medicinal plant used in traditional Chinese medicine</a></p>
<p><strong>æœŸåˆŠï¼š</strong> Horticulture Research</p>
<p><strong>å½±å“å› å­ï¼š</strong>3.640</p>
<p><strong>ç ”ç©¶å•ä½ï¼š</strong>å››å·å¤§å­¦</p>
<p><strong>ä¸»è¦ç ”ç©¶å†…ï¼š</strong></p>
<p>2020å¹´2 æœˆ1æ—¥ï¼Œå››å·å¤§å­¦ç”Ÿå‘½ç§‘å­¦å­¦é™¢åˆ˜å»ºå…¨è¯¾é¢˜ç»„ä¸åä¸­å†œä¸šå¤§å­¦ä½œç‰©é—ä¼ æ”¹è‰¯å›½å®¶é‡ç‚¹å®éªŒå®¤æå†äº‘è¯¾é¢˜ç»„é¦–æ¬¡å®Œæˆäº†è˜è“ï¼ˆ<em>Isatis indigotica</em>ï¼Œ2n=14ï¼‰æŸ“è‰²ä½“çº§åˆ«åŸºå› ç»„å›¾è°±ç»˜åˆ¶ã€‚è¯¥ç ”ç©¶åˆ©ç”¨Pacbioæµ‹åº(140X)ç»“åˆåŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©æŠ€æœ¯æœ‰é™å…¬å¸çš„Hi-CæŠ€æœ¯ï¼ˆ284Xï¼‰ç»„è£…å¾—åˆ°294Mbé«˜è´¨é‡åŸºå› ç»„ï¼ˆcontigN50=1.2Mbï¼‰ã€‚åŸºäºåŒæºæœç´¢å’ŒåŠŸèƒ½æ³¨é‡Šï¼Œç¡®å®šäº†è¯¥ç‰©ç§ä¸»è¦åŒ–åˆç‰©ï¼ˆå¦‚å²å“šç±»ã€èœç±»ã€é»„é…®ã€æœ¨è„‚ç´ ç­‰ç‰©è´¨ï¼‰çš„å¯èƒ½ç”Ÿç‰©åˆæˆé€šè·¯å’Œç›¸å…³çš„å€™é€‰åŸºå› ã€‚è¯¥ç ”ç©¶å¼ºè°ƒäº†åŸºå› ç»„æµ‹åºåœ¨é‰´å®šè¯ç”¨æ¤ç‰©ä»£è°¢äº§ç‰©åˆæˆå€™é€‰åŸºå› ä¸­çš„é‡è¦æ€§ï¼Œä¸ºä»Šååå­—èŠ±ç§‘æ¤ç‰©æ¯”è¾ƒåŸºå› ç»„ç­‰ç ”ç©¶æä¾›äº†é‡è¦é—ä¼ ä¿¡æ¯ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/31.png" alt="è˜è“åŸºå› ç»„Hi-Cçƒ­å›¾"></p>
<h2 id="7-8"><a href="#7-8" class="headerlink" title="7.8"></a>7.8</h2><h6 id="ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶"><a href="#ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶" class="headerlink" title="ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶"></a>ä»¥æ›´æ–°çš„äºšæ´²æ£‰AåŸºå› ç»„ä¸ºåŸºç¡€çš„243ä»½äºŒå€ä½“æ£‰çš„é‡è¦å†œè‰ºæ€§çŠ¶çš„ç ”ç©¶</h6><h6 id="RESEQUENCING-OF-243-DIPLOID-COTTON-ACCESSIONS-BASED-ON-AN-UPDATED-A-GENOME-IDENTIFIES-THE-GENETIC-BASIS-OF-KEY-AGRONOMIC-TRAITS"><a href="#RESEQUENCING-OF-243-DIPLOID-COTTON-ACCESSIONS-BASED-ON-AN-UPDATED-A-GENOME-IDENTIFIES-THE-GENETIC-BASIS-OF-KEY-AGRONOMIC-TRAITS" class="headerlink" title="RESEQUENCING OF 243 DIPLOID COTTON ACCESSIONS BASED ON AN UPDATED A GENOME IDENTIFIES THE GENETIC BASIS OF KEY AGRONOMIC TRAITS"></a>RESEQUENCING OF 243 DIPLOID COTTON ACCESSIONS BASED ON AN UPDATED A GENOME IDENTIFIES THE GENETIC BASIS OF KEY AGRONOMIC TRAITS</h6><p>æœŸåˆŠï¼šNature Genetics</p>
<p>å½±å“å› å­ï¼š27.125</p>
<p>å‘è¡¨å•ä½ï¼šä¸­å›½å†œä¸šç§‘å­¦é™¢æ£‰èŠ±ç ”ç©¶æ‰€ã€åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸ç­‰</p>
<p>å‘è¡¨å¹´ä»½ï¼š2018å¹´5æœˆ</p>
<p>ç ”ç©¶èƒŒæ™¯ï¼š</p>
<p>æ£‰èŠ±æ˜¯ç ”ç©¶æ¤ç‰©å¤šå€åŒ–çš„æœ‰ä»·å€¼çš„èµ„æºã€‚äºšæ´²æ£‰(<em>Gossypium arboreum</em>)å’Œè‰æ£‰(<em>Gossypium herbaceum</em>)çš„ç¥–å…ˆæ˜¯ç°ä»£æ ½åŸ¹å¼‚æºå››å€ä½“æ£‰èŠ±AäºšåŸºå› ç»„çš„ä¾›ä½“ã€‚ æœ¬ç ”ç©¶ä¸­ï¼Œåˆ©ç”¨äº†ä¸‰ä»£PacBioå’ŒHi-CæŠ€æœ¯ï¼Œé‡æ–°ç»„è£…äº†é«˜è´¨é‡çš„äºšæ´²æ£‰åŸºå› ç»„ï¼Œåˆ†æäº†243ä»½äºŒå€ä½“æ£‰èŠ±ç§è´¨çš„ç¾¤ä½“ç»“æ„å’ŒåŸºå› ç»„åˆ†åŒ–è¶‹åŠ¿ï¼ŒåŒæ—¶ç¡®å®šäº†ä¸€äº›æœ‰åŠ©äºæ£‰èŠ±çš®æ£‰äº§é‡é—ä¼ æ”¹è‰¯çš„å€™é€‰åŸºå› ä½ç‚¹ã€‚</p>
<p>ç ”ç©¶ç»“æœï¼š</p>
<p>1ã€äºšæ´²æ£‰ä¸‰ä»£åŸºå› ç»„ç»„è£…ï¼š</p>
<p>åˆ©ç”¨ä¸‰ä»£æµ‹åºå’ŒHi-Cç›¸ç»“åˆçš„æ–¹æ³•è¿›è¡Œäºšæ´²æ£‰åŸºå› ç»„ç»„è£…ã€‚å…±è®¡è·å¾—äº†142.54 Gb ï¼Œç»„è£…1.71 Gbäºšæ´²æ£‰åŸºå› ç»„ï¼ŒContig N50=1.1 Mbï¼Œæœ€é•¿çš„Contigä¸º12.37 Mbã€‚åˆ©ç”¨Hi-CæŠ€æœ¯å°†ç»„è£…çš„1573 Mbçš„æ•°æ®å®šä½åˆ°13æ¡æŸ“è‰²ä½“ä¸Šï¼Œä¸å·²ç»å‘è¡¨çš„åŸºå› ç»„ç›¸æ¯”ï¼Œå½“Hi-Cæ•°æ®æ¯”å¯¹åˆ°æ›´æ–°çš„åŸºå› ç»„åï¼Œå¯¹è§’çº¿å¤–çš„ä¸ä¸€è‡´æ€§æ˜æ˜¾å‡å°‘ï¼ˆå›¾1 a-bï¼‰</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/33.png" alt="img"></p>
<p>å›¾1 HI-Cæ•°æ®åœ¨ä¸¤ç‰ˆäºšæ´²æ£‰åŸºå› ç»„ä¸Šçš„æ¯”å¯¹</p>
<p>2ã€äºŒå€ä½“æ£‰èŠ±ç¾¤ä½“é—ä¼ è¿›åŒ–åˆ†æï¼š</p>
<p>å¯¹230ä»½äºšæ´²æ£‰å’Œ13ä»½è‰æ£‰é‡æµ‹åºï¼Œè¿›è¡ŒåŸºå› ç»„æ¯”å¯¹ã€ç³»ç»Ÿå‘è‚²æ ‘ã€ç¾¤ä½“ç»“æ„åˆ†æã€PCAã€LDå’Œé€‰æ‹©æ€§æ¸…é™¤åˆ†æå¾—å‡ºäºšæ´²æ£‰å’Œè‰æ£‰ï¼ˆAï¼‰ä¸é›·è’™å¾·æ°æ£‰åŒæ—¶è¿›è¡Œäº†åˆ†åŒ–ï¼›äºšæ´²æ£‰èµ·æºäºä¸­å›½å—éƒ¨ï¼Œéšåè¢«å¼•å…¥é•¿æ±Ÿå’Œé»„æ²³åœ°åŒºï¼Œå¤§å¤šæ•°å…·æœ‰é©¯åŒ–ç›¸å…³ç‰¹æ€§çš„ç§è´¨éƒ½ç»å†äº†åœ°ç†éš”ç¦»ï¼ˆå›¾2ï¼‰ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/34.png" alt="img"></p>
<p>å›¾2 äºŒå€ä½“æ£‰ç¾¤ä½“è¿›åŒ–å’Œç¾¤ä½“ç»“æ„åˆ†æ</p>
<p>3ã€äºšæ´²æ£‰çš„å…¨åŸºå› ç»„å…³è”åˆ†æï¼ˆGWASï¼‰ï¼š</p>
<p>å¯¹æ¥è‡ªä¸åŒç¯å¢ƒä¸‹çš„11ä¸ªé‡è¦æ€§çŠ¶è¿›è¡Œå…¨åŸºå› ç»„å…³è”åˆ†æï¼Œé‰´å®šäº†äºšæ´²æ£‰11ä¸ªé‡è¦å†œè‰ºæ€§çŠ¶çš„98ä¸ªæ˜¾è‘—å…³è”ä½ç‚¹ï¼ŒGaKASIIIçš„éåŒä¹‰æ›¿æ¢ï¼ˆåŠèƒ±æ°¨é…¸/ç²¾æ°¨é…¸æ›¿æ¢ï¼‰ä½¿å¾—æ£‰ç±½ä¸­çš„è„‚è‚ªé…¸ç»„æˆï¼ˆC16:0å’ŒC16:1ï¼‰å‘ç”Ÿäº†å˜åŒ–ï¼›å‘ç°æ£‰èŠ±æ¯èç—…æŠ—æ€§ä¸GaGSTF9åŸºå› çš„è¡¨è¾¾æ¿€æ´»ç›¸å…³ã€‚é€‰æ‹©äº†äºšæ´²æ£‰ç§è´¨ä¸­çš„158ä»½æœ‰ç»’æ¯›å’Œ57ä»½æ— ç»’æ¯›ææ–™è¿›è¡ŒGWASå…³è”åˆ†æï¼Œå‘ç°ä¸æ¯›çŠ¶ä½“å’Œçº¤ç»´å‘è‚²æœ‰å…³ä¿¡æ¯ï¼ˆå›¾3ï¼‰ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/35.png" alt="img"></p>
<p>å›¾3 äºŒå€ä½“æ£‰ç¾¤ä½“è¿›åŒ–å’Œç¾¤ä½“ç»“æ„åˆ†æ</p>
<p>ç ”ç©¶ç»“è®ºï¼š</p>
<p>åˆ©ç”¨ä¸‰ä»£æµ‹åº+Hi-CæŠ€æœ¯å®Œæˆäº†äºšæ´²æ£‰åŸºå› ç»„çš„é‡æ–°ç»„è£…ï¼Œå°†åŸºå› ç»„ç»„è£…æŒ‡æ ‡ä»72 Kbæå‡åˆ°1.1 Mbï¼Œä¸ºäºšæ´²æ£‰åç»­çš„ç¾¤ä½“é—ä¼ å­¦ç­‰ç›¸å…³ç ”ç©¶å¥ å®šäº†åŸºç¡€ï¼›é€šè¿‡ç¾¤ä½“é—ä¼ è¿›åŒ–ç­‰ç›¸å…³åˆ†æï¼Œå‘ç°äºšæ´²æ£‰å’Œè‰æ£‰(Aå‹)ä¸é›·è’™å¾·æ°æ£‰(Då‹)åŒæ—¶è¿›è¡Œäº†åˆ†åŒ–ï¼Œå¹¶è¯æ˜äº†äºšæ´²æ£‰èµ·æºäºä¸­å›½å—éƒ¨ï¼Œéšåè¢«å¼•å…¥é•¿æ±Ÿå’Œé»„æ²³åœ°åŒºï¼›æ•´åˆGWASä¸QTLç­‰åˆ†ææ–¹æ³•ï¼Œå¯¹äºšæ´²æ£‰è„‚è‚ªé…¸å«é‡ï¼ŒæŠ—ç—…æ€§åŠæ£‰ç»’ç”Ÿé•¿å‘è‚²ç›¸å…³åŸºå› è¿›è¡Œå®šä½ï¼Œå¹¶è¿›è¡Œç›¸å…³åŠŸèƒ½éªŒè¯ï¼Œä¿ƒè¿›äº†äºšæ´²æ£‰å¤æ‚å†œè‰ºæ€§çŠ¶çš„æ”¹è‰¯ã€‚</p>
<h2 id="7-9"><a href="#7-9" class="headerlink" title="7.9"></a>7.9</h2><h6 id="äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯"><a href="#äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯" class="headerlink" title="äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯"></a>äºŒå€ä½“ã€é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿæ¯”è¾ƒåŸºå› ç»„åˆ†ææ­ç¤ºäºšåŸºå› ç»„ä¸å¯¹ç§°è¿›åŒ–å’Œæ”¹è‰¯</h6><h6 id="COMPARISON-OF-ARACHIS-MONTICOLA-WITH-DIPLOID-AND-CULTIVATED-TETRAPLOID-GENOMES-REVEALS-ASYMMETRIC-SUBGENOME-EVOLUTION-AND-IMPROVEMENT-OF-PEANUT"><a href="#COMPARISON-OF-ARACHIS-MONTICOLA-WITH-DIPLOID-AND-CULTIVATED-TETRAPLOID-GENOMES-REVEALS-ASYMMETRIC-SUBGENOME-EVOLUTION-AND-IMPROVEMENT-OF-PEANUT" class="headerlink" title="COMPARISON OF ARACHIS MONTICOLA WITH DIPLOID AND CULTIVATED TETRAPLOID GENOMES REVEALS ASYMMETRIC SUBGENOME EVOLUTION AND IMPROVEMENT OF PEANUT"></a>COMPARISON OF <em>ARACHIS MONTICOLA</em> WITH DIPLOID AND CULTIVATED TETRAPLOID GENOMES REVEALS ASYMMETRIC SUBGENOME EVOLUTION AND IMPROVEMENT OF PEANUT</h6><p>æœŸåˆŠï¼šAdvanced Science</p>
<p>å½±å“å› å­ï¼š15.804</p>
<p>å‘è¡¨å•ä½ï¼šæ²³å—å†œä¸šå¤§å­¦ã€åŒ—äº¬ç™¾è¿ˆå®¢ç”Ÿç‰©ç§‘æŠ€æœ‰é™å…¬å¸ç­‰</p>
<p>å‘è¡¨å¹´ä»½ï¼š2019å¹´11æœˆ</p>
<p>ç ”ç©¶èƒŒæ™¯ï¼š</p>
<p>èŠ±ç”Ÿä½œä¸ºæˆ‘å›½é‡è¦çš„ç»æµä½œç‰©ï¼Œæ˜¯æä¾›é‡è¦çš„è›‹ç™½å’Œæ²¹æ–™çš„åŸºç¡€ã€‚èŠ±ç”Ÿå±ä¸€å…±åŒ…æ‹¬30ä¸ªäºŒå€ä½“å“ç§ï¼Œ1ä¸ªå¼‚æºå››å€ä½“é‡ç”ŸèŠ±ç”Ÿ(<em>A. monticola</em>)å’Œ1ä¸ªæ ½åŸ¹èŠ±ç”Ÿ(<em>A. hypogaea</em>)ã€‚ä½œä¸ºæ ½åŸ¹èŠ±ç”Ÿå†œè‰ºæ€§çŠ¶æ”¹è‰¯çš„é‡è¦é‡ç”Ÿèµ„æºä¾›ä½“ï¼Œé‡ç”Ÿå››å€ä½“èŠ±ç”Ÿä¸€ç›´æ˜¯å›½å†…å¤–å­¦è€…çš„ç ”ç©¶çƒ­ç‚¹ã€‚ç ”ç©¶ä¸­å¯¹èŠ±ç”Ÿå±å”¯ä¸€çš„é‡ç”Ÿå¼‚æºå››å€ä½“èŠ±ç”Ÿ<em>Arachis monticola</em>åŸºå› ç»„è¿›è¡Œäº†ç ”ç©¶ï¼ŒåŒæ—¶å¯¹17ä¸ªé‡ç”ŸäºŒå€ä½“èŠ±ç”Ÿï¼ˆAA;BB;EE;KKå’ŒCCï¼‰ä¸30ä¸ªé‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿè¿›è¡Œäº†é‡æµ‹åºåˆ†æã€‚</p>
<p>ç ”ç©¶ç»“æœï¼š</p>
<p>1ã€é‡ç”Ÿå››å€ä½“èŠ±ç”ŸåŸºå› ç»„denovoåŠä¸æ ½åŸ¹å››å€ä½“èŠ±ç”Ÿçš„æ¯”è¾ƒåˆ†æï¼š</p>
<p>åŸºäº Illuminaã€PacBio ã€Hi-Cå’Œå…‰å­¦å›¾è°±æ•°æ®ï¼Œç»„è£…<em>Arachis monticola</em>(2n = 4x = 40)åŸºå› ç»„å¤§å°ä¸º2.62 Gb ï¼Œcontigs N50=106.66 Kbï¼Œscaffolds N50=124.92 Mbï¼›ä¸æ ½åŸ¹å››å€ä½“èŠ±ç”Ÿ<em>A. hypogaea</em>åŸºå› ç»„ç»“æ„å˜å¼‚é«˜åº¦ä¿å®ˆï¼Œä¸”æ¯”é‡ç”Ÿç¥–å…ˆäºŒå€ä½“æ›´åŠ ä¿å®ˆï¼›</p>
<p>2ã€Aã€BäºšåŸºå› ç»„çš„å•ç³»èµ·æºå’Œå¤šæ ·æ€§ï¼š</p>
<p>å¯¹17ä¸ªäºŒå€ä½“é‡ç”Ÿç§ï¼ˆAAã€BBã€EEã€KKå’ŒCCï¼‰å’Œ30ä¸ªé‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿè¿›è¡Œäº†è¿›åŒ–æ ‘å’ŒPCAåˆ†æã€‚ç»“æœè¡¨æ˜ï¼Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿä¸é‡ç”Ÿå››å€ä½“èŠ±ç”Ÿæœ€æ¥è¿‘ï¼Œ Aå’ŒBäºšåŸºå› ç»„çš„å•ç³»èµ·æºï¼ˆå›¾1ï¼‰ï¼›</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/36.png" alt="img"></p>
<p>3ã€å››å€ä½“èŠ±ç”Ÿä¸å¯¹ç§°äºšåŸºå› ç»„è¿›åŒ–åŠè¡¨è¾¾å·®å¼‚ <strong>ï¼š</strong></p>
<p>æ ½åŸ¹èŠ±ç”Ÿå’Œé‡ç”ŸèŠ±ç”Ÿçš„äºšåŸºå› ç»„é—´çš„åŒæºåºåˆ—äº¤æ¢ç‡ï¼ˆHSEï¼‰åˆ†åˆ«ä¸º2.46%å’Œ2.54%ã€‚é‡ç”ŸèŠ±ç”Ÿä¸­Aåˆ°Bçš„HSEå¯Œé›†çš„åŸºå› ä¸ºç±»é»„é…®ç”Ÿç‰©åˆæˆå’Œæ˜¼å¤œèŠ‚å¾‹é€”å¾„çš„åŸºå› ï¼Œæš—ç¤ºä¸å¯¹ç§°HSEsåœ¨ç”Ÿç‰©å­¦åŠŸèƒ½ä¸­çš„ä½œç”¨ï¼›</p>
<p>4ã€SVå¯¹èšå‘è‚²å’Œé©¯åŒ–ç›¸å…³åŸºå› è¡¨è¾¾çš„å½±å“åŠæŠ—ç—…åŸºå› é‰´å®š <strong>ï¼š</strong></p>
<p>å¯¹é‡ç”Ÿå››å€ä½“èŠ±ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”Ÿä¸åŒå‘è‚²é˜¶æ®µèšæœçš„SVåˆ†æå‘ç°SVåœ¨èšæœå‘è‚²è¿‡ç¨‹ä¸­åŸºå› è¡¨è¾¾çš„å˜åŒ–ä¸Šå¯èƒ½èµ·ç€é‡è¦ä½œç”¨ï¼›åŒæ—¶åœ¨æ ½åŸ¹å››å€ä½“èŠ±ç”Ÿä¸­é‰´å®šåˆ°190ä¸ªSVæŠ—ç—…åŸºå› ï¼ˆSV-RGAsï¼‰ï¼Œå…¶ä¸­32ä¸ªåŸºå› åœ¨æ¥ç§åæ˜“æ„Ÿç»„æˆ–æŠ—æ€§ç»„ä¸­è¡¨ç°å‡ºæ˜¾è‘—çš„è¡¨è¾¾å˜åŒ–ï¼ˆå›¾2ï¼‰ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/37.png" alt="img"></p>
<p>ç ”ç©¶ç»“è®ºï¼š</p>
<p>å……åˆ†æ³¨é‡Šäº†é«˜è´¨é‡é‡ç”Ÿå››å€ä½“èŠ±ç”ŸåŸºå› ç»„ï¼Œæ­ç¤ºäº†èŠ±ç”ŸäºšåŸºå› ç»„å•ç³»èµ·æºå’Œé—ä¼ è¿›åŒ–æ¨¡å‹ï¼Œè¡¨æ˜äº†é‡ç”Ÿå’Œæ ½åŸ¹å››å€ä½“èŠ±ç”ŸäºšåŸºå› ç»„å‘ç”Ÿäº†ä¸å¯¹ç§°è¿›åŒ–ï¼›æ­¤å¤–ï¼Œé‡ç”ŸèŠ±ç”Ÿä¸­å­˜åœ¨çš„ç‹¬ç‰¹ç­‰ä½åŸºå› å¯ä»¥æ”¹å–„æ ½åŸ¹èŠ±ç”Ÿçš„æŠ—æ€§å’Œèšæœå¤§å°ç­‰å½¢çŠ¶ï¼Œä¸ºç ”ç©¶å¤šå€ä½“åŸºå› ç»„è¿›åŒ–ã€ä½œç‰©é©¯åŒ–å’ŒåŸºå› ç»„è¾…åŠ©èŠ±ç”Ÿç”Ÿäº§æ”¹è‰¯æä¾›ç‹¬ç‰¹çš„ä»·å€¼ã€‚</p>
<hr>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Hi-C/32.png" alt="å…¶ä»–"></p>
<p>åŒ—äº¬ç™¾è¿ˆå®¢è‡ªå¯åŠ¨Hi-CæŠ€æœ¯ç ”ç©¶ä»¥æ¥ï¼Œè‡ªä¸»å¼€å‘Hi-Cæ’å›¾è½¯ä»¶ï¼Œå…·æœ‰å®éªŒ+ç”Ÿç‰©ä¿¡æ¯åˆ†æä¸“åˆ©åŒä¿æŠ¤ï¼Œä¹Ÿæ˜¯ä¸­å›½å¸‚åœºä¸Šèƒ½ç‹¬ç«‹å®ŒæˆHi-Cå®éªŒâ€”â€”æ•°æ®åˆ†æçš„æµ‹åºä¼ä¸šä¹‹ä¸€ï¼å¹¶å®Œæˆä¸Šåƒä¸ªç‰©ç§ï¼Œè¿‘ä¸‡ä¸ªæ–‡åº“æ„å»ºï¼›æ–‡åº“å«é…¶åˆ‡ä½ç‚¹æœ‰æ•ˆæ•°æ®æ¯”ä¾‹æœ€é«˜è¾¾93%ä»¥ä¸Šï¼Œé’ˆå¯¹ç‰©ç§æ¨å‡ºå®šåˆ¶åŒ–å†…åˆ‡é…¶æœåŠ¡ï¼›å®ç°å¤šå€ä½“ç‰©ç§çš„Hi-Cè¾…åŠ©åŸºå› ç»„ç»„è£…ï¼Œ<strong>æŒ‚è½½æ•ˆç‡æœ€é«˜è¾¾100%ã€‚</strong></p>
<p>å¦å¤–ä¸ºäº†è®©æ›´å¤šç§‘ç ”å·¥ä½œè€…ä½“éªŒHi-Cå»ºåº“ï¼Œç™¾è¿ˆå®¢åœ¨æˆåŠŸæ„å»ºå¤šç§ç‰©ç§Hi-Cå»ºåº“æµ‹åºçš„ç»éªŒä¸Šï¼Œæ­£å¼æ¨å‡ºäº†Biomarker Hi-C Library Prep Kit for Illuminaã€‚</p>
<p>Biomarker Hi-C Library Prep Kit for Illuminaæ¶µç›–äº†Hi-Cå®éªŒå…¨éƒ¨ç¯èŠ‚ï¼ŒåŒ…æ‹¬ç”²é†›äº¤è”ã€Hi-Cæå–å’ŒHi-Cæ–‡åº“æ„å»ºï¼Œé€‚ç”¨äºç»†èƒç³»ã€åŠ¨ç‰©å’Œæ¤ç‰©ç»„ç»‡æ ·æœ¬ã€‚1å¥—Hi-Cè¯•å‰‚ç›’åŒ…å«5ä¸ªååº”ï¼Œ1ä¸ªååº”æ„å»ºçš„æ–‡åº“å¯ç”¨äº200Gbæ•°æ®é‡çš„æµ‹åºï¼Œè¯•å‰‚ç›’æ„å»ºçš„æ–‡åº“é€‚ç”¨äºIlluminaæµ‹åºå¹³å°ã€‚</p>
<hr>
<p>Ref:<a href="https://www.zhihu.com/question/48308074">https://www.zhihu.com/question/48308074</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1625366">https://cloud.tencent.com/developer/article/1625366</a></p>
<p><a href="http://www.biomarker.com.cn/technology-services/hi-c">http://www.biomarker.com.cn/technology-services/hi-c</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/140795830">https://zhuanlan.zhihu.com/p/140795830</a></p>
]]></content>
      <categories>
        <category>biology</category>
      </categories>
      <tags>
        <tag>technique</tag>
      </tags>
  </entry>
  <entry>
    <title>é€‰æ‹©åŸºå› </title>
    <url>/blog/2022/02/16/2022-0216-select-gene/</url>
    <content><![CDATA[<h1 id="é€‰æ‹©åŸºå› -selector-genes-æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚"><a href="#é€‰æ‹©åŸºå› -selector-genes-æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚" class="headerlink" title="é€‰æ‹©åŸºå› (selector genes)æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚"></a>é€‰æ‹©åŸºå› (selector genes)æ˜¯ä¸€ç±»å†³å®šä½“èŠ‚å‘è‚²çš„åŸºå› ã€‚</h1><span id="more"></span>

<p>æœ‰<font color="green">ä¸¤ç°‡é€‰æ‹©åŸºå› </font>åœ¨æ§åˆ¶<font color="green">æœè‡å¤–éƒ¨ç»“æ„</font>çš„æ­£ç¡®å‘è‚²é€”å¾„ä¸­èµ·å…³é”®ä½œç”¨ï¼š<font color="green">åŒèƒ¸å¤åˆç‰©(bithorax complex,BX-C)</font>å’Œ<font color="green">è§¦è§’è¶³å¤åˆç‰©(antennapedia complex,ANT-C)</font>ã€‚BX-Cå«æœ‰ä¸‰ä¸ªç»“æ„åŸºå› ï¼Œåˆ†åˆ«æ˜¯ï¼š<font color="green">Ultrabithorax(Ubx)ã€Abdominal A(abdA)å’ŒAbdominal B(abdB)</font>ï¼Œå®ƒä»¬<font color="green">å„ç¼–ç ä¸€ç§å…·æœ‰åŒæºæ¡†çš„è½¬å½•å› å­ã€‚è¿™ä¸‰ä¸ªåŸºå› éƒ½å«æœ‰å¾ˆå¤šå†…å«å­</font>ï¼Œè¿™äº›å†…å«å­å¯¹äºè°ƒèŠ‚è¿™äº›åŸºå› åœ¨ä¸åŒ<a href="https://baike.baidu.com/item/%E5%89%AF%E8%8A%82">å‰¯èŠ‚</a>è¿›è¡Œä¸åŒçš„è¡¨è¾¾å…·æœ‰é‡è¦ä½œç”¨ã€‚ANT-C<a href="https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0%E7%B0%87">åŸºå› ç°‡</a>å«æœ‰5ä¸ªåŸºå› ï¼š<font color="green">labial(lab)ã€proboscipedia(pb)ã€Deformed(Dfd)ã€Sex combs reduced(Scr)å’Œantennapedia(Antp)</font>ã€‚è¿™ä¸¤ç°‡åŸºå› éƒ½å®šä½äº<font color="green">3å·æŸ“è‰²ä½“</font>ã€‚ANT-Cç°‡ç¼–ç çš„è›‹ç™½è´¨æ§åˆ¶<font color="green">0-5å‰¯èŠ‚</font>çš„å‘è‚²ï¼ŒBX-CåŸºå› ç°‡ç¼–ç çš„è›‹ç™½è´¨æ§åˆ¶<font color="green">5-14</font>å‰¯èŠ‚çš„å‘è‚²ã€‚</p>
]]></content>
      <categories>
        <category>biology</category>
      </categories>
      <tags>
        <tag>biology</tag>
      </tags>
  </entry>
  <entry>
    <title>æŸ“è‰²è´¨ä¸‰ç»´ç»“æ„å›¾è°± Micro-C</title>
    <url>/blog/2022/02/16/2022-0216-chromosome-structure-Micro-C/</url>
    <content><![CDATA[<h1 id="Micro-C"><a href="#Micro-C" class="headerlink" title="Micro-C"></a>Micro-C</h1><span id="more"></span>

<h1 id="Micro-C-1"><a href="#Micro-C-1" class="headerlink" title="Micro-C"></a>Micro-C</h1><p>æŸ“è‰²è´¨ç»“æ„ä¸åŸºå› è¡¨è¾¾çš„è°ƒæ§å¯†åˆ‡ç›¸å…³ï¼ˆå¦‚<font color="green">å¸¸æŸ“è‰²è´¨/å¼‚æŸ“è‰²è´¨</font>ï¼‰ã€‚éšç€è¿‘å¹´<font color="green">æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯</font>çš„å‘å±•ï¼Œäº†è§£åˆ°ç»†èƒæ ¸å†…çš„DNAå­˜åœ¨ç€<font color="green">å¤šé‡ç»“æ„è°ƒèŠ‚æœºåˆ¶</font>ï¼Œä¾‹å¦‚<font color="green">A/BæŸ“è‰²è´¨åŒºå®¤ï¼ˆcompartmentï¼‰</font>å’Œ<font color="green">æ‹“æ‰‘ç»“æ„åŸŸï¼ˆTADï¼‰</font>ã€‚å¤§å°åˆ†åˆ«åœ¨<font color="green">ç™¾ä¸‡ç¢±åŸº</font>å’Œ<font color="green">åä¸‡ç¢±åŸº</font>å·¦å³ã€‚ç”±äºæµ‹åºæ·±åº¦å’ŒæŠ€æœ¯æ¡ä»¶é™åˆ¶ï¼Œ<font color="green">Hi-Cå¾ˆéš¾è¾¾åˆ°æ›´é«˜åˆ†è¾¨ç‡</font>ï¼Œ<strong>é™åˆ¶</strong>äº†åˆ†æå…³äºå•ä¸ªåŸºå› ï¼Œä»¥åŠå¯åŠ¨å­ï¼ˆPï¼‰ã€å¢å¼ºå­ï¼ˆEï¼‰ç­‰<font color="green">è°ƒæ§å…ƒä»¶ä¹‹é—´ç›¸äº’ä½œç”¨</font>ã€‚</p>
<p>Molecular Cellæ‚å¿—å‘è¡¨èƒŒé èƒŒæ–‡ç« Resolving the 3D Landscape of Transcription-Linked Mammalian Chromatin Foldingå’ŒUltrastructural Details of Mammalian Chromosome Architectureã€‚<font color="green">ä¸€ç§æ–°çš„æŸ“è‰²è´¨æ„è±¡æ•æ‰æŠ€æœ¯åä¸ºMicro-C</font>ã€‚Micro-Cè¾¾åˆ°<strong>å•æ ¸å°ä½“é•¿åº¦ï¼ˆï½200bpï¼‰</strong>å·¦å³çš„<strong>åˆ†è¾¨ç‡</strong>ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æ›´ä¸ºç²¾ç»†çš„æŸ“è‰²è´¨ç»“æ„ã€‚</p>
<p>Micro-Cå’ŒHi-Cåœ¨å®éªŒæ­¥éª¤ä¸Šæœ€å¤§çš„ä¸åŒï¼Œåœ¨äºMicro-Cå…ˆå¯¹æ ¸å°ä½“ä¸Šç¼ ç»•çš„DNAåšäº¤è”ï¼Œè€Œåç”¨MNaseåˆ‡æ–­æ ¸å°ä½“ä¹‹é—´çš„è¿æ¥DNAã€‚ä»¥Tjianå’ŒDarzacqå®éªŒå®¤çš„æ–‡ç« ä¸ºä¾‹ï¼Œä»–ä»¬å¯¹38ä¸ªå°é¼ å¹²ç»†èƒè¿›è¡ŒMicro-Cæµ‹åºï¼Œæ€»å…±è·å¾—çº¦26äº¿ä¸ªreadsã€‚<strong>ç›¸ä¼¼æµ‹åºæ·±åº¦</strong>ä¸‹<strong>20kbç²¾åº¦</strong>çš„<strong>Micro-Cå›¾è°±ä¸Hi-Cç»“æœç›¸ä¼¼</strong>ï¼Œä½†åœ¨<strong>100è‡³20kbçš„ç²¾åº¦ä¹‹é—´</strong>ï¼Œ<strong>Micro-C</strong>å±•ç¤º<strong>Hi-Cä¸å…·å¤‡</strong>çš„<strong>ç²¾ç»†</strong>ç»“æ„ï¼Œä¾‹å¦‚å¾ˆå¤šæœ‰å…³åŸºå› å¯åŠ¨å­å’Œå¢å¼ºå­çš„ç»“æ„åŸŸã€æ¡å¸¦å’Œç‚¹åœˆã€‚ä»Hi-Cå¯ä»¥å¾—åˆ°çº¦6000ä¸ªDNAç¯ï¼ˆloopï¼‰ï¼Œå³é«˜åº¦ç›¸äº’ä½œç”¨çš„ä¸€å¯¹åŒºåŸŸã€‚è€ŒMicro-Cå¯ä»¥å¾—åˆ°çº¦30000ä¸ªã€‚</p>
<p>åœ¨è¯å®äº†Micro-Cå…·å¤‡å¯é‡å¤æ€§å’Œé«˜ç²¾åº¦ä¹‹åï¼Œè¿›ä¸€æ­¥åˆ†æï¼Œ<font color="green">ç›¸æ¯”Hi-Cï¼ŒMicro-Cç‹¬ç‰¹</font>çš„ä¸»è¦åœ¨äºå¯æ¢æŸ¥<font color="green">è°ƒæ§å…ƒä»¶ä¹‹é—´ç›¸äº’ä½œç”¨</font>ï¼Œå¦‚EPï¼ŒPPç­‰ã€‚å…¶ä¸­æœ‰äº›ç›¸äº’ä½œç”¨å½¢æˆäº†æ¯”ä¼ ç»ŸTADå°çš„ç»“æ„åŸŸã€‚ç ”ç©¶è€…é€šè¿‡éš”ç¦»åˆ†å€¼çš„åˆ†æå¾—åˆ°äº†å¤§çº¦13ä¸‡ä¸ªè¿™æ ·çš„ç»“æ„åŸŸè¾¹ç•Œã€‚è¿™äº›<font color="green">è¾¹ç•Œé€šå¸¸æœ‰ç€æ´»è·ƒè½¬å½•çš„åŸºå› å’ŒåŠ¨æ€çš„æ ¸å°ä½“ç»“æ„</font>ï¼Œè€Œä¸ä¹‹å‰æ‰€äº†è§£çš„ï¼Œ<font color="green">ä»¥CTCFå’ŒCohesinä¸ºæ ‡å¿—çš„TADè¾¹ç•Œ</font>æœ‰å¾ˆå¤§<font color="green">ä¸åŒ</font>ã€‚</p>
<p>åˆ©ç”¨<strong>å›å½’æ¨¡å‹</strong>åˆ†æäº†è¿™äº›<strong>ç»“æ„åŸŸè¾¹ç•Œ</strong>å’Œ<strong>è¡¨å…³é—ä¼ ç‰¹å¾</strong>çš„<strong>å…³è”æ€§</strong>ã€‚<font color="green">CTCF</font>å’Œ<font color="green">Cohesin</font>åœ¨<font color="green">å†³å®šè¾¹ç•Œä½ç½®</font>æœ€é‡è¦ï¼Œç„¶è€Œå†³å®š<font color="green">è¾¹ç•Œå¼ºåº¦</font>å´ä¸»è¦æ˜¯<font color="green">è½¬å½•æ´»è·ƒçš„æ ‡å¿—ç‰©</font>ï¼Œå¦‚<font color="green">H3K4me3ä¿®é¥°å’ŒæŸ“è‰²è´¨å¼€æ”¾åº¦</font>ç­‰ã€‚è¿›ä¸€æ­¥å‘ç°è¾¹ç•Œä¹Ÿå­˜åœ¨å¾ˆå¤§å·®åˆ«ï¼Œå°†å…¶åˆ†ä¸ºäº”ç±»ï¼š<font color="red">è½¬å½•ç›¸å…³</font>ï¼›<font color="red">å¹²ç»†èƒç‰¹å¼‚æ€§å¢å¼ºå­</font>ï¼›<font color="red">ä¸€èˆ¬å¢å¼ºå­</font>ï¼›<font color="red">æŠ‘åˆ¶å‹</font>ï¼›<font color="red">CTCF-Cohesinç›¸å…³å‹</font>ã€‚å„æœ‰ä¸åŒçš„åŒ–å­¦ä¿®é¥°ã€‚</p>
<p>é€‰å–äº†ä¸€äº›ä»£è¡¨æ€§çš„åŒºåŸŸå‘ç°ï¼Œä¸ä»…<strong>å¯åŠ¨å­ã€å¢å¼ºå­å’ŒCTCFä¹‹é—´ç›¸äº’ä½œç”¨</strong>ï¼Œåœ¨<strong>èšæ¢³æŠ‘åˆ¶åŒº</strong>è¿˜å¯ä»¥è§‚å¯Ÿåˆ°æ˜¾è‘—çš„<strong>â€œå·¢çŠ¶â€ç¯</strong>ã€‚<strong>CTCFç›¸äº’ä½œç”¨èŒƒå›´è¾ƒé•¿</strong>ï¼Œè€Œ<strong>Pol II</strong>ä»‹å¯¼çš„ç›¸äº’ä½œç”¨åˆ™<strong>è¾ƒçŸ­</strong>ã€‚åŸºå› é™„è¿‘çš„ç›¸äº’ä½œç”¨è¶Šç´§å¯†ï¼Œå…¶è½¬å½•æ´»æ€§ä¹Ÿå¸¸å¸¸è¶Šé«˜ã€‚è¿›ä¸€æ­¥<strong>è¯æ˜</strong><font color="green">è½¬å½•å¯¹æŸ“è‰²è´¨æŠ˜å </font>çš„å½±å“ï¼Œåˆ©ç”¨<font color="green">è¯ç‰©æŠ‘åˆ¶è½¬å½•</font>ã€‚å¯¹æ¯”è§‚å¯Ÿåˆ°ï¼Œ<font color="green">TADç­‰å¤§å°ºåº¦ç»“æ„æ— å˜åŒ–</font>ï¼Œç„¶è€Œ<font color="green">åŸºå› é™„è¿‘çš„ç›¸äº’ä½œç”¨</font>æ¡çº¹<font color="green">å¤§å¤§å‡å¼±</font>ï¼Œè¯æ˜äº†è¿™äº›æ¡çº¹å›¢ç¡®å®æ˜¯ç”±è½¬å½•è¿‡ç¨‹å¯¼è‡´çš„ã€‚</p>
<p>ä¸¤ç¯‡æ–‡ç« æ˜¾ç¤ºäº†<strong>å“ºä¹³åŠ¨ç‰©</strong>çš„<font color="green">æŸ“è‰²è´¨ç›¸äº’ä½œç”¨</font>è¿˜æœ‰<font color="green">æ›´å¤šçš„ç²¾ç»†ç»“æ„ç­‰å¾…å¼€å‘</font>ã€‚æ›´é«˜ç²¾åº¦çš„æ•°æ®èƒ½å¸®åŠ©äººä»¬ç†è§£è¿™äº›<strong>ç»“æ„çš„å½¢æˆå’Œå¯¹åŸºå› è½¬å½•çš„å½±å“</strong>ã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzA3MzQyNjY1MQ==&amp;mid=2652482974&amp;idx=3&amp;sn=acc0381ecc6ab6779e335510b87de062&amp;chksm=84e23e2ab395b73">https://mp.weixin.qq.com/s?__biz=MzA3MzQyNjY1MQ==&amp;mid=2652482974&amp;idx=3&amp;sn=acc0381ecc6ab6779e335510b87de062&amp;chksm=84e23e2ab395b73</a></p>
<hr>
<p><font color="green">æŸ“è‰²è´¨é«˜çº§ç»“æ„</font>ç”±ä¸åŒå±‚æ¬¡çš„ç»“æ„å•å…ƒç»„æˆã€‚ä»<font color="green">åŒºå—ï¼ˆcompartmentï¼‰</font>ï¼Œ<font color="green">æ‹“æ‰‘ç»“æ„åŸŸï¼ˆTADï¼‰</font>ï¼Œåˆ°å•ä¸ªçš„<font color="green">ç¯ï¼ˆloopï¼‰</font>ï¼Œè¿™äº›å¤§å°ä¸åŒçš„å•å…ƒå„æœ‰ç‰¹å¾ï¼Œä¹Ÿå¯¹<strong>æŸ“è‰²è´¨åŠŸèƒ½</strong>å’Œ<strong>åŸºå› è¡¨è¾¾</strong>èµ·åˆ°å¤šç§å¤šæ ·çš„<strong>è°ƒæ§</strong>ã€‚CTCFè›‹ç™½æ‰®æ¼”äº†é‡è¦çš„è§’è‰²ã€‚</p>
<p><font color="red">CTCF</font>å¸¸å¸¸ä½äº<strong>TADå’Œloopçš„è¾¹ç•Œ</strong>ï¼Œèµ·åˆ°â€œ<font color="red">éš”ç¦»å­</font>â€çš„ä½œç”¨ã€‚è¿‘å¹´æ¥æå‡ºçš„loop extrusionæ¨¡å‹ä¹Ÿè®¤ä¸º<font color="green">CTCFå’Œcohesinçš„åè°ƒä½œç”¨æ˜¯loopå½¢æˆçš„æ™®éæœºç†</font>ã€‚è™½ç„¶æœ‰å‡è®¾ï¼Œå´ä¸€ç›´ä¸æ¸…æ¥šCTCF<font color="red">å¦‚ä½•ä½œç”¨</font>äºæŸ“è‰²è´¨ï¼Œå¹¶å¯¼è‡´å¤æ‚ç»“æ„å½¢æˆã€‚CTCFè›‹ç™½çš„å„ä¸ªç»“æ„åŸŸï¼Œé™¤äº†åŒDNAç»“åˆçš„11-ZFå¤–ï¼Œå…¶ä»–ç»“æ„åŸŸåŠŸèƒ½ï¼Ÿ</p>
<p>2019å¹´9æœˆ12æ—¥ï¼ŒMolecular Cellæ‚å¿—å‘è¡¨èƒŒé èƒŒæ–‡ç« â€œDistinct Classes of ChromatinLoops Revealed by Deletion of anRNA-Binding Region in CTCFâ€å’Œâ€œRNA Interactions Are Essentialfor CTCF-Mediated Genome Organizationâ€<strong>ï¼Œ</strong>å…±åŒæ­ç¤º<font color="green">CTCFä¸RNAçš„ç›¸äº’ä½œç”¨</font>å¯¹CTCFåŠŸèƒ½çš„é‡è¦æ„ä¹‰ã€‚</p>
<p>ä¹‹å‰ç ”ç©¶å‘ç°<font color="green">CTCFå¸¸åœ¨ç»†èƒä¸­æˆç°‡èšé›†</font>ã€‚ä¸ºç ”ç©¶èšé›†çš„<font color="green">æœºç†</font>ï¼Œåœ¨ç»†èƒä¸­åˆ†åˆ«åŠ å…¥<font color="green">DNaseå’ŒRNase</font>ã€‚ç»“æœåƒæƒŠï¼Œè¢«è®¤ä¸ºæ˜¯DNAç»“åˆè›‹ç™½çš„CTCFçš„èšåˆå¯¹<font color="green">DNaseå¹¶ä¸æ•æ„Ÿ</font>ï¼Œè€Œ<font color="green">RNaseå´æ˜¾è‘—å‡å°‘äº†CTCFçš„äº’ç›¸ç»“åˆ</font>ã€‚ ç»“åˆä¹‹å‰ç ”ç©¶ï¼ŒCTCFä¸Šçš„ZF10å’ŒZF11ç»“æ„åŸŸæœ‰ä¸€æ®µå…·æœ‰RNAç»“åˆåŠŸèƒ½ï¼ˆ<font color="red">RNA-binding region</font>ï¼Œ<strong>RBR</strong>ï¼‰ï¼Œå…¶ä¸­<strong>38ä¸ªæ°¨åŸºé…¸</strong>å¯¹å…¶ç»“åˆæ˜¯å¿…ä¸å¯å°‘ã€‚ç ”ç©¶è€…äºæ˜¯åœ¨<font color="red">å°é¼ å¹²ç»†èƒ</font>ä¸Šå°†è¿™æ®µè¢«ç§°ä¸º<font color="red">RBRiçš„ç‰‡æ®µæ›¿æ¢</font>ï¼Œå‘ç°<font color="green">ç¼ºé™·å‹ç»†èƒ</font>çš„<strong>CTCFè¡¨è¾¾æ°´å¹³</strong>è™½ç„¶<strong>æ— æ˜æ˜¾å˜åŒ–</strong>ï¼Œ<strong>ç”Ÿé•¿å´æ…¢äº†2å€</strong>ï¼Œæ˜¾ç¤º<strong>RBRi</strong>å¯èƒ½å…·æœ‰é‡è¦çš„<strong>ç”Ÿç†ä½œç”¨</strong>ã€‚RBRiç¼ºé™·çš„CTCFåœ¨ç»†èƒä¸­å’ŒRNAçš„<font color="green">ç»“åˆå‡å°‘ä½†å´æ²¡æœ‰å®Œå…¨æ¶ˆå¤±</font>ã€‚ç ”ç©¶è€…æ¥ç€å¯¹<strong>RBRiç¼ºé™·å’Œä¸ç¼ºé™·çš„CTCF</strong>åˆ†åˆ«åšäº†è§å…‰<strong>æ ‡è®°</strong>ã€‚ç»“æœ<strong>é‡ç”Ÿå‹CTCF</strong>å‘ˆç°äº†æ˜æ˜¾<strong>æ›´é«˜ç¨‹åº¦èšå›¢</strong>ã€‚ä¸è¿‡è¿™äº›ç»“æœå¹¶<strong>ä¸æ’é™¤RBRié—´æ¥ä½œç”¨</strong>äºå…¶ä»–å› å­çš„å¯èƒ½ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Micro-C/1.png" alt="img"></p>
<p>ç ”ç©¶è€…æ¥ç€åˆ†æäº†**<font color="red">RBRiç‰‡æ®µåŠŸèƒ½å’ŒCompartmentï¼ŒTADï¼ŒLoopä¸‰å¤§ç»“æ„å•å…ƒçš„å…³ç³»</font><strong>ã€‚å¯¹</strong>RBRiç¼ºé™·<strong>å’Œ</strong>é‡ç”Ÿå‹<strong>ç»†èƒ</strong>Micro-Cæµ‹åº<strong>ã€‚Micro-Cæ˜¯ä¸€ç§æ¯”Hi-Cæ¸…æ™°åº¦æ›´é«˜çš„ç ”ç©¶åŸºå› ç»„èŒƒå›´æŸ“è‰²è´¨ç›¸äº’ä½œç”¨çš„æ–¹æ³•ã€‚RBRiçš„<font color="green">ç¼ºé™·å¹¶ä¸å½±å“compartmentå½¢æˆ</font>ï¼Œä½†å´</strong><font color="red">å¤§èŒƒå›´æ”¹å˜äº†TADå’Œloopçš„ç»“æ„</font>**ã€‚å°†RBRi<font color="green">æ›¿æ¢å</font>ï¼Œå°é¼ ç»†èƒå†…<font color="green">TADçš„æ•°ç›®å’Œå¼ºåº¦éƒ½æœ‰æ‰€å‡å°‘</font>ï¼Œå…¶ä¸­<font color="green">å¤§éƒ¨åˆ†åŒTADè¾¹ç¼˜CTCFå’ŒCohesinçš„ChIP-seqä¿¡å·å˜åŒ–ä¸€è‡´</font>ã€‚RBRiçš„æ›¿æ¢ä¹Ÿä½¿å¾—<font color="green"><strong>Micro-C</strong></font>çƒ­å›¾ä¸Šçš„<font color="green"><strong>æ¡å¸¦ï¼ˆstripï¼‰å˜é•¿</strong></font>ï¼Œè¿™ç¬¦åˆloop extrusionæ¨¡å‹çš„å‡è®¾ã€‚è€Œloopçš„æ”¹å˜æ›´ä¸ºæœ‰è¶£â€“æœ‰äº›loopå®Œå…¨æ˜æ˜¾å‰Šå¼±ï¼ˆ38%ï½57%ï¼‰ï¼Œè€Œæœ‰äº›loopå´å®Œå¥½æ— æŸç”šè‡³å¢å¼ºäº†ã€‚ç ”ç©¶è€…äºæ˜¯<font color="green"><strong>å°†loopåˆ†æˆRBRiä¾èµ–å’Œä¸ä¾èµ–ä¸¤ç±»</strong></font>ï¼Œå¹¶å‘ç°å®ƒä»¬å…·æœ‰ä¸åŒçš„è½¬å½•å› å­ç»“åˆç‰¹å¾ã€‚ä»–ä»¬è¿˜æ®æ­¤å‡è®¾ï¼Œè¿™ä¸¤ç±»loopåŒCTCFæœ‰ä¸åŒçš„ç»“åˆæ–¹å¼ï¼Œå› æ­¤ç¨³å®šæ€§ä¹Ÿä¸åŒã€‚è¿™ä¹Ÿè®¸å¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆä¸æ˜¯æ‰€æœ‰çš„CTCFä½ç‚¹éƒ½ä¼šå½¢æˆloopã€‚æœ€åï¼Œå‘ç°å¤§çº¦500ä¸ªåŸºå› ç”±äºRBRiçš„æ›¿æ¢äº§ç”Ÿäº†å·®å¼‚è¡¨è¾¾ã€‚</p>
<p><img src="/blog/2022/02/16/2022-0216-chromosome-structure-Micro-C/2.png" alt="img"></p>
<p>Danny Reinbergå®éªŒå®¤åˆ™å°†ç›®å…‰é›†ä¸­åœ¨<strong>CTCFçš„ZF1å’ŒZF10ç»“æ„åŸŸ</strong>ä¸Šã€‚ä»–ä»¬å‘ç°å¯¹å°é¼ ç»†èƒçš„è½¬å½•æŠ‘åˆ¶åœ¨æ²¡æœ‰é™ä½CTCFè¡¨è¾¾æ°´å¹³çš„å‰æä¸‹ï¼Œå‡å°‘äº†CTCFåœ¨å…¨åŸºå› ç»„èŒƒå›´çš„ç»“åˆç¨‹åº¦ã€‚<font color="red">ZF1æˆ–ZF10ç¼ºé™·çš„CTCFä¸RNAçš„ç»“åˆèƒ½åŠ›éƒ½å¤§å¤§å‡å°‘ï¼Œå¹¶ä¸”åœ¨ä¸€å®šç¨‹åº¦å¯¼è‡´CTCFç»“åˆä½ç‚¹å’ŒåŸºå› è¡¨è¾¾æ”¹å˜ã€‚è€Œä¸åŒçš„æ˜¯ï¼ŒZF1ç¼ºé™·ä½¿å¾—å¤§éƒ¨åˆ†CTCF loopæ¶ˆå¤±ï¼Œè€ŒZF10ç¼ºé™·å‹ç»†èƒçš„loopå´ä»ç„¶ä¿æŒå®Œå¥½ã€‚</font></p>
<p><strong>è¿™ä¸¤ç¯‡èƒŒé èƒŒæ–‡ç« å…±åŒæ­ç¤ºäº†CTCFçš„RNAç»“åˆåŸŸ</strong>ï¼ˆRBRï¼‰<strong>åœ¨CTCFå‘æŒ¥æ­£å¸¸åŠŸèƒ½ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚</strong></p>
]]></content>
      <categories>
        <category>biology</category>
      </categories>
      <tags>
        <tag>technique</tag>
      </tags>
  </entry>
  <entry>
    <title>CTCF</title>
    <url>/blog/2022/02/15/2022-02-15-CTCF/</url>
    <content><![CDATA[<h1 id="ã€paper1ã€‘CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops"><a href="#ã€paper1ã€‘CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops" class="headerlink" title="ã€paper1ã€‘CTCF: the protein, the binding partners, the binding sites and their chromatin loops"></a>ã€paper1ã€‘CTCF: the protein, the binding partners, the binding sites and their chromatin loops</h1><span id="more"></span>

<p>review: <a href="https://pubmed.ncbi.nlm.nih.gov/23650640/">https://pubmed.ncbi.nlm.nih.gov/23650640/</a></p>
<h1 id="CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops"><a href="#CTCF-the-protein-the-binding-partners-the-binding-sites-and-their-chromatin-loops" class="headerlink" title="CTCF: the protein, the binding partners, the binding sites and their chromatin loops"></a>CTCF: the protein, the binding partners, the binding sites and their chromatin loops</h1><p>CTCF:è›‹ç™½è´¨ï¼Œç»“åˆä¼™ä¼´ï¼Œç»“åˆä½ç‚¹å’ŒæŸ“è‰²è´¨ç¯</p>
<p>CTCFä»€ä¹ˆéƒ½æœ‰ã€‚è½¬å½•å› å­ä¸æˆåƒä¸Šä¸‡ä¸ªåŸºå› ç»„ä½ç‚¹ç»“åˆï¼Œæœ‰äº›æ˜¯ç»„ç»‡ç‰¹å¼‚æ€§çš„ï¼Œæœ‰äº›æ˜¯è¶…ä¿å®ˆçš„ã€‚å®ƒå¯ä»¥ä½œä¸º<strong>è½¬å½•æ¿€æ´»å› å­</strong>ã€<strong>æŠ‘åˆ¶å­</strong>å’Œ<strong>ç»ç¼˜å­</strong>ï¼Œå¹¶å¯ä»¥<strong>æš‚åœè½¬å½•</strong>ã€‚CTCF<strong>ç»“åˆ</strong>åœ¨<strong>æŸ“è‰²è´¨ç»“æ„åŸŸè¾¹ç•Œ</strong>ï¼Œ<strong>å¢å¼ºå­</strong>å’Œ<strong>å¯åŠ¨å­</strong>ï¼Œä»¥åŠ<strong>åŸºå› åŒº</strong>ã€‚å®ƒå¯ä»¥å¸å¼•è®¸å¤šå…¶ä»–è½¬å½•å› å­åˆ°æŸ“è‰²è´¨ï¼ŒåŒ…æ‹¬ç»„ç»‡ç‰¹å¼‚æ€§è½¬å½•æ¿€æ´»å› å­ã€æŠ‘åˆ¶å­ã€ç²˜è¿è›‹ç™½å’ŒRNAèšåˆé…¶IIï¼Œå¹¶å½¢æˆæŸ“è‰²è´¨ç¯ã€‚å› æ­¤ï¼ŒCTCFåœ¨ç‰¹å®šåŸºå› ç»„ä½ç‚¹çš„ç¡®åˆ‡åŠŸèƒ½æ˜¯ä¸å¯é¢„æµ‹çš„ã€‚å®ƒä¼¼ä¹æ˜¯ç”±ç›¸å…³çš„è½¬å½•å› å­ã€ç»“åˆä½ç‚¹ç›¸å¯¹äºåŸºå› è½¬å½•èµ·å§‹ä½ç‚¹çš„ä½ç½®ã€ä»¥åŠè¯¥ä½ç‚¹åœ¨æŸ“è‰²è´¨ç¯ä¸­ä¸å…¶ä»–ctcfä½ç‚¹çš„ç»“åˆã€ä¸å¢å¼ºå­æˆ–å¯åŠ¨å­çš„ç»“åˆå†³å®šçš„ã€‚è¯¥reviewå°†è®¨è®ºCTCFç»“åˆäº‹ä»¶çš„å…¨åŸºå› ç»„ç‰¹å¾ï¼Œä»¥åŠè¿™ä¸ªæ˜¾è‘—çš„è½¬å½•å› å­çš„ä½ç‚¹ç‰¹å¼‚æ€§åŠŸèƒ½ã€‚</p>
<ol>
<li>introduction</li>
</ol>
<p>CTCFæ˜¯ä¸€ç§æ™®éè¡¨è¾¾çš„å¿…éœ€è›‹ç™½ï¼Œåœ¨è®¸å¤šæ–¹é¢éƒ½æ˜¯ä¸€ç§ç‰¹æ®Šçš„è½¬å½•å› å­ã€‚å®ƒæœ€åˆè¢«æè¿°ä¸ºè½¬å½•<strong>æŠ‘åˆ¶</strong>å› å­ï¼Œä½†ä¹Ÿè¢«å‘ç°ä½œä¸ºè½¬å½•<strong>æ¿€æ´»</strong>å› å­ã€‚è¿˜å…·æœ‰<strong>ç»ç¼˜ä½“æ´»æ€§</strong>:å½“å®ƒä½äºå¢å¼ºå­å’ŒåŸºå› å¯åŠ¨å­ä¹‹é—´æ—¶ï¼Œå®ƒé˜»æ–­å®ƒä»¬çš„é€šä¿¡å¹¶é˜»æ­¢è½¬å½•æ¿€æ´»ã€‚é€šè¿‡<strong>ChIP-seq</strong>ç³»ç»Ÿç ”ç©¶ï¼Œåœ¨<strong>ä¸åŒç‰©ç§çš„è®¸å¤šç»„ç»‡</strong>ä¸­ç»˜åˆ¶CTCFåœ¨åŸºå› ç»„å°ºåº¦çš„ç»“åˆäº‹ä»¶ã€‚ç»“æœæ˜¾ç¤ºåŸºå› ç»„è¢«<strong>æ— æ•°çš„CTCFç»“åˆä½ç‚¹</strong>æ‰€è¦†ç›–ã€‚ä¸å¤§å¤šæ•°å…¶ä»–è½¬å½•å› å­ç›¸æ¯”ï¼ŒCTCFä¼¼ä¹<strong>æ›´å®¹æ˜“</strong>ä¸åŸºå› é—´åºåˆ—<strong>ç»“åˆ</strong>ï¼Œé€šå¸¸<strong>è·</strong>ç¦»è½¬å½•èµ·å§‹ä½ç‚¹(<strong>TSS</strong>)<strong>è¾ƒè¿œ</strong>ã€‚CTCFæ˜¯<strong>æœ€æ—©è¢«è¯å®ä»‹å¯¼æŸ“è‰²è´¨æˆç¯</strong>çš„è›‹ç™½ä¹‹ä¸€ã€‚è¿›ä¸€æ­¥è§‚å¯Ÿåˆ°ï¼Œå®ƒç»å¸¸ä¼š<strong>ç»“åˆ</strong>åˆ°ä½äºç»†èƒæ ¸ä¸­ä¸åŒä½ç½®çš„<strong>æŸ“è‰²ä½“åŒºåŸŸä¹‹é—´çš„è¾¹ç•Œ</strong>ï¼Œ<strong>ç»“åˆ</strong>å…·æœ‰<strong>ä¸åŒè¡¨è§‚é—ä¼ ç‰¹å¾</strong>å’Œ/æˆ–<strong>ä¸åŒè½¬å½•æ´»æ€§</strong>çš„<strong>åŒºåŸŸè¾¹ç•Œ</strong>ï¼Œä»¥åŠæœ€è¿‘ç¡®å®šçš„<strong>æ‹“æ‰‘åŸŸä¹‹é—´çš„è¾¹ç•Œ</strong>ï¼Œè¿™æ˜¯ç©ºé—´ä¸Šç¡®å®šçš„<strong>æŸ“è‰²ä½“å•ä½</strong>ï¼Œåœ¨å…¶ä¸­<strong>åºåˆ—ä¼˜å…ˆç›¸äº’ä½œç”¨</strong>ã€‚æœ¬æ–‡è®¨è®ºCTCFçš„ç ”ç©¶ï¼Œå¹¶è¯„ä¼°å…¶åœ¨<strong>åŸºå› ç»„æŠ˜å </strong>å’Œ<strong>åŸºå› è¡¨è¾¾</strong>ä¸­çš„åŠŸèƒ½ã€‚</p>
<ol start="2">
<li>CTCFåœ¨<strong>Î’-globin</strong>å’Œ<strong>h19-igf2</strong>ä½ç‚¹:ä¸€ä¸ªçŸ­æš‚çš„å†å²</li>
</ol>
<p>å¤šåŠŸèƒ½DNAç»“åˆè›‹ç™½CTCFçš„åŠŸèƒ½æœ€åˆæ˜¯åœ¨<strong>å•ä¸ªä½ç‚¹</strong>ä¸Šæ¢ç´¢çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨<strong>Î²-ç è›‹ç™½ä½ç‚¹</strong>å’Œ<strong>å°è¿¹H19-Igf2ä½ç‚¹</strong>ã€‚<strong>chicken Î²-ç è›‹ç™½ä½ç‚¹</strong>åœ¨å…¶5 â€˜ä¾§æºå¸¦ä¸€ä¸ªDNaseIè¶…æ•ä½ç‚¹(5 â€˜ hs4)ï¼Œè¯¥ä½ç‚¹å°†è¯¥ä½ç‚¹<strong>ä¸é‚»è¿‘çš„å¼‚æŸ“è‰²è´¨åˆ†ç¦»</strong>ï¼Œè¯¥ä½ç‚¹è¢«å‘ç°èƒ½å¤Ÿ<strong>é˜»æ–­å¢å¼ºå­æ´»æ€§</strong>ã€‚CTCFéšåè¢«è¯æ˜ä¸5 â€˜ hs4çš„ç»ç¼˜ä½“æ´»æ€§æœ‰å…³ã€‚äººå’Œå°é¼ çš„Î²-ç è›‹ç™½ä½ç‚¹ä¹Ÿä½äºä¸æ´»è·ƒæŸ“è‰²è´¨çš„å¤§æŸ“è‰²ä½“åŒºåŸŸå†…ï¼Œå¹¶ç±»ä¼¼åœ°è¢«ctcfç»“åˆä½ç‚¹åŒ…å›´ã€‚è¿™äº›è¢«æ€€ç–‘ä¼šå¯¹è¿›å…¥çš„å¼‚æŸ“è‰²è´¨å½¢æˆå±éšœï¼Œä½†å®ƒä»¬çš„ç¼ºå¤±ä¸ä¼šå¯¼è‡´Î²-ç è›‹ç™½ä½ç‚¹çš„å…³é—­æˆ–å¤±æ´»ã€‚<strong>æŸ“è‰²ä½“æ„è±¡æ•è·(3C)æŠ€æœ¯</strong>çš„åº”ç”¨ä½¿Î²-ç è›‹ç™½CTCFä½ç‚¹çš„ç‰©ç†ç›¸äº’ä½œç”¨æˆä¸ºå¯èƒ½ã€‚å®ƒä»¬å½¢æˆ<strong>å¤§æŸ“è‰²è´¨ç¯</strong>ï¼ŒåŒ…æ‹¬Î²-ç è›‹ç™½çš„ä¸»è¦è°ƒèŠ‚å…ƒä»¶ï¼Œ<strong>Locus control regionåŸºå› ä½ç‚¹æ§åˆ¶åŒº(LCR)<strong>åŠå…¶</strong>åŸºå› </strong>ã€‚è¿™äº›ç¯æ˜¯çº¢ç»†èƒç‰¹å¼‚æ€§çš„ï¼Œåœ¨lcrä»‹å¯¼çš„Î²-ç è›‹ç™½åŸºå› é«˜è¡¨è¾¾ä¹‹å‰ï¼Œåœ¨çº¢ç»†èƒç¥–ç»†èƒä¸­å½¢æˆ(å›¾1a;)ã€‚æ®æ¨æµ‹ï¼ŒCTCFç¯å¯ä»¥<strong>ä¿ƒè¿›LCRä¸å…¶é¶åŸºå› ä¹‹é—´çš„åç»­ç©ºé—´ç›¸äº’ä½œç”¨</strong>ï¼Œä½†è¿™æ–¹é¢çš„è¯æ®ä»ç„¶ç¼ºä¹ã€‚</p>
<p><img src="/blog/2022/02/15/2022-02-15-CTCF/1.png"></p>
<p>Figure 1. CTCFï¼ŒæŸ“è‰²è´¨ç¯å’Œç‰¹å®šåŸºå› ä½ç‚¹çš„è½¬å½•è°ƒæ§ã€‚(a)<strong>ä½äºÎ²-ç è›‹ç™½ä½ç‚¹çš„åŸºå› </strong>å—<strong>åŸºå› ä½ç‚¹æ§åˆ¶åŒº(LCR)*<em><strong>æ§åˆ¶ã€‚</strong>ctcfç»“åˆä½ç‚¹ç›¸äº’ä½œç”¨</em>*ï¼Œå½¢æˆ</strong>æŸ“è‰²è´¨æ¢çº½<strong>ï¼Œå…¶ä¸­åŒ…å«</strong>LCRå’ŒÎ²-ç è›‹ç™½åŸºå› <strong>ã€‚åœ¨</strong>çº¢ç»†èƒåˆ†åŒ–<strong>æ—¶ï¼Œ</strong>çº¢ç»†èƒç‰¹å¼‚æ€§è½¬å½•å› å­å’Œå†…èšè›‹ç™½èƒ½å¤Ÿå½¢æˆä¸€ä¸ªæ´»è·ƒçš„æŸ“è‰²è´¨æ¢çº½<strong>ï¼Œå…¶ä¸­</strong>LCRä¸åŸºå› æ¥è§¦å¹¶å¢å¼ºå…¶è¡¨è¾¾<strong>ã€‚(b) H19å’ŒIgf2åŸºå› çš„å°è¿¹è¡¨è¾¾æ˜¯é€šè¿‡CTCFåœ¨å°è¿¹æ§åˆ¶åŒº(ICR)çš„ç”²åŸºåŒ–ä¾èµ–ç»“åˆä»‹å¯¼çš„ã€‚(i)åœ¨çˆ¶ç³»ç­‰ä½åŸºå› ä¸Šï¼ŒICRçš„ç”²åŸºåŒ–</strong>é˜»æ­¢CTCFç»“åˆ**ï¼Œå¹¶é€šè¿‡è¿œç«¯å¢å¼ºå­(E)ä¸Igf2å¯åŠ¨å­çš„æ¥è§¦ä»‹å¯¼Igf2åŸºå› çš„è¡¨è¾¾ã€‚(ii) <strong>CTCFç»“åˆåœ¨ICRä¸Šé˜»æ–­äº†Igf2åŸºå› å’Œè¿œç«¯å¢å¼ºå­ä¹‹é—´çš„é€šä¿¡</strong>ï¼Œä»è€Œå¯¼è‡´æ¯æºç­‰ä½åŸºå› H19åŸºå› çš„è¡¨è¾¾ã€‚</p>
<p>å°è¿¹H19/Igf2ä½ç‚¹ã€‚è¯¥ä½ç‚¹åŒ…å«ä¸€ä¸ª<strong>å·®å¼‚ç”²åŸºåŒ–åŒºåŸŸ</strong>ï¼Œç§°ä¸º<strong>å°è¿¹æ§åˆ¶åŒº(ICR)<strong>ï¼Œä½äºH19å’ŒIgf2åŸºå› ä¹‹é—´ã€‚ICRå†³å®šäº†H19åœ¨</strong>æ¯ä½“ç­‰ä½åŸºå› </strong>ä¸Š<strong>æ´»è·ƒ</strong>ï¼Œè€Œ<strong>Igf2</strong>åˆ™æ˜¯ä»<strong>çˆ¶ç³»ç­‰ä½åŸºå› è½¬å½•</strong>è€Œæ¥çš„ã€‚å½“CTCFè¢«å‘ç°ä»¥<strong>ç”²åŸºåŒ–ä¾èµ–</strong>çš„æ–¹å¼ä¸<strong>ICRç»“åˆ</strong>æ—¶ï¼ŒCTCFè¿›å…¥äº†è¿™ä¸ªé˜¶æ®µ:<strong>CTCFä¸æœªç”²åŸºåŒ–çš„æ¯æºICRçš„ç»“åˆé˜»</strong>æ­¢äº†H19åŸºå› é™„è¿‘çš„å…±äº«å¢å¼ºå­<strong>è·¨è¶Šå¹¶æ¿€æ´»</strong>Igf2ã€‚åœ¨<strong>çˆ¶ç³»ç­‰ä½åŸºå› CTCFä¸èƒ½å‘æŒ¥å…¶ç»ç¼˜ä½“æ´»æ€§ï¼Œå› ä¸ºDNAç”²åŸºåŒ–é˜»æ­¢äº†å…¶ä¸ICRçš„ç»“åˆ</strong>(å›¾1b;)ã€‚æŸ“è‰²è´¨ç¯å†æ¬¡å½¢æˆï¼Œä¼¼ä¹å¯¹ICRçš„åŠŸèƒ½å¾ˆé‡è¦ã€‚å¸¦æœ‰å¢å¼ºå­å’Œå¯åŠ¨å­çš„ç­‰ä½åŸºå› ç‰¹å¼‚æ€§æŸ“è‰²è´¨ç¯æ˜¯ç”±æ¯ä½“çš„ã€ä¸ctcfç»“åˆçš„ICRå½¢æˆçš„ï¼Œè¿™è¡¨æ˜è¿™ç§æ¥è§¦å¯èƒ½æ˜¯ctcfä»‹å¯¼çš„ç»ç¼˜ä½“æ´»æ€§çš„åŸºç¡€ã€‚æ€»çš„æ¥è¯´ï¼Œæ—©æœŸå…³äºCTCFåœ¨Î²-ç è›‹ç™½å’ŒH19-Igf2ä½ç‚¹åŠŸèƒ½çš„ç ”ç©¶è¡¨æ˜ï¼Œè¯¥è›‹ç™½å¯ä»¥<strong>å¹²æ‰°å¯åŠ¨å­-å¢å¼ºå­é€šä¿¡</strong>ã€‚CTCFå¯ä»¥åœ¨å…¶ç»“åˆä½ç‚¹ä¹‹é—´å½¢æˆæŸ“è‰²è´¨ç¯ï¼Œä¹Ÿå¯èƒ½ä¸å…¶ä»–è°ƒæ§åºåˆ—å½¢æˆæŸ“è‰²è´¨ç¯ã€‚</p>
<ol start="3">
<li>CTCFé€šè¿‡åŸºå› ç»„ä¸æŸ“è‰²è´¨è¾¹ç•Œã€å¢å¼ºå­å’ŒåŸºå› å¯åŠ¨å­ç»“åˆ</li>
</ol>
<p>é€šè¿‡ChIPå¯¹å…¨åŸºå› ç»„ç»“åˆä½ç‚¹çš„å®šä½å‘ç°ï¼ŒCTCFå¯ä¸æ•°ä¸‡ä¸ªåŸºå› ç»„ä½ç‚¹ç»“åˆã€‚åœ¨ä¸åŒçš„ç»†èƒç±»å‹ä¸­ï¼Œå¤§çº¦<strong>ä¸‰åˆ†ä¹‹ä¸€çš„ä½ç‚¹ç›¸å¯¹ä¿å®ˆ</strong>ã€‚ä¸€é¡¹å¯¹äº”ç§å“ºä¹³åŠ¨ç‰©è‚è„ä¸­CTCFç»“åˆè°±çš„ç‰©ç§é—´æ¯”è¾ƒå‘ç°ï¼Œç‰©ç§å’Œç»„ç»‡ä¹‹é—´å¤§çº¦æœ‰5000ä¸ªè¶…<strong>ä¿å®ˆä½ç‚¹</strong>ã€‚è¿™äº›ä¼¼ä¹æ˜¯<strong>é«˜äº²å’ŒåŠ›çš„ç»“åˆä½ç‚¹</strong>ï¼Œæç¤ºäº²å’ŒåŠ›çš„å·®å¼‚å¯èƒ½ä¸çš„ä¿å®ˆå¼ºåº¦æœ‰å…³ã€‚é€†è½¬å½•å› å­çš„æ¿€æ´»äº§ç”Ÿäº†ç‰©ç§ç‰¹å¼‚æ€§çš„CTCFç»“åˆä½ç‚¹çš„æ‰©å±•ï¼Œè¿™ç§å½¢å¼çš„åŸºå› ç»„è¿›åŒ–åœ¨å“ºä¹³åŠ¨ç‰©ä¸­ä»ç„¶é«˜åº¦æ´»è·ƒã€‚åŸºäºä¸€è‡´motifè¯„åˆ†å¯¹CTCFç»“åˆä½ç‚¹è¿›è¡Œåˆ†ç±»å¾—å‡ºäº†ç±»ä¼¼çš„ç»“è®º:<strong>é«˜å ç”¨ä½ç‚¹ä¼¼ä¹åœ¨æ‰€æœ‰ç»†èƒç±»å‹ä¸­éƒ½æ˜¯ä¿å®ˆçš„ï¼Œè€Œä½å ç”¨ä½ç‚¹åˆ™æ›´å—ç»„ç»‡é™åˆ¶</strong>ã€‚</p>
<p>CTCFä¸€è‡´ç»“åˆåºåˆ—åŒ…å«CpGï¼Œå› æ­¤å¯èƒ½å—åˆ°DNAç”²åŸºåŒ–çš„å½±å“ã€‚CTCFèƒ½å¤Ÿåœ¨<strong>ä½“å¤–ç»“åˆç”²åŸºåŒ–DNAåºåˆ—</strong>ï¼Œä½†<strong>ä¼˜å…ˆç»“åˆæœªç”²åŸºåŒ–çš„åºåˆ—</strong>ï¼Œåœ¨H19-Igf2ä½ç‚¹ä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚äº‹å®ä¸Šï¼ŒDNAç”²åŸºåŒ–ä¼¼ä¹åœ¨CTCFçš„ä¸€äº›ç»„ç»‡ç‰¹å¼‚æ€§ç»“åˆäº‹ä»¶ä¸­å‘æŒ¥ä½œç”¨ã€‚æ­¤å¤–ï¼Œ<strong>CTCF</strong>å¯ä»¥é€šè¿‡ä¸ä¸¤ç§ä¸DNAç”²åŸºåŒ–ç›¸å…³çš„é…¶:å¤šèš(adp -æ ¸ç³–)èšåˆé…¶1 (<strong>PARP1</strong>)å’Œæ— å¤„ä¸åœ¨è¡¨è¾¾çš„DNA(èƒå˜§å•¶-5)ç”²åŸºè½¬ç§»é…¶1 (<strong>DNMT1</strong>)å½¢æˆ<strong>å¤åˆç‰©æ¥å½±å“DNAç”²åŸºåŒ–</strong>ã€‚<strong>CTCFæ¿€æ´»PARP1, PARP1åœ¨DNMT1ä¸Šæ·»åŠ adp -æ ¸ç³–åŸºå›¢ä½¿DNMT1å¤±æ´»ï¼Œä»è€Œç»´æŒæ— ç”²åŸºCpGsçš„å­˜åœ¨</strong>ã€‚</p>
<p><strong>éƒ¨åˆ†CTCFç»“åˆä½ç‚¹</strong>åœ¨<strong>æ´»æ€§æŸ“è‰²è´¨</strong>(<strong>é«˜H2K5Ac</strong>)å’Œ<strong>éæ´»æ€§</strong>æŸ“è‰²è´¨ç»“æ„åŸŸ(<strong>é«˜H3K27me3</strong>)ä¹‹<strong>é—´</strong>çš„è¿‡æ¸¡<strong>å¯Œé›†</strong>ã€‚å¯¹äºé€†è½¬å½•è½¬åº§çš„CTCFç»“åˆä½ç‚¹ä¼¼ä¹å°¤å…¶å¦‚æ­¤ã€‚CTCFä½ç‚¹ç»å¸¸ä½äºæ‰€è°“çš„<strong>è†œç›¸å…³åŸŸ</strong>(lad)æ—è¾¹ã€‚ladæ˜¯ä¸<strong>è¦†ç›–æ ¸è†œå†…ä¾§çš„å±‚çŠ¶è›‹ç™½ç½‘ç»œç›¸å…³çš„æŸ“è‰²ä½“åŒºåŸŸ</strong>;è¿™äº›æŸ“è‰²ä½“åŒºåŸŸå¾€å¾€æ˜¯<strong>è½¬å½•ä¸æ´»è·ƒ</strong>çš„ã€‚å®ƒçš„å­˜åœ¨æç¤º<strong>CTCFæœ‰åŠ©äºæŸ“è‰²è´¨çš„ä¸‰ç»´ç»“æ„çš„ç»„ç»‡</strong>ã€‚åœ¨æœè‡ä¸­ï¼ŒCTCFçš„æŠ‘åˆ¶å¯¼è‡´éæ´»æ€§åŸŸå†…H3K27me3æ°´å¹³çš„é™ä½ï¼Œè¡¨æ˜CTCFåœ¨è¾¹ç•Œä¸Šçš„ç»“åˆæ˜¯<strong>ç»´æŒæŠ‘åˆ¶</strong>æ‰€å¿…éœ€çš„ã€‚CTCFçš„å…³è”ä¼´éšç€ç»†èƒåˆ†åŒ–è¿‡ç¨‹ä¸­<strong>æ´»æ€§åŸŸå’Œéæ´»æ€§åŸŸçš„é‡ç½®</strong>ï¼Œè¿›ä¸€æ­¥è¡¨æ˜å®ƒçš„åŠŸèƒ½æ˜¯<strong>åˆ†ç¦»ä¸åŒçš„æŸ“è‰²è´¨çŠ¶æ€</strong>ã€‚ä¸€äº›ladåœ¨ç»†èƒåˆ†åŒ–è¿‡ç¨‹ä¸­ä¹Ÿä¼šå‘ç”ŸåŠ¨æ€å˜åŒ–[35]ï¼Œä½†CTCFæ˜¯å¦ä¸è¿™äº›å·®å¼‚ladçš„è¾¹ç•Œç»“åˆç›®å‰å°šä¸æ¸…æ¥šã€‚</p>
<p>å°½ç®¡CTCFç»“åˆå¸¸å‡ºç°åœ¨TSSsè¿œç«¯ï¼Œä½†å®ƒç¡®å®ä¸<strong>åŸºå› å¯†åº¦æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§</strong>(å›¾2a,b)ã€‚äº‹å®ä¸Šï¼ŒCTCFåœ¨è½¬å½•è°ƒæ§ä¸­<strong>ç›´æ¥ä½œç”¨çš„è¯æ®æ¥è‡ªäºæ—©æœŸå¯¹å•ä¸ªåŸºå› çš„ç ”ç©¶</strong>ã€‚åœ¨å…¨åŸºå› ç»„èŒƒå›´å†…ï¼Œéƒ¨åˆ†CTCFä½ç‚¹ä¸<strong>å¯åŠ¨å­ç‰¹å¼‚æ€§H3K4me3æ ‡è®°å…±å®šä½</strong>ï¼Œå¦ä¸€éƒ¨åˆ†ä¸<strong>å¢å¼ºå­æ ‡è®°H3K4me1é‡åˆ</strong>ã€‚å¯åŠ¨å­ä¸Šçš„CTCFç»“åˆäº‹ä»¶åœ¨ç»„ç»‡ä¸­è¶‹äº<strong>ä¿å®ˆ</strong>ï¼Œè€ŒCTCFä¸å¢å¼ºå­çš„ç»“åˆåˆ™æ›´å—<strong>ç»„ç»‡é™åˆ¶</strong>ã€‚</p>
<p><img src="/blog/2022/02/15/2022-02-15-CTCF/2.png"></p>
<p>Figure2. CTCFåœ¨æŸ“è‰²è´¨ç”Ÿç‰©å­¦ä¸­çš„å¹¿æ³›ä½œç”¨ã€‚(a) CTCFç»“åˆä½ç‚¹çš„å…¨åŸºå› ç»„åŠŸèƒ½åˆ†ç±»ï¼Œé‡‡ç”¨Chen et al.[36]ã€‚(b) (i) CTCFç»“åˆä½ç‚¹ä½äº<strong>åˆ†ç¦»æ´»æ€§åŸŸå’Œéæ´»æ€§åŸŸçš„è¾¹ç•Œ</strong>ä¸Šã€‚CTCFç»“åˆåˆ°(ii)<strong>å¢å¼ºå­</strong>æ ·åºåˆ—å’Œ(iv)åŸºå› <strong>å¯åŠ¨å­</strong>ä¸Šå¯ä»¥ä¿ƒè¿›è¿™äº›åºåˆ—ä¹‹é—´çš„ç¯ç¯ç›¸æ‰£ã€‚(iii) CTCFç»“åˆåœ¨<strong>å¢å¼ºå­å’ŒåŸºå› å¯åŠ¨å­ä¹‹é—´</strong>ï¼Œå¯ä»¥<strong>é˜»æ–­</strong>å¢å¼ºå­ä¸å…¶ç›®æ ‡å¯åŠ¨å­ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚</p>
<ol start="4">
<li>CTCFå’Œå†…èšè›‹ç™½å…±äº«DNAç»“åˆä½ç‚¹</li>
<li>5.ctcfå’Œå…¶ä»–ç»‘å®šä¼™ä¼´</li>
<li>CTCFåœ¨å•ä¸ªåŸºå› ä½ç‚¹çš„åŠŸèƒ½</li>
<li>CTCFä»‹å¯¼çš„å…¨åŸºå› ç»„æŸ“è‰²è´¨ç¯</li>
</ol>
<p>CTCFçš„åŸºå› ç»„ç»“åˆä½ç‚¹(é€šè¿‡å…¨åŸºå› ç»„<strong>ChIP</strong>)ä¸<strong>Hi-C</strong>ç”Ÿæˆçš„<strong>genome-wide DNA contact map</strong>çš„è®¡ç®—äº¤å‰è¡¨æ˜ï¼ŒCTCFå‚ä¸æŸ“è‰²ä½“ä¹‹é—´å’ŒåŸºå› ç»„å†…çš„æŸ“è‰²è´¨ç›¸äº’ä½œç”¨ã€‚æŸ“è‰²è´¨ç›¸äº’ä½œç”¨åˆ†æä¸é…å¯¹æœ«ç«¯æ ‡è®°æµ‹åº<strong>Chromatin interaction analysis with paired-end tag sequencing (ChIA-PET)</strong> ç»“åˆäº†ChIPå’Œ3Cæ–¹æ³•ï¼Œç”¨äºç ”ç©¶ç”±<strong>æ„Ÿå…´è¶£çš„è›‹ç™½è´¨ä»‹å¯¼çš„å…¨åŸºå› ç»„DNAç›¸äº’ä½œç”¨</strong>ã€‚å½“é¶å‘CTCFæ—¶ï¼ŒChIA-PETæ­ç¤ºäº†è›‹ç™½ä»‹å¯¼çš„å¤§çº¦<strong>1500ä¸ªæŸ“è‰²ä½“å†…</strong>å’Œ<strong>300ä¸ªæŸ“è‰²ä½“é—´</strong>çš„ç›¸äº’ä½œç”¨ã€‚éšåï¼Œæ ¹æ®<strong>ç»„è›‹ç™½æ ‡è®°</strong>çš„åˆ†å¸ƒï¼Œå¯¹<strong>æŸ“è‰²ä½“å†…ç¯</strong>æ‰€åŒ…å›´çš„<strong>åŒºåŸŸ(10-200 kb)è¿›è¡Œèšç±»</strong>ã€‚è¿™è¡¨æ˜CTCFç¯å¯ä»¥åŒ…å«ä»ç¯å¤–éæ´»æ€§æŸ“è‰²è´¨åˆ†ç¦»å‡ºæ¥çš„æ´»æ€§æŸ“è‰²è´¨ï¼Œåä¹‹äº¦ç„¶ã€‚CTCFè¿˜å¯ä»¥åŒæ—¶<strong>æ•è·æŸ“è‰²è´¨ç¯ä¸­çš„å¢å¼ºå­å’Œå¯åŠ¨å­</strong>ã€‚åœ¨å¤§çº¦<strong>40000ä¸ªCTCFç»“åˆä½ç‚¹</strong>ä¸­ï¼Œåªæœ‰<strong>ä¸€å°éƒ¨åˆ†</strong>å‚ä¸äº†å¤§çº¦1500ä¸ªCTCFä»‹å¯¼çš„<strong>ç¯</strong>ã€‚è¿™æ„å‘³ç€ä¸æ˜¯æ‰€æœ‰CTCFä»‹å¯¼çš„ç›¸äº’ä½œç”¨éƒ½è¢«è¯†åˆ«å‡ºæ¥äº†ï¼Œæˆ–è€…<strong>å¤§å¤šæ•°CTCFä½ç‚¹æ²¡æœ‰å‚ä¸ç¯çš„å½¢æˆ</strong>ã€‚</p>
<p>åè€…å¾ˆå¯èƒ½æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸º5C(<strong>chromosome conformation capture carbon copy</strong>æŸ“è‰²ä½“æ„è±¡æ•è·ç¢³å¤åˆ¶)æŠ€æœ¯è¡¨æ˜ï¼Œåœ¨1%çš„åŸºå› ç»„ä¸­ï¼Œå¤§å¤šæ•°CTCFä½ç‚¹ä¸å‚ä¸æŸ“è‰²è´¨ç¯ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦è¢«å†…èšè›‹ç™½å…±åŒå æ®ã€‚<strong>CTCFç»“åˆåºåˆ—å¸¸è¢«åŸºå› å¯åŠ¨å­è·³è¿‡ï¼Œä¸å¢å¼ºå­æˆ–æ›´è¿œçš„CTCFä½ç‚¹è¿›è¡Œæ¥è§¦</strong>ã€‚</p>
<p>æœ€è¿‘å¤§é‡çš„å…¨åŸºå› ç»„DNAç›¸äº’ä½œç”¨æ•°æ®é›†æœ‰åŠ©äº<strong>è¯„ä¼°CTCFå¯¹æŸ“è‰²ä½“æ‹“æ‰‘çš„å½±å“</strong>ã€‚æŸ“è‰²ä½“ä¸Šé è¿‘<strong>CTCFç»“åˆä½ç‚¹çš„åºåˆ—</strong>æ˜¾ç¤ºåœ¨å®ƒä»¬çš„DNAæ¥è§¦ä¸­å­˜åœ¨åå€š:å®ƒä»¬ä¸<strong>CTCFä½ç‚¹åŒä¾§</strong>çš„å…¶ä»–<strong>åºåˆ—çš„ç›¸äº’ä½œç”¨</strong>å¤§äºä¸<strong>CTCFä½ç‚¹è·¨ä¾§</strong>çš„åºåˆ—çš„ç›¸äº’ä½œç”¨(å›¾3a;)ã€‚åŒæ ·çš„ç»“æœä¹Ÿå‡ºç°åœ¨æœè‡ä¸­å¦ä¸€ç§ä¸åŒçš„ç»ç¼˜ä½“è›‹ç™½ä¸Š:å®ƒä¸ä¸€ä¸ªä½ç‚¹çš„ç»“åˆé˜»æ­¢äº†ä¾§ç¿¼åºåˆ—åœ¨è¿™ä¸ªä½ç‚¹ä¸Šç›¸äº’æ¥è§¦ã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™å¯èƒ½ä¸ºç»ç¼˜ä½“çš„åŠŸèƒ½æä¾›äº†ä¸€ç§è§£é‡Š:å®ƒä»¬å¯ä»¥é˜»æ­¢DNAåœ¨ç»ç¼˜åºåˆ—ä¸Šçš„ç©ºé—´æ¥è§¦ã€‚åœ¨ä¸€ä¸ªç‰¹åˆ«è¯¦ç»†çš„å…¨åŸºå› ç»„DNAæ¥è§¦ç ”ç©¶ä¸­ï¼Œ<strong>æ‹“æ‰‘åŸŸ</strong>è¢«å®šä¹‰;å®ƒä»¬æ˜¯<strong>å¹³å‡å¤§å°ä¸º1mbçš„æŸ“è‰²ä½“åŒºåŸŸ</strong>ï¼Œå…¶ä¸­<strong>åºåˆ—ä¼˜å…ˆç›¸äº’ä½œç”¨</strong>ã€‚åœ¨ç»„ç»‡ä¹‹é—´ï¼Œç”šè‡³åœ¨ç‰©ç§ä¹‹é—´ï¼Œæ‹“æ‰‘ç»“æ„åŸŸå…·æœ‰å¾ˆå¼ºçš„<strong>ä¿æŒæ€§</strong>ï¼Œè¿™è¡¨æ˜è¿™äº›ç»“æ„åŸŸå¯¹<strong>ç»†èƒçš„ç‰¹å¼‚æ€§èº«ä»½æ²¡æœ‰è´¡çŒ®</strong>ã€‚æœ‰è¶£çš„æ˜¯ï¼ŒCTCFç»“åˆä½ç‚¹åœ¨è¿™äº›<strong>åŒºåŸŸè¾¹ç•Œå‘¨å›´çš„20kbçª—å£ä¸­å¯Œé›†</strong>(å›¾3b)ï¼Œå†æ¬¡å¼ºè°ƒäº†å…¶ä½œä¸º<strong>æŸ“è‰²è´¨ç»„ç»‡è€…</strong>çš„ä½œç”¨ã€‚å…¶ä¸­ä¸€é¡¹ç ”ç©¶è¡¨æ˜ï¼Œè¾¹ç•Œçš„ç ´åä¼šå¯¼è‡´æ‹“æ‰‘åŸŸçš„æ··åˆï¼Œå¹¶å¯¼è‡´ç›¸å…³åŸºå› çš„è¡¨è¾¾å¤±è°ƒ[79]ã€‚ä¸åŒäºæ‹“æ‰‘åŸŸæœ¬èº«ï¼ŒåŸŸå†…çš„æ¥è§¦åœ¨åˆ†åŒ–è¿‡ç¨‹ä¸­æ˜¯å˜åŒ–çš„ã€‚åœ¨è¿™é‡Œï¼ŒCTCFä¼¼ä¹å‘æŒ¥äº†ä½œç”¨ï¼Œå¯èƒ½é€‚åº”åŸºå› è¡¨è¾¾çš„å‘è‚²å˜åŒ–ã€‚</p>
<p><img src="/blog/2022/02/15/2022-02-15-CTCF/3.png"></p>
<p>Fig 3. CTCFé€šè¿‡é˜»ç¢DNAåœ¨å…¶ç»“åˆä½ç‚¹ä¸Šçš„æ¥è§¦è€Œèµ·åˆ°ç»ç¼˜ä½“çš„ä½œç”¨ã€‚(a) CTCF<strong>é˜»ç¢å…¶ç»“åˆä½ç‚¹åœ¨10kbä»¥å†…çš„åºåˆ—è·¨è¶Š</strong>ã€‚<strong>çº¿çš„åšåº¦å‡å°è¡¨æ˜äº¤äº’ä½œç”¨çš„æ¦‚ç‡å‡å°</strong>ã€‚(b) CTCFç»“åˆä½ç‚¹å¸¸å‡ºç°åœ¨æ‹“æ‰‘åŸŸçš„è¾¹ç•Œå¤„ã€‚(i) ESCså’Œçš®è´¨çš„Hi-cæ•°æ®ï¼Œç”¨å°é¼ ç¬¬12å·æŸ“è‰²ä½“åºåˆ—ä¹‹é—´çš„é¢œè‰²ç¼–ç æ¥è§¦é¢‘ç‡ã€‚<strong>ä¸‰è§’å½¢</strong>æ˜¾ç¤ºå’Œçªå‡º<strong>æ‹“æ‰‘åŸŸ</strong>ï¼Œæ˜¯<strong>æŸ“è‰²ä½“åºåˆ—ä¼˜å…ˆç›¸äº’ä½œç”¨çš„åŒºåŸŸ</strong>ã€‚(ii)å±‚å…³è”åŸŸ(LAD)æ•°æ®ï¼ŒLADè¾¹ç•Œä¸æ‹“æ‰‘åŸŸè¾¹ç•Œé‡åˆã€‚(iii) CTCF ChIP-seq profilesï¼Œæ˜¾ç¤ºåœ¨è¾¹ç•Œçš„CTCFç»“åˆä½ç‚¹ç°‡ã€‚è¯·æ³¨æ„ï¼Œè¿™ç§CTCFé›†ç¾¤åœ¨å…¶ä»–åœ°æ–¹ä¹Ÿå­˜åœ¨ï¼Œç‰¹åˆ«æ˜¯åœ¨éladåœ°åŒºã€‚æ˜¾ç¤ºåŒºåŸŸ:chr12: 112.3-119.3 Mb (mm9)ã€‚</p>
<ol start="8">
<li>ç»“è®º</li>
</ol>
<p>å°½ç®¡CTCFä¸€ç›´æ˜¯ç ”ç©¶çš„çƒ­ç‚¹ï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ç§<strong>ç¥ç§˜çš„è½¬å½•å› å­</strong>ã€‚å®ƒä¸åŸºå› ç»„ä¸­æˆåƒä¸Šä¸‡ä¸ªä½ç‚¹ç»“åˆï¼Œä¸å¤§é‡å…¶ä»–è½¬å½•å› å­ç›¸äº’ä½œç”¨ã€‚å®ƒå¸¸è¢«å‘ç°å‚ä¸æŸ“è‰²è´¨<strong>ç¯</strong>ï¼Œæœ‰æ—¶æœ‰ï¼Œæœ‰æ—¶æ²¡æœ‰<strong>å†…èšè›‹ç™½</strong>çš„å‚ä¸ã€‚å®ƒå¯ä»¥<strong>ä¸å…¶ä»–CTCFç»“åˆä½ç‚¹</strong>å½¢<strong>æˆ</strong>æŸ“è‰²è´¨<strong>ç¯</strong>ï¼Œä¹Ÿå¯ä»¥ä¸<strong>å¢å¼ºå­</strong>å’Œ<strong>å¯åŠ¨å­</strong>åºåˆ—å½¢<strong>æˆ</strong>æŸ“è‰²è´¨<strong>ç¯</strong>ã€‚CTCFä¸ä»…ä¸åŸºå› å†…å¤–çš„åºåˆ—ç»“åˆï¼Œä¹Ÿä¸<strong>åŸºå› ä½“å†…</strong>çš„<strong>åºåˆ—ç»“åˆ</strong>ï¼Œåœ¨åŸºå› ä½“å†…å®ƒä¼¼ä¹èƒ½å¤Ÿ<strong>æš‚åœæ»‘åŠ¨èšåˆé…¶åˆ†å­</strong>ã€‚æœ€åï¼ŒCTCFç»“åˆä½ç‚¹ä»ç„¶ä½œä¸º<strong>åè½¬å½•è½¬åº§åºåˆ—</strong>æ´»è·ƒåœ°è·³è·ƒï¼Œä½¿CTCFç»“åˆæ™¯è§‚åœ¨ä¸åŒå“ºä¹³åŠ¨ç‰©ç‰©ç§ä¹‹é—´å…·æœ‰å¤šæ ·æ€§ã€‚</p>
<p>å¯ä»¥è§£é‡ŠCTCFä¸æŸ“è‰²è´¨å…³è”çš„è®¸å¤šï¼Œ<strong>æœ‰æ—¶æ˜¯ç›¸åçš„åŠŸèƒ½</strong>åæœçš„ç»Ÿä¸€ä¸»é¢˜å¯èƒ½æ˜¯å…¶<strong>æˆç¯èƒ½åŠ›</strong>ã€‚æ ¹æ®ç¯ä¸­åŒ…å«çš„åºåˆ—å’Œç¯å¤–çš„åºåˆ—ï¼Œç”±CTCFå½¢æˆçš„æŸ“è‰²è´¨å¯èƒ½ä¼š<strong>ä¿ƒè¿›æˆ–é˜»ç¢å¢å¼ºå­å’Œé¶åŸºå› ä¹‹é—´çš„ä¸‰ç»´æ¥è§¦</strong>ï¼Œä»è€Œäº§ç”Ÿä¸åŒçš„è½¬å½•ç»“æœã€‚è®¸å¤šé—®é¢˜ä»ç„¶å­˜åœ¨:ä¸ºä»€ä¹ˆä¸€äº›CTCFä½ç‚¹å½¢æˆæŸ“è‰²è´¨ç¯è€Œå¦ä¸€äº›åˆ™æ²¡æœ‰?è¿™åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¾èµ–äºç›¸å…³çš„è›‹ç™½è´¨å› å­?å½“è›‹ç™½è´¨ä¸æŸ“è‰²è´¨ç»“åˆæ—¶ï¼Œå®ƒæ˜¯å¦‚ä½•è®¾æ³•ä¸è¿™ä¹ˆå¤šå…¶ä»–è½¬å½•å› å­ç›¸äº’ä½œç”¨çš„?ä¸€ç§å¯èƒ½æ˜¯CTCFä½œä¸ºæŸ“è‰²è´¨æ‰«æè½¬å½•å› å­çš„è·¯éšœï¼Œå½“é‡åˆ°ç»“åˆè›‹ç™½æ—¶ï¼Œè¿™äº›è½¬å½•å› å­ä»¥æŸç§æ–¹å¼è¢«å›°ä½ã€‚ctcfä»‹å¯¼çš„æŸ“è‰²ä½“é—´æ¥è§¦æœ‰ä½•ç›¸å…³æ€§?CTCFæ˜¯å¦é€šè¿‡é˜»æ­¢3D DNAæ¥è§¦æ¥é˜»æ–­å¢å¼ºå­-å¯åŠ¨å­é€šä¿¡?æˆ–è€…ç»ç¼˜æ˜¯å¦æ¶‰åŠç»ç¼˜ä½“åºåˆ—ä¸å¢å¼ºå‰‚å’Œå¯åŠ¨å‰‚çš„ç‰©ç†ç›¸äº’ä½œç”¨?è¿™äº›é—®é¢˜çš„ç­”æ¡ˆéœ€è¦èƒ½å¤Ÿé¢„æµ‹ç»™å®šçš„CTCFç»“åˆäº‹ä»¶æ˜¯å¦åœ¨åŠŸèƒ½ä¸Šä¸ç›¸å…³ï¼Œæ˜¯å¦ä¼šå¼•èµ·è½¬å½•æ¿€æ´»æˆ–æŠ‘åˆ¶ï¼Œæ˜¯å¦ä¼šå¹²æ‰°è½¬å½•æ¿€æ´»æˆ–ä¼šäº§ç”ŸæŸ“è‰²è´¨è¾¹ç•Œã€‚</p>
]]></content>
      <categories>
        <category>biology</category>
      </categories>
      <tags>
        <tag>paper</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€GOã€‘ã€KEGGã€‘</title>
    <url>/blog/2021/12/20/2021_12_20_GO_KEGG_post/</url>
    <content><![CDATA[<h2 id="Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘"><a href="#Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘" class="headerlink" title="Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘"></a>Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘</h2><span id="more"></span>

<p><strong>GOåˆ†æ</strong>ï¼šåŸºå› -&gt;åŠŸèƒ½ç±»ç¾¤</p>
<p>**KEGG(Pathway)**ï¼šåŸºå› -&gt;ä»£è°¢ç½‘ç»œ</p>
<p><strong>GO/KEGGé€‰å–ç›®æ ‡åŸºå› </strong></p>
<ul>
<li><p>æŒ‡æ ‡ï¼šEnrichment scoreï¼Œpå€¼ï¼ŒFDR</p>
</li>
<li><p>pathwayï¼špå’ŒFDRè¶Šå°è¶Šå¥½ï¼Œé—®é¢˜æ˜¯æœ‰æ—¶æœ¬å°±ä¸æ˜“å¯Œé›†å‡ºï¼Œå¦‚ä½•å–èˆ</p>
</li>
<li><p>GOï¼špï¼ŒFDRï¼ŒEnrichmentscoreï¼ˆè¶Šå¤§è¶Šå®¹æ˜“å—åˆ°å½±å“ï¼‰</p>
</li>
<li><p><font color="green">fold changeè¾ƒå¤§çš„åŸºå› </font>ï¼ˆupï¼Œdownï¼‰</p>
</li>
<li><p>å¯èƒ½æœ‰ç”¨çš„è›‹ç™½ï¼ŒPPIï¼Ÿ</p>
</li>
</ul>
<p>GO: ç ”ç©¶çš„åŸºå› å“ªäº›é€šè·¯ï¼Ÿæ˜¯å¦å˜åŒ–</p>
<p><strong>KEGGç­›é€‰æ–¹æ³•ï¼š</strong></p>
<ul>
<li>å…ˆçœ‹KEGGçš„èšç±»åˆ†æç»“æœï¼ˆæ„Ÿå…´è¶£ç ”ç©¶æ–¹å‘æœ‰å…³çš„åŸºå› æ˜¯ä¸æ˜¯æœ‰å·®å¼‚ï¼‰â†’ GOåˆ†ä¸ºä¸‰ä¸ªåˆ†æï¼Œå…ˆçœ‹BPåˆ†æï¼ˆæ„Ÿå…´è¶£ç ”ç©¶æ–¹å‘æœ‰å…³çš„åŸºå› æ˜¯ä¸æ˜¯æœ‰å·®å¼‚ï¼‰â†’æŒ‘é€‰å’Œæˆ‘ä»¬ç ”ç©¶æ¯”è¾ƒç›¸å…³çš„â†’åæœŸéªŒè¯ï¼šé€‰FCæ¯”è¾ƒå¤§ï¼ŒéªŒè¯æˆåŠŸç‡ä¼šé«˜ä¸€äº›</li>
<li>æ ¹æ®Rich factorå€¼ã€Qvalueå€¼æˆ–<font color="green">å¯Œé›†åˆ°æ­¤é€šè·¯ä¸Šçš„åŸºå› ä¸ªæ•°æ¥è¡¡é‡KEGGçš„å¯Œé›†ç¨‹åº¦</font>ï¼Œæ‰¾åˆ°å¯Œé›†æœ€æ˜¾è‘—çš„é€šè·¯</li>
<li>æ‰¾è‡ªå·±æ„Ÿå…´è¶£çš„ï¼šé«˜åŸååº”-&gt;å‘¼å¸åŠŸèƒ½ç›¸å…³é€šè·¯ï¼Œå…ç–«ç³»ç»Ÿ-&gt;ç‚ç—‡å› å­ã€TNFç›¸å…³é€šè·¯</li>
<li>ä»é€šè·¯ä¸­å»æ‰¾åˆ°<font color="green">è¡¨è¾¾å€æ•°æ˜¾è‘—çš„åŸºå› è¿›è¡ŒéªŒè¯</font>ï¼Œè¿›ä¸€æ­¥è§£é‡Šç›¸å…³åˆ†å­è¡¨è¾¾æœºåˆ¶</li>
</ul>
<p><strong>ç›®æ ‡è¡¨ç¤º</strong></p>
<p>HOTAIRå‡ºæ²¡äºèƒæ ¸ï¼ˆCCï¼‰ï¼Œå‚ä¸äº†ç»„è›‹ç™½ç”²åŸºåŒ–è°ƒæ§å¼•å‘ç™ŒåŸºå› æ²‰é»˜ï¼ˆBPï¼‰ï¼Œå…·ä½“æ˜¯ç»“åˆPRC2å¤åˆç‰©ä»¥åŠLSD1ï¼ˆMFï¼‰</p>
<hr>
<p><strong>è½¬å½•ç»„æ•°æ®ä¸­ç­›é€‰å…³é”®åŸºå› </strong></p>
<p>ç­›é€‰å…³é”®åŸºå› çš„æ–¹æ³•æœ‰3ç±»ï¼š</p>
<p>1.è¡¨è¾¾é‡ï¹¢åŠŸèƒ½å¯Œé›†</p>
<p>2.è¡¨è¾¾é‡ï¹¢å®éªŒ</p>
<p>3.è¡¨è¾¾é‡ï¹¢åºåˆ—</p>
<p>ä¸Šé¢çš„ä¸‰ç§æ–¹æ³•ä¸éš¾çœ‹å‡ºï¼Œç­›é€‰å…³é”®åŸºå› çš„<font color="green">æ ¸å¿ƒ</font>æ˜¯<font color="green">è¡¨è¾¾é‡</font>ï¼Œå…¶å®è½¬å½•ç»„çš„æ ¸å¿ƒå°±æ˜¯ä»¥è¡¨è¾¾é‡ä¸ºæ ¸å¿ƒå±•å¼€å…¶ä»–åˆ†æçš„ï¼Œç„¶åå†é™„åŠ å…¶ä»–ä¸€äº›ä¿¡æ¯ï¼Œæ‰¾å‡ºç›®æ ‡åŸºå› ï¼›æœ€åå°†åˆ†æç»“æœä¸ç ”ç©¶ç›®çš„å·§å¦™èåˆï¼Œå¦‚æœå†åšä¸€äº›åŸºå› åŠŸèƒ½å®éªŒéªŒè¯ï¼ˆé«˜åˆ†å¿…å¤‡ï¼Œå¯ä¸åšï¼‰ï¼Œä¸€ç¯‡é«˜è´¨é‡çš„æ–‡ç« å°±okäº†ã€‚</p>
<p><strong>1.è¡¨è¾¾é‡ï¹¢åŠŸèƒ½å¯Œé›†</strong></p>
<p>Zhu T, Wang X, Xu Z, Xu J, Li R, et al. (2020) Screening of key genes responsible for Pennisetum setaceum â€˜Rubrumâ€™ leaf color using tranome sequencing. PLOS ONE 15(11): e0242618.</p>
<p>è¯¥æ–‡ç ”ç©¶å¯¹è±¡ç‹¼å°¾è‰è§‚èµè‰æ¤ç‰©ï¼Œ<font color="green">é«˜å…‰</font>ç¯äº§ç´«è‰²å¶å­ï¼Œ<font color="green">ä½å…‰</font>äº§æµ…ç´«è‰²æˆ–ç»¿è‰²å¶å­ã€‚è¯¥æ–‡é‰´å®šä¸<font color="green">å¶ç‰‡ç€è‰²ç›¸å…³çš„å…³é”®åŸºå› </font>ï¼Œå¹¶é˜æ˜å‚ä¸ç‹¼å°¾è‰å¶å­çš„é¢œè‰²å˜åŒ–çš„åˆ†å­æœºåˆ¶ã€‚</p>
<p>å·®å¼‚è¡¨è¾¾åŸºå› åˆ†ææ€»å…±é‰´å®šäº†19043ä¸ªDEGsï¼Œä¸T0ï¼ˆæœªå¤„ç†é˜¶æ®µçš„å¶å­ï¼‰é˜¶æ®µçš„è¡¨è¾¾ç›¸æ¯”ï¼Œåœ¨T1ï¼ˆé®é˜´12å¤©åæ–°å¶å­å®Œå…¨å˜ç»¿çš„é˜¶æ®µï¼‰é˜¶æ®µä¸Šè°ƒå’Œä¸‹è°ƒçš„åŸºå› åˆ†åˆ«ä¸º10761å’Œ8642ã€‚<font color="green">KEGGå¯Œé›†åˆ†æå‘ç°ï¼Œæ˜¾è‘—å¯Œé›†çš„é€šè·¯ä¸»è¦æœ‰ç±»é»„é…®çš„ç”Ÿç‰©åˆæˆï¼Œé»„é…®å’Œé»„é…®é†‡çš„ç”Ÿç‰©åˆæˆä»¥åŠç±»èƒ¡èåœç´ çš„ç”Ÿç‰©åˆæˆ</font>ã€‚<font color="red">åŸºå› ç­›é€‰(æ˜¾è‘—KEGGå†…çš„åŸºå› ç­›é€‰ï¼Ÿ)</font>å‘ç°å­˜åœ¨ä¸<strong>å¶ç»¿ç´ ä»£è°¢</strong>æœ‰å…³çš„31ä¸ªå·®å¼‚è¡¨è¾¾åŸºå› ï¼Œå…¶ä¸­21ä¸ªä¸å¶ç»¿ç´ çš„ç”Ÿç‰©<strong>åˆæˆ</strong>æœ‰å…³ï¼Œæœ‰10ä¸ªä¸å¶ç»¿ç´ çš„<strong>é™è§£</strong>æœ‰å…³ï¼Œä»¥åŠ3ä¸ªä¸å¶ç»¿ç´ <strong>é™è§£è°ƒæ§</strong>æœ‰å…³çš„è½¬å½•å› å­ï¼Œ<strong>èŠ±é’ç´ çš„åˆæˆå’Œç§¯</strong>ç´¯æœ‰31ä¸ªå…³é”®é…¶åŸºå› ï¼Œ4ä¸ªå¯èƒ½å‚ä¸<strong>èŠ±è‰²è‹·ä»£è°¢è°ƒæ§</strong>çš„è½¬å½•å› å­ï¼ˆå›¾1æ‰€ç¤ºï¼‰ ã€‚</p>
<p><img src="/blog/2021/12/20/2021_12_20_GO_KEGG_post/selectDEG.png" alt="selectDEG"></p>
<p>å¿«é€Ÿç­›é€‰å‡ºæ„Ÿå…´è¶£çš„åŸºå› ï¼šåŸºå› é•¿åº¦ã€åŸºå› åœ¨æ ·å“ä¸­çš„è¡¨è¾¾é‡ã€<strong>å·®å¼‚å€æ•°</strong>ã€<strong>æ³¨é‡Šä¿¡æ¯</strong>ç­‰ã€‚</p>
<p><font color="green">æ‰¾æ˜¾è‘—é€šè·¯é‡Œçš„åŸºå› ã€‚åšä¸€ä¸ªä¿¡æ¯è¡¨ã€‚</font></p>
<p><strong>2.è¡¨è¾¾é‡ï¹¢å®éªŒ</strong></p>
<p>Wang A, Chao T, Ji Z, Xuan R, Liu S, Guo M, Wang G, Wang J. 2020. Tranome analysis reveals potential immune function-related regulatory genes/pathways of female Lubo goat submandibular glands at different developmental stages. PeerJ 8:e9947.</p>
<p>è¯¾é¢˜ç»„å‰æœŸçš„åŸºå› åŠŸèƒ½å®éªŒæˆ–æ–‡çŒ®æŸ¥é˜…æ¥å€ŸåŠ©åˆ«äººçš„å·²ç»éªŒè¯è¿‡çš„åŸºå› åŠŸèƒ½ç»“æœï¼Œä¹‹åå†æ ¹æ®è¡¨è¾¾é‡ç­›é€‰å…³é”®åŸºå› ã€‚</p>
<p>è½¬å½•ç»„ç ”ç©¶çš„ç›®çš„å°±æ˜¯å¯»æ‰¾ä¸å®éªŒè®¾è®¡ç›¸å…³çš„å…³é”®åŸºå› ï¼Œä¸€èˆ¬æ¥è¯´ç ”ç©¶æŸç”Ÿç†ç°è±¡éƒ½å…ˆè¦é˜…è¯»å¤§é‡æ–‡çŒ®æ¥åˆ¤æ–­è¯¥å®éªŒçš„å¯è¡Œæ€§ã€‚å¦‚è½¬å½•ç»„åˆ†ææ­ç¤ºäº†é›Œæ€§é²æ³¢<strong>å±±ç¾Šä¸‹é¢Œè…º</strong>åœ¨<strong>ä¸åŒå‘è‚²é˜¶æ®µ</strong>çš„æ½œåœ¨<strong>å…ç–«åŠŸèƒ½ç›¸å…³è°ƒèŠ‚åŸºå› </strong>æˆ–é€”å¾„</p>
<p>è¯¥æ–‡ç ”ç©¶çš„ç›®çš„æ˜¯é€šè¿‡<strong>è½¬å½•ç»„æµ‹åº</strong>æ¥<strong>å®šä½</strong>å·®å¼‚è¡¨è¾¾åŸºå› ï¼ˆDEGï¼‰åœ¨<strong>ä¸‰ä¸ªä¸åŒé˜¶æ®µçš„è¡¨è¾¾è°±</strong>ï¼Œé¢„æµ‹åœ¨<strong>ä¸åŒå‘è‚²é˜¶æ®µ</strong>çš„<strong>ä¸‹é¢Œä¸‹è…ºçš„å…ç–«åŠŸèƒ½</strong>ã€‚ç”±äº<strong>äººã€å°é¼ ã€å¤§é¼ ã€ç‰›</strong>çš„ä¸‹é¢Œè…ºéƒ½æ£€æµ‹åˆ°äº†<strong>ç›¸å…³æŠ—ä½“</strong>ï¼Œå¹¶ä¸”ç ”ç©¶å‘ç°äº†ä¸‹é¢Œè…ºä¸­çš„<strong>ç±»çº¢ç»†èƒåˆ†åŒ–å› å­ã€å†…çš®ç´ ã€è‚ç»†èƒç”Ÿé•¿å› å­ï¼ˆHGFï¼‰ã€è½¬ç§»æ€§ç”Ÿé•¿å› å­ï¼ˆMGFï¼‰ã€è½¬åŒ–ç”Ÿé•¿å› å­-Î±ï¼ˆTGF-Î±ï¼‰å’Œå…¶ä»–å› å­</strong>ã€‚æ‰€ä»¥åœ¨<strong>åç»­çš„åŸºå› ç­›é€‰ä¸­ä¼šé‡ç‚¹å…³æ³¨ç›¸å…³å› å­çš„è¡¨è¾¾åŸºå› </strong>ã€‚</p>
<p>ä»ä¸Šé¢ä¾‹å­ä¸­å¯ä»¥å‘ç°ä¸€ä¸ª<strong>å¥—è·¯</strong>ï¼Œå…ˆæŸ¥é˜…æ¨¡å¼ç”Ÿç‰©ä¸­è¯¥æ–¹é¢çš„ç ”ç©¶ç»“æœï¼Œç„¶åå†ç»“åˆè‡ªå·±çš„ç ”ç©¶é¡¹ç›®ç­›é€‰å‡ºåŸºå› ï¼Œå¹¶ä¸”<strong>é‡ç‚¹å…³æ³¨æ¨¡å¼ç”Ÿç‰©ä¸­å·²çŸ¥çš„åŠŸèƒ½åŸºå› æœ‰æ²¡æœ‰è¾ƒå¤§çš„å·®å¼‚å€æ•°</strong>ã€‚</p>
<hr>
<p>refï¼š</p>
<p><a href="https://zhuanlan.zhihu.com/p/78093534">https://zhuanlan.zhihu.com/p/78093534</a></p>
<p><a href="https://www.sohu.com/a/437865907_278730">https://www.sohu.com/a/437865907_278730</a></p>
<hr>
<h1 id="è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢"><a href="#è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢" class="headerlink" title="è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢"></a>è½¬å½•ç»„å›¾å½¢ä¸“é¢˜ä¹‹å·®å¼‚åŸºå› ç›¸å…³å›¾å½¢</h1><p>é›·è¾¾å›¾ã€çƒ­å›¾ã€æŸ±çŠ¶å›¾ã€éŸ¦æ©å›¾ã€ç«å±±å›¾</p>
<p><a href="https://www.sohu.com/a/428207189_278730">https://www.sohu.com/a/428207189_278730</a></p>
<h1 id="å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£"><a href="#å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£" class="headerlink" title="å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£"></a>å…¨å¥—çš„å¯Œé›†åˆ†æç›¸å…³å›¾å½¢è¯¦è§£</h1><p>æŸ±å½¢å›¾ï¼Œæ°”æ³¡å›¾ï¼Œåœˆå›¾ï¼Œz-scoreå›¾ï¼Œç½‘ç»œå›¾</p>
<p><a href="https://www.sohu.com/a/436470973_278730">https://www.sohu.com/a/436470973_278730</a></p>
]]></content>
      <categories>
        <category>GO</category>
        <category>KEGG</category>
      </categories>
      <tags>
        <tag>O_Sativa</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux command awk</title>
    <url>/blog/2021/12/17/2021_12_17_Linux_awk_command/</url>
    <content><![CDATA[<h2 id="Linux-command-ã€awkã€‘"><a href="#Linux-command-ã€awkã€‘" class="headerlink" title="Linux command ã€awkã€‘"></a>Linux command ã€awkã€‘</h2><span id="more"></span>

<h1 id="Linux-awk-å‘½ä»¤"><a href="#Linux-awk-å‘½ä»¤" class="headerlink" title="Linux awk å‘½ä»¤"></a>Linux awk å‘½ä»¤</h1><p><a href="https://www.runoob.com/linux/linux-command-manual.html"><img src="https://www.runoob.com/images/up.gif" alt="Linux å‘½ä»¤å¤§å…¨"> Linux å‘½ä»¤å¤§å…¨</a></p>
<p>AWK æ˜¯ä¸€ç§<font color="green">å¤„ç†æ–‡æœ¬æ–‡ä»¶</font>çš„è¯­è¨€ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ã€‚</p>
<p>ä¹‹æ‰€ä»¥å« AWK æ˜¯å› ä¸ºå…¶å–äº†ä¸‰ä½åˆ›å§‹äºº Alfred <strong>A</strong>hoï¼ŒPeter <strong>W</strong>einberger, å’Œ Brian <strong>K</strong>ernighan çš„ Family Name çš„é¦–å­—ç¬¦ã€‚</p>
<h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">awk [é€‰é¡¹å‚æ•°] <span class="string">&#x27;script&#x27;</span> var=value file(s)</span><br><span class="line">æˆ–</span><br><span class="line">awk [é€‰é¡¹å‚æ•°] -f scriptfile var=value file(s)</span><br></pre></td></tr></table></figure>

<p><strong>é€‰é¡¹å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li>-F fs or â€“field-separator fs<br>æŒ‡å®šè¾“å…¥æ–‡ä»¶æŠ˜åˆ†éš”ç¬¦ï¼Œfsæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚<font color="green">-F:</font>ã€‚</li>
<li>-v var=value or â€“asign var=value<br>èµ‹å€¼ä¸€ä¸ªç”¨æˆ·å®šä¹‰å˜é‡ã€‚</li>
<li>-f scripfile or â€“file scriptfile<br>ä»è„šæœ¬æ–‡ä»¶ä¸­è¯»å–awkå‘½ä»¤ã€‚</li>
<li>-W posix<br>æ‰“å¼€å…¼å®¹æ¨¡å¼ã€‚ä½†æœ‰ä»¥ä¸‹é™åˆ¶ï¼Œä¸è¯†åˆ«ï¼š/xã€å‡½æ•°å…³é”®å­—ã€funcã€æ¢ç åºåˆ—ä»¥åŠå½“fsæ˜¯ä¸€ä¸ªç©ºæ ¼æ—¶ï¼Œå°†æ–°è¡Œä½œä¸ºä¸€ä¸ªåŸŸåˆ†éš”ç¬¦ï¼›æ“ä½œç¬¦<strong>å’Œ</strong>=ä¸èƒ½ä»£æ›¿^å’Œ^=ï¼›fflushæ— æ•ˆ?</li>
<li>-W version or â€“version<br>æ‰“å°<font color="green">bugæŠ¥å‘Šä¿¡æ¯</font>çš„ç‰ˆæœ¬ã€‚</li>
</ul>
<hr>
<h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><p>log.txtæ–‡æœ¬å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">2 this is a <span class="built_in">test</span></span><br><span class="line">3 Are you like awk</span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">10 There are orange,apple,mongo</span></span><br></pre></td></tr></table></figure>

<p>ç”¨æ³•ä¸€ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;[pattern] action&#125;&#x27;</span> &#123;filenames&#125;   <span class="comment"># è¡ŒåŒ¹é…è¯­å¥ awk &#x27;&#x27; åªèƒ½ç”¨å•å¼•å·</span></span><br></pre></td></tr></table></figure>

<p>å®ä¾‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¯è¡ŒæŒ‰ç©ºæ ¼æˆ–TABåˆ†å‰²ï¼Œè¾“å‡ºæ–‡æœ¬ä¸­çš„1ã€4é¡¹</span></span><br><span class="line"> $ awk <span class="string">&#x27;&#123;print $1,$4&#125;&#x27;</span> log.txt</span><br><span class="line"> ---------------------------------------------</span><br><span class="line"> 2 a</span><br><span class="line"> 3 like</span><br><span class="line"> This<span class="string">&#x27;s</span></span><br><span class="line"><span class="string"> 10 orange,apple,mongo</span></span><br><span class="line"><span class="string"> # æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line"><span class="string"> $ awk &#x27;</span>&#123;<span class="built_in">printf</span> <span class="string">&quot;%-8s %-10s\n&quot;</span>,<span class="variable">$1</span>,<span class="variable">$4</span>&#125;<span class="string">&#x27; log.txt</span></span><br><span class="line"><span class="string"> ---------------------------------------------</span></span><br><span class="line"><span class="string"> 2        a</span></span><br><span class="line"><span class="string"> 3        like</span></span><br><span class="line"><span class="string"> This&#x27;</span>s</span><br><span class="line"> 10       orange,apple,mongo</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p><font color="green">ç”¨æ³•äºŒï¼š</font></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">awk -F  <span class="comment">#-Fç›¸å½“äºå†…ç½®å˜é‡FS, æŒ‡å®šåˆ†å‰²å­—ç¬¦</span></span><br></pre></td></tr></table></figure>

<p>å®ä¾‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨&quot;,&quot;åˆ†å‰²</span></span><br><span class="line"> $  awk -F, <span class="string">&#x27;&#123;print $1,$2&#125;&#x27;</span>   log.txt</span><br><span class="line"> ---------------------------------------------</span><br><span class="line"> 2 this is a <span class="built_in">test</span></span><br><span class="line"> 3 Are you like awk</span><br><span class="line"> This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string"> 10 There are orange apple</span></span><br><span class="line"><span class="string"> # æˆ–è€…ä½¿ç”¨å†…å»ºå˜é‡</span></span><br><span class="line"><span class="string"> $ awk &#x27;</span>BEGIN&#123;FS=<span class="string">&quot;,&quot;</span>&#125; &#123;<span class="built_in">print</span> <span class="variable">$1</span>,<span class="variable">$2</span>&#125;<span class="string">&#x27;     log.txt</span></span><br><span class="line"><span class="string"> ---------------------------------------------</span></span><br><span class="line"><span class="string"> 2 this is a test</span></span><br><span class="line"><span class="string"> 3 Are you like awk</span></span><br><span class="line"><span class="string"> This&#x27;</span>s a <span class="built_in">test</span></span><br><span class="line"> 10 There are orange apple</span><br><span class="line"> <span class="comment">#! ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦.å…ˆä½¿ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œç„¶åå¯¹åˆ†å‰²ç»“æœå†ä½¿ç”¨&quot;,&quot;åˆ†å‰²</span></span><br><span class="line"> $ awk -F <span class="string">&#x27;[ ,]&#x27;</span>  <span class="string">&#x27;&#123;print $1,$2,$5&#125;&#x27;</span>   log.txt</span><br><span class="line"> ---------------------------------------------</span><br><span class="line"> 2 this <span class="built_in">test</span></span><br><span class="line"> 3 Are awk</span><br><span class="line"> This<span class="string">&#x27;s a</span></span><br><span class="line"><span class="string"> 10 There apple</span></span><br></pre></td></tr></table></figure>

<p><font color="green">ç”¨æ³•ä¸‰ï¼š</font>-va -vb</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">awk -v  # è®¾ç½®å˜é‡</span><br></pre></td></tr></table></figure>

<p>å®ä¾‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ awk -va=1 <span class="string">&#x27;&#123;print $1,$1+a&#125;&#x27;</span> log.txt</span><br><span class="line">---------------------------------------------</span><br><span class="line">2 3</span><br><span class="line">3 4</span><br><span class="line">This<span class="string">&#x27;s 1</span></span><br><span class="line"><span class="string">10 11</span></span><br><span class="line"><span class="string">$ awk -va=1 -vb=s &#x27;</span>&#123;<span class="built_in">print</span> <span class="variable">$1</span>,<span class="variable">$1</span>+a,<span class="variable">$1b</span>&#125;<span class="string">&#x27; log.txt</span></span><br><span class="line"><span class="string">---------------------------------------------</span></span><br><span class="line"><span class="string">2 3 2s</span></span><br><span class="line"><span class="string">3 4 3s</span></span><br><span class="line"><span class="string">This&#x27;</span>s 1 This<span class="string">&#x27;ss</span></span><br><span class="line"><span class="string">10 11 10s</span></span><br></pre></td></tr></table></figure>

<p>ç”¨æ³•å››ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">awk -f &#123;awkè„šæœ¬&#125; &#123;æ–‡ä»¶å&#125;</span><br></pre></td></tr></table></figure>

<p>å®ä¾‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ awk -f cal.awk log.txt</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h2><table>
<thead>
<tr>
<th align="left">è¿ç®—ç¬¦</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">= += -= *= /= %= ^= **=</td>
<td align="left">èµ‹å€¼</td>
</tr>
<tr>
<td align="left">?:</td>
<td align="left">Cæ¡ä»¶è¡¨è¾¾å¼</td>
</tr>
<tr>
<td align="left">||</td>
<td align="left">é€»è¾‘æˆ–</td>
</tr>
<tr>
<td align="left">&amp;&amp;</td>
<td align="left">é€»è¾‘ä¸</td>
</tr>
<tr>
<td align="left">~ å’Œ !~</td>
<td align="left">åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼å’Œä¸åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</td>
</tr>
<tr>
<td align="left">&lt; &lt;= &gt; &gt;= != ==</td>
<td align="left">å…³ç³»è¿ç®—ç¬¦</td>
</tr>
<tr>
<td align="left">ç©ºæ ¼</td>
<td align="left">è¿æ¥</td>
</tr>
<tr>
<td align="left">+ -</td>
<td align="left">åŠ ï¼Œå‡</td>
</tr>
<tr>
<td align="left">* / %</td>
<td align="left">ä¹˜ï¼Œé™¤ä¸æ±‚ä½™</td>
</tr>
<tr>
<td align="left">+ - !</td>
<td align="left">ä¸€å…ƒåŠ ï¼Œå‡å’Œé€»è¾‘é</td>
</tr>
<tr>
<td align="left">^ ***</td>
<td align="left">æ±‚å¹‚</td>
</tr>
<tr>
<td align="left">++ â€“</td>
<td align="left">å¢åŠ æˆ–å‡å°‘ï¼Œä½œä¸ºå‰ç¼€æˆ–åç¼€</td>
</tr>
<tr>
<td align="left">$</td>
<td align="left">å­—æ®µå¼•ç”¨</td>
</tr>
<tr>
<td align="left">in</td>
<td align="left">æ•°ç»„æˆå‘˜</td>
</tr>
</tbody></table>
<p>è¿‡æ»¤ç¬¬ä¸€åˆ—å¤§äº2çš„è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ awk &#x27;$1&gt;2&#x27; log.txt    #å‘½ä»¤</span><br><span class="line">#è¾“å‡º</span><br><span class="line">3 Are you like awk</span><br><span class="line">This&#x27;s a test</span><br><span class="line">10 There are orange,apple,mongo</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤ç¬¬ä¸€åˆ—ç­‰äº2çš„è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ awk &#x27;$1==2 &#123;print $1,$3&#125;&#x27; log.txt    #å‘½ä»¤</span><br><span class="line">#è¾“å‡º</span><br><span class="line">2 is</span><br></pre></td></tr></table></figure>

<p><font color="green">è¿‡æ»¤ç¬¬ä¸€åˆ—å¤§äº2å¹¶ä¸”ç¬¬äºŒåˆ—ç­‰äºâ€™Areâ€™çš„è¡Œ</font></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ awk &#x27;$1&gt;2 &amp;&amp; $2==&quot;Are&quot; &#123;print $1,$2,$3&#125;&#x27; log.txt    #å‘½ä»¤</span><br><span class="line">#è¾“å‡º</span><br><span class="line">3 Are you</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å†…å»ºå˜é‡"><a href="#å†…å»ºå˜é‡" class="headerlink" title="å†…å»ºå˜é‡"></a>å†…å»ºå˜é‡</h2><table>
<thead>
<tr>
<th align="left">å˜é‡</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$n</td>
<td align="left">å½“å‰è®°å½•çš„<font color="green">ç¬¬nä¸ªå­—æ®µ</font>ï¼Œå­—æ®µé—´ç”±FSåˆ†éš”</td>
</tr>
<tr>
<td align="left"><font color="red">$0</font></td>
<td align="left"><font color="green">å®Œæ•´çš„è¾“å…¥è®°å½•</font></td>
</tr>
<tr>
<td align="left">ARGC</td>
<td align="left">å‘½ä»¤è¡Œå‚æ•°çš„æ•°ç›®</td>
</tr>
<tr>
<td align="left">ARGIND</td>
<td align="left">å‘½ä»¤è¡Œä¸­å½“å‰æ–‡ä»¶çš„ä½ç½®(ä»0å¼€å§‹ç®—)</td>
</tr>
<tr>
<td align="left">ARGV</td>
<td align="left">åŒ…å«å‘½ä»¤è¡Œå‚æ•°çš„æ•°ç»„</td>
</tr>
<tr>
<td align="left">CONVFMT</td>
<td align="left">æ•°å­—è½¬æ¢æ ¼å¼(é»˜è®¤å€¼ä¸º%.6g)ENVIRONç¯å¢ƒå˜é‡å…³è”æ•°ç»„</td>
</tr>
<tr>
<td align="left">ERRNO</td>
<td align="left">æœ€åä¸€ä¸ªç³»ç»Ÿé”™è¯¯çš„æè¿°</td>
</tr>
<tr>
<td align="left">FIELDWIDTHS</td>
<td align="left">å­—æ®µå®½åº¦åˆ—è¡¨(ç”¨ç©ºæ ¼é”®åˆ†éš”)</td>
</tr>
<tr>
<td align="left">FILENAME</td>
<td align="left">å½“å‰æ–‡ä»¶å</td>
</tr>
<tr>
<td align="left"><strong>FNR</strong></td>
<td align="left">å„æ–‡ä»¶åˆ†åˆ«è®¡æ•°çš„è¡Œå·</td>
</tr>
<tr>
<td align="left"><strong>FS</strong></td>
<td align="left">å­—æ®µåˆ†éš”ç¬¦(é»˜è®¤æ˜¯ä»»ä½•ç©ºæ ¼)</td>
</tr>
<tr>
<td align="left">IGNORECASE</td>
<td align="left">å¦‚æœä¸ºçœŸï¼Œåˆ™è¿›è¡Œå¿½ç•¥å¤§å°å†™çš„åŒ¹é…</td>
</tr>
<tr>
<td align="left"><strong>NF</strong></td>
<td align="left">ä¸€æ¡è®°å½•çš„å­—æ®µçš„æ•°ç›®</td>
</tr>
<tr>
<td align="left"><strong>NR</strong></td>
<td align="left">å·²ç»è¯»å‡ºçš„è®°å½•æ•°ï¼Œå°±æ˜¯è¡Œå·ï¼Œä»1å¼€å§‹</td>
</tr>
<tr>
<td align="left">OFMT</td>
<td align="left">æ•°å­—çš„è¾“å‡ºæ ¼å¼(é»˜è®¤å€¼æ˜¯%.6g)</td>
</tr>
<tr>
<td align="left"><strong>OFS</strong></td>
<td align="left">è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤å€¼ä¸è¾“å…¥å­—æ®µåˆ†éš”ç¬¦ä¸€è‡´ã€‚</td>
</tr>
<tr>
<td align="left"><strong>ORS</strong></td>
<td align="left">è¾“å‡ºè®°å½•åˆ†éš”ç¬¦(é»˜è®¤å€¼æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦)</td>
</tr>
<tr>
<td align="left">RLENGTH</td>
<td align="left">ç”±matchå‡½æ•°æ‰€åŒ¹é…çš„å­—ç¬¦ä¸²çš„é•¿åº¦</td>
</tr>
<tr>
<td align="left">RS</td>
<td align="left">è®°å½•åˆ†éš”ç¬¦(é»˜è®¤æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦)</td>
</tr>
<tr>
<td align="left">RSTART</td>
<td align="left">ç”±matchå‡½æ•°æ‰€åŒ¹é…çš„å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªä½ç½®</td>
</tr>
<tr>
<td align="left">SUBSEP</td>
<td align="left">æ•°ç»„ä¸‹æ ‡åˆ†éš”ç¬¦(é»˜è®¤å€¼æ˜¯/034)</td>
</tr>
</tbody></table>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#çœ‹å„å˜é‡å€¼</span></span><br><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;printf &quot;%4s %4s %4s %4s %4s %4s %4s %4s %4s\n&quot;,&quot;FILENAME&quot;,&quot;ARGC&quot;,&quot;FNR&quot;,&quot;FS&quot;,&quot;NF&quot;,&quot;NR&quot;,&quot;OFS&quot;,&quot;ORS&quot;,&quot;RS&quot;;printf &quot;---------------------------------------------\n&quot;&#125; &#123;printf &quot;%4s %4s %4s %4s %4s %4s %4s %4s %4s\n&quot;,FILENAME,ARGC,FNR,FS,NF,NR,OFS,ORS,RS&#125;&#x27;</span>  log.txt</span><br><span class="line">FILENAME ARGC  FNR   FS   NF   NR  OFS  ORS   RS</span><br><span class="line">---------------------------------------------</span><br><span class="line">log.txt    2    1         5    1</span><br><span class="line">log.txt    2    2         5    2</span><br><span class="line">log.txt    2    3         3    3</span><br><span class="line">log.txt    2    4         4    4</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºé¡ºåºå· NR, åŒ¹é…æ–‡æœ¬è¡Œå·</span></span><br><span class="line">$ awk <span class="string">&#x27;&#123;print NR,FNR,$1,$2,$3&#125;&#x27;</span> log.txt</span><br><span class="line">---------------------------------------------</span><br><span class="line">1 1 2 this is</span><br><span class="line">2 2 3 Are you</span><br><span class="line">3 3 This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">4 4 10 There are</span></span><br><span class="line"><span class="string"># æŒ‡å®šè¾“å‡ºåˆ†å‰²ç¬¦</span></span><br><span class="line"><span class="string">$  awk &#x27;</span>&#123;<span class="built_in">print</span> <span class="variable">$1</span>,<span class="variable">$2</span>,<span class="variable">$5</span>&#125;<span class="string">&#x27; OFS=&quot; $ &quot;  log.txt</span></span><br><span class="line"><span class="string">---------------------------------------------</span></span><br><span class="line"><span class="string">2 $ this $ test</span></span><br><span class="line"><span class="string">3 $ Are $ awk</span></span><br><span class="line"><span class="string">This&#x27;</span>s $ a $</span><br><span class="line">10 $ There $</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…"><a href="#ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…" class="headerlink" title="ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…"></a><font color="green">ä½¿ç”¨æ­£åˆ™ï¼Œå­—ç¬¦ä¸²åŒ¹é…</font></h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¾“å‡ºç¬¬äºŒåˆ—åŒ…å« &quot;th&quot;ï¼Œå¹¶æ‰“å°ç¬¬äºŒåˆ—ä¸ç¬¬å››åˆ—</span></span><br><span class="line">$ awk <span class="string">&#x27;$2 ~ /th/ &#123;print $2,$4&#125;&#x27;</span> log.txt</span><br><span class="line">---------------------------------------------</span><br><span class="line">this a</span><br><span class="line"><span class="comment">#$0æ˜¯b.txtæ¯ä¸€è¡Œå…¨éƒ¨å­—æ®µï¼Œ-i &#123;&#125; a.txt ä¸€è¡Œä¸€è¡Œèµ‹å€¼ç»™ &#123;&#125;</span></span><br><span class="line">cat a.txt | xargs -i awk <span class="string">&#x27;BEGIN&#123;FS=&quot;\t&quot;&#125; $0 ~/&#123;&#125;/ &#123; print &#125;&#x27;</span> b.txt &gt; c.txt</span><br></pre></td></tr></table></figure>

<p><strong>~ è¡¨ç¤ºæ¨¡å¼å¼€å§‹ã€‚// ä¸­æ˜¯æ¨¡å¼ã€‚</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¾“å‡ºåŒ…å« &quot;re&quot; çš„è¡Œ</span></span><br><span class="line">$ awk <span class="string">&#x27;/re/ &#x27;</span> log.txt</span><br><span class="line">---------------------------------------------</span><br><span class="line">3 Are you like awk</span><br><span class="line">10 There are orange,apple,mongo</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å¿½ç•¥å¤§å°å†™"><a href="#å¿½ç•¥å¤§å°å†™" class="headerlink" title="å¿½ç•¥å¤§å°å†™"></a>å¿½ç•¥å¤§å°å†™</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;IGNORECASE=1&#125; /this/&#x27;</span> log.txt</span><br><span class="line">---------------------------------------------</span><br><span class="line">2 this is a <span class="built_in">test</span></span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="æ¨¡å¼å–å"><a href="#æ¨¡å¼å–å" class="headerlink" title="æ¨¡å¼å–å"></a>æ¨¡å¼å–å</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">this is</span><br><span class="line">Are you</span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">There are</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$ awk &#x27;</span><span class="variable">$2</span> !~ /th/ &#123;<span class="built_in">print</span> <span class="variable">$2</span>,<span class="variable">$4</span>&#125;<span class="string">&#x27; log.txt</span></span><br><span class="line"><span class="string">---------------------------------------------</span></span><br><span class="line"><span class="string">Are like</span></span><br><span class="line"><span class="string">a</span></span><br><span class="line"><span class="string">There orange,apple,mongo</span></span><br><span class="line"><span class="string">$ awk &#x27;</span>!/th/ &#123;<span class="built_in">print</span> <span class="variable">$2</span>,<span class="variable">$4</span>&#125;<span class="string">&#x27; log.txt</span></span><br><span class="line"><span class="string">---------------------------------------------</span></span><br><span class="line"><span class="string">Are like</span></span><br><span class="line"><span class="string">a</span></span><br><span class="line"><span class="string">There orange,apple,mongo</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="awkè„šæœ¬"><a href="#awkè„šæœ¬" class="headerlink" title="awkè„šæœ¬"></a>awkè„šæœ¬</h2><p>å…³äº awk è„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸¤ä¸ªå…³é”®è¯ BEGIN å’Œ ENDã€‚</p>
<ul>
<li>BEGIN{ è¿™é‡Œé¢æ”¾çš„æ˜¯<font color="green">æ‰§è¡Œå‰</font>çš„è¯­å¥ }</li>
<li>END {è¿™é‡Œé¢æ”¾çš„æ˜¯å¤„ç†å®Œ<font color="green">æ‰€æœ‰çš„è¡Œåè¦æ‰§è¡Œ</font>çš„è¯­å¥ }</li>
<li>{è¿™é‡Œé¢æ”¾çš„æ˜¯å¤„ç†<font color="green">æ¯ä¸€è¡Œæ—¶</font>è¦æ‰§è¡Œçš„è¯­å¥}</li>
</ul>
<p>å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶ï¼ˆå­¦ç”Ÿæˆç»©è¡¨ï¼‰ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ cat score.txt</span><br><span class="line">Marry   2143 78 84 77</span><br><span class="line">Jack    2321 66 78 45</span><br><span class="line">Tom     2122 48 77 71</span><br><span class="line">Mike    2537 87 97 95</span><br><span class="line">Bob     2415 40 57 62</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çš„ awk è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ cat cal.awk</span><br><span class="line"><span class="comment">#!/bin/awk -f</span></span><br><span class="line"><span class="comment">#è¿è¡Œå‰</span></span><br><span class="line">BEGIN &#123;</span><br><span class="line">    math = 0</span><br><span class="line">    english = 0</span><br><span class="line">    computer = 0</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL\n&quot;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;---------------------------------------------\n&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#è¿è¡Œä¸­</span></span><br><span class="line">&#123;</span><br><span class="line">    math+=<span class="variable">$3</span></span><br><span class="line">    english+=<span class="variable">$4</span></span><br><span class="line">    computer+=<span class="variable">$5</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%-6s %-6s %4d %8d %8d %8d\n&quot;</span>, <span class="variable">$1</span>, <span class="variable">$2</span>, <span class="variable">$3</span>,<span class="variable">$4</span>,<span class="variable">$5</span>, <span class="variable">$3</span>+<span class="variable">$4</span>+<span class="variable">$5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#è¿è¡Œå</span></span><br><span class="line">END &#123;</span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;---------------------------------------------\n&quot;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;  TOTAL:%10d %8d %8d \n&quot;</span>, math, english, computer</span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;AVERAGE:%10.2f %8.2f %8.2f\n&quot;</span>, math/NR, english/NR, computer/NR</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ‰§è¡Œç»“æœï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ awk -f cal.awk score.txt</span><br><span class="line">NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL</span><br><span class="line">---------------------------------------------</span><br><span class="line">Marry  2143     78       84       77      239</span><br><span class="line">Jack   2321     66       78       45      189</span><br><span class="line">Tom    2122     48       77       71      196</span><br><span class="line">Mike   2537     87       97       95      279</span><br><span class="line">Bob    2415     40       57       62      159</span><br><span class="line">---------------------------------------------</span><br><span class="line">  TOTAL:       319      393      350</span><br><span class="line">AVERAGE:     63.80    78.60    70.00</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å¦å¤–ä¸€äº›å®ä¾‹"><a href="#å¦å¤–ä¸€äº›å®ä¾‹" class="headerlink" title="å¦å¤–ä¸€äº›å®ä¾‹"></a>å¦å¤–ä¸€äº›å®ä¾‹</h2><p>AWK çš„ hello world ç¨‹åºä¸ºï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">BEGIN &#123; <span class="built_in">print</span> <span class="string">&quot;Hello, world!&quot;</span> &#125;</span><br></pre></td></tr></table></figure>

<p>è®¡ç®—æ–‡ä»¶å¤§å°</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ ls -l *.txt | awk <span class="string">&#x27;&#123;sum+=$5&#125; END &#123;print sum&#125;&#x27;</span></span><br><span class="line">--------------------------------------------------</span><br><span class="line">666581</span><br></pre></td></tr></table></figure>

<p>ä»æ–‡ä»¶ä¸­æ‰¾å‡º<font color="green">é•¿åº¦å¤§äº 80 çš„è¡Œ</font>ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">awk <span class="string">&#x27;length&gt;80&#x27;</span> log.txt</span><br></pre></td></tr></table></figure>

<p>æ‰“å°ä¹ä¹ä¹˜æ³•è¡¨</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">seq 9 | sed <span class="string">&#x27;H;g&#x27;</span> | awk -v RS=<span class="string">&#x27;&#x27;</span> <span class="string">&#x27;&#123;for(i=1;i&lt;=NF;i++)printf(&quot;%dx%d=%d%s&quot;, i, NR, i*NR, i==NR?&quot;\n&quot;:&quot;\t&quot;)&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ›´å¤šå†…å®¹ï¼š</p>
<ul>
<li><a href="https://www.runoob.com/w3cnote/awk-work-principle.html">AWK å·¥ä½œåŸç†</a></li>
<li><a href="https://www.runoob.com/w3cnote/awk-arrays.html">AWK æ•°ç»„</a></li>
<li><a href="https://www.runoob.com/w3cnote/awk-if-loop.html">AWK æ¡ä»¶è¯­å¥ä¸å¾ªç¯</a></li>
<li><a href="https://www.runoob.com/w3cnote/awk-user-defined-functions.html">AWK ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°</a></li>
<li><a href="https://www.runoob.com/w3cnote/awk-built-in-functions.html">AWK å†…ç½®å‡½æ•°</a></li>
<li><a href="https://www.runoob.com/w3cnote/8-awesome-awk-built-in-variables.html">8 ä¸ªæœ‰åŠ›çš„ Awk å†…å»ºå˜é‡</a></li>
<li><a href="http://www.gnu.org/software/gawk/manual/gawk.html">AWK å®˜æ–¹æ‰‹å†Œ</a></li>
</ul>
</blockquote>
<p><strong>awkã€sedã€grepæ›´é€‚åˆçš„æ–¹å‘ï¼š</strong></p>
<ul>
<li> grep æ›´é€‚åˆå•çº¯çš„æŸ¥æ‰¾æˆ–åŒ¹é…æ–‡æœ¬</li>
<li> sed æ›´é€‚åˆç¼–è¾‘åŒ¹é…åˆ°çš„æ–‡æœ¬</li>
<li> awk æ›´é€‚åˆæ ¼å¼åŒ–æ–‡æœ¬ï¼Œå¯¹æ–‡æœ¬è¿›è¡Œè¾ƒå¤æ‚æ ¼å¼å¤„ç†</li>
</ul>
<p>å…³äºawkå†…å»ºå˜é‡ä¸ªäººè§è§£ï¼Œç®€å•æ˜“æ‡‚</p>
<p>è§£é‡Šä¸€ä¸‹å˜é‡ï¼š</p>
<p>å˜é‡ï¼šåˆ†ä¸ºå†…ç½®å˜é‡å’Œè‡ªå®šä¹‰å˜é‡;è¾“å…¥åˆ†éš”ç¬¦FSå’Œè¾“å‡ºåˆ†éš”ç¬¦OFSéƒ½å±äºå†…ç½®å˜é‡ã€‚</p>
<p>å†…ç½®å˜é‡å°±æ˜¯awké¢„å®šä¹‰å¥½çš„ã€å†…ç½®åœ¨awkå†…éƒ¨çš„å˜é‡ï¼Œè€Œè‡ªå®šä¹‰å˜é‡å°±æ˜¯ç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚</p>
<ul>
<li> FS(Field Separator)ï¼šè¾“å…¥å­—æ®µåˆ†éš”ç¬¦ï¼Œ é»˜è®¤ä¸ºç©ºç™½å­—ç¬¦</li>
<li> OFS(Out of Field Separator)ï¼šè¾“å‡ºå­—æ®µåˆ†éš”ç¬¦ï¼Œ é»˜è®¤ä¸ºç©ºç™½å­—ç¬¦</li>
<li> RS(Record Separator)ï¼šè¾“å…¥è®°å½•åˆ†éš”ç¬¦(è¾“å…¥æ¢è¡Œç¬¦)ï¼Œ æŒ‡å®šè¾“å…¥æ—¶çš„æ¢è¡Œç¬¦</li>
<li> ORS(Output Record Separate)ï¼šè¾“å‡ºè®°å½•åˆ†éš”ç¬¦ï¼ˆè¾“å‡ºæ¢è¡Œç¬¦ï¼‰ï¼Œè¾“å‡ºæ—¶ç”¨æŒ‡å®šç¬¦å·ä»£æ›¿æ¢è¡Œç¬¦</li>
<li> NF(Number for Field)ï¼šå½“å‰è¡Œçš„å­—æ®µçš„ä¸ªæ•°(å³å½“å‰è¡Œè¢«åˆ†å‰²æˆäº†å‡ åˆ—)</li>
<li> NR(Number of Record)ï¼šè¡Œå·ï¼Œå½“å‰å¤„ç†çš„æ–‡æœ¬è¡Œçš„è¡Œå·ã€‚</li>
<li> FNRï¼šå„æ–‡ä»¶åˆ†åˆ«è®¡æ•°çš„è¡Œå·</li>
<li> ARGCï¼šå‘½ä»¤è¡Œå‚æ•°çš„ä¸ªæ•°</li>
<li> ARGVï¼šæ•°ç»„ï¼Œä¿å­˜çš„æ˜¯å‘½ä»¤è¡Œæ‰€ç»™å®šçš„å„å‚æ•°</li>
</ul>
<p><strong>è‡ªå®šä¹‰å˜é‡çš„æ–¹æ³•</strong></p>
<ul>
<li> æ–¹æ³•ä¸€ï¼š-v varname=value ï¼Œå˜é‡ååŒºåˆ†å­—ç¬¦å¤§å°å†™ã€‚</li>
<li> æ–¹æ³•äºŒï¼šåœ¨programä¸­ç›´æ¥å®šä¹‰ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux command xargs</title>
    <url>/blog/2021/12/17/2021_12_17_Linux_xargs_command/</url>
    <content><![CDATA[<h2 id="Linux-command-ã€xargsã€‘"><a href="#Linux-command-ã€xargsã€‘" class="headerlink" title="Linux command ã€xargsã€‘"></a>Linux command ã€xargsã€‘</h2><span id="more"></span>

<h1 id="Linux-xargs-å‘½ä»¤"><a href="#Linux-xargs-å‘½ä»¤" class="headerlink" title="Linux xargs å‘½ä»¤"></a>Linux xargs å‘½ä»¤</h1><p><a href="https://www.runoob.com/linux/linux-command-manual.html"><img src="/blog/Linux.command/up.gif" alt="Linux å‘½ä»¤å¤§å…¨"> Linux å‘½ä»¤å¤§å…¨</a></p>
<p>xargsï¼ˆè‹±æ–‡å…¨æ‹¼ï¼š eXtended ARGumentsï¼‰æ˜¯ç»™<font color="green">å‘½ä»¤ä¼ é€’å‚æ•°</font>çš„ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œä¹Ÿæ˜¯<font color="green">ç»„åˆå¤šä¸ªå‘½ä»¤</font>çš„ä¸€ä¸ªå·¥å…·ã€‚</p>
<p>xargs å¯ä»¥å°†ç®¡é“æˆ–æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰æ•°æ®è½¬æ¢æˆå‘½ä»¤è¡Œå‚æ•°ï¼Œä¹Ÿèƒ½å¤Ÿä»æ–‡ä»¶çš„è¾“å‡ºä¸­è¯»å–æ•°æ®ã€‚</p>
<p>xargs ä¹Ÿå¯ä»¥å°†å•è¡Œæˆ–å¤šè¡Œæ–‡æœ¬è¾“å…¥è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ï¼Œä¾‹å¦‚<font color="green">å¤šè¡Œå˜å•è¡Œï¼Œå•è¡Œå˜å¤šè¡Œ</font>ã€‚</p>
<p>xargs é»˜è®¤å‘½ä»¤æ˜¯ echoï¼Œè¿™æ„å‘³ç€é€šè¿‡<font color="green">ç®¡é“ä¼ é€’ç»™ xargs çš„è¾“å…¥åŒ…å«æ¢è¡Œå’Œç©ºç™½</font>ï¼Œé€šè¿‡ xargs çš„å¤„ç†ï¼Œ<font color="green">æ¢è¡Œå’Œç©ºç™½å°†è¢«ç©ºæ ¼å–ä»£</font>ã€‚</p>
<p>xargs æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„å‘½ä»¤ï¼Œå®ƒèƒ½å¤Ÿæ•è·ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºï¼Œç„¶åä¼ é€’ç»™å¦å¤–ä¸€ä¸ªå‘½ä»¤ã€‚</p>
<p>ä¹‹æ‰€ä»¥èƒ½ç”¨åˆ°è¿™ä¸ªå‘½ä»¤ï¼Œå…³é”®æ˜¯ç”±äºå¾ˆå¤šå‘½ä»¤ä¸æ”¯æŒ|ç®¡é“æ¥ä¼ é€’å‚æ•°ï¼Œè€Œæ—¥å¸¸å·¥ä½œä¸­æœ‰æœ‰è¿™ä¸ªå¿…è¦ï¼Œæ‰€ä»¥å°±æœ‰äº† xargs å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">find /sbin -perm +700 |ls -l       <span class="comment">#è¿™ä¸ªå‘½ä»¤æ˜¯é”™è¯¯çš„</span></span><br><span class="line">find /sbin -perm +700 |xargs ls -l   <span class="comment">#è¿™æ ·æ‰æ˜¯æ­£ç¡®çš„</span></span><br></pre></td></tr></table></figure>

<p>xargs ä¸€èˆ¬æ˜¯å’Œç®¡é“ä¸€èµ·ä½¿ç”¨ã€‚</p>
<p><strong>å‘½ä»¤æ ¼å¼ï¼š</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">somecommand |xargs -item  <span class="built_in">command</span></span><br></pre></td></tr></table></figure>

<p><strong>å‚æ•°ï¼š</strong></p>
<ul>
<li>-a file ä»æ–‡ä»¶ä¸­è¯»å…¥ä½œä¸º stdin</li>
<li>-e flag ï¼Œæ³¨æ„æœ‰çš„æ—¶å€™å¯èƒ½ä¼šæ˜¯-Eï¼Œflagå¿…é¡»æ˜¯ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ ‡å¿—ï¼Œå½“xargsåˆ†æåˆ°å«æœ‰flagè¿™ä¸ªæ ‡å¿—çš„æ—¶å€™å°±åœæ­¢ã€‚</li>
<li>-p å½“æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªargumentçš„æ—¶å€™è¯¢é—®ä¸€æ¬¡ç”¨æˆ·ã€‚</li>
<li>-n num åé¢åŠ æ¬¡æ•°ï¼Œè¡¨ç¤ºå‘½ä»¤åœ¨æ‰§è¡Œçš„æ—¶å€™ä¸€æ¬¡ç”¨çš„argumentçš„ä¸ªæ•°ï¼Œé»˜è®¤æ˜¯ç”¨æ‰€æœ‰çš„ã€‚</li>
<li>-t è¡¨ç¤ºå…ˆæ‰“å°å‘½ä»¤ï¼Œç„¶åå†æ‰§è¡Œã€‚</li>
<li><font color="green">-i æˆ–æ˜¯-I</font>ï¼Œè¿™å¾—çœ‹linuxæ”¯æŒäº†ï¼Œå°†xargsçš„æ¯é¡¹åç§°ï¼Œä¸€èˆ¬æ˜¯<font color="green">ä¸€è¡Œä¸€è¡Œèµ‹å€¼ç»™ {}ï¼Œå¯ä»¥ç”¨ {} ä»£æ›¿</font>ã€‚</li>
<li>-r no-run-if-empty å½“xargsçš„è¾“å…¥ä¸ºç©ºçš„æ—¶å€™åˆ™åœæ­¢xargsï¼Œä¸ç”¨å†å»æ‰§è¡Œäº†ã€‚</li>
<li>-s num å‘½ä»¤è¡Œçš„æœ€å¤§å­—ç¬¦æ•°ï¼ŒæŒ‡çš„æ˜¯ xargs åé¢é‚£ä¸ªå‘½ä»¤çš„æœ€å¤§å‘½ä»¤è¡Œå­—ç¬¦æ•°ã€‚</li>
<li><font color="green">-L num ä»æ ‡å‡†è¾“å…¥ä¸€æ¬¡è¯»å– num è¡Œé€ç»™ command å‘½ä»¤</font>ã€‚</li>
<li>-l åŒ -Lã€‚</li>
<li>-d delim åˆ†éš”ç¬¦ï¼Œé»˜è®¤çš„xargsåˆ†éš”ç¬¦æ˜¯å›è½¦ï¼Œargumentçš„åˆ†éš”ç¬¦æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œä¿®æ”¹çš„æ˜¯xargsçš„åˆ†éš”ç¬¦ã€‚</li>
<li>-x exitçš„æ„æ€ï¼Œä¸»è¦æ˜¯é…åˆ-sä½¿ç”¨ã€‚ã€‚</li>
<li>-P ä¿®æ”¹æœ€å¤§çš„è¿›ç¨‹æ•°ï¼Œé»˜è®¤æ˜¯1ï¼Œä¸º0æ—¶å€™ä¸ºas many as it can ï¼Œè¿™ä¸ªä¾‹å­æˆ‘æ²¡æœ‰æƒ³åˆ°ï¼Œåº”è¯¥å¹³æ—¶éƒ½ç”¨ä¸åˆ°çš„å§ã€‚</li>
</ul>
<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>xargs ç”¨ä½œæ›¿æ¢å·¥å…·ï¼Œè¯»å–è¾“å…¥æ•°æ®é‡æ–°æ ¼å¼åŒ–åè¾“å‡ºã€‚</p>
<p>å®šä¹‰ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œå†…æœ‰å¤šè¡Œæ–‡æœ¬æ•°æ®ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat test.txt</span></span><br><span class="line"></span><br><span class="line">a b c d e f g</span><br><span class="line">h i j k l m n</span><br><span class="line">o p q</span><br><span class="line">r s t</span><br><span class="line">u v w x y z</span><br></pre></td></tr></table></figure>

<p><font color="green">å¤šè¡Œè¾“å…¥å•è¡Œè¾“å‡ºï¼š</font></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat test.txt | xargs</span></span><br><span class="line">a b c d e f g h i j k l m n o p q r s t u v w x y z</span><br></pre></td></tr></table></figure>

<p><font color="green">-n é€‰é¡¹å¤šè¡Œè¾“å‡ºï¼š</font></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat test.txt | xargs -n3</span></span><br><span class="line"></span><br><span class="line">a b c</span><br><span class="line">d e f</span><br><span class="line">g h i</span><br><span class="line">j k l</span><br><span class="line">m n o</span><br><span class="line">p q r</span><br><span class="line">s t u</span><br><span class="line">v w x</span><br><span class="line">y z</span><br></pre></td></tr></table></figure>

<p>-d é€‰é¡¹å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå®šç•Œç¬¦ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># echo &quot;nameXnameXnameXname&quot; | xargs -dX</span></span><br><span class="line"></span><br><span class="line">name name name name</span><br></pre></td></tr></table></figure>

<p>ç»“åˆ -n é€‰é¡¹ä½¿ç”¨ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># echo &quot;nameXnameXnameXname&quot; | xargs -dX -n2</span></span><br><span class="line"></span><br><span class="line">name name</span><br><span class="line">name name</span><br></pre></td></tr></table></figure>

<p>è¯»å– stdinï¼Œå°†æ ¼å¼åŒ–åçš„å‚æ•°ä¼ é€’ç»™å‘½ä»¤</p>
<p>å‡è®¾ä¸€ä¸ªå‘½ä»¤ä¸º sk.sh å’Œä¸€ä¸ªä¿å­˜å‚æ•°çš„æ–‡ä»¶ arg.txtï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#sk.shå‘½ä»¤å†…å®¹ï¼Œæ‰“å°å‡ºæ‰€æœ‰å‚æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> $*</span><br></pre></td></tr></table></figure>

<p>arg.txtæ–‡ä»¶å†…å®¹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat arg.txt</span></span><br><span class="line"></span><br><span class="line">aaa</span><br><span class="line">bbb</span><br><span class="line">ccc</span><br></pre></td></tr></table></figure>

<p>xargs çš„ä¸€ä¸ªé€‰é¡¹ -Iï¼Œä½¿ç”¨ -I æŒ‡å®šä¸€ä¸ªæ›¿æ¢å­—ç¬¦ä¸² {}ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åœ¨ xargs æ‰©å±•æ—¶ä¼šè¢«æ›¿æ¢æ‰ï¼Œå½“ -I ä¸ xargs ç»“åˆä½¿ç”¨ï¼Œæ¯ä¸€ä¸ªå‚æ•°å‘½ä»¤éƒ½ä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat arg.txt | xargs -I &#123;&#125; ./sk.sh -p &#123;&#125; -l</span></span><br><span class="line"></span><br><span class="line">-p aaa -l</span><br><span class="line">-p bbb -l</span><br><span class="line">-p ccc -l</span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶åˆ° /data/images ç›®å½•ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ls *.jpg | xargs -n1 -I &#123;&#125; cp &#123;&#125; /data/images</span><br></pre></td></tr></table></figure>

<p>xargs ç»“åˆ find ä½¿ç”¨</p>
<p>ç”¨ rm åˆ é™¤å¤ªå¤šçš„æ–‡ä»¶æ—¶å€™ï¼Œå¯èƒ½å¾—åˆ°ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼š**/bin/rm Argument list too long.** ç”¨ xargs å»é¿å…è¿™ä¸ªé—®é¢˜ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> f -name <span class="string">&quot;*.log&quot;</span> -print0 | xargs -0 rm -f</span><br></pre></td></tr></table></figure>

<p>xargs -0 å°† \0 ä½œä¸ºå®šç•Œç¬¦ã€‚</p>
<p>ç»Ÿè®¡ä¸€ä¸ªæºä»£ç ç›®å½•ä¸­æ‰€æœ‰ php æ–‡ä»¶çš„è¡Œæ•°ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> f -name <span class="string">&quot;*.php&quot;</span> -print0 | xargs -0 wc -l</span><br></pre></td></tr></table></figure>

<p>æŸ¥æ‰¾æ‰€æœ‰çš„ jpg æ–‡ä»¶ï¼Œå¹¶ä¸”å‹ç¼©å®ƒä»¬ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> f -name <span class="string">&quot;*.jpg&quot;</span> -<span class="built_in">print</span> | xargs tar -czvf images.tar.gz</span><br></pre></td></tr></table></figure>

<p>xargs å…¶ä»–åº”ç”¨</p>
<p>å‡å¦‚æœ‰<font color="green">ä¸€ä¸ªæ–‡ä»¶åŒ…å«äº†å¾ˆå¤šå¸Œæœ›ä¸‹è½½çš„ URL</font>ï¼Œä½ èƒ½å¤Ÿä½¿ç”¨ xargsä¸‹è½½æ‰€æœ‰é“¾æ¥ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat url-list.txt | xargs wget -c</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘</title>
    <url>/blog/2021/12/16/2021_12_16_osa_GO_KEGG/</url>
    <content><![CDATA[<h2 id="Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘"><a href="#Oryza-Sativa-ã€Gene-IDã€‘ã€GOã€‘ã€KEGGã€‘" class="headerlink" title="Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘"></a>Oryza Sativa ã€Gene IDã€‘ã€GOã€‘ã€KEGGã€‘</h2><span id="more"></span>

<h1 id="O-sativa-ID-åŒºåˆ†"><a href="#O-sativa-ID-åŒºåˆ†" class="headerlink" title="O_sativa ID åŒºåˆ†"></a>O_sativa ID åŒºåˆ†</h1><ul>
<li><p>MSU, <font color="red">RGAP7.0</font>(rice genome annotation project)ï¼š<strong>LOC_Os01g01010.1</strong>,  LOC_Osp#g#####ï¼Œ<strong>LOC_Os-Chr-g-number</strong></p>
</li>
<li><p><font color="red">RAP</font>(the rice annotation project), IRGSP-1.0: <strong>Os06t0664200</strong>ï¼Œ<strong>Os-Chr-g-number</strong></p>
</li>
<li><p><font color="red">KEGGæ”¯æŒ</font>ï¼šosaï¼šRefSeq IDï¼ˆGene IDï¼š<strong>4334374</strong>ï¼‰ï¼›dosaï¼šRAP-DB IDï¼ˆ<strong>Os06t0664200-01</strong>ï¼‰</p>
</li>
<li><p>ç–‘é—®ï¼šRAP-DB IDä¸ºä»€ä¹ˆå’ŒIRGSP-1.0 IDå¤šäº†ä¸ª-01ï¼šRAP-Locusä¸RAP IDä¸åŒ</p>
</li>
<li><p>clusterProfilerå¯èƒ½æ˜¯ç›®å‰KEGGå¯Œé›†åˆ†ææœ€å¥½çš„è½¯ä»¶ï¼Œå› ä¸ºèƒ½<strong>çˆ¬å–æœ€æ–°çš„KEGGåœ¨çº¿ç‰ˆæ•°æ®åº“</strong>ï¼Œè€Œä¸æ˜¯ç”¨ä¸å†æ›´æ–°çš„KEGG.dbã€‚</p>
</li>
<li><p>å¯¹äºRGAPæ°´ç¨»çš„åŸºå› ç¼–å·ï¼Œå¦‚LOC_Os01g01010.1 æˆ‘ä»¬è¦æŠŠå®ƒå˜æˆ<code>Os06t0664200-01</code> RAP-IDçš„å‘½åæ–¹å¼ï¼Œç¬¦åˆ<code>dosa</code>çš„è¦æ±‚ã€‚</p>
</li>
</ul>
<h2 id="è½¬åŒ–id"><a href="#è½¬åŒ–id" class="headerlink" title="è½¬åŒ–id"></a>è½¬åŒ–id</h2><ul>
<li><p>ä¸‹è½½ä¸€ä¸ªå„ä¸ªIDå¯¹åº”çš„æ–‡ä»¶ï¼š<a href="https://shigen.nig.ac.jp/rice/oryzabase/download/riceId%E3%80%82%E5%AF%B9%E4%BA%8ERGAP%E6%B0%B4%E7%A8%BB%E7%9A%84%E5%9F%BA%E5%9B%A0%E7%BC%96%E5%8F%B7%EF%BC%8C%E5%A6%82LOC_Os01g01010.1">https://shigen.nig.ac.jp/rice/oryzabase/download/riceIdã€‚å¯¹äºRGAPæ°´ç¨»çš„åŸºå› ç¼–å·ï¼Œå¦‚LOC_Os01g01010.1</a> æŠŠå®ƒå˜æˆ<code>Os06t0664200-01</code> RAP-IDçš„å‘½åæ–¹å¼ï¼Œç¬¦åˆ<code>dosa</code>çš„è¦æ±‚ã€‚</p>
</li>
<li><p>æ—¥æœ¬æ™´æ•°æ®åº“ï¼š<a href="https://shigen.nig.ac.jp/rice/oryzabase">https://shigen.nig.ac.jp/rice/oryzabase</a></p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ grep LOC_Os01g01010.1  rice_id_20140620174522.txt</span><br><span class="line">Os01g0100100    Os01t0100100-01 J075199P03      301700  J075199P03              LOC_Os01g01010.1        AK242339</span><br><span class="line">cat LOC.txt | xargs -i awk <span class="string">&#x27;BEGIN&#123;FS=&quot;\t&quot;&#125;  $0 ~/&#123;&#125;/ &#123; print $2&#125;&#x27;</span> rice_id_20140620174522.txt &gt; RAP_id.txt</span><br></pre></td></tr></table></figure>



<hr>
<h1 id="è¶…å‡ ä½•åˆ†å¸ƒ"><a href="#è¶…å‡ ä½•åˆ†å¸ƒ" class="headerlink" title="è¶…å‡ ä½•åˆ†å¸ƒ"></a>è¶…å‡ ä½•åˆ†å¸ƒ</h1><p>å®ƒæè¿°äº†ä»æœ‰é™Nä¸ªç‰©ä»¶ï¼ˆå…¶ä¸­åŒ…å«Mä¸ªæŒ‡å®šç§ç±»çš„ç‰©ä»¶ï¼‰ä¸­æŠ½å‡ºnä¸ªç‰©ä»¶ï¼ŒæˆåŠŸæŠ½å‡ºè¯¥æŒ‡å®šç§ç±»çš„ç‰©ä»¶çš„æ¬¡æ•°ï¼ˆä¸æ”¾å›ï¼‰ã€‚ç§°ä¸ºè¶…å‡ ä½•åˆ†å¸ƒã€‚</p>
<p><a href="https://baike.baidu.com/item/%E8%B6%85%E5%87%A0%E4%BD%95%E5%88%86%E5%B8%83/4782968">https://baike.baidu.com/item/è¶…å‡ ä½•åˆ†å¸ƒ/4782968</a></p>
<hr>
<h1 id="GO-enrichmentï¼šweb"><a href="#GO-enrichmentï¼šweb" class="headerlink" title="GO enrichmentï¼šweb"></a>GO enrichmentï¼šweb</h1><blockquote>
<p>ç½‘ç«™ï¼š<a href="http://systemsbiology.cau.edu.cn/agriGOv2">http://systemsbiology.cau.edu.cn/agriGOv2</a>  åå¤§</p>
</blockquote>
<h1 id="GO-enrichmentï¼šR-clusterProfiler"><a href="#GO-enrichmentï¼šR-clusterProfiler" class="headerlink" title="GO enrichmentï¼šR clusterProfiler"></a>GO enrichmentï¼šR clusterProfiler</h1><p><strong>X</strong> clusterprofilerä¸èƒ½ç”¨æ¥åšGOçš„å¯Œé›†åˆ†æï¼Œå› ä¸ºå…¶20ä¸ªç‰©ç§ä¸­ä¸åŒ…æ‹¬æ°´ç¨»ï¼›</p>
<h2 id="è·å–Orgdbï¼Œ"><a href="#è·å–Orgdbï¼Œ" class="headerlink" title="è·å–Orgdbï¼Œ"></a>è·å–Orgdbï¼Œ</h2><p>AnnotationHubåœ¨çº¿æ£€ç´¢å¹¶æŠ“å–OrgDb</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">&gt; require(AnnotationHub)</span><br><span class="line">&gt; hub &lt;- AnnotationHub()</span><br><span class="line">&gt; query(hub, <span class="string">&quot;oryza sativa&quot;</span>)</span><br><span class="line">title</span><br><span class="line">  AH10561 | hom.Oryza_sativa.inp8.sqlite</span><br><span class="line">  AH55775 | org.Oryza_sativa_Japonica_Group.eg.sqlite</span><br><span class="line">&gt; rice &lt;- hub[[<span class="string">&#x27;AH55775&#x27;</span>]]</span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">&gt; <span class="built_in">length</span>(keys(rice))[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#é€šè¿‡æ£€ç´¢ï¼Œorg.Oryza_sativa_Japonica_Group.eg.sqliteå°±æ˜¯æˆ‘ä»¬æ‰€è¦çš„OrgDbï¼Œå¯ä»¥é€šè¿‡ç›¸åº”çš„accession number, AH55775 æŠ“å–æ–‡ä»¶ï¼Œå¹¶å­˜å…¥äº†riceå¯¹è±¡ä¸­ï¼Œå®ƒåŒ…å«äº†32639ä¸ªåŸºå› çš„æ³¨é‡Š</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è¿™ä¸ªOrgDbï¼ŒåŒ…å«æœ‰ä»¥ä¸‹ä¸€äº›æ³¨é‡Šä¿¡æ¯:</span></span><br><span class="line">&gt; columns(rice)</span><br><span class="line"> [<span class="number">1</span>] <span class="string">&quot;ACCNUM&quot;</span>      <span class="string">&quot;ALIAS&quot;</span>       <span class="string">&quot;CHR&quot;</span>         <span class="string">&quot;ENTREZID&quot;</span>    <span class="string">&quot;EVIDENCE&quot;</span></span><br><span class="line"> [<span class="number">6</span>] <span class="string">&quot;EVIDENCEALL&quot;</span> <span class="string">&quot;GENENAME&quot;</span>    <span class="string">&quot;GID&quot;</span>         <span class="string">&quot;GO&quot;</span>          <span class="string">&quot;GOALL&quot;</span></span><br><span class="line">[<span class="number">11</span>] <span class="string">&quot;ONTOLOGY&quot;</span>    <span class="string">&quot;ONTOLOGYALL&quot;</span> <span class="string">&quot;PMID&quot;</span>        <span class="string">&quot;REFSEQ&quot;</span>      <span class="string">&quot;SYMBOL&quot;</span></span><br><span class="line">  [<span class="number">16</span>] <span class="string">&quot;UNIGENE&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">##æˆ‘ä»¬å¯ä»¥ä½¿ç”¨bitræ¥è½¬æ¢IDï¼Œç”šè‡³äºç›´æ¥æ£€ç´¢GOæ³¨é‡Šï¼š</span></span><br><span class="line">&gt; require(clusterProfiler)</span><br><span class="line">&gt; bitr(keys(rice)[<span class="number">1</span>], <span class="string">&#x27;ENTREZID&#x27;</span>, <span class="built_in">c</span>(<span class="string">&quot;REFSEQ&quot;</span>, <span class="string">&quot;GO&quot;</span>, <span class="string">&quot;ONTOLOGY&quot;</span>), rice)</span><br><span class="line"><span class="string">&#x27;select()&#x27;</span> returned <span class="number">1</span>:many mapping between keys and columns</span><br><span class="line">  ENTREZID      REFSEQ         GO ONTOLOGY</span><br><span class="line"><span class="number">1</span>  <span class="number">3131385</span> NP_039457.2 GO:<span class="number">0005739</span>       CC</span><br><span class="line"><span class="number">2</span>  <span class="number">3131385</span> NP_039457.2 GO:<span class="number">0005763</span>       CC</span><br><span class="line"><span class="comment">##GOå¯Œé›†åˆ†æ</span></span><br><span class="line">&gt; sample_genes &lt;- keys(rice)[<span class="number">1</span>:<span class="number">100</span>]</span><br><span class="line">&gt; head(sample_genes)</span><br><span class="line">[<span class="number">1</span>] <span class="string">&quot;3131385&quot;</span> <span class="string">&quot;3131390&quot;</span> <span class="string">&quot;3131391&quot;</span> <span class="string">&quot;3131392&quot;</span> <span class="string">&quot;3131393&quot;</span> <span class="string">&quot;3131394&quot;</span></span><br><span class="line"><span class="comment">##è¿™é‡Œåªæ˜¯ç®€å•åœ°ä½¿ç”¨IDåˆ—è¡¨ä¸­å‰100ä¸ªENTREZåŸºå› IDï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒçš„IDï¼Œé€šè¿‡å€ŸåŠ©äºbitrè¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…é€šè¿‡ç»™enrichGOæŒ‡å®šIDç±»å‹(keyTypeå‚æ•°ï¼‰ã€‚</span></span><br><span class="line">&gt; æœ‰äº†OrgDbï¼Œä½¿ç”¨èµ·æ¥ï¼Œå°±è·Ÿæ–‡æ¡£ä¸­ä½¿ç”¨äººç±»åŸºå› åšä¸ºä¾‹å­ä¸€æ ·ï¼Œç”¨æ³•ä¸€è‡´ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥é€šè¿‡clusterProfileræ‰€æä¾›çš„å„ç§å¯è§†åŒ–å‡½æ•°å¯¹ç»“æœè¿›è¡Œå±•ç¤ºï¼š</span><br><span class="line"></span><br><span class="line">&gt; require(clusterProfiler)</span><br><span class="line">&gt; res = enrichGO(sample_genes, OrgDb=rice, pvalueCutoff=<span class="number">1</span>, qvalueCutoff=<span class="number">1</span>)</span><br><span class="line">&gt; res</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># over-representation test</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#...@organism    Oryza sativa_Japonica_Group</span></span><br><span class="line"><span class="comment">#...@ontology    MF</span></span><br><span class="line"><span class="comment">#...@keytype     ENTREZID</span></span><br><span class="line"><span class="comment">#...@gene        chr [1:100] &quot;3131385&quot; &quot;3131390&quot; &quot;3131391&quot; &quot;3131392&quot; &quot;3131393&quot; &quot;3131394&quot; ...</span></span><br><span class="line"><span class="comment">#...pvalues adjusted by &#x27;BH&#x27; with cutoff &lt;1</span></span><br><span class="line"><span class="comment">#...28 enriched terms found</span></span><br><span class="line"><span class="string">&#x27;data.frame&#x27;</span>:   <span class="number">28</span> obs. of  <span class="number">9</span> variables:</span><br><span class="line"> $ ID         : chr  <span class="string">&quot;GO:0003735&quot;</span> <span class="string">&quot;GO:0005198&quot;</span> <span class="string">&quot;GO:0003723&quot;</span> <span class="string">&quot;GO:0016830&quot;</span> ...</span><br><span class="line"> $ Description: chr  <span class="string">&quot;structural constituent of ribosome&quot;</span> <span class="string">&quot;structural molecule activity&quot;</span> <span class="string">&quot;RNA binding&quot;</span> <span class="string">&quot;carbon-carbon lyase activity&quot;</span> ...</span><br><span class="line"> $ GeneRatio  : chr  <span class="string">&quot;7/12&quot;</span> <span class="string">&quot;7/12&quot;</span> <span class="string">&quot;2/12&quot;</span> <span class="string">&quot;1/12&quot;</span> ...</span><br><span class="line"> $ BgRatio    : chr  <span class="string">&quot;22/478&quot;</span> <span class="string">&quot;22/478&quot;</span> <span class="string">&quot;14/478&quot;</span> <span class="string">&quot;10/478&quot;</span> ...</span><br><span class="line"> $ pvalue     : num  <span class="number">1.08e-07</span> <span class="number">1.08e-07</span> <span class="number">4.45e-02</span> <span class="number">2.26e-01</span> <span class="number">3.24e-01</span> ...</span><br><span class="line"> $ p.adjust   : num  <span class="number">1.52e-06</span> <span class="number">1.52e-06</span> <span class="number">4.15e-01</span> <span class="number">1.00</span> <span class="number">1.00</span> ...</span><br><span class="line"> $ qvalue     : num  <span class="number">1.42e-06</span> <span class="number">1.42e-06</span> <span class="number">3.90e-01</span> <span class="number">9.40e-01</span> <span class="number">9.40e-01</span> ...</span><br><span class="line"> $ geneID     : chr  <span class="string">&quot;3131425/3131435/3131436/3131439/3131441/3131442/3131457&quot;</span> <span class="string">&quot;3131425/3131435/3131436/3131439/3131441/3131442/3131457&quot;</span> <span class="string">&quot;3131425/3131457&quot;</span> <span class="string">&quot;3131463&quot;</span> ...</span><br><span class="line"> $ Count      : int  <span class="number">7</span> <span class="number">7</span> <span class="number">2</span> <span class="number">1</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">4</span> <span class="number">4</span> <span class="number">1</span> ...</span><br></pre></td></tr></table></figure>



<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">sly &lt;- ah[[<span class="string">&quot;AH61992&quot;</span>]]</span><br><span class="line">sly</span><br><span class="line">saveDb(sly,file=<span class="string">&quot;sly.orgdb&quot;</span>)</span><br><span class="line">laodDb(file=<span class="string">&quot;sly.orgdb&quot;</span>)</span><br></pre></td></tr></table></figure>



<p>plant_GSEA: MSU-&gt;Uniprot</p>
<p>david:Uniprot-&gt;Entrez_id</p>
<hr>
<h1 id="KEGG-enrichmentï¼šR-clusterProfiler"><a href="#KEGG-enrichmentï¼šR-clusterProfiler" class="headerlink" title="KEGG enrichmentï¼šR clusterProfiler"></a>KEGG enrichmentï¼šR clusterProfiler</h1><ol>
<li><p>enrichKEGG</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">enrichKEGG(gene, organism = <span class="string">&quot;hsa&quot;</span>, keyType = <span class="string">&quot;kegg&quot;</span>, pvalueCutoff = <span class="number">0.05</span>,</span><br><span class="line">  pAdjustMethod = <span class="string">&quot;BH&quot;</span>, universe, minGSSize = <span class="number">10</span>, maxGSSize = <span class="number">500</span>,</span><br><span class="line">  qvalueCutoff = <span class="number">0.2</span>, use_internal_data = <span class="literal">FALSE</span>)</span><br><span class="line"><span class="comment">#geneï¼š åŸºå› åï¼Œè¦å’ŒkeyTypeå¯¹åº”</span></span><br><span class="line"><span class="comment">#organism: éœ€è¦å‚è€ƒ http://www.genome.jp/kegg/catalog/org_list.html</span></span><br><span class="line"><span class="comment">#keyType: åŸºå› çš„å‘½åæ–¹å¼ï¼Œ â€œkeggâ€, â€˜ncbi-geneidâ€™, â€˜ncib-proteinidâ€™ and â€˜uniprotâ€™é€‰æ‹©å…¶ä¸€</span></span><br><span class="line"><span class="comment">#enrichKEGGçš„ä¸€ä¸ªå…³é”®åœ¨äºç†è§£å®ƒæ˜¯å¦‚ä½•è·å–æ•°æ®çš„ã€‚åœ¨çº¿çˆ¬å–æ•°æ®åº“ï¼Œç›¸å½“äºåœ¨KEGGä¸Šæ‰‹åŠ¨è¾“å…¥åŸºå› åæŸ¥è¯¢ã€‚</span></span><br><span class="line"><span class="comment">#æ‰€ä»¥ï¼ŒæŠŠenrichKEGGå½“åšæµè§ˆå™¨ï¼Œè¯•å‡ºåˆé€‚çš„keytypesã€‚</span></span><br></pre></td></tr></table></figure></li>
<li></li>
</ol>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library(clusterProfiler)</span><br><span class="line"><span class="comment"># å¯¹äºGID</span></span><br><span class="line">kk &lt;- enrichkegg(gid_list,organism=<span class="string">&#x27;osa&#x27;</span>,keyType = <span class="string">&#x27;kegg&#x27;</span>,pvalueCutoff=<span class="number">0.05</span>, pAdjustMethod=<span class="string">&#x27;BH&#x27;</span>,qvalueCutoff=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹äºRAP_ID</span></span><br><span class="line">kk &lt;- enrichkegg(rap_list,organism=<span class="string">&#x27;dosa&#x27;</span>,keyType = <span class="string">&#x27;kegg&#x27;</span>,pvalueCutoff=<span class="number">0.05</span>, pAdjustMethod=<span class="string">&#x27;BH&#x27;</span>,qvalueCutoff=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">write.table(ekk,<span class="string">&quot;kegg.txt&quot;</span>,sep = <span class="string">&quot;\t&quot;</span>,<span class="built_in">quote</span> = <span class="built_in">F</span>,row.names = <span class="built_in">F</span>)</span><br><span class="line">barplot(ekk,showCategory = <span class="number">15</span>,title = <span class="string">&quot;EnrichmentKEGG&quot;</span>)</span><br></pre></td></tr></table></figure>



<ol start="3">
<li>è‹¥å·®å¼‚åŸºå› é›†ï¼ˆå¦‚500ä¸ªï¼‰æœ¬èº«ç¡®å®æ²¡æœ‰ç”Ÿç‰©å­¦åŠŸèƒ½åå¥½æ€§ï¼Œéå¸¸æœ‰å¯èƒ½æ— æ˜¾è‘—å¯Œé›†çš„keggé€šè·¯ã€‚</li>
</ol>
<p>ä¿®æ”¹ä»£ç ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">kk.down &lt;- enrichKEGG(gene = gene_down,</span><br><span class="line">                        organism = <span class="string">&#x27;hsa&#x27;</span>, </span><br><span class="line">                        pvalueCutoff = <span class="number">0.9</span>,</span><br><span class="line">                        qvalueCutoff =<span class="number">0.9</span>)</span><br><span class="line"><span class="comment"># éœ€è¦è‡ªå·±å·®å¼‚åˆ†æç­›é€‰å¾—åˆ° gene_down åŸºå› é›† ï¼Œç„¶åè¿›è¡Œè¶…å‡ ä½•åˆ†å¸ƒæ£€éªŒ</span></span><br><span class="line"><span class="comment">#å†è°ƒæ•´é˜ˆå€¼</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>æˆ–å¯å»MSigDBï¼ˆMolecular Signatures Database<a href="https://www.gsea-msigdb.org/gsea/msigdb%EF%BC%89%E7%9C%8B%E5%85%B6%E5%AE%83%E5%8A%9F%E8%83%BD%E5%9F%BA%E5%9B%A0%E9%9B%86%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E5%AF%8C%E9%9B%86%EF%BC%8CMSigDB%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E5%AE%9A%E4%B9%89%E4%BA%86%E5%B7%B2%E7%9F%A5%E7%9A%84%E5%9F%BA%E5%9B%A0%E9%9B%86%E5%90%88%EF%BC%9A%E5%8C%85%E6%8B%ACH%E5%92%8CC1-C7%E5%85%AB%E4%B8%AA%E7%B3%BB%E5%88%97%EF%BC%88Collection%EF%BC%89%EF%BC%8C%E6%A4%8D%E7%89%A9%E9%80%82%E7%94%A8%EF%BC%9F">https://www.gsea-msigdb.org/gsea/msigdbï¼‰çœ‹å…¶å®ƒåŠŸèƒ½åŸºå› é›†æ˜¯å¦å¯ä»¥å¯Œé›†ï¼ŒMSigDBæ•°æ®åº“ä¸­å®šä¹‰äº†å·²çŸ¥çš„åŸºå› é›†åˆï¼šåŒ…æ‹¬Hå’ŒC1-C7å…«ä¸ªç³»åˆ—ï¼ˆCollectionï¼‰ï¼Œæ¤ç‰©é€‚ç”¨ï¼Ÿ</a></p>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/150744437">GSEAåˆ†æ</a>ï¼Œä¸ä¾èµ–äºå·®å¼‚åˆ†ææœ¬èº«,æ¤ç‰©é€‚ç”¨ï¼Ÿ</p>
</li>
</ol>
<hr>
<h1 id="KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼"><a href="#KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼" class="headerlink" title="KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼"></a>KEGGæ•°æ®åº“ä¸ä¼šä¸‹è½½ï¼Ÿäº†è§£ä¸‹APIï¼</h1><ol>
<li><p>KEGGæ•°æ®åº“å¹¶ä¸æä¾›å…è´¹ã€æ‰¹é‡è›‹ç™½åºåˆ—ä¸‹è½½ï¼Œå…¶å®˜æ–¹æä¾›åœ¨çº¿åˆ†æå·¥å…·BlastKOALAï¼ˆ<a href="https://link.zhihu.com/?target=https://www.kegg.jp/blastkoala/">https://www.kegg.jp/blastkoala/</a>ï¼‰ç­‰å¯ç”¨äºKEGGæ•°æ®åº“çš„æ³¨é‡Šåˆ†æã€‚æ­¤å¤–è¿˜æœ‰å…¶ä»–ä¸€äº›åœ¨çº¿åˆ†æå·¥å…·ä¾‹å¦‚å¾ˆå¸¸ç”¨çš„KAASï¼ˆ<a href="https://link.zhihu.com/?target=https://www.genome.jp/tools/kaas/">https://www.genome.jp/tools/kaas/</a>ï¼‰ç­‰ã€‚åœ¨çº¿å·¥å…·å†…éƒ¨å‚æ•°æœªçŸ¥ã€‚</p>
</li>
<li><p>KEGG APIï¼ˆ<a href="https://www.kegg.jp/kegg/rest/keggapi.html%EF%BC%89%E6%98%AF%E5%92%8CKEGG%E5%86%85%E6%A0%B8%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%E4%BA%A4%E4%BA%92%E7%9A%84%E7%A8%8B%E5%BA%8F%E7%95%8C%E9%9D%A2%EF%BC%8C%E5%85%81%E8%AE%B8%E7%94%A8%E6%88%B7%E5%9F%BA%E4%BA%8E%E8%AF%A5%E7%95%8C%E9%9D%A2%E6%A3%80%E7%B4%A2KEGG%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C[%E4%B8%8B%E8%BD%BD](https://zhuanlan.zhihu.com/p/76195765)">https://www.kegg.jp/kegg/rest/keggapi.htmlï¼‰æ˜¯å’ŒKEGGå†…æ ¸æ•°æ®åº“è¿›è¡Œäº¤äº’çš„ç¨‹åºç•Œé¢ï¼Œå…è®¸ç”¨æˆ·åŸºäºè¯¥ç•Œé¢æ£€ç´¢KEGGæ•°æ®åº“ï¼Œ[ä¸‹è½½](https://zhuanlan.zhihu.com/p/76195765)</a></p>
<p>(1)<a href="https://mp.weixin.qq.com/s/YlJbkIg9It9On5HWRPPgmQ">https://mp.weixin.qq.com/s/YlJbkIg9It9On5HWRPPgmQ</a></p>
<p>(2)<a href="https://mp.weixin.qq.com/s/F3dRgHBI4a2atvz0O_pukA">https://mp.weixin.qq.com/s/F3dRgHBI4a2atvz0O_pukA</a></p>
<p>(3)<a href="https://mp.weixin.qq.com/s/oDDIlWXsLyTCh18bEEysmQ">https://mp.weixin.qq.com/s/oDDIlWXsLyTCh18bEEysmQ</a></p>
</li>
</ol>
]]></content>
      <categories>
        <category>GO</category>
        <category>KEGG</category>
      </categories>
      <tags>
        <tag>O_Sativa</tag>
      </tags>
  </entry>
  <entry>
    <title>KMeans</title>
    <url>/blog/2021/11/15/2021-11-15-kmeans/</url>
    <content><![CDATA[<p>ç›‘ç£å­¦ä¹ </p>
<p>æ— ç›‘ç£å­¦ä¹ ï¼šæ•°æ®æ— æ ‡æ³¨ç”šè‡³éç»“æ„åŒ–ã€‚KMeansâ€¦</p>
<span id="more"></span>



<h1 id="KMeans"><a href="#KMeans" class="headerlink" title="KMeans"></a>KMeans</h1><h2 id="ç®€ä»‹-èšç±»ä¸KMeans"><a href="#ç®€ä»‹-èšç±»ä¸KMeans" class="headerlink" title="ç®€ä»‹-èšç±»ä¸KMeans"></a>ç®€ä»‹-èšç±»ä¸KMeans</h2><blockquote>
<ul>
<li><strong>èšç±»ï¼ˆClusteringï¼‰</strong>ï¼šå°†æ•°æ®å¯¹è±¡åˆ†ä¸ºå¤šä¸ªç±»æˆ–è€…ç°‡ (Cluster)ï¼Œä½¿åŒä¸€ç°‡å¯¹è±¡é—´è¾ƒé«˜ç›¸ä¼¼åº¦ï¼Œä¸åŒç°‡å¯¹è±¡å·®åˆ«è¾ƒå¤§ã€‚</li>
<li><strong>åˆ’åˆ†ï¼ˆPartitioningï¼‰</strong>ï¼šèšç±»å¯åŸºäºåˆ’åˆ†ï¼Œä¹Ÿå¯åŸºäºåˆ†å±‚ã€‚åˆ’åˆ†å³å°†å¯¹è±¡åˆ’åˆ†æˆä¸åŒç°‡ï¼Œè€Œåˆ†å±‚å°†å¯¹è±¡åˆ†ç­‰çº§ã€‚</li>
<li><strong>æ’ä»–ï¼ˆExclusiveï¼‰</strong>ï¼šä¸€ä¸ªæ•°æ®å¯¹è±¡ï¼Œåªèƒ½è¢«åˆ’åˆ†åˆ°ä¸€ä¸ªç°‡ã€‚å¦‚æœä¸€ä¸ªæ•°æ®å¯¹è±¡å¯è¢«åˆ’åˆ†åˆ°å¤šä¸ªç°‡ï¼Œåˆ™ç§°ä¸ºå¯é‡å ï¼ˆOverlappingï¼‰ã€‚</li>
<li><strong>è·ç¦»ï¼ˆDistanceï¼‰</strong>ï¼šåŸºäºè·ç¦»çš„èšç±»å°†è·ç¦»è¿‘çš„ç›¸ä¼¼å¯¹è±¡èšåœ¨ä¸€èµ·ã€‚åŸºäº<font color="red">æ¦‚ç‡åˆ†å¸ƒæ¨¡å‹çš„èšç±»ï¼Ÿ</font>åœ¨ä¸€ç»„å¯¹è±¡ä¸­ï¼Œæ‰¾åˆ°ç¬¦åˆç‰¹å®šåˆ†å¸ƒæ¨¡å‹çš„å¯¹è±¡çš„é›†åˆï¼Œä¸ä¸€å®šæ˜¯è·ç¦»æœ€è¿‘çš„æˆ–è€…æœ€ç›¸ä¼¼çš„ï¼Œè€Œæ˜¯èƒ½å®Œç¾çš„å‘ˆç°å‡ºæ¦‚ç‡åˆ†å¸ƒæ¨¡å‹æ‰€æè¿°çš„æ¨¡å‹ã€‚</li>
<li>æ¬§æ°è·ç¦»ï¼šæ¬§å‡ é‡Œå¾—åº¦é‡äºŒç»´å’Œä¸‰ç»´ç©ºé—´ä¸­çš„æ¬§æ°è·ç¦»å°±æ˜¯ä¸¤ç‚¹ä¹‹é—´çš„å®é™…è·ç¦»</li>
</ul>
</blockquote>
<ul>
<li><p>ä¸åˆ†ç±»ã€åºåˆ—æ ‡æ³¨ä¸åŒï¼Œèšç±»äº‹å…ˆå¹¶ä¸çŸ¥é“ä»»ä½•æ ·æœ¬æ ‡ç­¾ï¼Œé€šè¿‡æ•°æ®ä¹‹é—´å†…åœ¨å…³ç³»æŠŠæ ·æœ¬åˆ’åˆ†ä¸ºè‹¥å¹²ç±»åˆ«ï¼Œä½¿å¾—åŒç±»åˆ«æ ·æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦é«˜ï¼Œä¸åŒç±»åˆ«ç›¸ä¼¼åº¦ä½ï¼ˆå¢å¤§ç±»å†…èšï¼Œå‡å°‘ç±»é—´è·ï¼‰ã€‚</p>
</li>
<li><p>èšç±»å±äºéç›‘ç£å­¦ä¹ ï¼ŒKå‡å€¼èšç±»æœ€åŸºç¡€å¸¸ç”¨ã€‚åŸºæœ¬æ€æƒ³ï¼Œ<font color="green">é€šè¿‡è¿­ä»£å¯»æ‰¾Kä¸ªç°‡ï¼ˆClusterï¼‰ï¼Œä½¿èšç±»ç»“æœå¯¹åº”çš„æŸå¤±å‡½æ•°æœ€å°</font>ã€‚ç»ˆæ­¢æ¡ä»¶æ˜¯æ²¡æœ‰ï¼ˆæˆ–æœ€å°æ•°ç›®ï¼‰å¯¹è±¡è¢«é‡æ–°åˆ†é…ç»™ä¸åŒçš„èšç±»ï¼Œæ²¡æœ‰ï¼ˆæˆ–æœ€å°æ•°ç›®ï¼‰èšç±»ä¸­å¿ƒå†å‘ç”Ÿå˜åŒ–ï¼Œè¯¯å·®å¹³æ–¹å’Œå±€éƒ¨æœ€å°ã€‚<font color="red">æŸå¤±å‡½æ•°å®šä¹‰ä¸ºå„ä¸ªæ ·æœ¬è·ç¦»æ‰€å±ç°‡ä¸­å¿ƒç‚¹çš„è¯¯å·®å¹³æ–¹å’Œ</font>ï¼š</p>
</li>
</ul>
<p><img src="/blog/2021/11/15/2021-11-15-kmeans/1.png"></p>
<p>xiä»£è¡¨ç¬¬iä¸ªæ ·æœ¬ï¼Œciæ˜¯xiæ‰€å±çš„ç°‡ï¼Œuciä»£è¡¨ç°‡å¯¹åº”ä¸­å¿ƒç‚¹ï¼ŒMæ˜¯æ ·æœ¬æ€»æ•°ã€‚</p>
<ul>
<li><p>ï¼ŸæŸå¤±å‡½æ•°æœ¬è´¨æ˜¯è¡¡é‡æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœï¼Œæœ‰æ±‚è§£å‚æ•°éœ€æ±‚çš„ç®—æ³•ï¼Œæ‰ä¼šæœ‰æŸå¤±å‡½æ•°ã€‚Kmeans ä¸æ±‚è§£ä»€ä¹ˆå‚æ•°ï¼Œå®ƒçš„æ¨¡å‹æœ¬è´¨ä¹Ÿæ²¡æœ‰åœ¨æ‹Ÿåˆæ•°æ®ï¼Œè€Œæ˜¯åœ¨å¯¹æ•°æ®è¿›è¡Œä¸€ ç§æ¢ç´¢ã€‚åœ¨å†³ç­–æ ‘ä¸­æœ‰è¡¡é‡åˆ†ç±»æ•ˆæœçš„æŒ‡æ ‡å‡†ç¡®åº¦<code>accuracy</code>ï¼Œå‡†ç¡®åº¦æ‰€å¯¹åº”çš„æŸå¤±å«åšæ³›åŒ–è¯¯å·®ï¼Œä½†ä¸èƒ½é€šè¿‡æœ€å°åŒ–æ³›åŒ–è¯¯å·®æ¥æ±‚è§£æŸä¸ªæ¨¡å‹ä¸­éœ€è¦çš„ä¿¡æ¯ï¼Œåªæ˜¯å¸Œæœ›æ¨¡å‹çš„æ•ˆæœä¸Šè¡¨ç°å‡ºæ¥çš„æ³›åŒ–è¯¯å·® å¾ˆå°ã€‚å› æ­¤å†³ç­–æ ‘ï¼ŒKNN ç­‰ç®—æ³•ï¼Œæ˜¯ç»å¯¹æ²¡æœ‰æŸå¤±å‡½æ•°çš„ã€‚</p>
</li>
<li><table>
<thead>
<tr>
<th>è·ç¦»åº¦é‡å¯¹æ¯”</th>
<th>è´¨å¿ƒ</th>
<th>Inertia</th>
</tr>
</thead>
<tbody><tr>
<td>æ¬§å‡ é‡Œå¾—è·ç¦»</td>
<td>å‡å€¼</td>
<td>æœ€å°åŒ–æ¯ä¸ªæ ·æœ¬ç‚¹åˆ°è´¨å¿ƒçš„æ¬§å¼è·ç¦»ä¹‹å’Œ</td>
</tr>
<tr>
<td>æ›¼å“ˆé¡¿è·ç¦»</td>
<td>ä¸­ä½æ•°</td>
<td>æœ€å°åŒ–æ¯ä¸ªæ ·æœ¬ç‚¹åˆ°è´¨å¿ƒçš„æ›¼å“ˆé¡¿è·ç¦»ä¹‹å’Œ</td>
</tr>
<tr>
<td>ä½™å¼¦è·ç¦»</td>
<td>å‡å€¼</td>
<td>æœ€å°åŒ–æ¯ä¸ªæ ·æœ¬ç‚¹åˆ°è´¨å¿ƒçš„ä½™å¼¦è·ç¦»ä¹‹å’Œ</td>
</tr>
</tbody></table>
</li>
<li><p>  ä¸Šè¿°é—®é¢˜æ˜¯<font color="green">NP-Hard</font>é—®é¢˜ã€‚ä¸€èˆ¬æ˜¯é‡‡ç”¨åæ ‡ä¸‹é™ï¼ˆCoordinate Decendetï¼‰æ–¹æ³•æ±‚è§£ã€‚åæ ‡ä¸‹é™æ³•å±äºéæ¢¯åº¦ä¼˜åŒ–æ–¹æ³•ï¼Œæ¯ä¸€æ­¥è¿­ä»£ä¸­æ²¿ç€ä¸€ä¸ªåæ ‡è½´æ–¹å‘æ¢ç´¢ï¼Œé€šè¿‡å¾ªç¯ä½¿ç”¨ä¸åŒçš„åæ ‡è¾¾åˆ°æ±‚è§£ç›®æ ‡å‡½æ•°çš„å±€éƒ¨æœ€å°å€¼ã€‚ </p>
</li>
</ul>
<p><img src="/blog/2021/11/15/2021-11-15-kmeans/4.png"></p>
<p>å¦‚ä¸Šå›¾ï¼Œå‡è®¾ä¸¤ç»´åº¦xï¼Œyï¼š</p>
<ol>
<li>é¦–å…ˆé€‰æ‹©åˆå§‹ä½ç½®(x,y)ï¼Œå‡è®¾xæœªçŸ¥å°†yçš„å€¼ä»£å…¥ç›®æ ‡å‡½æ•°ä¸­ï¼Œä»¤ç›®æ ‡å‡½æ•°å¯¼æ•°0ï¼Œæ±‚å¾—æ­¤æ—¶æœ€ä½³xå€¼ã€‚</li>
<li>åˆå‡è®¾yæœªçŸ¥å°†åˆšæ±‚å¾—xçš„å€¼ä»£å…¥ç›®æ ‡å‡½æ•°ï¼Œä»¤ç›®æ ‡å‡½æ•°å¯¼æ•°0ï¼Œæ±‚å¾—æ­¤æ—¶æœ€ä½³yã€‚</li>
<li>é‡å¤æ‰§è¡Œç¬¬1æ­¥ç¬¬2æ­¥ï¼Œç›®æ ‡å‡½æ•°é€æ¸æ¥è¿‘æå°å€¼ç‚¹ï¼Œç›´åˆ°è¾¾åˆ°äº†æå°å€¼ç‚¹åœæ­¢ã€‚</li>
</ol>
<p>æ”¶æ•›çš„è¿‡ç¨‹å¦‚çº¢è‰²ç®­å¤´æ‰€ç¤ºã€‚æ›´å¤šç»´åº¦æ—¶ï¼ŒåŒç†ï¼Œä¸€æ¬¡åªå¯¹ä¸€ä¸ªç»´åº¦æœ€ä¼˜åŒ–ã€‚</p>
<p>åæ ‡ä¸‹é™æ³•ä¸€èˆ¬è¦æ±‚ç›®æ ‡å‡½æ•°æ˜¯å¯å¾®çš„å‡¸å‡½æ•°(å±€éƒ¨æœ€å°å€¼å³å…¨å±€æœ€å°å€¼?)ï¼Œæ­¤æ—¶æ±‚å¾—çš„æå°å€¼æ‰èƒ½æ˜¯å…¨å±€æœ€å°å€¼ã€‚</p>
<p>ä½¿ç”¨K-Meanså‰ï¼Œå¯å…ˆç”¨PCAä½¿å„ä¸ªå˜é‡é—´å°½å¯èƒ½ç‹¬ç«‹ã€‚å¦åˆ™å¦‚ä¸¤å˜é‡é—´æœ‰è¾ƒå¼ºå…³è”æ€§ï¼Œå‡½æ•°æ”¶æ•›é€Ÿåº¦ä¼šéå¸¸æ…¢ã€‚</p>
<h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>KMeansçš„æ ¸å¿ƒç›®æ ‡æ˜¯å°†ç»™å®šçš„æ•°æ®é›†åˆ’åˆ†æˆKä¸ªç°‡ï¼ˆKæ˜¯è¶…å‚ï¼‰ï¼Œå¹¶ç»™å‡ºæ¯ä¸ªæ ·æœ¬æ•°æ®å¯¹åº”çš„ä¸­å¿ƒç‚¹ã€‚å…·ä½“æ­¥éª¤éå¸¸ç®€å•ï¼Œå¯ä»¥åˆ†ä¸º4æ­¥ï¼š</p>
<p><img src="/blog/2021/11/15/2021-11-15-kmeans/2.png"></p>
<p><strong>KMeansæœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±æ˜¯å…ˆå›ºå®šä¸­å¿ƒç‚¹ï¼Œè°ƒæ•´æ¯ä¸ªæ ·æœ¬æ‰€å±çš„ç±»åˆ«æ¥å‡å°‘Jï¼›å†å›ºå®šæ¯ä¸ªæ ·æœ¬çš„ç±»åˆ«ï¼Œè°ƒæ•´ä¸­å¿ƒç‚¹ç»§ç»­å‡å°J ã€‚ä¸¤ä¸ªè¿‡ç¨‹äº¤æ›¿å¾ªç¯ï¼Œ J å•è°ƒé€’å‡ç›´åˆ°æœ€ï¼ˆæï¼‰å°å€¼ï¼Œä¸­å¿ƒç‚¹å’Œæ ·æœ¬åˆ’åˆ†çš„ç±»åˆ«åŒæ—¶æ”¶æ•›ã€‚</strong></p>
<p><img src="/blog/2021/11/15/2021-11-15-kmeans/3.png"></p>
<p><img src="/blog/2021/11/15/2021-11-15-kmeans/5.png"></p>
<h1 id="ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥"><a href="#ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥"></a>ä¼˜ç¼ºç‚¹ä¼˜åŒ–ç­–ç•¥</h1><p>KMenasä¼˜ç‚¹ï¼š</p>
<ul>
<li>é«˜æ•ˆå¯ä¼¸ç¼©ï¼Œè®¡ç®—å¤æ‚åº¦ ä¸º<font color="green">O(NKt)</font>æ¥è¿‘äºçº¿æ€§ï¼ˆNæ˜¯æ•°æ®é‡ï¼ŒKæ˜¯èšç±»æ€»æ•°ï¼Œtæ˜¯è¿­ä»£è½®æ•°ï¼‰ã€‚</li>
<li><font color="green">æ”¶æ•›é€Ÿåº¦å¿«</font>ï¼ŒåŸç†é€šä¿—æ˜“æ‡‚ï¼Œå¯è§£é‡Šæ€§å¼ºã€‚</li>
</ul>
<p>KMeansæ˜æ˜¾ç¼ºç‚¹ï¼š</p>
<ul>
<li>å—<font color="green">åˆå§‹å€¼</font>å’Œ<font color="green">å¼‚å¸¸</font>å½±å“ï¼Œèšç±»ç»“æœå¯èƒ½ä¸æ˜¯å…¨å±€æœ€ä¼˜è€Œæ˜¯<font color="green">å±€éƒ¨æœ€ä¼˜</font>ã€‚</li>
<li><font color="green">K</font>æ˜¯è¶…å‚æ•°ï¼ŒæŒ‰<font color="green">ç»éªŒé€‰æ‹©</font></li>
<li><font color="green">æ ·æœ¬ç‚¹åªèƒ½åˆ’åˆ†åˆ°å•ä¸€çš„ç±»ä¸­</font></li>
<li>åªèƒ½å‘ç°çƒçŠ¶çš„ç°‡ã€‚</li>
<li>åˆå§‹å€¼å¯¹ç»“æœå½±å“è¾ƒå¤§ï¼Œå¯èƒ½æ¯æ¬¡èšç±»ç»“æœéƒ½ä¸ä¸€æ ·ã€‚</li>
</ul>
<p>æ ¹æ®ä»¥ä¸Šç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸‹é¢å‡ ä¸ªè§’åº¦å¯¹ç®—æ³•åšè°ƒä¼˜</p>
<ol>
<li><strong>æ•°æ®é¢„å¤„ç†ï¼šå½’ä¸€åŒ–å’Œå¼‚å¸¸ç‚¹è¿‡æ»¤</strong></li>
</ol>
<p><strong>KMeansæœ¬è´¨æ˜¯åŸºäºæ¬§å¼è·ç¦»åº¦é‡çš„æ•°æ®åˆ’åˆ†æ–¹æ³•ï¼Œå‡å€¼å’Œæ–¹å·®å¤§çš„ç»´åº¦å°†å¯¹æ•°æ®èšç±»ç»“æœäº§ç”Ÿå†³å®šæ€§å½±å“ã€‚</strong>èšç±»å‰å¯¹æ•°æ®ï¼ˆ<strong>å…·ä½“çš„è¯´æ˜¯æ¯ä¸€ä¸ªç»´åº¦çš„ç‰¹å¾</strong>ï¼‰åš<font color="green">å½’ä¸€åŒ–</font>å’Œ<font color="green">å•ä½ç»Ÿä¸€</font>è‡³å…³é‡è¦ã€‚<font color="green">å¼‚å¸¸å€¼</font>ä¼šå¯¹å‡å€¼è®¡ç®—äº§ç”Ÿè¾ƒå¤§å½±å“ï¼Œå¯¼è‡´<strong>ä¸­å¿ƒåç§»</strong>ï¼Œ<font color="green">å™ªå£°ç‚¹æœ€å¥½èƒ½æå‰è¿‡æ»¤</font>ã€‚</p>
<p><strong>2.åˆç†é€‰æ‹©Kå€¼</strong></p>
<p>Kå€¼çš„é€‰æ‹©ä¸€èˆ¬åŸºäºå®éªŒå’Œå¤šæ¬¡å®éªŒç»“æœã€‚ä¾‹å¦‚é‡‡ç”¨<strong>æ‰‹è‚˜æ³•</strong>ï¼Œå°è¯•ä¸åŒKå€¼å¹¶å°†å¯¹åº”çš„æŸå¤±å‡½æ•°ç”»æˆæŠ˜çº¿ã€‚æ‰‹è‚˜æ³•è®¤ä¸ºå›¾ä¸Šçš„<strong>æ‹ç‚¹å°±æ˜¯Kçš„æœ€ä½³å€¼</strong>ï¼ˆä¸Šå›¾å¯¹åº”K=3ï¼‰ã€‚</p>
<p><strong>Gap Statisticæ–¹æ³•</strong>ã€‚åªéœ€è¦æ‰¾åˆ°æœ€å¤§çš„Gap Statisticå¯¹åº”çš„K(è‡ªåŠ¨)ã€‚</p>
<p>æ²¿ç”¨ç¬¬ä¸€èŠ‚ä¸­<font color="green">æŸå¤±å‡½æ•°</font>è®°ä¸º Dkï¼Œå½“åˆ†ä¸ºKç±»æ—¶ï¼ŒGap Statisticå®šä¹‰ä¸ºï¼š Gap(k)=E(logDk)-logDk ã€‚ E(logDk)æ˜¯logDkçš„æœŸæœ›ï¼Œä¸€èˆ¬ç”±<font color="green">è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ</font>äº§ç”Ÿã€‚åœ¨<font color="green">æ ·æœ¬æ‰€åœ¨çš„åŒºåŸŸå†…æŒ‰ç…§å‡åŒ€åˆ†å¸ƒéšæœºåœ°äº§ç”Ÿå’ŒåŸå§‹æ ·æœ¬æ•°ä¸€æ ·å¤šçš„éšæœºæ ·æœ¬</font>ï¼Œå¯¹è¿™ä¸ª<font color="green">éšæœºæ ·æœ¬åšKMeans</font>ï¼Œå¾—åˆ°ä¸€ä¸ª<font color="green">Dk</font>ï¼Œ<font color="green">é‡å¤å¤šæ¬¡</font>è®¡ç®—å‡º E(logDk)çš„è¿‘ä¼¼å€¼ã€‚</p>
<p><strong>Gap(K) çš„ç‰©ç†å«ä¹‰æ˜¯<font color="green">éšæœºæ ·æœ¬çš„æŸå¤±ä¸å®é™…æ ·æœ¬çš„æŸå¤±ä¹‹å·®</font>ã€‚Gapè¶Š<font color="green">å¤§</font>è¯´æ˜èšç±»çš„æ•ˆæœè¶Šå¥½</strong>ã€‚éšç€Kçš„å˜åŒ–Gap(K)å‡ ä¹ç»´æŒä¸€æ¡ç›´çº¿ä¿æŒä¸å˜ã€‚è¯´æ˜è¿™äº›æ ·æœ¬é—´æ²¡æœ‰æ˜æ˜¾çš„ç±»åˆ«å…³ç³»ï¼Œ<font color="green">æ•°æ®åˆ†å¸ƒå‡ ä¹å’Œå‡åŒ€åˆ†å¸ƒä¸€è‡´</font>ï¼Œè¿‘ä¼¼éšæœºã€‚æ­¤æ—¶èšç±»æ²¡æœ‰æ„ä¹‰ã€‚</p>
<p><strong>3.æ”¹è¿›åˆå§‹å€¼çš„é€‰æ‹©</strong></p>
<p>é‡‡å–éšæœºé€‰æ‹©Kä¸ªä¸­å¿ƒï¼Œ<font color="green">å¯èƒ½å¯¼è‡´ä¸åŒä¸­å¿ƒç‚¹è·ç¦»å¾ˆè¿‘</font>ï¼Œéœ€<font color="green">æ›´å¤šçš„è¿­ä»£æ¬¡æ•°æ‰èƒ½æ”¶æ•›</font>ã€‚å¦‚åœ¨é€‰æ‹©åˆå§‹ä¸­å¿ƒç‚¹æ—¶<strong>ä¸åŒçš„ä¸­å¿ƒå°½å¯èƒ½è¿œç¦»</strong>ï¼Œæ•ˆæœæ›´å¥½ã€‚è¿™ç±»ç®—æ³•ä¸­ï¼Œä»¥K-Means++ç®—æ³•æœ€å…·å½±å“åŠ›ã€‚</p>
<p><strong>4.é‡‡ç”¨æ ¸å‡½æ•°?</strong></p>
<p>ä¸»è¦æ€æƒ³æ˜¯é€šè¿‡ä¸€ä¸ªéçº¿æ€§æ˜ å°„ï¼Œå°†è¾“å…¥ç©ºé—´ä¸­çš„æ•°æ®ç‚¹æ˜ å°„åˆ°é«˜ä½çš„ç‰¹å¾ç©ºé—´ä¸­ï¼Œå¹¶åœ¨æ–°çš„ç©ºé—´è¿›è¡Œèšç±»ã€‚éçº¿æ€§æ˜ å°„å¢åŠ äº†æ•°æ®ç‚¹çº¿æ€§å¯åˆ†çš„æ¦‚ç‡ï¼ˆä¸SVMä¸­ä½¿ç”¨æ ¸å‡½æ•°æ€æƒ³ç±»ä¼¼ï¼‰å¯¹äºéå‡¸çš„æ•°æ®åˆ†å¸ƒå¯ä»¥è¾¾åˆ°æ›´ä¸ºå‡†ç¡®çš„èšç±»ç»“æœã€‚</p>
<ol start="5">
<li>ä»EMç®—æ³•è§£é‡ŠKMeans</li>
</ol>
<p>EMï¼ˆExpectation-Maximumï¼‰ç®—æ³•å³æœŸæœ›æœ€å¤§åŒ–ç®—æ³•ï¼Œæ˜¯æœ€å¸¸è§çš„éšå˜é‡ä¼°è®¡æ–¹æ³•ã€‚EMç®—æ³•æ˜¯ä¸€ç§è¿­ä»£ä¼˜åŒ–ç­–ç•¥ï¼Œæ¯ä¸€æ¬¡è¿­ä»£éƒ½åˆ†ä¸ºä¸¤æ­¥ï¼šæœŸæœ›æ­¥ï¼ˆEï¼‰ã€æå¤§æ­¥ï¼ˆMï¼‰ã€‚<strong>EMç®—æ³•çš„æå‡ºæœ€åˆæ˜¯ä¸ºäº†è§£å†³æ•°æ®ç¼ºå¤±æƒ…å†µä¸‹çš„å‚æ•°ä¼°è®¡é—®é¢˜</strong>ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯é¦–å…ˆæ ¹æ®å·²æœ‰çš„è§‚æµ‹æ•°æ®ï¼Œé€šè¿‡æå¤§ä¼¼ç„¶ä¼°è®¡ä¼°è®¡å‡ºæ¨¡å‹çš„å‚æ•°ï¼›å†æ ¹æ®ä¸Šä¸€æ­¥ä¼°è®¡å‡ºçš„å‚æ•°å€¼ä¼°è®¡ç¼ºå¤±æ•°æ®çš„å€¼ï¼›æœ€åæ ¹æ®ä¼°è®¡å‡ºçš„ç¼ºå¤±æ•°æ®å’ŒåŸæœ‰çš„è§‚æµ‹æ•°æ®é‡æ–°å¯¹å‚æ•°å€¼è¿›è¡Œä¼°è®¡ï¼Œåå¤è¿­ä»£ç›´åˆ°æ”¶æ•›ã€‚</p>
<hr>
<p>Kå‡å€¼èšç±»æ˜¯ä½¿ç”¨<a href="https://baike.baidu.com/item/%E6%9C%80%E5%A4%A7%E6%9C%9F%E6%9C%9B%E7%AE%97%E6%B3%95/10180861">æœ€å¤§æœŸæœ›ç®—æ³•</a>ï¼ˆExpectation-Maximization algorithmï¼‰æ±‚è§£çš„<a href="https://baike.baidu.com/item/%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B/8878468">é«˜æ–¯æ··åˆæ¨¡å‹</a>ï¼ˆGaussian Mixture Model, GMMï¼‰åœ¨<a href="https://baike.baidu.com/item/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/829892">æ­£æ€åˆ†å¸ƒ</a>çš„åæ–¹å·®ä¸ºå•ä½çŸ©é˜µï¼Œä¸”éšå˜é‡çš„åéªŒåˆ†å¸ƒä¸ºä¸€ç»„<a href="https://baike.baidu.com/item/%E7%8B%84%E6%8B%89%E5%85%8B%CE%B4%E5%87%BD%E6%95%B0/5760582">ç‹„æ‹‰å…‹Î´å‡½æ•°</a>æ—¶æ‰€å¾—åˆ°çš„ç‰¹ä¾‹?</p>
<p>Python</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KMeansClusterer</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,ndarray,cluster_num</span>):</span></span><br><span class="line">        self.ndarray = ndarray</span><br><span class="line">        self.cluster_num = cluster_num</span><br><span class="line">        self.points=self.__pick_start_point(ndarray,cluster_num)</span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cluster</span>(<span class="params">self</span>):</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.cluster_num):</span><br><span class="line">            result.append([])</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> self.ndarray:</span><br><span class="line">            distance_min = sys.maxsize</span><br><span class="line">            index=-<span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(self.points)):                </span><br><span class="line">                distance = self.__distance(item,self.points[i])</span><br><span class="line">                <span class="keyword">if</span> distance &lt; distance_min:</span><br><span class="line">                    distance_min = distance</span><br><span class="line">                    index = i</span><br><span class="line">            result[index] = result[index] + [item.tolist()]</span><br><span class="line">        new_center=[]</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> result:</span><br><span class="line">            new_center.append(self.__center(item).tolist())</span><br><span class="line">        <span class="comment"># ä¸­å¿ƒç‚¹æœªæ”¹å˜ï¼Œè¯´æ˜è¾¾åˆ°ç¨³æ€ï¼Œç»“æŸé€’å½’</span></span><br><span class="line">        <span class="keyword">if</span> (self.points==new_center).<span class="built_in">all</span>():</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">         </span><br><span class="line">        self.points=np.array(new_center)</span><br><span class="line">        <span class="keyword">return</span> self.cluster()</span><br><span class="line">             </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__center</span>(<span class="params">self,<span class="built_in">list</span></span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;è®¡ç®—ä¸€ç»„åæ ‡çš„ä¸­å¿ƒç‚¹</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># è®¡ç®—æ¯ä¸€åˆ—çš„å¹³å‡å€¼</span></span><br><span class="line">        <span class="keyword">return</span> np.array(<span class="built_in">list</span>).mean(axis=<span class="number">0</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__distance</span>(<span class="params">self,p1,p2</span>):</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;è®¡ç®—ä¸¤ç‚¹é—´è·</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        tmp=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(p1)):</span><br><span class="line">            tmp += <span class="built_in">pow</span>(p1[i]-p2[i],<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(tmp,<span class="number">0.5</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__pick_start_point</span>(<span class="params">self,ndarray,cluster_num</span>):</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> cluster_num &lt;<span class="number">0</span> <span class="keyword">or</span> cluster_num &gt; ndarray.shape[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;ç°‡æ•°è®¾ç½®æœ‰è¯¯&quot;</span>)</span><br><span class="line">      </span><br><span class="line">        <span class="comment"># éšæœºç‚¹çš„ä¸‹æ ‡</span></span><br><span class="line">        indexes=random.sample(np.arange(<span class="number">0</span>,ndarray.shape[<span class="number">0</span>],step=<span class="number">1</span>).tolist(),cluster_num)</span><br><span class="line">        points=[]</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> indexes:</span><br><span class="line">            points.append(ndarray[index].tolist())</span><br><span class="line">        <span class="keyword">return</span> np.array(points)</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="KMeans-and-gaussian-mixture-model"><a href="#KMeans-and-gaussian-mixture-model" class="headerlink" title="KMeans and gaussian mixture model"></a>KMeans and gaussian mixture model</h2><p>æ•°æ®è¡¨ç¤ºï¼škmeanså•ä¸ªç‚¹å¯¹clusterå»ºæ¨¡ï¼ˆå‡è®¾å„clusæ•°æ®æ˜¯åœ†å½¢æˆ–é«˜ä½çƒå½¢ï¼‰ã€‚GMMï¼Œä½¿ç”¨é«˜æ–¯åˆ†å¸ƒè¡¨ç¤º</p>
<p>æ•°æ®å…ˆéªŒï¼škmeansï¼Œå‡è®¾å„cluså…ˆéªŒæ¦‚ç‡ä¸€æ ·ï¼Œå®é™…clusæ•°æ®é‡å¯èƒ½ä¸å‡åŒ€ã€‚clusA10000ï¼ŒB100ï¼Œæ–°æ ·æœ¬ä¸è€ƒè™‘ä¸ABç›¸ä¼¼åº¦ï¼Œå±äºAæ¦‚ç‡å¤§ã€‚GMMå¯¹æ•°æ®å…ˆéªŒè¿›è¡Œå»ºæ¨¡ã€‚</p>
<p>ç›¸ä¼¼åº¦è¡¡é‡ï¼šKmeansçš„æ¬§å¼è·ç¦»å‡è®¾å„ä¸ªç»´åº¦å¯¹ç›¸ä¼¼åº¦è¡¡é‡ä½œç”¨ä¸€æ ·ã€‚GMMç›¸ä¼¼åº¦è¡¡é‡ä½¿ç”¨åéªŒæ¦‚ç‡é€šè¿‡å¼•å…¥åæ–¹å·®çŸ©é˜µï¼Œå¯¹å„ä¸ªç»´åº¦æ•°æ®çš„ä¸åŒé‡è¦æ€§å»ºæ¨¡ã€‚</p>
<p>æ•°æ®åˆ†é…ï¼škmeanså„æ ·æœ¬åªå±äºç›¸ä¼¼åº¦æœ€é«˜clusï¼ˆhard clustingï¼‰ï¼ŒGMMä½¿ç”¨åéªŒæ¦‚ç‡å¯¹å„ä¸ªclusæŒ‰æ¯”ä¾‹åˆ†é…ï¼ˆfuzzy clusteringï¼Ÿï¼‰ã€‚</p>
<hr>
<h2 id="k-means-èšç±»ç®—æ³•"><a href="#k-means-èšç±»ç®—æ³•" class="headerlink" title="k-means++èšç±»ç®—æ³•"></a>k-means++èšç±»ç®—æ³•</h2><p><code>KMeans</code>ç®—æ³•ï¼Œ<code>KMeans</code>åœ¨èšç±»ä¹‹å‰é¦–å…ˆéœ€åˆå§‹åŒ–kä¸ªç°‡ä¸­å¿ƒï¼Œå› æ­¤ <code>KMeans</code> ç®—æ³•å¯¹åˆå€¼æ•æ„Ÿï¼Œå¯¹äºä¸åŒçš„åˆå§‹å€¼ï¼Œä¼šå¯¼è‡´ä¸åŒèšç±»ç»“æœã€‚è‹¥åˆå§‹åŒ–éšæœºï¼Œå¾ˆæœ‰å¯èƒ½ kç°‡ä¸­å¿ƒéƒ½åœ¨åŒä¸€ä¸ªç°‡ï¼Œè¿™ç§æƒ…å†µ <code>KMeans</code> å¾ˆå¤§ç¨‹åº¦ä¸Šéƒ½ä¸ä¼šæ”¶æ•›åˆ°å…¨å±€æœ€å°ã€‚</p>
<p>ä¸ºä¼˜åŒ–é€‰æ‹©åˆå§‹è´¨å¿ƒçš„æ–¹æ³•ï¼Œ2007 å¹´ Arthur,ç­‰ ä¸‰äººå‘è¡¨äº†è®ºæ–‡â€œk-means++: <code>The advantages of careful seeding</code>ï¼Œ<code>sklearn.cluster.KMeans</code> ä¸­é»˜è®¤å‚æ•°ä¸º <code>init=&#39;k-means++&#39;</code> ï¼Œå…¶ç®—æ³•åŸç†ä¸ºåœ¨åˆå§‹åŒ–ç°‡ä¸­å¿ƒæ—¶ï¼Œé€ä¸ªé€‰å– kä¸ªç°‡ä¸­å¿ƒï¼Œä¸”ç¦»å…¶ä»–ç°‡ä¸­å¿ƒè¶Šè¿œçš„æ ·æœ¬è¶Šæœ‰å¯èƒ½è¢«é€‰ä¸ºä¸‹ä¸ªç°‡ä¸­å¿ƒã€‚</p>
<p>ç®—æ³•æ­¥éª¤ï¼š</p>
<p><img src="/blog/2021/11/15/2021-11-15-kmeans/6.png"></p>
<hr>
<p>refï¼š</p>
<p><a href="https://zhuanlan.zhihu.com/p/184686598">https://zhuanlan.zhihu.com/p/184686598</a></p>
<p><a href="https://www.cnblogs.com/gaochundong/p/kmeans_clustering.html">https://www.cnblogs.com/gaochundong/p/kmeans_clustering.html</a></p>
<p><a href="https://www.zhihu.com/question/31296149">https://www.zhihu.com/question/31296149</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/342052190#:~:text=KMeans%20">https://zhuanlan.zhihu.com/p/342052190#:~:text=KMeans%20</a></p>
]]></content>
      <categories>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>ATAC-seq-4ã€Macs2/3 Installationã€‘</title>
    <url>/blog/2021/10/29/ATAC-seq-4-macs3-install/</url>
    <content><![CDATA[<h3 id="Macs2-3-installation-Debug-Record"><a href="#Macs2-3-installation-Debug-Record" class="headerlink" title="Macs2/3 installation Debug Record"></a>Macs2/3 installation Debug Record</h3><span id="more"></span>

<p>macs2 installation record<br>install conda<br>creat work environment<br>install numpy1.17<br>python setup.py install â€“prefix â€¦./software/MACS</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">####################################ERROR1#############################################</span><br><span class="line">#MACS3/fermi-lite/ksw.c:31:26: fatal error: lib/x86/sse2.h: No such file or directory</span><br><span class="line"># #include &quot;lib/x86/sse2.h&quot;                      ^</span><br><span class="line">#compilation terminated.</span><br><span class="line">#error: command &#x27;gcc&#x27; failed with exit status 1</span><br><span class="line">######################################################################################</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/macs3-project/MACS/issues/473">https://github.com/macs3-project/MACS/issues/473</a><br>zip downloaded from github zip is not complete in the deep dir<br>git clone <a href="https://github.com/macs3-project/MACS.git">https://github.com/macs3-project/MACS.git</a> â€“recursive<br>or download absent files</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">####################################ERROR2#############################################</span><br><span class="line">Checking .pth file support in ..../software/MACS2/lib/python3.8/site-packages/</span><br><span class="line">..../.conda/envs/atacseq/bin/python -E -c pass</span><br><span class="line">TEST FAILED: ..../software/MACS2/lib/python3.8/site-packages/ does NOT support .pth files</span><br><span class="line">bad install directory or PYTHONPATH</span><br><span class="line"></span><br><span class="line">You are attempting to install a package to a directory that is not</span><br><span class="line">on PYTHONPATH and which Python does not read &quot;.pth&quot; files from.  The</span><br><span class="line">installation directory you specified (via --install-dir, --prefix, or</span><br><span class="line">the distutils default setting) was:</span><br><span class="line"></span><br><span class="line">    ..../software/MACS2/lib/python3.8/site-packages/</span><br><span class="line"></span><br><span class="line">and your PYTHONPATH environment variable currently contains:</span><br><span class="line"></span><br><span class="line">    &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">Here are some of your options for correcting the problem:</span><br><span class="line"></span><br><span class="line">* You can choose a different installation directory, i.e., one that is</span><br><span class="line">  on PYTHONPATH or supports .pth files</span><br><span class="line"></span><br><span class="line">* You can add the installation directory to the PYTHONPATH environment</span><br><span class="line">  variable.  (It must then also be on PYTHONPATH whenever you run</span><br><span class="line">  Python and want to use the package(s) you are installing.)</span><br><span class="line"></span><br><span class="line">* You can set up the installation directory to support &quot;.pth&quot; files by</span><br><span class="line">  using one of the approaches described here:</span><br><span class="line"></span><br><span class="line">  https://setuptools.readthedocs.io/en/latest/deprecated/easy_install.html#custom-installation-locations</span><br></pre></td></tr></table></figure>

<p>[ok]export PYTHONPATH=${PYTHONPATH}:â€¦./software/MACS2/lib/python3.9/site-packages/</p>
<p>directly set PYTHONPATH=â€¦./software/MACS2/lib/python3.9/site-packages/ in ~/.bashrc was failed.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">####################################ERROR3#############################################</span><br><span class="line">error: package directory &#x27;MACS2&#x27; does not exist</span><br><span class="line">#######################################################################################</span><br></pre></td></tr></table></figure>
<p>zip Dir was not complete, tried .tar.gz </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">####################################ERROR4#############################################</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;..../software/MACS3/bin/macs3&quot;, line 4, in &lt;module&gt;</span><br><span class="line">    __import__(&#x27;pkg_resources&#x27;).run_script(&#x27;MACS3==3.0.0a6&#x27;, &#x27;macs3&#x27;)</span><br><span class="line">  File &quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;, line 3243, in &lt;module&gt;</span><br><span class="line">    def _initialize_master_working_set():</span><br><span class="line">  File &quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;, line 3226, in _call_aside</span><br><span class="line">    f(*args, **kwargs)</span><br><span class="line">  File &quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;, line 3255, in _initialize_master_working_set</span><br><span class="line">    working_set = WorkingSet._build_master()</span><br><span class="line">  File &quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;, line 568, in _build_master</span><br><span class="line">    ws.require(__requires__)</span><br><span class="line">  File &quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;, line 886, in require</span><br><span class="line">    needed = self.resolve(parse_requirements(requirements))</span><br><span class="line">  File &quot;..../miniconda3/lib/python3.9/site-packages/pkg_resources/__init__.py&quot;, line 772, in resolve</span><br><span class="line">    raise DistributionNotFound(req, requirers)</span><br><span class="line">pkg_resources.DistributionNotFound: The &#x27;Cython&gt;=0.29&#x27; distribution was not found and is required by MACS3``</span><br></pre></td></tr></table></figure>

<p><code>conda install Cython=0.29</code></p>
<p><a href="https://pypi.org/project/cykhash/">https://pypi.org/project/cykhash/</a><br><code>pip install cykhash</code><br>Collecting cykhash<br>  Using cached cykhash-1.0.2-cp39-cp39-linux_x86_64.whl<br>Installing collected packages: cykhash<br>Successfully installed cykhash-1.0.2</p>
<p>python setup.py install â€“prefix â€¦./software/MACS2</p>
<p>success</p>
]]></content>
      <categories>
        <category>Software</category>
        <category>ATAC-seq</category>
      </categories>
      <tags>
        <tag>Debug</tag>
      </tags>
  </entry>
  <entry>
    <title>ATAC-seq-5ã€PeakCalling-MACS2ã€‘</title>
    <url>/blog/2021/10/29/ATAC-seq-5-macs2-info/</url>
    <content><![CDATA[<h2 id="MACS2-detail"><a href="#MACS2-detail" class="headerlink" title="MACS2 detail"></a>MACS2 detail</h2><span id="more"></span>


<h3 id="ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚"><a href="#ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚" class="headerlink" title="ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚"></a>ç²—ç•¥ä»‹ç»MACSåŸºæœ¬åŸç†ã€‚</h3><p>TFåœ¨åŸºå› ç»„ä¸Šçš„ç»“åˆæ˜¯éšæœºè¿‡ç¨‹ï¼ŒåŸºå› ç»„çš„æ¯ä¸ªä½ç½®éƒ½æœ‰æœºä¼šç»“åˆæŸä¸ªTFï¼Œåªæ˜¯æ¦‚ç‡ä¸ä¸€æ ·ï¼Œpeakå‡ºç°çš„ä½ç½®ï¼Œæ˜¯TFç»“åˆçƒ­ç‚¹ï¼Œè€Œpeak-callingå°±ä¸ºäº†æ‰¾è¿™äº›çƒ­ç‚¹ã€‚</p>
<p>å¦‚ä½•å®šä¹‰çƒ­ç‚¹ï¼Ÿé€šä¿—è®²ï¼Œçƒ­ç‚¹æ˜¯è¿™æ ·ä¸€äº›ä½ç½®ï¼Œè¿™äº›ä½ç½®å¤šæ¬¡è¢«æµ‹å¾—çš„readæ‰€è¦†ç›–ï¼ˆæˆ‘ä»¬æµ‹çš„æ˜¯ä¸€ä¸ªç»†èƒç¾¤ä½“ï¼Œreadå‡ºç°æ¬¡æ•°å¤šï¼Œè¯´æ˜è¯¥ä½ç½®è¢«TFç»“åˆçš„å‡ ç‡å¤§ï¼‰ã€‚readæ•°è¾¾åˆ°å¤šå°‘æ‰å«å¤šï¼Ÿå°±è¦ç”¨åˆ°ç»Ÿè®¡æ£€éªŒã€‚å‡è®¾TFåœ¨åŸºå› ç»„ä¸Šçš„åˆ†å¸ƒæ²¡æœ‰ä»»ä½•è§„å¾‹ï¼Œé‚£ä¹ˆæµ‹åºå¾—åˆ°çš„readåœ¨åŸºå› ç»„ä¸Šçš„åˆ†å¸ƒä¹Ÿå¿…ç„¶æ˜¯éšæœºçš„ï¼ŒæŸä¸ªç¢±åŸºä¸Šè¦†ç›–çš„readçš„æ•°ç›®åº”æœä»äºŒé¡¹åˆ†å¸ƒã€‚å’ŒæŠ½å°çƒçš„è¿‡ç¨‹ç±»ä¼¼ã€‚å½“nå¾ˆå¤§ï¼Œpå¾ˆå°æ—¶ï¼ŒäºŒé¡¹åˆ†å¸ƒè¿‘ä¼¼ç”¨æ³Šæ¾åˆ†å¸ƒæ›¿ä»£ï¼Œåœ¨è¿™é‡Œï¼š<br><img src="/blog/2021/10/29/ATAC-seq-5-macs2-info/1.png"></p>
<p>æ‹‰å§†è¾¾æ˜¯æ³Šæ¾åˆ†å¸ƒå”¯ä¸€å‚æ•°ï¼Œnæ˜¯æµ‹åºreadæ€»æ•°ç›®ï¼Œlæ˜¯å•ä¸ªreadé•¿åº¦ï¼Œsæ˜¯åŸºå› ç»„å¤§å°ã€‚æœ‰äº†åˆ†å¸ƒï¼Œå¯ä»¥ç®—å‡ºåœ¨æŸä¸ªç½®ä¿¡æ¦‚ç‡ï¼ˆå¦‚0.00001ï¼‰ä¸‹ï¼Œéšæœºæƒ…å†µä¸‹ï¼ŒæŸä¸ªç¢±åŸºä¸Šå¯ä»¥è¦†ç›–çš„readæ•°ç›®çš„æœ€å°å€¼ï¼Œå½“å®é™…è§‚å¯Ÿåˆ°çš„readæ•°ç›®è¶…è¿‡è¿™ä¸ªå€¼ï¼ˆå•ä¾§æ£€éªŒï¼‰æ—¶ï¼Œè®¤ä¸ºè¯¥ç¢±åŸºæ˜¯TFçš„ä¸€ä¸ªç»“åˆçƒ­ç‚¹ã€‚åè¿‡æ¥ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªreadæ•°ç›®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç®—å‡ºå¯¹åº”çš„ç½®ä¿¡æ¦‚ç‡Pã€‚</p>
<p>ä½†è¿™åªæ˜¯ç®€åŒ–æ¨¡å‹ï¼Œå®é™…æƒ…å†µå¤æ‚å¥½å¤šã€‚ç”±äºæµ‹åºã€mappingè¿‡ç¨‹å†…åœ¨<font color="red">åå¥½æ€§</font>ï¼Œä»¥åŠä¸åŒæŸ“è‰²è´¨é—´çš„å·®å¼‚æ€§ï¼Œç›¸æ¯”å…¨åŸºå› ç»„ï¼ŒæŸäº›ç¢±åŸºå¯èƒ½å†…åœ¨åœ°ä¼šè¢«æ›´å¤šçš„readæ‰€è¦†ç›–ï¼Œè¿™ç§æƒ…å†µå¾—åˆ°çš„å¾ˆå¤špeakå¯èƒ½éƒ½æ˜¯å‡çš„ã€‚MACSè€ƒè™‘åˆ°è¿™ç‚¹ï¼Œ<font color="red">å½“å¯¹æŸä¸ªç¢±åŸºè¿›è¡Œå‡è®¾æ£€éªŒï¼ŒMACSåªè€ƒè™‘è¯¥ç¢±åŸºé™„è¿‘æŸ“è‰²è´¨åŒºæ®µï¼ˆå¦‚10kï¼‰ï¼Œæ­¤æ—¶ä¸Šè¿°å…¬å¼ä¸­nè¡¨ç¤ºé™„è¿‘10kåŒºé—´å†…çš„readæ•°ç›®ï¼Œsè¢«ç½®ä¸º10k</font>ã€‚å½“æœ‰å¯¹ç…§ç»„ï¼ˆControlï¼Œç›¸æ¯”å®éªŒç»„æ²¡æœ‰ç”¨æŠ—ä½“æ•è·TFæˆ–ç”¨äº†ä¸€ä¸ªé€šç”¨æŠ—ä½“ï¼‰å­˜åœ¨ï¼Œåˆ©ç”¨Controlç»„çš„æ•°æ®æ„å»ºæ³Šæ¾åˆ†å¸ƒï¼Œ<font color="red">æ²¡æœ‰Controlæ—¶ï¼Œåˆ©ç”¨å®éªŒç»„ï¼Œç¨å¤§ä¸€ç‚¹çš„å±€éƒ¨åŒºé—´ï¼ˆæ¯”å¦‚50kï¼‰</font>çš„æ•°æ®æ„å»ºæ³Šæ¾åˆ†å¸ƒã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œreadåªæ˜¯è·Ÿéšç€TFä¸€èµ·æ²‰æ·€ä¸‹æ¥çš„DNA fragmentçš„æœ«ç«¯ï¼Œreadçš„ä½ç½®å¹¶ä¸æ˜¯çœŸå®çš„TFç»“åˆä½ç½®ã€‚æ‰€ä»¥åœ¨peak-callingä¹‹å‰ï¼Œå»¶ä¼¸readæ˜¯å¿…é¡»çš„ã€‚ä¸åŒTFå¤§å°ä¸ä¸€æ ·ï¼Œå¯¹readå»¶ä¼¸çš„é•¿åº¦ä¹Ÿç†åº”ä¸åŒ.æµ‹å¾—çš„<font color="red">readæœ€ç»ˆå…¶å®ä¼šè¿‘ä¼¼åœ°å¹³å‡åˆ†é…åˆ°æ­£è´Ÿé“¾</font>ï¼Œå¯¹äºä¸€ä¸ªTFç»“åˆçƒ­ç‚¹ï¼Œreadåœ¨é™„è¿‘æ­£è´Ÿé“¾ä¸Šä¼šè¿‘ä¼¼åœ°å½¢æˆ<font color="red">â€œåŒå³°â€</font>ã€‚MACSä¼šä»¥<font color="red">æŸä¸ªwindow sizeæ‰«æåŸºå› ç»„ï¼Œç»Ÿè®¡æ¯ä¸ªwindowé‡Œé¢readçš„å¯Œé›†ç¨‹åº¦ï¼Œç„¶åæŠ½å–ï¼ˆæ¯”å¦‚1000ä¸ªï¼‰åˆé€‚çš„ï¼ˆreadå¯Œé›†ç¨‹åº¦é€‚ä¸­ï¼Œè¿‡å°‘ï¼Œæ— æ³•å»ºç«‹æ¨¡å‹ï¼Œè¿‡å¤§ï¼Œå¯èƒ½åæ˜ çš„åªæ˜¯æŸç§åå¥½æ€§ï¼‰windowä½œæ ·æœ¬ï¼Œå»ºç«‹â€œåŒå³°æ¨¡å‹â€</font>ã€‚æœ€åï¼Œä¸¤ä¸ªå³°ä¹‹é—´çš„è·ç¦»å°±è¢«è®¤ä¸ºæ˜¯<font color="red">TFçš„é•¿åº¦Dï¼Œæ¯ä¸ªreadå°†å»¶ä¼¸D/2</font>ã€‚è§ä¸‹å›¾ï¼š</p>
<p><img src="/blog/2021/10/29/ATAC-seq-5-macs2-info/2.png"></p>
<p>å½“æœ‰å¯¹ç…§ç»„ï¼ŒMACSä¼šè¿›è¡Œä¸¤æ¬¡peak callingã€‚ç¬¬ä¸€æ¬¡ä»¥å®éªŒç»„ï¼ˆTreatmentï¼‰ä¸ºå®éªŒç»„ï¼Œå¯¹ç…§ç»„ä¸ºå¯¹ç…§ç»„ï¼Œç¬¬äºŒæ¬¡é¢ å€’ï¼Œä»¥å®éªŒç»„ä¸ºå¯¹ç…§ç»„ï¼Œå¯¹ç…§ç»„ä¸ºå®éªŒç»„ã€‚ä¹‹åï¼ŒMACSå¯¹æ¯ä¸€ä¸ªPè®¡ç®—äº†ç›¸åº”çš„FDRï¼ˆFalse Discovery Rateï¼‰å€¼ï¼š</p>
<p><img src="/blog/2021/10/29/ATAC-seq-5-macs2-info/3.png"></p>
<p>è¡¨ç¤ºç¬¬äºŒæ¬¡peak callingï¼ˆé¢ å€’çš„ï¼‰å¾—åˆ°çš„ç½®ä¿¡æ¦‚ç‡å°äºPçš„peakçš„ä¸ªæ•°ã€‚è¡¨ç¤ºç¬¬ä¸€æ¬¡peak callingå¾—åˆ°çš„ç½®ä¿¡æ¦‚ç‡å°äºPçš„peakçš„ä¸ªæ•°ã€‚FDRç»¼åˆåˆ©ç”¨äº†å®éªŒç»„å’Œå¯¹ç…§ç»„çš„ä¿¡æ¯ï¼Œæ˜¾ç„¶ï¼ŒFDRè¶Šå°è¶Šå¥½ã€‚</p>
<h3 id="MACS-peak-calling-pipelineï¼š"><a href="#MACS-peak-calling-pipelineï¼š" class="headerlink" title="MACS peak-calling pipelineï¼š"></a>MACS peak-calling pipelineï¼š</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚å¯¹ç»„è›‹ç™½ä¿®é¥°çš„ChIP-seqæ•°æ®peak-callingæ—¶ï¼Œâ€œåŒå³°æ¨¡å‹â€ä¼šå»ºç«‹å¤±è´¥ï¼Œ<font color="red">å› ä¸ºç»„è›‹ç™½ä¿®é¥°å¾€å¾€å¹¶ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œå¯èƒ½å¾ˆé•¿ä¸€æ®µæŸ“è‰²è´¨åŒºé—´éƒ½è¢«åŒä¸€ä¸ªç»„è›‹ç™½ä¿®é¥°å æ®ï¼Œç»„è›‹ç™½ä¿®é¥°çš„peakå¹¶ä¸å…¸å‹ã€‚</font>è¿™æ—¶ï¼Œåªè¦å¤šåŠ ä¸€ä¸ªå‚æ•°ï¼š</p>
<p><font color="red">â€“nomodel â€“shiftsize=number</font></p>
<p>â€“nomodelå°†<font color="red">ç•¥è¿‡â€œåŒå³°æ¨¡å‹â€å»ºç«‹çš„è¿‡ç¨‹</font>ï¼Œè€Œ<font color="red">â€“shiftsizeå°†äººä¸ºæŒ‡å®šreadså»¶ä¼¸çš„é•¿åº¦</font>ã€‚<font color="red">ä¸€ä¸ªæ ¸å°ä½“ä¸Šå¤§æ¦‚ç¼ ç»•ç€147bpDNA</font>ï¼Œåœ¨å¯¹ç»„è›‹ç™½ä¿®é¥°åšpeak-callingæ—¶å¯ä»¥æŒ‡å®šï¼š</p>
<p><font color="red">â€“nomodel â€“shiftsize=73</font></p>
<p>CTCF_peaks.bedè¯¦ç»†åˆ—å‡ºäº†æ¯ä¸€ä¸ªpeakçš„ä½ç½®ä¿¡æ¯å’Œå¯ä¿¡åº¦ï¼ˆæœ€åä¸€åˆ—ï¼š)ï¼ŒBEDæ–‡ä»¶æ ¼å¼è¯¦è§ï¼š<a href="http://genome.ucsc.edu/FAQ/FAQformat.html#format1">http://genome.ucsc.edu/FAQ/FAQformat.html#format1</a></p>
<p>å…¶ä»–å¸¸ç”¨å‚æ•°ï¼š-bw number å»ºç«‹â€œåŒå³°æ¨¡å‹â€è¿‡ç¨‹ä¸­window sizeçš„ä¸€åŠï¼Œé»˜è®¤300bp.<br><font color="red">-p Pvalue</font>è®¾å®špeakç½®ä¿¡æ¦‚ç‡çš„ä¸´ç•Œå€¼ï¼ˆthresholdï¼‰ï¼Œé»˜è®¤0.00001?(macs2 callpeak -h: pvalue not set, dont use p and q value at the same time)ï¼Œå¯¹äºH3k36me3ã€H3k27me3ã€H3k9me3ç­‰å…·æœ‰â€œéå¸¸è§„â€ç‰¹å¾çš„peakï¼ˆbroad peakï¼‰è€Œè¨€ï¼Œæ­¤å‚æ•°å¯ä»¥ç¨å¾®è®¾å¤§ä¸€ç‚¹ï¼Œæ¯”å¦‚0.001ã€‚</p>
<p>-m number1,number2 å»ºç«‹â€œåŒå³°æ¨¡å‹â€ç”¨åˆ°ï¼Œè®¾å®šæŒ‘é€‰çš„windowä¸Šreadsçš„å¯Œé›†ç¨‹åº¦ï¼ˆ<font color="red">fold enrichment</font>ï¼Œç›¸å¯¹å…¨åŸºå› ç»„è€Œè¨€ï¼‰ï¼Œé»˜è®¤10,30ã€‚</p>
<p>-slocal=number -llocal=number å…±åŒç¡®å®šMACSåŠ¨æ€è®¡ç®—æ—¶æ‰€è€ƒå¯Ÿçš„å±€éƒ¨åŒºé—´çš„é•¿åº¦ã€‚é»˜è®¤å‚æ•°ï¼Œ-slocal=1000 -llocal=10000ã€‚é™¤äº†å»ºç«‹â€œåŒå³°æ¨¡å‹â€ï¼Œåœ¨å¯»æ‰¾peakè¿‡ç¨‹ä¸­ï¼ŒMACSä¾ç„¶ä¼šä»¥2å€äº-bwçš„windowæ‰«æåŸºå› ç»„ï¼Œå¯¹äºå½“å‰windowè€Œè¨€ï¼ˆ-slocal,-llocalå–é»˜è®¤å‚æ•°ï¼‰ï¼š</p>
<p>-w/-B å»ºç«‹wigæˆ–BEDæ ¼å¼çš„raw signalï¼ˆæœ€é«˜ç²¾ç¡®åˆ°æ¯ä¸ªç¢±åŸºä¸Šreadsçš„è¦†ç›–æƒ…å†µï¼‰æ–‡ä»¶ï¼Œé»˜è®¤æ¯æ¡æŸ“è‰²ä½“å»ºä¸€ä¸ªã€‚</p>
<p>-S åªå»ºç«‹ä¸€ä¸ªraw signalæ–‡ä»¶ã€‚</p>
<p>-space ä¸-wæ­é…ä½¿ç”¨ï¼Œç¡®å®šwigæ–‡ä»¶çš„åˆ†è¾¨ç‡ï¼Œé»˜è®¤10bpã€‚</p>
<hr>
<p>linkï¼š<a href="https://www.plob.org/article/7227.html">https://www.plob.org/article/7227.html</a></p>
]]></content>
      <categories>
        <category>Software</category>
        <category>ATAC-seq</category>
      </categories>
      <tags>
        <tag>software</tag>
      </tags>
  </entry>
  <entry>
    <title>ATAC-seq-3ã€hbctraining_pipelineã€‘</title>
    <url>/blog/2021/10/26/ATAC-seq-3-hbctraining/</url>
    <content><![CDATA[<h2 id="https-github-com-hbctraining-In-depth-NGS-Data-Analysis-Course-tree-master-sessionV-lessons"><a href="#https-github-com-hbctraining-In-depth-NGS-Data-Analysis-Course-tree-master-sessionV-lessons" class="headerlink" title="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons"></a><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons</a></h2><span id="more"></span>

<p>ç®—æ³•ï¼Œå‚æ•°ï¼Œè¾“å‡ºã€‚</p>
<h2 id="Peak-calling"><a href="#Peak-calling" class="headerlink" title="Peak calling"></a>Peak calling</h2><p><img src="https://img-blog.csdnimg.cn/f2741798d4f04f708412c97b2e6ef045.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ChIP-seqå®éªŒï¼Œä»æ¯”å¯¹æ–‡ä»¶ä¸­è§‚å¯Ÿåˆ°<code>æ­£/è´Ÿé“¾</code>ä¸Šä»¥<code>ç»“åˆä½ç‚¹ä¸ºä¸­å¿ƒ</code>çš„éå¯¹ç§°reads<br>å¯†åº¦ã€‚<br>For ChIP-seq experiments, what we observe from the alignment files is a strand asymmetry with read densities on the +/- strand, centered around the binding site. <code>The 5â€™ ends of the selected fragments</code> will form <code>groups</code> on the positive- and negative-strand. The <code>distributions</code> of these groups are then assessed using <code>statistical measures</code> and <code>compared against background</code> (input or mock IP samples) to determine if the site of enrichment is likely to be a real binding site.</p>
<p><img src="https://img-blog.csdnimg.cn/a5f4429afb3348be91f68d90d4011065.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åŠ ç²—æ ·å¼"><br><code>ChIP-seq analysis algorithms</code> are specialized in identifying one of <code>two types of enrichment</code> (or have specific methods for each): <code>broad peaks or broad domains</code> (i.e. <code>histone modifications that cover entire gene bodies</code>) or <code>narrow peaks</code> ( <code>transcription factor binding</code>). <code>Narrow peaks are easier to detect</code> as we are looking for regions that have higher amplitude and are easier to distinguish from the background, compared to broad or dispersed marks. There are also <code>â€˜mixedâ€™ binding profiles</code> which can be hard for algorithms to discern. An example of this is the binding properties of <code>PolII</code>, which binds at promotor and across the length of the gene resulting in mixed signals (<code>narrow and broad</code>).</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NOTEï¼šChIP-seqçš„åˆ†ææ–¹æ³•å¯ä»¥é‰´å®šä¸¤ç§ç±»å‹çš„å¯Œé›†æ¨¡å¼ï¼šbroad domainså’Œnarrow peaksã€‚broad domainsï¼Œå¦‚ç»„è›‹ç™½ä¿®é¥°åœ¨æ•´ä¸ªåŸºå› bodyåŒºåŸŸçš„åˆ†å¸ƒï¼›narrow peakï¼Œå¦‚è½¬å½•å› å­çš„ç»“åˆã€‚narrow peakç›¸å¯¹äºbroad æˆ–è€…åˆ†æ•£çš„marksæ›´æ˜“è¢«æ£€æµ‹åˆ°ã€‚ä¹Ÿæœ‰ä¸€äº›æ··åˆçš„ç»“åˆå›¾è°±ï¼Œå¦‚PolIIåŒ…æ‹¬narrowå’Œbroadä¿¡å·ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="MACS2"><a href="#MACS2" class="headerlink" title="MACS2"></a>MACS2</h2><p>MACS2æ˜¯æœ€å¸¸ç”¨çš„call peakså·¥å…·ã€‚ The MACS algorithm captures the influence of <code>genome complexity</code> to evaluate the significance of enriched ChIP regionsã€‚å…¨ç§°<code>Model-based Analysis of ChIP-Seq</code>ï¼Œæœ€åˆè®¾è®¡ç”¨æ¥<code>é‰´å®šè½¬å½•å› å­ç»“åˆä½ç‚¹</code>ï¼ˆalso suited for <code>larger</code> regionsï¼‰ï¼Œä¹Ÿå¯ç”¨äº<code>å…¶ä»–ç±»å‹</code>çš„å¯Œé›†æ–¹å¼æµ‹åºã€‚<br>MACSé€šè¿‡æ•´åˆ<code>åºåˆ—æ ‡ç­¾ä½ç½®ä¿¡æ¯</code>å’Œ<code>æ–¹å‘</code>ä¿¡æ¯æé«˜<code>ç»“åˆä½ç‚¹</code>çš„<code>ç©ºé—´åˆ†è¾¨ç‡</code>ï¼ˆ <code>improves</code> the <code>spatial resolution of binding sites</code> through <code>combining the information of both sequencing tag position and orientation</code>ï¼‰ã€‚å•ç‹¬ä½¿ç”¨æˆ–åŠ å¯¹ç…§ï¼ˆ <code>increases specificity</code> of the peak callsï¼‰ã€‚<br><img src="https://img-blog.csdnimg.cn/3929b0f60a01477ea09402760205f200.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_17,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="1-Remove-redundancy"><a href="#1-Remove-redundancy" class="headerlink" title="1. Remove redundancy"></a>1. Remove redundancy</h3><p><code>Why worry about duplicates?</code> <code>Reads with the same start position</code> are <code>considered duplicates</code>. These duplicates can arise from experimental artifacts, but can also contribute to genuine ChIP-signal. (ç›¸åŒèµ·ç‚¹çš„readsè¢«è®¤ä¸ºæ˜¯duplicatesï¼Œå¯èƒ½ç”±äºå®éªŒè¯¯å·®é€ æˆï¼Œ<code>ä¹Ÿå¯èƒ½æ˜¯ChIPä¿¡å·</code>)</p>
<ul>
<li><code>å duplicates</code>: If initial starting <code>material is low</code> this can lead to <code>overamplification</code> of this material before sequencing. Any <code>biases in PCR</code> will compound this problem and can lead to <code>artificially enriched regions</code>. Also <code>blacklisted (repeat) regions</code> with ultra high signal will also be high in duplicates. <code>Masking these regions</code> prior to analysis can help remove this problemã€‚ å®éªŒææ–™é‡å°‘ï¼Œè¿‡åº¦æ‰©å¢ï¼ŒPCRåå·®ï¼Œäººä¸ºå¯Œé›†åŒºåŸŸã€‚<code>blacklistï¼ˆé‡å¤ï¼‰åŒºåŸŸï¼Ÿæ€ä¹ˆè·å¾—</code>ï¼Œå±è”½è¯¥åŒºåŸŸã€‚</li>
<li><code>å¥½ duplicates</code>: You can expect some <code>biological duplicates with ChIP-seq</code> since you are only sequencing a small <code>part of the genome</code>. This number can increase if your depth of coverage is excessive or if your protein only binds to few sites. If there are a good proportion of biological dupicates, <code>removal</code> can lead to an <code>underestimation of the ChIP signal</code>. æœ‰ChIP-seqæ„ä¹‰çš„ç”Ÿç‰©å­¦æ„ä¹‰duplicates ï¼Œæµ‹åºåŸºå› ç»„å°éƒ¨åˆ†ã€‚è¦†ç›–æ·±åº¦è¿‡å¤šï¼Œè›‹ç™½è´¨ä¸å°‘æ•°ä½ç‚¹ç»“åˆï¼Œduplicatesä¼šå¢åŠ ã€‚å»é™¤æ­¤ç±»ä¼šå¯¼è‡´å¯¹ChIPä¿¡å·çš„ä½ä¼°ã€‚</li>
<li>Consider your <code>enrichment efficiency</code> and <code>sequencing depth</code>. Try to <code>discriminate</code> via genome browser of your non-deduplicated data. Bona fide peaks will have <code>multiple overlapping</code> reads with <code>offsets</code>, while samples with only PCR duplicates will stack up perfectly without offsets. A possible solution to distinguishing biological duplicate from PCR artifact would be to include UMIs into your experimental setup. è€ƒè™‘<code>å¯Œé›†æ•ˆç‡</code>å’Œ<code>æµ‹åºæ·±åº¦</code>ã€‚é€šè¿‡<code>åŸºå› ç»„æµè§ˆå™¨åŒºåˆ«</code>ã€‚<code>çœŸæ­£çš„å³°</code>ä¼šæœ‰å¤šä¸ª<code>é‡å readså’Œåç§»é‡</code>ï¼Œ<code>PCRé‡å¤æ²¡æœ‰åç§»é‡</code>ã€‚å¦‚ä½•åŒºåˆ†ï¼šå®éªŒè®¾è®¡è€ƒè™‘<a href="https://www.sohu.com/a/471483238_120055884">UMIs</a>ï¼ˆ<code>UMIå°†è¢«ç”¨äºåˆå¹¶PCRå¤åˆ¶ç‰©</code>ï¼‰ã€‚</li>
<li>Retain duplicates for differential binding analysis. ä¿ç•™duplicates ç”¨äºå·®å¼‚ç»“åˆåˆ†æ <code>why</code>ï¼Ÿretainå’ŒkeepåŒºåˆ«ï¼Ÿ</li>
<li>If you are expecting binding in repetitive regions, use paired-end sequencing and keep duplicates. ç ”ç©¶é‡å¤åŒºåŸŸï¼Œä½¿ç”¨pariedendæµ‹åºå¹¶<code>ä¿æŒé‡å¤ï¼Ÿ</code></li>
<li>call peakä¹‹å‰å°±remove dup<h3 id="2-0-Shift-size-d"><a href="#2-0-Shift-size-d" class="headerlink" title="2.0 Shift size d"></a>2.0 <code>Shift size d</code></h3></li>
<li>çœŸå®ç»“åˆä½ç‚¹å‘¨å›´çš„tag densityåº”æ˜¾ç¤º<code>åŒå³°å¯Œé›†</code>(<code>æˆå¯¹å³°</code>)ã€‚MACSåˆ©ç”¨è¿™ç§åŒå³°æ¨¡å¼ <code>empirically model the shifting size</code>ï¼Œç²¾ç¡®å®šä½ç»“åˆä½ç‚¹ã€‚</li>
<li>ä¸ºäº†æ‰¾åˆ°<code>æˆå¯¹å³°</code>æ¥<code>æ„å»ºæ¨¡å‹</code>ï¼ŒMACSé¦–å…ˆ<code>æ‰«ææ•´ä¸ªæ•°æ®é›†</code>ï¼Œå¯»æ‰¾<code>é«˜åº¦æ˜¾è‘—å¯Œé›†åŒºåŸŸ</code>ã€‚åªåˆ©ç”¨ChIPæ ·æœ¬ï¼Œç»™å®šè¶…å£°å¤§å°sonication size(<code>bandwidth</code>)å’Œhigh-confidence fold-enrichment(<code>mfold</code>)ï¼Œ MACS <code>slides two bandwidth windows</code> across the genome to find <code>regions with tags more than mfold enriched</code> relative to a <code>random tag genome distribution</code>.</li>
<li>MACS<code>éšæœºæŠ½å–1000ä¸ªé«˜è´¨é‡å³°</code>ï¼Œ<code>åˆ†ç¦»æ­£é“¾å’Œè´Ÿé“¾æ ‡ç­¾</code>ï¼Œaligns them by the midpoint between their centersã€‚The <code>distance between the modes of the two peaks in the alignment is defined as â€˜dâ€™</code> and represents the estimated fragment length. MACS shifts all the tags by d/2 toward the 3â€™ ends to the most likely protein-DNA interaction sites.<br><img src="https://img-blog.csdnimg.cn/eeefe600965542478444f761de31db17.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_10,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
</ul>
<h3 id="2-Select-1000-regions-with-a-10-to-30-fold-enrichment-relative-to-the-genome-background"><a href="#2-Select-1000-regions-with-a-10-to-30-fold-enrichment-relative-to-the-genome-background" class="headerlink" title="2. Select 1000 regions with a 10- to 30-fold enrichment relative to the genome background"></a>2. Select 1000 regions with a 10- to 30-fold enrichment relative to the genome background</h3><h3 id="3-Build-model-and-estimate-DNA-fragment-size-d"><a href="#3-Build-model-and-estimate-DNA-fragment-size-d" class="headerlink" title="3. Build model and estimate DNA fragment size d"></a>3. Build model and estimate DNA fragment size d</h3><h3 id="4-Shift-reads-toward-3â€™end-by-d"><a href="#4-Shift-reads-toward-3â€™end-by-d" class="headerlink" title="4. Shift reads toward 3â€™end by d"></a>4. Shift reads toward 3â€™end by d</h3><h3 id="5-Scale-two-libraries-if-have-control"><a href="#5-Scale-two-libraries-if-have-control" class="headerlink" title="5. Scale two libraries(if have control)"></a>5. Scale two libraries(if have control)</h3><p>For experiments in which <code>sequence depth differs</code> between input and treatment samples, MACS linearly scales the total control tag count to be the same as the total ChIP tag count. The default behaviour is for the <code>larger sample to be scaled down</code>. </p>
<h3 id="6-0-Effective-genome-length"><a href="#6-0-Effective-genome-length" class="headerlink" title="6.0 Effective genome length"></a>6.0 Effective genome length</h3><p>To calculate Î»BG from tag count, MAC2 requires the <code>effective genome size or the size of the genome that is mappable</code>. Mappability is related to the <code>uniqueness of the k-mers</code> at a particular position the genome. <code>Low-complexity</code> and <code>repetitive regions</code> have <code>low uniqueness</code>, which means <code>low mappability</code>. Therefore we need to provide the effective genome length to correct for the loss of true signals in low-mappable regions. æä¾›<code>æœ‰æ•ˆåŸºå› ç»„é•¿åº¦</code>ï¼Œä»¥<code>çº æ­£ä½å®šä½åŒºåŸŸçœŸå®ä¿¡å·ä¸¢å¤±</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/5571c4b228cb4706805ba0853c546c3c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><code>å¦‚ä½•è·å¾—ï¼Ÿ</code>The MACS2 software has some <code>pre-computed values</code> for <code>commonly used</code> organisms (human, mouse, worm and flyï¼Œ<code>riceï¼Ÿ</code>). more accurate values? The <code>deepTools</code> docs has additional pre-computed values for more recent builds but also has some good materials on <code>how to go about computing</code> it.</p>
<h3 id="6-Call-candidate-peaks-relative-to-genome-background"><a href="#6-Call-candidate-peaks-relative-to-genome-background" class="headerlink" title="6. Call candidate peaks relative to genome background"></a>6. Call candidate peaks relative to genome background</h3><p>After MACS <code>shifts every tag by d/2</code>, it then <code>slides across the genome</code> using a window size of <code>2d</code> to <code>find candidate peaks</code>.  The <code>tag distribution</code> along the genome can be modeled by a <code>Poisson distribution</code>.  The Poisson is a one parameter model, where the parameter <code>Î» is the expected number of reads in that window</code>.</p>
<h3 id="7-Calculate-dynamic-Î»-for-candidate-peaks"><a href="#7-Calculate-dynamic-Î»-for-candidate-peaks" class="headerlink" title="7. Calculate dynamic Î» for candidate peaks"></a>7. Calculate dynamic Î» for candidate peaks</h3><p><img src="https://img-blog.csdnimg.cn/eaac9c4b4c294be3b8b3b3caf7c35a21.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ³Šæ¾åˆ†å¸ƒçš„å‚æ•°Î»æ˜¯å•ä½æ—¶é—´(æˆ–å•ä½é¢ç§¯)å†…éšæœºäº‹ä»¶çš„å¹³å‡å‘ç”Ÿæ¬¡æ•°ã€‚ æ³Šæ¾åˆ†å¸ƒçš„æœŸæœ›å’Œæ–¹å·®å‡ä¸ºÎ».<br>Instead of using a uniform Î» estimated from the whole genome, MACS uses a <code>dynamic parameter, Î»local</code>, defined for <code>each candidate peak</code>. The lambda parameter is estimated from the control sample and is deduced by taking the maximum value across <code>various window sizes</code>:</p>
<blockquote>
<p>Î»local = max(Î»BG, Î»1k, Î»5k, Î»10k).</p>
</blockquote>
<p>In this way lambda <code>captures the influence of local biases</code>, and is robust against occasional low tag counts at small local regions. Possible sources for these biases include local chromatin structure, DNA amplification and sequencing bias, and genome copy number variation. é€šè¿‡ä½¿ç”¨åŠ¨æ€lambdaæ•è·å±€éƒ¨åå·®çš„å½±å“ï¼Œå¹¶ä¸”å¯¹å°å±€éƒ¨åŒºåŸŸä¸­<code>å¶å°”å‡ºç°çš„low tag counts</code>è¡¨ç°è¾ƒå¥½ã€‚<code>åå·®å¯èƒ½æ¥æº</code>åŒ…æ‹¬å±€éƒ¨æŸ“è‰²è´¨ç»“æ„ã€DNAæ‰©å¢å’Œæµ‹åºåå·®ä»¥åŠåŸºå› ç»„æ‹·è´æ•°å˜åŒ–ã€‚<br><img src="https://img-blog.csdnimg.cn/3c7c645b299e45b2b7975d6327d421bc.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>A region is considered to have a <code>significant tag enrichment</code> if the <code>p-value &lt; 10e-5</code> (å¯è®¾ç½®). This is a Poisson distribution p-value based on Î».</p>
<p>Overlapping enriched peaks are merged, and each tag position is <code>extended â€˜dâ€™ basesï¼Ÿ</code> from its center. The location in the <code>peak with the highest fragment pileupå †ç§¯</code>, hereafter referred to as the summitå³°é¡¶, is <code>predicted as the precise binding location</code>. The <code>ratio between the ChIP-seq tag count and Î»localï¼Ÿ</code> is reported as the fold enrichment.</p>
<h3 id="8-Calculate-P-value-and-filter-candidate-peaks"><a href="#8-Calculate-P-value-and-filter-candidate-peaks" class="headerlink" title="8. Calculate P value and filter candidate peaks"></a>8. Calculate P value and filter candidate peaks</h3><h3 id="9-Calculate-FDR-by-exchanging-treatment-and-control"><a href="#9-Calculate-FDR-by-exchanging-treatment-and-control" class="headerlink" title="9. Calculate FDR by exchanging treatment and control"></a>9. Calculate FDR by exchanging treatment and control</h3><p>Each peak is considered an independent test and thus, when we encounter thousands of significant peaks detected in a sample we have a multiple testing problem. In <code>MACSv1.4</code>, the FDR was determined <code>empirically by exchanging the ChIP and control samples</code>. However, in <code>MACS2</code>, p-values are now corrected for multiple comparison using the <code>Benjamini-Hochberg correction</code>.</p>
<h2 id="MACS2-å‚æ•°"><a href="#MACS2-å‚æ•°" class="headerlink" title="MACS2 å‚æ•°"></a>MACS2 å‚æ•°</h2><h3 id="1-Input-file-options"><a href="#1-Input-file-options" class="headerlink" title="1. Input file options"></a>1. Input file options</h3><ul>
<li><code>-t</code> : The IP data file (this is the only REQUIRED parameter for MACS) å®éªŒç»„</li>
<li><code>-c</code> : Control or mock data å¯¹ç…§</li>
<li><code>-f</code> : è¾“å…¥æ–‡ä»¶æ ¼å¼ï¼Œé»˜è®¤å€¼â€œAUTOâ€ ï¼Œbam sam bed</li>
<li><code>-g</code> :  <code>mappable genome size</code> which is defined as the genome size which can be sequenced; some precompiled values provided.</li>
<li>hs: 2.7e9äººç±»åŸºå› ç»„æœ‰æ•ˆå¤§å°(UCSC human hg18 assembly)<h3 id="2-Output-arguments"><a href="#2-Output-arguments" class="headerlink" title="2. Output arguments"></a>2. Output arguments</h3></li>
<li><code>-outdir</code> : è¾“å‡ºæ–‡ä»¶å¤¹</li>
<li><code>-n</code> : æ–‡ä»¶å‰ç¼€</li>
<li><code>-B/--bdg</code> : store the fragment pileup, control lambda, -log10pvalue and -log10qvalue scores in bedGraph files è¾“å‡ºbedgraphæ ¼å¼çš„æ–‡ä»¶<h3 id="3-Shifting-model-arguments"><a href="#3-Shifting-model-arguments" class="headerlink" title="3. Shifting model arguments"></a>3. Shifting model arguments</h3></li>
<li><code>-s</code> : <code>size of sequencing tags</code>. Default, MACS will use the <code>first 10 sequences</code> from your input treatment file to determine it</li>
<li><code>--bw</code> : The bandwidth which is used to <code>scan the genome</code> ONLY for model building. Can be set to the expected sonication fragment size.</li>
<li><code>--mfold</code> : <code>upper and lower limit</code> for model building</li>
<li><code>--nomodel</code>ï¼š<code>å’Œextsizeã€shiftæ˜¯é…å¥—ä½¿ç”¨</code>ï¼Œæœ‰è¿™ä¸ªå‚æ•°æ‰å¯è®¾ç½®extsizeå’Œshiftã€‚</li>
<li><code>--extsize</code>ï¼šå½“è®¾ç½®äº†nomodelæ—¶ï¼ŒMACSä¼šç”¨â€“extsizeè¿™ä¸ªå‚æ•°ä»<code>5&#39;-&gt;3&#39;æ–¹å‘æ‰©å±•readsä¿®å¤fragments</code>ã€‚å¦‚è½¬å½•å› å­ç»“åˆèŒƒå›´200bpï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°æ˜¯200ã€‚</li>
<li><code>--shift</code>ï¼šå½“è®¾ç½®äº†â€“nomodelï¼ŒMACSç”¨è¿™ä¸ªå‚æ•°ä»<code>5&#39; ç«¯ç§»åŠ¨å‰ªåˆ‡</code>ï¼Œç„¶åç”¨â€“extsizeå»¶ä¼¸ï¼Œå¦‚æœâ€“shiftæ˜¯è´Ÿå€¼è¡¨ç¤ºä»3â€™ç«¯æ–¹å‘ç§»åŠ¨ã€‚å»ºè®®ChIP-seqæ•°æ®é›†è¿™ä¸ªå€¼ä¿æŒé»˜è®¤å€¼ä¸º0ï¼Ÿï¼Œå¯¹äºæ£€æµ‹å¯Œé›†å‰ªåˆ‡ä½ç‚¹å¦‚DNAseqæ•°æ®é›†è®¾ç½®ä¸ºEXTSIZEçš„ä¸€åŠã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æƒ³æ‰¾å¯Œé›†å‰ªåˆ‡ä½ç‚¹ï¼Œå¦‚DNAse-seqï¼Œæ‰€æœ‰5&#x27;ç«¯çš„åºåˆ—readsåº”è¯¥ä»ä¸¤ä¸ªæ–¹å‘å»¶ä¼¸ï¼Œå¦‚æœæƒ³è®¾ç½®ç§»åŠ¨çš„çª—å£æ˜¯200bpï¼Œå‚æ•°è®¾ç½®å¦‚ä¸‹ï¼š</span><br><span class="line">--nomodel --shift -100 --extsize 200</span><br><span class="line">å¯¹nucleosome-seqæ•°æ®ï¼Œç”¨æ ¸å°ä½“å¤§å°çš„ä¸€åŠè¿›è¡Œextsize,æ‰€ä»¥å‚æ•°è®¾ç½®å¦‚ä¸‹ï¼š</span><br><span class="line">--nomodel --shift 37 --extsize 73</span><br></pre></td></tr></table></figure>

<p><code>ATAC-seq</code>å…³å¿ƒçš„æ˜¯åœ¨å“ªåˆ‡æ–­ï¼Œæ–­ç‚¹æ‰æ˜¯peakçš„ä¸­å¿ƒï¼Œæ‰€ä»¥ä½¿ç”¨shiftæ¨¡å‹ï¼Œâ€“shift -75æˆ–-100<br>å¯¹äººç»†èƒç³»ATAC-seq æ•°æ®call peakçš„å‚æ•°è®¾ç½®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">macs2 callpeak -t H1hesc.final.bam -n sample --shift -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2&gt; sample.macs2.log</span><br></pre></td></tr></table></figure>

<h3 id="4-Peak-calling-arguments"><a href="#4-Peak-calling-arguments" class="headerlink" title="4. Peak calling arguments"></a>4. Peak calling arguments</h3><ul>
<li><code>-q</code> : q-value (minimum FDR) cutoff <code>q valueé»˜è®¤å€¼æ˜¯0.05ï¼Œä¸pvalueä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚</code></li>
<li><code>-p</code> : p-value cutoff (instead of q-value cutoff)</li>
<li><code>--nolambda</code> : do not consider the local bias/lambda at peak candidate regionsã€‚ä¸è¦è€ƒè™‘åœ¨å³°å€¼å€™é€‰åŒºåŸŸçš„å±€éƒ¨åå·®/Î»</li>
<li><code>--broad</code> : broad peak callingï¼Œnarrow peakå’Œbroad peak</li>
</ul>
<p> Relaxing the <code>q-value</code> does not behave as expected in this case since it is partially tied to peak widths. Ideally, if you <code>relaxed the thresholds</code>, you would simply get <code>more peaks</code> but with MACS2 relaxing thresholds also results in <code>wider peaks</code>. qå€¼ä¸å³°å®½æœ‰ä¸€å®šçš„è”ç³»ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¦‚æœæ”¾å®½é˜ˆå€¼ï¼Œæ‚¨å°†ç®€å•åœ°è·å¾—æ›´å¤šçš„å³°å€¼ï¼Œä½†æ˜¯ä½¿ç”¨MACS2æ”¾æ¾é˜ˆå€¼ä¹Ÿä¼šå¯¼è‡´æ›´å®½çš„å³°å€¼ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">macs2 callpeak -t bowtie2/H1hesc_Nanog_Rep1_aln.bam \</span><br><span class="line">	-c bowtie2/H1hesc_Input_Rep1_aln.bam \</span><br><span class="line"> 	-f BAM -g 1.3e+8 \</span><br><span class="line">	-n Nanog-rep1 \</span><br><span class="line">	--outdir macs2 2&gt; macs2/Nanog-rep1-macs2.log</span><br></pre></td></tr></table></figure>


<h2 id="MACS2-Output-files"><a href="#MACS2-Output-files" class="headerlink" title="MACS2 Output files"></a>MACS2 Output files</h2><h3 id="narrowPeak"><a href="#narrowPeak" class="headerlink" title="narrowPeak"></a>narrowPeak</h3><p>A narrowPeak (<code>.narrowPeak</code>) file is used by the ENCODE project to provide <code>called peaks of signal enrichment</code> based on pooled, normalized (interpreted) data. It is a <code>BED 6+4 format</code>, which means the <code>first 6 columns of a standard BED file</code> with <code>4 additional</code> fields:<br><img src="https://img-blog.csdnimg.cn/7bd1ca4fcb3847daacc450a91989b5cd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="WIG-format"><a href="#WIG-format" class="headerlink" title="WIG format"></a>WIG format</h3><p>Wiggle format (WIG) allows the <code>display</code> of continuous-valued data in a track format. Wiggle format is <code>line-oriented</code>. It is composed of declaration lines and data lines, and require a separate wiggle track definition line. There are two options for formatting wiggle data: variableStep and fixedStep. These formats were developed to allow the file to be written as compactly as possible.</p>
<h3 id="BedGraph-format"><a href="#BedGraph-format" class="headerlink" title="BedGraph format"></a>BedGraph format</h3><p>The BedGraph format also allows display of continuous-valued data in track format. This display type is useful for probability scores and transcriptome data. This track type is similar to the wiggle (WIG) format, but unlike the wiggle format, data exported in the bedGraph format are preserved in their original state. For the purposes of visualization, these can be interchangeable.</p>
<ul>
<li><p><code>_peaks.narrowPeak</code>: BED6+4 format file which contains the peak locations together with peak summit, pvalue and qvalueã€‚<code>BED6+4æ ¼å¼ï¼Œå¯ä»¥ä¸Šä¼ åˆ°UCSCæµè§ˆã€‚</code></p>
<ul>
<li>1ï¼šæŸ“è‰²ä½“å·</li>
<li>2ï¼špeakèµ·å§‹ä½ç‚¹</li>
<li>3ï¼šç»“æŸä½ç‚¹</li>
<li>4ï¼špeak name</li>
<li>5ï¼šint(-10*log10qvalue)</li>
<li>6 ï¼šæ­£è´Ÿé“¾</li>
<li>7ï¼šfold change</li>
<li>8ï¼š-log10pvalue</li>
<li>9ï¼š-log10qvalue</li>
<li>10ï¼šrelative summit position to peak startï¼ˆï¼Ÿï¼‰</li>
</ul>
</li>
<li><p><code>_peaks.xls</code>: a tabular file which contains information about called peaks. Additional information includes pileup and fold enrichmentã€‚<code>å«peakä¿¡æ¯çš„tabåˆ†å‰²çš„æ–‡ä»¶ï¼Œå‰å‡ è¡Œæ˜¾ç¤ºcallpeakå‘½ä»¤</code>ã€‚</p>
<ul>
<li>æŸ“è‰²ä½“å·</li>
<li>peakèµ·å§‹ä½ç‚¹</li>
<li>peakç»“æŸä½ç‚¹</li>
<li>peakåŒºåŸŸé•¿åº¦</li>
<li>peakçš„å³°å€¼ä½ç‚¹ï¼ˆsummit positionï¼‰</li>
<li>peak å³°å€¼çš„é«˜åº¦ï¼ˆpileup height at peak summit, -log10(pvalue) for the peak summitï¼‰</li>
<li>peakçš„å¯Œé›†å€æ•°ï¼ˆç›¸å¯¹äºrandom Poisson distribution with local lambdaï¼‰</li>
<li>XLSé‡Œçš„åæ ‡å’Œbedæ ¼å¼çš„åæ ‡è¿˜ä¸ä¸€æ ·ï¼Œèµ·å§‹åæ ‡éœ€è¦å‡1æ‰ä¸narrowPeakçš„èµ·å§‹åæ ‡ä¸€æ ·ã€‚</li>
</ul>
</li>
<li><p><code>_summits.bed</code>: peak summits locations for every peak. To find the motifs at the binding sites, this file is recommendedã€‚BEDæ ¼å¼çš„æ–‡ä»¶ï¼ŒåŒ…å«peakçš„summitsä½ç½®ï¼Œç¬¬5åˆ—æ˜¯-log10pvalueã€‚å¦‚æœæƒ³æ‰¾motifï¼Œæ¨èä½¿ç”¨æ­¤æ–‡ä»¶ã€‚</p>
</li>
<li><p><code>_model.R</code>: an R script which you can use to produce a PDF image about the model based on your data and cross-correlation plot</p>
</li>
<li><p><code>_control_lambda.bdg</code>: bedGraph format for input sample</p>
</li>
<li><p><code>_treat_pileup.bdg</code>: bedGraph format for treatment sampleã€‚bedGraphæ ¼å¼ï¼Œå¯ä»¥å¯¼å…¥UCSCæˆ–è€…è½¬æ¢ä¸ºbigwigæ ¼å¼ã€‚ä¸¤ç§bfgæ–‡ä»¶ï¼štreat_pileup, and control_lambda.</p>
</li>
<li><p><code>NAME_peaks.broadPeak</code>ï¼š BED6+3æ ¼å¼ä¸narrowPeakç±»ä¼¼ï¼Œåªæ˜¯æ²¡æœ‰ç¬¬10åˆ—ã€‚</p>
</li>
</ul>
<p>Rä½œå›¾the first plot illustrates the distance between the modes from which the shift size was determinedï¼Ÿ<br><img src="https://img-blog.csdnimg.cn/3d941b11b37c4b7687b11e6766a9daff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_13,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>The second plot is the cross-correlation plot. This is a graphical representation of the Pearson correlation of positive- and negative- strand tag densities, shifting the strands relative to each other by increasing distanceï¼Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xlsæ–‡ä»¶</span><br><span class="line">æ–‡ä»¶åŒ…å«ä¿¡æ¯è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œå’ŒnarrowPeakå”¯ä¸€ä¸åŒçš„æ˜¯peakçš„èµ·å§‹ä½ç½®éœ€è¦å‡1æ‰æ˜¯bedæ ¼å¼çš„æ–‡ä»¶ï¼Œå¦å¤–è¿˜åŒ…å«fold_enrichment å’ŒnarrowPeakçš„fold change å¯¹åº”ï¼Œ-log10pvalue,-log10qvalue,peaké•¿åº¦ï¼Œpeak å³°å€¼ä½ç½®ç­‰ã€‚</span><br><span class="line">narrowPeakæ–‡ä»¶</span><br><span class="line">å’Œxlsæ–‡ä»¶ä¿¡æ¯ç±»ä¼¼</span><br><span class="line">summits.bedæ–‡ä»¶</span><br><span class="line">åŒ…å«å³°çš„ä½ç½®ä¿¡æ¯å’Œ-log10pvalue</span><br><span class="line">bdgæ–‡ä»¶</span><br><span class="line">bdgæ–‡ä»¶é€‚åˆå¯¼å…¥UCSCæˆ–IGVè¿›è¡Œè°±å›¾å¯è§†åŒ–ï¼Œæˆ–è€…è½¬æ¢ä¸ºbigwigæ ¼å¼å†è¿›è¡Œå¯è§†åŒ–ã€‚</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>ATAC-seq</category>
      </categories>
      <tags>
        <tag>ATAC-seq</tag>
      </tags>
  </entry>
  <entry>
    <title>å•å€å‹åŸºå› ç»„ç»„è£…ç®—æ³•hifiasm</title>
    <url>/blog/2021/10/20/hifiasm/</url>
    <content><![CDATA[<h2 id="Nat-Methods-ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰"><a href="#Nat-Methods-ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰" class="headerlink" title="Nat. Methods|ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰"></a>Nat. Methods|ç­‰ä½åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼ˆ20210202ï¼‰</h2><p>paperï¼š    <a href="https://pubmed.ncbi.nlm.nih.gov/33526886/">Haplotype-resolved de novo assembly using phased assembly graphs with hifiasm</a><br>è¯¥ç ”ç©¶æå‡ºä¸€ç§å…¨æ–°çš„å•å€å‹åŸºå› ç»„ç»„è£…ç®—æ³•hifiasmï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¯¹<font color="red">å¤§å‹å¤æ‚åŸºå› ç»„ç”Ÿæˆé«˜è´¨é‡çš„å•å€å‹ç»„è£…ç»“æœ</font>ã€‚</p>
<span id="more"></span>

<h3 id="å•å€å‹ç»„è£…éš¾ç‚¹"><a href="#å•å€å‹ç»„è£…éš¾ç‚¹" class="headerlink" title="å•å€å‹ç»„è£…éš¾ç‚¹"></a>å•å€å‹ç»„è£…éš¾ç‚¹</h3><p>å•å€å‹åŸºå› ç»„ç»„è£…æ˜¯ç ”ç©¶åŸºå› ç»„ç»“æ„ä¸å˜å¼‚çš„æœ€ç†æƒ³æ–¹å¼ã€‚ç”±äºæŠ€æœ¯çš„å±€é™ï¼Œå¤§å¤šæ•°ç»„è£…ç®—æ³•å€¾å‘äºå°†ä¸åŒå•å€å‹æœ‰æŸçš„å‹ç¼©æˆä¸€æ¡æ··åˆçš„ä»£è¡¨æ€§åºåˆ—ã€‚å¯¹äºè‡ªç„¶ç•Œä¸­ä¸»æµçš„äºŒå€ä½“å’Œå¤šå€ä½“æ ·æœ¬è€Œè¨€ï¼Œè¿™ç±»æ–¹æ³•æŸå¤±äº†å¤§é‡çš„å•å€å‹ä¿¡æ¯ã€‚è¿™ä½¿å¾—é•¿ä¹…ä»¥æ¥ï¼Œç ”ç©¶äººå‘˜éš¾ä»¥å¯¹é«˜æ‚åˆã€é«˜é‡å¤çš„åŸºå› ç»„è¿›è¡Œæ·±å…¥çš„åˆ†æã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªéš¾é¢˜ï¼Œä¸€äº›ç»„è£…ç®—æ³•é¦–å…ˆç”Ÿæˆæ··åˆçš„ä»£è¡¨æ€§åºåˆ—ï¼Œæ¥ç€ä»ä»£è¡¨æ€§åºåˆ—ä¸­æ¢å¤å‡ºä¸åŒçš„å•å€å‹ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œç”±äºä»£è¡¨æ€§åºåˆ—æœ¬èº«å·²ç»ä¸¢å¤±äº†å¤§é‡çš„ä¿¡æ¯ï¼Œè¿™ç±»æ–¹æ³•éš¾ä»¥è·å¾—é«˜è´¨é‡çš„å•å€å‹ç»„è£…ç»“æœã€‚</p>
<p>è¿‘æœŸçš„ç»„è£…ç®—æ³•é€šè¿‡é¢å¤–çš„ä¿¡æ¯ï¼Œå¦‚å®¶ç³»(Trio binning)æˆ–è€…Hi-Cç­‰æ•°æ®ï¼Œé¢„å…ˆå…¨å±€æ€§çš„å°†å¾…ç»„è£…çš„æµ‹åºè¯»æ®µåˆ’åˆ†åˆ°ä¸åŒå•å€å‹ï¼Œå†è¿›è¡Œåˆ†åˆ«ç»„è£…ï¼Œä»è€Œè¯•å›¾è·å¾—é«˜è´¨é‡çš„å•å€å‹ç»„è£…ç»“æœã€‚ä½†æ˜¯å¯¹äºä½æ‚åˆçš„æ ·æœ¬è€Œè¨€ï¼Œè¿™ç§æ–¹æ³•éš¾ä»¥åšåˆ°å®Œç¾çš„é¢„å…ˆåˆ’åˆ†ï¼Œå› æ­¤å®¹æ˜“äº§ç”Ÿç»„è£…é”™è¯¯ã€‚</p>
<h3 id="Hifiasm-ç®—æ³•"><a href="#Hifiasm-ç®—æ³•" class="headerlink" title="Hifiasm ç®—æ³•"></a>Hifiasm ç®—æ³•</h3><p>åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œç ”ç©¶äººå‘˜æå‡ºäº†ä¸€ç§å…¨æ–°çš„é’ˆå¯¹PacBio HiFi (High-Fidelity reads) æ•°æ®çš„å•å€å‹ç»„è£…ç®—æ³•hifiasmã€‚è¯¥ç®—æ³•æœ‰ä¸¤é¡¹é‡è¦åˆ›æ–°ã€‚</p>
<p>ç¬¬ä¸€ï¼Œæå‡ºäº†å•å€å‹æ•æ„Ÿçš„ç»„è£…æ€è·¯ï¼Œä½¿å¾—åœ¨ç»„è£…çš„å…¨è¿‡ç¨‹ä¸­èƒ½å¤Ÿæ— æŸçš„ä¿ç•™å•å€å‹ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿæå¤§çš„æå‡äº†å¯¹åŸºå› ç»„é«˜é‡å¤å’Œå¤æ‚åŒºåŸŸçš„è§£æèƒ½åŠ›ã€‚</p>
<p>ç¬¬äºŒï¼Œæå‡ºäº†Graph-binningçš„åˆ†å‹ç­–ç•¥ï¼Œå…¶åˆ©ç”¨ç»„è£…å›¾çš„ç»“æ„ä¿¡æ¯å¯¹å…¨å±€åˆ†å‹ç»“æœè¿›è¡Œæ ¡æ­£ï¼Œä»è€Œæå¤§åœ°æé«˜äº†å•å€å‹ç»„è£…çš„è´¨é‡ã€‚Graph-binningä¸å¯¹å¾…ç»„è£…çš„æµ‹åºè¯»æ®µè¿›è¡Œé¢„å…ˆå…¨å±€åˆ’åˆ†ï¼Œå› æ­¤èƒ½å¤Ÿå…‹æœåˆ’åˆ†é”™è¯¯å¸¦æ¥ç»„è£…é—®é¢˜ã€‚</p>
<h3 id="ç»„è£…ç»“æœ"><a href="#ç»„è£…ç»“æœ" class="headerlink" title="ç»„è£…ç»“æœ"></a>ç»„è£…ç»“æœ</h3><p>ç ”ç©¶äººå‘˜åœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šæµ‹è¯•äº†hifiasmç®—æ³•ã€‚å¯¹äºä¸åŒå¤§å°ï¼Œä¸åŒæ‚åˆåº¦å’Œä¸åŒå•å€å‹æ•°é‡çš„åŠ¨ç‰©å’Œæ¤ç‰©åŸºå› ç»„ï¼Œhifiasmèƒ½å¤Ÿäº§ç”Ÿè´¨é‡æœ€é«˜çš„ç»„è£…ç»“æœã€‚å°¤å…¶å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œhifiasmä»…ç”¨ä¸‰å¤©æ—¶é—´ï¼Œå°±å®Œæˆ27Gbè¶…å¤§åŠ å·çº¢æ‰åŸºå› ç»„çš„ç»„è£…ï¼Œå¹¶ä¸”ç»„è£…ç»“æœçš„è¿ç»­æ€§7å€äºå…¶ä»–ç®—æ³•ã€‚</p>
<p>å¯¹äºäººç±»åŸºå› ç»„ï¼Œhifiasmä¹Ÿèƒ½å–å¾—æœ€å¥½çš„æ•ˆæœã€‚ç›¸æ¯”äºç°æœ‰ç®—æ³•ï¼Œhifiasmæ‰€äº§ç”Ÿçš„ç»„è£…ç»“æœè¿ç»­æ€§æœ€é«˜ï¼ŒåŒæ—¶ä¹Ÿæ­£ç¡®è§£æäº†æœ€å¤šçš„å¤æ‚å’Œé«˜é‡å¤åŒºåŸŸï¼Œå¦‚MHC (ä¸»è¦ç»„ç»‡ç›¸å®¹æ€§å¤åˆä½“)å’Œcentromere (ç€ä¸ç«¯ç²’)ã€‚å°¤å…¶å¯¹äºäººç±»äºŒå€ä½“æ ·æœ¬HG002å’ŒHG00733ï¼Œhifiasmäº§ç”Ÿçš„ç»„è£…ç»“æœçš„è¿ç»­æ€§3å€äºå…¶ä»–ç®—æ³•ï¼Œå¹¶æˆåŠŸä¿ç•™äº†æœ€å¤šçš„å˜å¼‚ä¿¡æ¯ã€‚</p>
<p><a href="http://www.evolution.ynu.edu.cn/info/1016/1208.htm">http://www.evolution.ynu.edu.cn/info/1016/1208.htm</a></p>
]]></content>
      <categories>
        <category>Papers</category>
      </categories>
      <tags>
        <tag>Assemble</tag>
      </tags>
  </entry>
  <entry>
    <title>ATAC-seq-2ã€Harvard FAS Informaticsã€‘</title>
    <url>/blog/2021/10/14/ATAC-seq-2-harvard/</url>
    <content><![CDATA[<h2 id="ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„"><a href="#ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„" class="headerlink" title="ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„"></a>ATAC-seqæ•°æ®è´¨é‡è¯„ä¼°æ³¨æ„</h2><span id="more"></span>

<p><code>ENCODE</code>çš„ATACseq<a href="https://www.encodeproject.org/atac-seq/">æ•°æ®æ ‡å‡†</a>ã€‚</p>
<h3 id="Uniform-Processing-Pipeline-Restrictions"><a href="#Uniform-Processing-Pipeline-Restrictions" class="headerlink" title="Uniform Processing Pipeline Restrictions"></a>Uniform Processing Pipeline Restrictions</h3><ul>
<li>The <code>read length</code> prior to any trimming should be a minimum of <code>45 base pairs</code>.</li>
<li>Sequencing may be <code>paired</code>- or <code>single</code>-ended, <code>sequencing type</code> is specified and <code>paired sequences</code> are indicated.</li>
<li>All <code>Illumina platforms</code> are supported for use in the uniform pipeline, though <code>data from different platforms should be processed separately</code>; colorspace (<code>SOLiD</code>) reads are <code>not</code> supported. </li>
<li><code>Barcodes</code>, if present in the fastq, must be <code>indicated</code>.</li>
<li><code>Library insert size</code> range must be <code>indicated</code>. <h3 id="Current-Standards"><a href="#Current-Standards" class="headerlink" title="Current Standards"></a>Current Standards</h3></li>
</ul>
<ol>
<li>å¿…é¡»æœ‰ä¸¤æ¬¡æˆ–æ›´å¤šæ¬¡<code>ç”Ÿç‰©å­¦é‡å¤</code>ï¼ˆç¨€æœ‰æ ·æœ¬ä¹Ÿå¿…é¡»åšä¸¤æ¬¡<code>æŠ€æœ¯é‡å¤</code>ï¼‰</li>
<li>æ¯æ¬¡é‡å¤è¦æœ‰25millionéå†—ä½™ï¼Œéçº¿ç²’ä½“ï¼Œèƒ½å¤Ÿå›å¸–çš„fragmentï¼ˆå•ç«¯25 million readsï¼Œ<code>åŒç«¯50 million reads</code>=25 million fragmentï¼‰</li>
<li>å›å¸–ç‡&gt;95%, &gt;80%å¯æ¥å—ã€‚</li>
<li>ç”¨<code>IDR(Irreproducible Discovery Rate)</code>è®¡ç®—é‡å¤ä¸€è‡´æ€§ï¼Œrescueå’Œself consisty ratios éƒ½&gt;2</li>
<li>ç”¨ä»¥ä¸‹æŒ‡æ ‡æ§åˆ¶PCRæ‰©å¢å¯¹æ–‡åº“å¤æ‚æ€§çš„å½±å“ï¼š <code>Non-Redundant Fraction (NRF)</code> and PCR Bottlenecking Coefficients 1 and 2, or PBC1 and PBC2ï¼šNRF&gt;0.9, PBC1&gt;0.9, PBC2&gt;3</li>
<li>peakæ–‡ä»¶å¿…é¡»æ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼š<blockquote>
<p>æ¯ä¸ªé‡å¤peakæ•°&gt;150000ï¼Œ&gt;100000å¯æ¥å—ï¼ˆENCODEçš„ATAC-seqçš„peak fileæ²¡æ³•ç”¨ï¼‰<br>IDR peak&gt;70000,&gt;50000å¯æ¥å—<br>è¦å­˜åœ¨æ— æ ¸å°ä½“åŒºNFR<br>å­˜åœ¨å•æ ¸å°ä½“å³°ï¼Œå¥½çš„ATACseqæ•°æ®åº”åŒ…å«æ ¸å°ä½“ï¼Œæ—¢èƒ½çœ‹å¼€æ”¾æŸ“è‰²è´¨ï¼Œåˆèƒ½çœ‹æ ¸å°ä½“</p>
</blockquote>
</li>
<li>The fraction of reads in called peak regions(FRip score)&gt;0.3,&gt;0.2 å¯ä»¥æ¥å—ã€‚å¯¹äºç¨€æœ‰æ ·æœ¬ä¸è¦æ±‚FRiPä½†TSSå¯Œé›†è¿˜æ˜¯è¦ä½œä¸ºå…³é”®çš„è¡¡é‡ä¿¡å™ªæ¯”çš„æŒ‡æ ‡ã€‚</li>
<li>TSSå¯Œé›†åˆ†æ•°é˜ˆå€¼ä¸å‚è€ƒåŸºå› ç»„ç›¸å…³ã€‚</li>
</ol>
<h2 id="ATACseq-ä¸»å¹²åˆ†ææµç¨‹"><a href="#ATACseq-ä¸»å¹²åˆ†ææµç¨‹" class="headerlink" title="ATACseq ä¸»å¹²åˆ†ææµç¨‹"></a>ATACseq ä¸»å¹²åˆ†ææµç¨‹</h2><p>referenceï¼š<br><strong>1.æ–‡ç« </strong>ï¼š<a href="https://peerj.com/articles/4040/">https://peerj.com/articles/4040/</a><br><strong>2.CHIPseqè¯¾ç¨‹</strong>ï¼š<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons</a><br><strong>3.Harvard FAS Informatics - ATAC-seq Guidelines</strong>ï¼š<a href="https://informatics.fas.harvard.edu/atac-seq-guidelines.html">https://informatics.fas.harvard.edu/atac-seq-guidelines.html</a></p>
<h2 id="Harvard-FAS-Informatics-ATAC-seq-Guidelines"><a href="#Harvard-FAS-Informatics-ATAC-seq-Guidelines" class="headerlink" title="Harvard FAS Informatics - ATAC-seq Guidelines"></a><a href="https://informatics.fas.harvard.edu/atac-seq-guidelines.html">Harvard FAS Informatics - ATAC-seq Guidelines</a></h2><h3 id="Experimental-design"><a href="#Experimental-design" class="headerlink" title="Experimental design"></a>Experimental design</h3><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4374986/">Detailed protocol</a></p>
<ul>
<li>Replicates</li>
<li>Controlsï¼šä¸€èˆ¬<code>ä¸è®¾ç½®å¯¹ç…§</code>ã€‚ä½œç”¨æœ‰é™ï¼Œè´¹ç”¨ã€‚æ²¡æœ‰è½¬åº§é…¶å¤„ç†çš„æ ·æœ¬æµ‹åº</li>
<li>PCR amplificationï¼š<code>å°½å¯èƒ½å°‘</code>åœ°ä½¿ç”¨<code>PCRå¾ªç¯</code>æ¥æ‰©å¢æ ·æœ¬ï¼Œå‡å°‘å¹²æ‰°</li>
<li>Sequencing depthï¼šæœ€ä½³æµ‹åºæ·±åº¦å–å†³äº<code>å‚è€ƒåŸºå› ç»„çš„å¤§å°</code>å’Œ<code>é¢„æœŸæŸ“è‰²è´¨çš„å¼€æ”¾ç¨‹åº¦</code>ã€‚äººç±»æ ·æœ¬çš„ç ”ç©¶æ¨èæ¯ä¸ªæ ·æœ¬è¶…è¿‡5000ä¸‡ä¸ªreadsã€‚</li>
<li>Sequencing modeï¼š(1) ATACseqæ¨èä½¿ç”¨paired-endã€‚paired-end sequencing, helps to <code>reduce these alignment ambiguities</code>. (2) we are interested in <code>knowing both ends of the DNA fragments generated by the assay</code>, since the ends indicate where the transposase inserted. (3) <strong><code>PCR duplicates are identified more accurately</code></strong>.  PCR duplicates are <code>artifacts of the procedure</code>, and they should be removed as part of the analysis pipeline . <code>Computational programs that remove PCR duplicates typically identify duplicates based on comparing ends of aligned reads</code>. With <strong><code>single-end reads</code></strong>, there is <code>only one position to compare</code>, and so any <code>reads whose 5&#39; ends match are considered duplicates</code>. Thus, <code>many false positives</code> may result, and perfectly <code>good reads are removed</code> from further analysis. <strong><code>Paired-end sequencing</code></strong>, <code>both ends of the original DNA fragments are defined</code>. <code>To be declared a duplicate, both ends of one fragment need to match both ends of another fragment</code>, which is far <code>less likely to occur by chance</code>. Therefore, paired-end sequencing leads to <code>fewer false positives</code>.</li>
<li>Mitochondria: ä¼—æ‰€å‘¨çŸ¥ATAC-seqæ•°æ®é€šå¸¸åŒ…å«å¾ˆå¤§æ¯”ä¾‹çš„<code>æ¥è‡ªçº¿ç²’ä½“DNAçš„reads</code>ï¼ˆ<em>çº¿ç²’ä½“DNAæ˜¯è£¸éœ²çš„ï¼Œä¹Ÿå¯ä»¥è¢«Tn5é…¶è¯†åˆ«åˆ‡å‰²ï¼Œæ¤ç‰©å¶ç»¿ä½“</em>ï¼‰ã€‚çº¿ç²’ä½“åŸºå› ç»„ä¸­æ²¡æœ‰ATAC-seqæ„Ÿå…´è¶£çš„å³°ï¼Œè¿™äº›readsåœ¨è®¡ç®—ä¸­è¢«ä¸¢å¼ƒï¼Œæµªè´¹æµ‹åºèµ„æºã€‚å¯åœ¨æµ‹åºå‰ä½¿ç”¨æ´—æ¶¤å‰‚<a href="https://www.nature.com/articles/nmeth.4396">å»é™¤æ ·æœ¬ä¸­çš„çº¿ç²’ä½“</a>ã€‚</li>
</ul>
<h3 id="Quality-control"><a href="#Quality-control" class="headerlink" title="Quality control"></a>Quality control</h3><h4 id="FastQC"><a href="#FastQC" class="headerlink" title="FastQC"></a>FastQC</h4><p>Process a file of <code>20 million reads</code> in about <code>5 minutes</code> with less than <code>250MB memory</code> used. Quality scores, GC levels, PCR duplicates, and adapter content.</p>
<h4 id="Adapter-removal"><a href="#Adapter-removal" class="headerlink" title="Adapter removal"></a>Adapter removal</h4><p>For reads derived from <code>short DNA fragments</code>, the <code>3&#39; ends may contain portions of the Illumina sequencing adapter</code>.  </p>
<h5 id="Cutadapt"><a href="#Cutadapt" class="headerlink" title="Cutadapt"></a><a href="https://cutadapt.readthedocs.io/en/stable/guide.html">Cutadapt</a></h5><h5 id="NGmerge"><a href="#NGmerge" class="headerlink" title="NGmerge"></a><a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-018-2579-2">NGmerge</a></h5><p>Unlike cutadapt, NGmerge <code>does not require</code> that the <code>adapter sequences</code> be provided, <code>nor</code> does it <code>require a parameter for the minimum length of adapter to match</code> (in fact, it <code>does not perform adapter matching</code> at all).For input files of <code>20 million paired reads</code>, NGmerge should run in <code>less than one hour on a single core</code>, with minimal memory usage.<br><img src="https://img-blog.csdnimg.cn/e2669cfa1a184ec2b7026fe528f9c97a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<h5 id="Just-adapter-removal"><a href="#Just-adapter-removal" class="headerlink" title="Just adapter removal"></a>Just adapter removal</h5><p>Other than adapter removal, we <code>do not recommend any trimming of the reads.</code> Such adjustments can complicate later steps, such as the identification of PCR duplicates.</p>
<h3 id="Alignment"><a href="#Alignment" class="headerlink" title="Alignment"></a>Alignment</h3><p>Two of the most popular alignment program are BWA and <code>Bowtie2</code>.</p>
<h4 id="Genome-indexing"><a href="#Genome-indexing" class="headerlink" title="Genome indexing"></a>Genome indexing</h4><p>For many model organisms, the genome and pre-built reference indexes are available from <a href="https://support.illumina.com/sequencing/sequencing_software/igenome.html">iGenomes</a>.<br>Otherwise, Bowtie2 indexes are made from a FASTA genome file using the program <code>bowtie2-build</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bowtie2-build  &lt;genome.fa&gt;  &lt;genomeIndexName&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Alignment-1"><a href="#Alignment-1" class="headerlink" title="Alignment"></a>Alignment</h4><p><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml">Bowtie2 parameters</a>. Here are a few that <code>may benefit the alignment of an ATAC-seq dataset</code> :</p>
<p><code>-X &lt;int&gt;</code> : Maximum DNA fragment length (<code>default 500bp</code>). If you anticipate that you may have DNA fragments <code>longer than</code> the default value, you should <code>increase</code> this parameter accordingly; otherwise, alignments from such fragments are considered not properly paired (see Fig. 3B below).<br><code>--very-sensitive</code> : Bowtie2 has a number of alignment and effort parameters that interact in complex (and sometimes unexpected) ways. Preset collections of these parameters are provided for convenience; the default is â€“sensitive, but <code>better alignment results</code> are frequently achieved with â€“very-sensitive.<br><code>-k &lt;int&gt;</code> : Maximum number of alignments to report per read. By default, Bowtie2 reports at most one alignment per read, and if multiple equivalent alignments exist, it chooses one randomly.<br><code>-p &lt;int&gt;</code> : Number of <code>cores</code> on which to run</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bowtie2  --very-sensitive  -k 10  -x &lt;genomeIndexName&gt;  -1 &lt;name&gt;_1.fastq.gz  -2 &lt;name&gt;_2.fastq.gz  \</span><br><span class="line">  |  samtools view  -u  -  \</span><br><span class="line">  |  samtools sort  -n  -o &lt;BAM&gt;  -</span><br></pre></td></tr></table></figure>
<ul>
<li>For input files of <code>20 million</code> paired reads, this command takes around <code>five hours</code> on Cannon(1 core too slow). One could specify eight cores for Bowtie2 with <code>-p 8</code> and adjust the request in the <code>SLURM script</code> to <code>#SBATCH -n 10</code> (that is, <code>eight</code> cores for <code>Bowtie2</code> and <code>one each</code> for <code>SAMtools view</code> and <code>sort</code>). </li>
<li>Bowtie2 also provides (via stderr) a summary of the mapping results, separated according to uniqueness and alignment type.</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/9f961cf3106f4c99b6e85bd1c3f6e373.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"><br> Alignment types for paired-end reads. <strong>A</strong>: Properly paired alignments (â€œ<code>concordant</code>â€œ) have the reads <code>aligned in opposite orientations</code> on the <code>same reference</code> sequence (chromosome). The reads <code>may overlap</code> to some extent (bottom). <strong>B</strong>: A read alignment (for <code>R1</code>) can be <code>unpaired</code> for several reasons: if the readâ€™s mate (<code>R2</code>) is <code>unaligned</code> (<code>upper left</code>), <code>aligns to a different chromosome</code> (<code>upper right</code>), aligns in the <code>incorrect orientation</code> (<code>middle</code> cases), or aligns in the correct orientation but at an <code>invalid distance</code> (<code>bottom</code>). In all cases except the upper left, the R2 read alignment is also unpaired, and the read pair align discordantly (though Bowtie2 also requires uniqueness for such alignments to be counted as discordant).</p>
<p>Generich ç‰ˆæœ¬</p>
<h3 id="Peak-calling"><a href="#Peak-calling" class="headerlink" title="Peak calling"></a>Peak calling</h3><h4 id="æ¨èæ–°çš„Generich"><a href="#æ¨èæ–°çš„Generich" class="headerlink" title="æ¨èæ–°çš„Generich???"></a>æ¨èæ–°çš„<a href="https://github.com/jsh58/Genrich"><code>Generich</code></a>???</h4><p>Genrich was designed to be able to <code>run all of the post-alignment steps</code> through <code>peak-calling with one command</code>. It also possesses a few <code>novel features</code>. Consider the following attributes:</p>
<ul>
<li><strong>Removal of mitochondrial reads</strong>. Genrich <code>disregards all alignments to the mitochondrial</code> chromosome with <code>-e chrM</code>.</li>
<li><strong>Removal of PCR duplicates</strong>. Genrich follows a <code>systematic procedure</code> to <code>remove PCR duplicates</code> with <code>-r</code>. Note that this evaluation <code>takes into account multimapping reads</code> (see next), which is <code>not provided by other alignment-based duplicate-removal programs</code>, such as <code>Picard&#39;s MarkDuplicates</code>.</li>
</ul>
<p><strong>Analysis of multimapping reads</strong>. é‡å¤åŒºåŸŸå¤šçš„åŸºå› ç»„å¯èƒ½å¯¼è‡´éå”¯ä¸€mappingã€‚ Non-uniquely aligned reads can be removed by filtering based on MAPQ scores with <code>samtools</code>, but this effectively renders certain genomic regions inaccessible to the assay. With Genrich, <code>reads with multiple alignments are analyzed</code> by adding a fractional count to each location. Genrichâ€™s <code>statistical model</code> accommodates these values.<br>Along these same lines, Genrich considers the entire reference genome to be part of the assay. If there are chromosomes or genomic regions that should be excluded from analysis, these can be specified by <code>-e or -E</code>, and Genrich will adjust the <code>genome length calculation</code> accordingly. There is no need to <code>guesstimate an &quot;effective&quot; genome size</code> like with MACS2.<br><strong>Analysis of multiple replicates</strong>. When alignment files for multiple replicates are provided to Genrich, it <code>calls peaks for the replicates collectively</code>. <code>No more IDR</code>. Done.<br><strong>Interpretation of alignments suitable for ATAC-seq</strong>. Genrich provides an ATAC-seq analysis mode (-j) in which, rather than inferring the full fragments from the alignments, intervals are interpreted that are centered on transposase cut sites (the ends of each DNA fragment). Only properly paired alignments are analyzed by default, but there is an option to consider unpaired alignments as well (-y) (Fig. 4).</p>
<p><img src="https://img-blog.csdnimg.cn/abb30e7406834c91b7e456ff14e23742.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°"></p>
<ul>
<li>Our previous recommendation was to run <code>MACS2</code> with <code>-f BAMPE</code>, which is similar to the <code>default analysis mode of Genrich</code> (<strong>inferring full fragments, rather than cut site intervals</strong>). Others have attempted to interpret cut site intervals with MACS2 by using the <code>--shif</code>t and <code>--extsize</code> arguments, but these arguments are ignored in <code>BAMPE</code> mode. They do work in the default (<code>BAM</code>) mode, but then, with paired-end reads, <code>most of the alignments are automatically discarded</code> (half of the properly paired alignments and all of the unpaired alignments; secondary alignments are never considered). Is it worse to interpret full fragments that may be less informative biologically, or to disregard more than half of the sequence data? A complicated question. The correct answer is: <strong>use Genrich.</strong><h4 id="Genrich"><a href="#Genrich" class="headerlink" title="Genrich"></a>Genrich</h4></li>
</ul>
<p><strong>most important parameters and options of Genrich for analyzing ATAC-seqï¼š</strong> </p>
<p><code>-j</code> : ATAC-seq mode (<strong>must</strong> be specified)<br><code>-d &lt;int&gt;</code> : Expand cut sites to the given length (default 100bp)<br><code>-y</code> : Analyze <strong>unpaired</strong> alignments<br><code>-r</code> : Remove PCR duplicates<br><code>-e &lt;arg&gt;</code> : Chromosomes (reference sequences) to exclude. Can be a comma-separated list, e.g. <code>-e chrM,chrY</code>.<br><code>-E &lt;file&gt;</code> : Input BED file(s) of genomic regions to exclude, such as â€˜Nâ€™ homopolymers or high mappability regions<br><code>-q &lt;float&gt;</code> : Maximum q-value (FDR-adjusted p-value) for peak calling (default 0.05). An unadjusted p-value threshold can be used instead with <code>-p &lt;float&gt;</code>.<br><code>-a &lt;float&gt;</code> : Minimum area under the curve (total significance) for a peak (default 20.0). <code>Increasing</code> this value results in <code>fewer</code> but <code>higher confidence</code> peaks.<br><code>-v</code> : Verbose mode</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Genrich  -t &lt;BAM&gt;  -o &lt;OUT&gt;  -j  -y  -r  -e chrM  -v</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹äºé‡å¤data,  <code>-t &lt;BAM1&gt;,&lt;BAM2&gt;</code>.</li>
<li>The output file produced by Genrich is in <a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format12"><code>ENCODE narrowPeak format</code></a>, listing the genomic coordinates of each peak called and various statistics.</li>
<li>Speedï¼š a single BAM containing <code>146.3 million alignments</code> was analyzed by Genrich in <code>10.5min</code> with <code>17.1GB of memory</code> . In general, input BAM(s) of more alignments take longer to analyze, but the memory usage should not increase greatly. Note that <code>Genrich is not multithreaded</code>, so it runs on a single core only.</li>
<li>Those who wish to explore the results of varying the <code>peak-calling parameters (-q/-p, -a, -l, -g)</code> should consider having Genrich produce a log file when it parses the SAM/BAM files (for example, with <code>-f &lt;LOG&gt;</code> added to the above command). Then, Genrich can call peaks directly from the log file with the <code>-P</code> optionï¼ˆè°ƒå‚æ•°ä½¿ç”¨æ­¤æ³•èŠ‚çœå†…å­˜å’Œæ—¶é—´ï¼‰:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Genrich  -P  -f &lt;LOG&gt;  -o &lt;OUT2&gt;  -p 0.01  -a 200  -v</span><br></pre></td></tr></table></figure>

<h3 id="NEXT-Steps"><a href="#NEXT-Steps" class="headerlink" title="NEXT Steps"></a>NEXT Steps</h3><h4 id="Visualization"><a href="#Visualization" class="headerlink" title="Visualization"></a>Visualization</h4><p>For ATAC-seq in model organisms, the <code>peak file produced by Genrich</code> can be <code>uploaded</code> directly to the <a href="https://genome.ucsc.edu/cgi-bin/hgCustom">UCSC genome browser</a>. Add header.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">track type=narrowPeak</span><br></pre></td></tr></table></figure>
<p>An alternative visualization tool is the <a href="http://software.broadinstitute.org/software/igv/">Integrative Genomics Viewer (IGV)</a>. Peak files can be loaded directly (File â†’ Load from File). <strong>Viewing BAM files with IGV requires that they be sorted by coordinate and indexed</strong> using <a href="http://www.htslib.org/doc/samtools.html">SAMtools</a>. However, the BAMs show the read alignments, <code>not the full fragments generated by the ATAC</code> <code>nor the cut site intervals</code> analyzed by Genrich. To view the intervals, one can use the optional output <code>BED file</code> produced by Genrich with <code>-b</code>.</p>
<h4 id="Comparing-peak-files"><a href="#Comparing-peak-files" class="headerlink" title="Comparing peak files"></a>Comparing peak files</h4><p>Determining genomic regions that are <code>common or different to a set of peak files</code> is best accomplished with <a href="http://bedtools.readthedocs.io/en/latest/index.html">BEDTools</a>, a suite of software tools that enables â€œgenome arithmetic.â€<br>For example, <a href="http://bedtools.readthedocs.io/en/latest/content/tools/intersect.html">bedtools intersect</a> determines regions that are <strong><code>common</code></strong> to two peak files. Finding <strong><code>differences</code></strong> between two peak files, such as control vs. experimental groups, is accomplished via <a href="http://bedtools.readthedocs.io/en/latest/content/tools/subtract.html">bedtools subtract</a>.</p>
<h4 id="Annotation"><a href="#Annotation" class="headerlink" title="Annotation"></a>Annotation</h4><p>It is helpful to know <code>what genomic features are near the peaks</code> called by Genrich. One program that is commonly used to annotate peaks is <a href="https://bioconductor.org/packages/release/bioc/html/ChIPseeker.html">ChIPseeker</a>. ChIPseeker was originally designed to be used in the analysis of ChIP-seq, but it works just <code>as well with ATAC-seq.</code><br>ChIPseeker <strong>requires</strong> that the <code>genome of interest be annotated with locations of genes and other features</code>. The <a href="https://bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html">ChIPseeker user guide</a> is extremely helpful in using this R/Bioconductor package.</p>
<h4 id="Motif-finding"><a href="#Motif-finding" class="headerlink" title="Motif finding"></a>Motif finding</h4><p><a href="http://homer.ucsd.edu/homer/introduction/basics.html">HOMER</a> is a suite of software designed for <a href="http://homer.ucsd.edu/homer/ngs/peakMotifs.html">motif discovery</a>. It takes a <code>peak file as input</code> and <code>checks for the enrichment</code> of both <code>known sequence motifs</code> and <code>de novo motifs</code>.</p>
<p>MACS2ç‰ˆæœ¬</p>
<h4 id="Alignmentï¼ˆsameï¼‰"><a href="#Alignmentï¼ˆsameï¼‰" class="headerlink" title="Alignmentï¼ˆsameï¼‰"></a>Alignmentï¼ˆsameï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bowtie2  --very-sensitive  -x &lt;genomeIndexName&gt;  -1 &lt;name&gt;_1.fastq.gz  -2 &lt;name&gt;_2.fastq.gz \</span><br><span class="line"> |  samtools view -u -  \</span><br><span class="line"> |  samtools sort -  &gt;  &lt;BAM&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Alignment-adjustments"><a href="#Alignment-adjustments" class="headerlink" title="Alignment adjustments"></a>Alignment adjustments</h4><h5 id="Mitochondrial-reads"><a href="#Mitochondrial-reads" class="headerlink" title="Mitochondrial reads"></a>Mitochondrial reads</h5><ul>
<li>ATAC-seq datasets usually contain a large percentage of reads that are derived from mitochondrial DNA (<a href="http://seqanswers.com/forums/showthread.php?t=35318">discussion</a>). Using <a href="https://www.nature.com/articles/s41598-017-02547-w">CRISPR to reduce mitochondrial contamination</a>. Or recently <a href="https://www.nature.com/articles/nmeth.4396">Omni-ATAC method</a> uses detergents[æ´—æ¶¤å‰‚] to remove mitochondria and is likely to be more accessible for most researchers ( <a href="https://www.biorxiv.org/content/10.1101/496521v1">bad computational workflow</a>).</li>
<li>Method 1 : <strong>Remove the mitochondrial genome from the reference genome before aligning the reads</strong>. In human/mouse genome builds, the mitochondrial genome is labeled â€˜<code>chrM</code>â€˜. That sequence can be deleted from the reference prior to building the genome indexes. The downside of this approach is that the alignment numbers will look much worse; all of the mitochondrial reads will count as unaligned. [æ¤ç‰©ï¼Ÿ]</li>
<li>Method 2 : <strong>Remove the mitochondrial reads after alignment</strong>. A python script, creatively named removeChrom, is available in the ATAC-seq module to accomplish this. For example, to remove all â€˜chrMâ€™ reads from a BAM file, one would run this:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">samtools view -h  &lt;inBAM&gt;  |  removeChrom - - chrM  |  samtools view -b -  &gt;  &lt;outBAM&gt;</span><br></pre></td></tr></table></figure>
<h5 id="PCR-duplicates"><a href="#PCR-duplicates" class="headerlink" title="PCR duplicates"></a>PCR duplicates</h5><p> Picardâ€™s <a href="http://broadinstitute.github.io/picard/command-line-overview.html#MarkDuplicates">MarkDuplicates</a>. The output file specified by <code>M=</code> lists counts of alignments analyzed and duplicates identified.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar $PICARD_TOOLS_HOME/picard.jar MarkDuplicates I=&lt;inBAM&gt; O=&lt;outBAM&gt; M=dups.txt REMOVE_DUPLICATES=true</span><br></pre></td></tr></table></figure>
<h5 id="Non-unique-alignments"><a href="#Non-unique-alignments" class="headerlink" title="Non-unique alignments"></a>Non-unique alignments</h5><p>é‡å¤åŒºåŸŸå¤šçš„å‚è€ƒåºåˆ—å¯èƒ½å¯¼è‡´readså¤šå¤„mapping. ç”¨samtools viewçš„-q <code>å»é™¤éå”¯ä¸€æ¯”å¯¹</code>. For reads with multiple alignments, <code>Bowtie2</code> (or <code>BWA</code>) will <code>report only one alignment</code> (by <code>default</code>) and will assign it a low mapping quality (MAPQ) score, which is defined as -10 * log10Pr{mapping position is wrong}. To eliminate alignments with <code>MAPQ &lt; 10</code> (i.e., where <code>Bowtie2</code> has determined <code>Pr&#123;mapping position is wrong&#125; &gt; 0.1</code>), one would run the following:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">samtools view -b  -q 10  &lt;inBAM&gt;  &gt;  &lt;outBAM&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Peak-calling-1"><a href="#Peak-calling-1" class="headerlink" title="Peak calling"></a>Peak calling</h4><ul>
<li>Model-based Analysis of ChIP-Seq (<a href="https://github.com/taoliu/MACS">MACS2</a>) is a program for detecting regions of <code>genomic enrichment</code>. Though designed for ChIP-seq, it works just <code>as well on ATAC-seq and other genome-wide enrichment assays that have narrow peaks</code>. The main program in MACS2 is <code>callpeak</code>, and its options are described below. (Note that the latest version of MACS2 on Odyssey (v2.1.2_dev) is different from the updated official MACS2 release (v2.1.2), although the latter does incorporate many of the bug fixes made in the Odyssey <code>versionï¼Ÿ</code>.)</li>
<li>It is important to remember that the <code>read alignments indicate only a portion of the DNA fragments generated by the ATACï¼Ÿ</code>. Therefore, one must consider how one wants MACS2 to interpret the alignments.<h5 id="Alignments-to-analyze"><a href="#Alignments-to-analyze" class="headerlink" title="Alignments to analyze"></a>Alignments to analyze</h5></li>
<li>alignmentsåˆ†ä¸ºä¸¤ç±»ï¼šâ€<strong>properly paired</strong>â€œ and â€œ<strong>singletons</strong>â€œ ã€‚<code>-f</code> é€‰æ‹©å…¶ç±»å‹ã€‚</li>
<li><strong>Analyze only properly paired alignments, but ignore R2 reads and treat R1 reads as singletons</strong>. This is the default option (<code>-f AUTO</code>). MACS2 creates a model of the fragment lengths and extends the 3â€™ ends of the R1 reads to the calculated average length. An alternative is to skip this model building and instead extend each read to a specified length (e.g., <code>--nomodel --extsize 300</code> for 300bp fragments). The value of the length parameter is usually determined from the average size during library preparation (the default value is 200bp if no value is specified). However, <code>neither of these approaches utilizes the value of paired-end sequencing</code>, which defines both fragment ends.</li>
<li><strong>Analyze only properly paired alignments with <code>-f BAMPE</code></strong>. Here, the fragments are defined by the paired alignmentsâ€™ ends, and there is <code>no modeling or artificial extension</code>. Singleton alignments are ignored. This is the <code>preferred option</code> for using only properly paired alignments.</li>
<li><strong>Analyze all alignments</strong>. For this approach, a python script, SAMtoBED, is available in the ATAC-seq module. This script converts the read alignments to BED intervals, treating the properly paired alignments as such and extending the singleton alignments as specified. There are <code>four options for the singletons</code>: ignore them, keep them as is, extend them to an arbitrary length (similar to the <code>--extsize</code> option of MACS2), or extend them to the average length calculated from the properly paired alignments. </li>
<li>Here is an example command, using the â€œextend to average lengthâ€ option (<code>-x</code>):</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">samtools view -h  &lt;BAM&gt;  |  SAMtoBED  -i -  -o &lt;BED&gt;  -x  -v</span><br></pre></td></tr></table></figure>
<p>The output from SAMtoBED is a <a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1">BED file</a> that should be analyzed by MACS2 with <code>-f BEDPE</code>.<br>(Note that the BEDTools program <a href="http://bedtools.readthedocs.io/en/latest/content/tools/bamtobed.html">
</a> cannot be used here, since its output is in a nonstandard BED format that MACS2 cannot analyze.)</p>
<ul>
<li>In deciding among these analysis options, it may help to consider the counts produced by Bowtie2, which indicate <code>how many alignments fall into each category</code>. For example, if most of the reads are aligned in proper pairs, it may be sufficient to use <code>option #2</code>. On the other hand, <code>option #3</code> is preferred if a substantial fraction of the reads consists of singletons.<h5 id="Other-arguments"><a href="#Other-arguments" class="headerlink" title="Other arguments"></a>Other arguments</h5></li>
<li>MACS2 is <code>not multithreaded</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">macs2 callpeak  -t &lt;BED&gt;  -f BEDPE  -n NAME  -g ce  --keep-dup all</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>-n &lt;str&gt;</code>    Name of the sample. The output files  name prefix.<br><code>-g &lt;int&gt;</code>    Effective genome size, the size of the organismâ€™s genome that can be analyzed (not including Ns, repetitive sequences, etc.). This will be less than the actual genome size. Parameters are provided for some model organisms, and the <code>default value is hs</code> (for Homo sapiens), which corresponds to a value of 2.7e9.<br><code>-q &lt;float&gt;</code>    <code>Maximum q-value</code> (FDR-adjusted p-value) for peak calling (default <code>0.05</code>). Reducing this threshold will decrease the number of peaks identified by MACS2 but increase the confidence in the called peaks.<br><code>--keep-dup &lt;arg&gt;</code>    How to handle PCR duplicates (default: â€“keep-dup 1, i.e. remove all potential duplicates). If PCR duplicates have been removed by another program, such as Picardâ€™s MarkDuplicates, then specify <code>--keep-dup all</code>.<br><code>--max-gap &lt;int&gt;</code>    Maximum gap between significant sites to cluster them together (default 50bp). (v2.1.2_dev only)<br><code>--min-length &lt;int&gt;</code>    Minimum length of a peak (default 100bp). (v2.1.2_dev only)</p>
</blockquote>
<h5 id="Output-files"><a href="#Output-files" class="headerlink" title="Output files"></a>Output files</h5><ul>
<li>NAME_peaks.xls</li>
<li>NAME_peaks.narrowPeak</li>
<li>NAME_summits.bed</li>
<li>The most useful file is <code>NAME_peaks.narrowPeak</code>, a plain-text <code>BED</code> file that lists the <code>genomic coordinates of each peak called</code>, along with various <code>statistics</code> (fold-change, p- and q-values, etc.).</li>
</ul>
]]></content>
      <categories>
        <category>ATAC-seq</category>
      </categories>
      <tags>
        <tag>ATAC-seq</tag>
      </tags>
  </entry>
  <entry>
    <title>ATAC-seq-1ã€Backgroundã€‘</title>
    <url>/blog/2021/10/11/ATAC-seq-1-background/</url>
    <content><![CDATA[<h3 id="ATAC-seqæ„ä¹‰"><a href="#ATAC-seqæ„ä¹‰" class="headerlink" title="ATAC-seqæ„ä¹‰"></a>ATAC-seqæ„ä¹‰</h3><span id="more"></span>

<p><img src="https://img-blog.csdnimg.cn/2eb44c70d00b45bab31b0eb915e91cac.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>ä¸ºä½•åŒæ ·DNAåºåˆ—çš„ç»†èƒçš„è¡¨å‹ä¼šä¸åŒï¼Œä¸ºä½•è‚ç»†èƒæ˜¯è‚ç»†èƒï¼Œç¥ç»ç»†èƒæ˜¯ç¥ç»ç»†èƒï¼Ÿæ˜¯ä»€ä¹ˆé€ æˆäº†ä»–ä»¬ç”Ÿäº§è›‹ç™½ä¸åŒï¼Œå†³å®šè›‹ç™½ç”Ÿæˆçš„RNAä¸åŒå‘¢ï¼ŸåŸå› å¯ä»¥ç”¨<code>è¡¨è§‚é—ä¼ </code>æ¥è§£é‡Šã€‚<br><img src="https://img-blog.csdnimg.cn/9bf2e2d5d25a4e2eab27321b99b0b0b8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_15,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>DNAè½¬å½•æˆRNAè¿‡ç¨‹å¤æ‚ï¼ŒåŒ…æ‹¬ï¼š<code>æŸ“è‰²è´¨å¯åŠæ€§</code>ï¼Œ<code>DNAä¿®é¥°</code>ï¼Œ<code>ç»„è›‹ç™½ä¿®é¥°</code>ç­‰ç­‰ï¼ˆé€‰æ‹©æ€§è¡¨è¾¾ï¼‰ã€‚</li>
<li><code>æŸ“è‰²è´¨å¯åŠæ€§å³DNAå¼€æ”¾åŒºåŸŸ</code>ï¼Œå°¤ä¸ºé‡è¦ã€‚<code>æ ¸å°ä½“</code>ç”±<code>8ä¸ªç»„è›‹ç™½</code>ç»„æˆå¤åˆç‰©ï¼Œæ¯ä¸ªæ ¸å°ä½“çº¦<code>147bpDNA</code>ã€‚è½¬å½•æ—¶DNAå°†ä»æ ¸å°ä½“å¤åˆç‰©æ¾å¼€ã€‚è®¸å¤šå› ç´ ï¼Œå¦‚<code>æŸ“è‰²è´¨ç»“æ„</code>ã€<code>æ ¸å°ä½“ä½ç½®</code>å’Œ<code>ç»„è›‹ç™½ä¿®é¥°</code>ï¼Œåœ¨æŸ“è‰²è´¨çš„ç»„ç»‡å’Œå¯åŠæ€§èµ·é‡è¦ä½œç”¨ã€‚è‡´å¯†æ ¸å°ä½“ç»“æ„è¢«ç ´ååï¼Œ<code>å¯åŠ¨å­ã€å¢å¼ºå­ã€ç»ç¼˜å­ã€æ²‰é»˜å­</code>ç­‰<code>é¡ºå¼è°ƒæ§å…ƒä»¶å’Œåå¼ä½œç”¨å› å­å¯ä»¥æ¥è¿‘</code>çš„ç‰¹æ€§ï¼Œå«<code>æŸ“è‰²è´¨çš„å¯åŠæ€§</code>ï¼Œä¹Ÿå«<code>æŸ“è‰²è´¨å¼€æ”¾æ€§</code>(chromatin accessibility ï¼‰ï¼Œè¿™æ®µåŒºåŸŸå«å¼€æ”¾æŸ“è‰²è´¨ï¼ˆopen chromatinï¼‰ ã€‚</li>
<li>ä»€ä¹ˆæ˜¯ç»„è›‹ç™½ä¿®é¥°<ul>
<li>å®šä¹‰ï¼šç»„è›‹ç™½åŒ…å«5ä¸ªéƒ¨åˆ†ï¼ŒæŒ‰åˆ†å­é‡å¤§å°åˆ†åˆ«ç§°ä¸º<code>H1ï¼ŒH3ï¼ŒH2Aï¼ŒH2Bå’ŒH4</code>ã€‚ç»„è›‹ç™½åœ¨ç›¸å…³é…¶ä½œç”¨ä¸‹å‘ç”Ÿ<code>ç”²åŸºåŒ–ï¼Œä¹™é…°åŒ–ï¼Œç£·é…¸åŒ–ï¼Œè…ºè‹·é…¸åŒ–ï¼Œæ³›ç´ åŒ–ï¼ŒADPæ ¸ç³–åŸºåŒ–</code>ç­‰ä¿®é¥°</li>
<li><code>H3Â·H4ä¹™é…°åŒ–</code>å½¢æˆ<code>å¼€æ”¾æŸ“è‰²è´¨ç»“æ„</code>ï¼Œ<code>å¢åŠ åŸºå› è¡¨è¾¾</code></li>
<li>ç»„è›‹ç™½<code>ç”²åŸºåŒ–</code>ä¿®é¥°å¤šå‘ç”Ÿåœ¨<code>H3H4</code>ï¼Œä¸åŸºå› <code>æŠ‘åˆ¶åŠæ¿€æ´»</code>ç›¸å…³ï¼Œå–å†³äºè¢«<code>ä¿®é¥°ä½ç½®å’Œç¨‹åº¦</code></li>
<li>ç»„è›‹ç™½<code>ç£·é…¸åŒ–</code>ä¿®é¥°ä¸€èˆ¬ä¸åŸºå› <code>æ´»åŒ–</code>æœ‰å…³</li>
<li>ç»„è›‹ç™½<code>æ³›ç´ åŒ–</code>åˆ™æ˜¯<code>å¯åŠ¨åŸºå› è¡¨è¾¾</code></li>
</ul>
</li>
<li>2013å¹´ç”±æ–¯å¦ç¦å¤§å­¦William J. Greenleafå’ŒHoward Y. Changå®éªŒå®¤å¼€å‘çš„ATAC-seqï¼ˆ<code>Assay</code> for <code>Transposase</code>-<code>Accessible</code> <code>Chromatin</code> with high throughput sequencingï¼‰ï¼Œä¸€ç§æ•è·æŸ“è‰²è´¨å¯åŠæ€§ï¼ˆæŸ“è‰²è´¨å¼€æ”¾æ€§ï¼‰çš„æµ‹åºæ–¹æ³•ã€‚</li>
<li>ATAC-seq<code>æ£€æµ‹æŸ“è‰²è´¨å¯åŠæ€§</code>ï¼Œ<code>ç¡®å®šåŸºå› è¡¨è¾¾è°ƒæ§æœºåˆ¶</code>ã€‚è¯†åˆ«<code>å¯åŠ¨å­åŒºåŸŸ</code>ã€<code>æ½œåœ¨çš„å¢å¼ºå­æˆ–æŠ‘åˆ¶å­</code>ã€‚<code>å¯åŠ¨å­</code>æ˜¯é è¿‘è½¬å½•èµ·å§‹ç‚¹(TSS)çš„DNAåŒºåŸŸã€‚åŒ…å«<code>è½¬å½•å› å­çš„ç»“åˆä½ç‚¹</code>ï¼Œè½¬å½•å› å­æ‹›å‹ŸRNAèšåˆé…¶ã€‚<code>å¢å¼ºå­</code>æ˜¯ä½äº<code>å¯åŠ¨å­ä¸‹æ¸¸æˆ–ä¸Šæ¸¸1Mb</code>çš„DNAåŒºåŸŸã€‚<code>å½“è½¬å½•å› å­ä¸å¢å¼ºå­ç»“åˆï¼Œå¹¶ä¸å¯åŠ¨å­åŒºåŸŸæ¥è§¦æ—¶ï¼Œè¯¥åŸºå› çš„è½¬å½•å¢åŠ </code>ã€‚ç›¸å<code>æŠ‘åˆ¶å­</code>ä¼š<code>å‡å°‘æˆ–æŠ‘åˆ¶åŸºå› è¡¨è¾¾</code>ã€‚</li>
<li>ATAC-seqçš„<code>å³°</code>å¾€å¾€æ˜¯<code>å¯åŠ¨å­</code>ï¼Œ<code>å¢å¼ºå­åºåˆ—</code>ä»¥åŠä¸€äº›<code>åå¼è°ƒæ§å› å­</code>ç»“åˆä½ç‚¹ã€‚</li>
<li>ä¸ºæ‰¾åˆ°å¼€æ”¾æŸ“è‰²è´¨åŒºï¼ŒåŸºå› ç»„è¢«<code>TN5è½¬åº§é…¶</code>å¤„ç†ã€‚åœ¨ATAC-Seqä¸­ï¼Œ<code>ä¿®é¥°åçš„TN5å°†ä¸NextEraæ¥å¤´ç›¸å¯¹åº”çš„DNAåºåˆ—æ’å…¥åˆ°åŸºå› ç»„çš„å¼€æ”¾åŒºåŸŸ</code>ï¼ŒåŒæ—¶ï¼ŒDNAè¢«è½¬åº§é…¶æ´»æ€§å‰ªåˆ‡ã€‚</li>
<li>å¼€æ”¾æŸ“è‰²è´¨çš„ç ”ç©¶æ–¹æ³•é™¤äº†ATAC-seqï¼Œè¿˜æœ‰DNase-Seqï¼ŒFAIRE-seqï¼ŒMNase-seq ç­‰ã€‚ATAC-Seq<code>æ‰€éœ€æ ·æœ¬å°‘ï¼Œå»ºåº“å¿«ï¼Œé‡å¤æ€§æ›´é«˜</code></li>
<li>æŠ€æœ¯ï¼šåˆ¶å¤‡ç»†èƒæ‚¬æ¶²-&gt;è£‚è§£ç»†èƒè†œï¼Œè·å–ç»†èƒæ ¸-&gt;é‡‡ç”¨Tn5è¿›è¡Œé…¶åˆ‡-&gt;å›æ”¶DNAç‰‡æ®µï¼ŒPCRæ‰©å¢å»ºåº“-&gt;é«˜é€šé‡æµ‹åº-&gt;ç”Ÿä¿¡åˆ†æ</li>
<li><img src="https://img-blog.csdnimg.cn/00f06cb4758b44c7a35b8c5c3ff74eda.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li><code>ATAC-seq</code>ä¸<code>Chip-seq</code> callå‡ºæ¥çš„<code>peak</code>ä»£è¡¨çš„<code>æ„ä¹‰ä¸åŒ</code>ã€‚<code>Chip-seq</code> peakæ˜¯è¢«<code>ç›®çš„è›‹ç™½ç»“åˆæ‹‰ä¸‹æ¥çš„DNA</code>ï¼Œä¸€èˆ¬åªæœ‰<code>ä¸€ä¸ªå³°</code>ï¼Œè€Œ<code>ATAC-seq</code>æ˜¯è¢«<code>Tn5è½¬åº§é…¶åˆ‡å¼€</code>ã€æ²¡æœ‰è¢«ç»„è›‹ç™½ç»“åˆã€æŸ“è‰²è´¨å¼€æ”¾çš„DNAä½ç‚¹ï¼Œ<code>å¦‚æœæ˜¯TFç»“åˆçš„åŒºåŸŸï¼Œä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªå±±è°·èˆ¬çš„å­˜åœ¨</code>ã€‚ChIP-seqå’ŒATAC-seqåœ¨TFæˆ–è€…Tn5ç»“åˆåŒºåŸŸ<code>éƒ½ä¼šå½¢æˆä¸€ä¸ªåŒå³°çš„readsç»“åˆæ¨¡å¼</code>ï¼Œä½†<code>åˆ¤æ–­peakçš„æ—¶ä¼šæœ‰ä¸åŒçš„æ ‡å‡†</code>ã€‚chip-seqæ˜¯ç”±äº<code>TFä¸€èµ·æ²‰æ·€ä¸‹æ¥çš„DNA fragmentä¸€èˆ¬ä¼šå¤§äºTFçš„ç»“åˆåŒºåŸŸ</code>ï¼Œ<code>readçš„ä½ç½®å¹¶ä¸æ˜¯çœŸå®TFç»“åˆä½ç½®</code>ï¼Œéœ€è¦<code>å‘å†…shift</code>ï¼›è€Œ<code>ATAC-seqä¸€èˆ¬æ˜¯å¾€ä¸¤è¾¹shift</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/e501e5a398b34d0e8fd514fba8333cdb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li><code>ATAC-seq</code>ä¸<code>Chip-seq</code>åº”ç”¨ä¸Šçš„åŒºåˆ«:</li>
<li>ATAC-Seqå¯<code>æ£€æµ‹å…¨åŸºå› ç»„DNAç»“åˆè›‹ç™½</code>ï¼Œ<code>è½¬å½•ç»“åˆä½ç‚¹</code> ï¼Œä¸€èˆ¬ç”¨äº<code>ä¸çŸ¥é“ç‰¹å®šçš„è½¬å½•å› å­</code>ï¼Œç”¨æ­¤æ–¹æ³•ä¸å…¶ä»–æ–¹æ³•ç»“åˆ<code>ç­›æŸ¥æ„Ÿå…´è¶£çš„ç‰¹å®šè°ƒæ§å› å­</code>ï¼›</li>
<li>ChIP-Seqæ˜¯å·²çŸ¥è½¬å½•å› å­ï¼Œæ ¹æ®<code>æ„Ÿå…´è¶£çš„è½¬å½•å› å­è®¾è®¡æŠ—ä½“</code>å»åšChIPå®éªŒ<code>å¯Œé›†ç»“åˆçš„DNAç‰‡æ®µ</code>ã€‚åœ¨æµ‹å®šè½¬å½•å› å­çš„ ChIP-seq ä¸­<code>ç‹¬æœ‰çš„å³°å¯èƒ½æ˜¯å…ˆé©±è½¬å½•å› å­</code>ï¼Œå…¶<code>å…ˆç»“åˆåˆ°å°é—­æŸ“è‰²è´¨</code>ï¼Œç„¶å<code>æ‹›å‹ŸæŸ“è‰²è´¨é‡å¡‘å› å­æˆ–å…¶ä»–è½¬å½•å› å­èµ·å§‹è½¬å½•</code>ã€‚è¿™äº›è½¬å½•å› å­ <code>ATAC-seqæ£€æµ‹ä¸åˆ°</code>ã€‚</li>
<li>å¾—åˆ°DNAç‰‡æ®µåï¼Œä¸ºæµ‹åºå‡†å¤‡å»ºåº“ï¼ŒåŒ…æ‹¬<code>ç”¨å®Œæ•´çš„NextEraæ¥å¤´</code>å’Œ<code>çº¯åŒ–</code>ã€<code>PCRæ‰©å¢</code>ç­‰ã€‚åŸºäºä¸Šè¿°åŸå› ï¼Œ<code>ATAC-Seqæ¨èä½¿ç”¨åŒç«¯é…å¯¹</code>çš„æ–¹æ³•ã€‚</li>
</ul>
<h3 id="ATACseqåº”ç”¨"><a href="#ATACseqåº”ç”¨" class="headerlink" title="ATACseqåº”ç”¨"></a>ATACseqåº”ç”¨</h3><ul>
<li><p>æŸ“è‰²è´¨<code>å¼€æ”¾æ€§å›¾è°±ç»˜åˆ¶</code>ï¼Œè¡¨è§‚åŸºå› ç»„å›¾è°±</p>
</li>
<li><p>æ‰¾<code>è°ƒæ§</code>ç”Ÿç‰©å­¦è¿‡ç¨‹çš„<code>å…³é”®è½¬å½•å› å­</code></p>
</li>
<li><p>æ‰¾<code>å“ªä¸ªè½¬å½•å› å­</code>è°ƒæ§äº†ç ”ç©¶çš„åŸºå› </p>
</li>
<li><p>æ‰¾è½¬å½•å› å­è°ƒæ§çš„<code>é¶åŸºå› </code></p>
</li>
<li><p>å¾—åˆ°<code>ä¸åŒç»„ç»‡æˆ–ä¸åŒæ¡ä»¶ä¸‹å¯¹åº”å¯åŠæ€§åŒºåŸŸ</code>ã€‚</p>
</li>
<li><p>å¾—åˆ°æ ¸å°ä½“ä½ç½®</p>
</li>
<li><p>ç”Ÿæˆè½¬å½•å› å­ç»“åˆåŒºåŸŸçš„ç‰¹å¾(footprinting)</p>
<h3 id="æŠ€æœ¯é™åˆ¶"><a href="#æŠ€æœ¯é™åˆ¶" class="headerlink" title="æŠ€æœ¯é™åˆ¶"></a>æŠ€æœ¯é™åˆ¶</h3></li>
<li><p>Tn5é€šè¿‡<code>æ’å…¥å‰ªæ–­DNA å¹¶å°†æµ‹åºæ¥å¤´è¿æ¥åˆ°å‰ªæ–­çš„ä¸¤ä¸ªDNA ç‰‡æ®µçš„æœ«ç«¯</code>ï¼Œå› æ­¤å¯¹äºä¸€ä¸ªDNA ç‰‡æ®µè€Œè¨€ï¼Œå…¶ä¸¤ç«¯çš„æ¥å¤´è¿æ¥æ˜¯éšæœºçš„ï¼Œå¯¼è‡´<code>åŒä¸€ç‰‡æ®µä¸¤ç«¯çš„æ¥å¤´æœ‰50%çš„æ¦‚ç‡æ˜¯åŒä¸€æ¥å¤´</code>ã€‚è€Œ<code>åªæœ‰è¿æ¥ä¸åŒæ¥å¤´çš„ç‰‡æ®µæ‰å¯ç”¨äºå¯Œé›†æ‰©å¢åŠæµ‹åº</code>ï¼Œå› æ­¤<code>ä¸€åŠçš„ç‰‡æ®µæ— æ³•åˆ©ç”¨</code>ï¼› </p>
</li>
<li><p><code>å¤§é‡å‰ªæ–­çš„DNA ç”±äºç‰‡æ®µè¿‡å¤§ï¼Œæ— æ³•è¿›è¡ŒPCRå¯Œé›†</code>; </p>
</li>
<li><p>Tn5 çš„<code>æ´»æ€§</code>å—ååº”æº¶æ¶²çš„ç»„æˆåŠååº”æ¡ä»¶<code>å½±å“</code>ï¼Œä»ç„¶éœ€è¦ä¼˜åŒ–ä»¥ä¾¿æé«˜å‰ªåˆ‡æ•ˆæœï¼› </p>
</li>
<li><p>ATAC-seqåœ¨<code>æ¤ç‰©ç»†èƒå­˜åœ¨ä»¥ä¸‹éš¾ç‚¹</code>ï¼š<code>ç»†èƒå£</code>ï¼Œ<code>å¶ç»¿ä½“çº¿ç²’ä½“ç­‰ç»†èƒå™¨æ±¡æŸ“</code>ï¼Œ<code>ç¼ºå°‘ç¨³å®šé—ä¼ çš„ç»†èƒç³»</code>; </p>
</li>
</ul>
<h3 id="ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq"><a href="#ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq" class="headerlink" title="ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq"></a>ATAC-Seqã€Dnase-Seqã€MNase-Seqã€FAIRE-Seq</h3><ul>
<li>æ•´ä½“çš„åˆ†ææ€è·¯ä¸€è‡´ï¼Œ<code>æ‰¾å¯Œé›†åŒºåŸŸ</code>ï¼Œå¯¹å¯Œé›†åŒºåŸŸè¿›è¡ŒåŠŸèƒ½åˆ†æã€‚</li>
<li>ChIP-Seqæ˜¯<code>æ­ç¤ºç‰¹å®šè½¬å½•å› å­</code>æˆ–<code>è›‹ç™½å¤åˆç‰©</code>çš„ç»“åˆåŒºåŸŸï¼Œå®é™…æ˜¯<code>ç ”ç©¶DNAå’Œè›‹ç™½è´¨çš„ç›¸äº’ä½œç”¨</code>ï¼Œåˆ©ç”¨<code>æŠ—ä½“å°†è›‹ç™½è´¨å’ŒDNAä¸€èµ·å¯Œé›†</code>ï¼Œå¹¶å¯¹<code>å¯Œé›†çš„DNAæµ‹åº</code>ã€‚</li>
<li>DNase-Seqã€ATAC-Seqã€FAIRE-Seqéƒ½<code>ç ”ç©¶å¼€æ”¾æŸ“è‰²è´¨åŒºåŸŸ</code>ï¼š</li>
<li>DNase-Seqç”¨<code>DNase Iå†…åˆ‡é…¶è¯†åˆ«</code>å¼€æ”¾æŸ“è‰²è´¨åŒºåŸŸï¼Œ</li>
<li>ATAC-seqç”¨<code>Tn5è½¬åº§é…¶</code>ï¼Œéšåè¿›è¡Œ<code>å¯Œé›†æ‰©å¢</code>ï¼›</li>
<li>FAIRE-Seqå…ˆè¶…å£°è£‚è§£ï¼Œåç”¨é…š-æ°¯ä»¿å¯Œé›†ï¼›</li>
<li>MNase-Seqé‰´å®šæ ¸å°ä½“åŒºåŸŸã€‚ </li>
</ul>
<p>ä¸‹å›¾æ˜¯ä¸åŒæµ‹åºæ–¹æ³•è·å–çš„å³°å½¢ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/aea5161044eb40e1a1cc4c1a65d63cbb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_18,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ£€æµ‹æŸ“è‰²è´¨å¯åŠæ€§çš„æ–¹æ³•ä¸­ï¼ŒATAC-seqå°¤å…¶å—æ¬¢è¿ã€‚<br><img src="https://img-blog.csdnimg.cn/96808dfcce9446298f1d0d4cc0db6eee.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_10,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<ul>
<li>ATAC-seqçš„ä¼˜ç‚¹ï¼š<code>Tn5è½¬åº§é…¶çš„é«˜æ´»æ€§</code>ä½¿ATAC-seqç®€å•ï¼Œçœæ—¶ï¼Œè€Œä¸”åªéœ€500-50,000ä¸ªç»†èƒã€‚çµæ•åº¦ç‰¹å¼‚æ€§ä¸DNase-seqç›¸å½“ï¼Œä¼˜äºFAIRE-seqã€‚</li>
</ul>
<h3 id="æ•´åˆåˆ†æ"><a href="#æ•´åˆåˆ†æ" class="headerlink" title="æ•´åˆåˆ†æ"></a>æ•´åˆåˆ†æ</h3><ul>
<li>ç”±äºå¼€æ”¾æŸ“è‰²è´¨æ˜¯å¤§å¤šæ•°TFç»“åˆçš„å…ˆå†³æ¡ä»¶ï¼Œå› æ­¤<code>ATAC-seqå³°é€šå¸¸ä¸TF ChIP-seqå³°é‡å ï¼Œä½†é€šå¸¸æ›´å®½</code>ã€‚å› æ­¤ï¼Œ<code>TF ChIP-seqå’ŒATAC-seqå¯ä»¥åœ¨åŒä¸€å®éªŒç³»ç»Ÿä¸­ç›¸äº’éªŒè¯</code>å½¼æ­¤çš„è´¨é‡å’Œå¯é æ€§ã€‚ </li>
<li>ATAC-seqä¸ histone marker ChIP-seqé›†æˆï¼Œå‘ç°ä¸æ´»è·ƒæŸ“è‰²è´¨æ ‡ H3K4me3ï¼ŒH3K4me1ï¼ŒH3K27acç­‰æ­£ç›¸å…³ï¼Œä¸ä¸æ´»è·ƒçš„æŸ“è‰²è´¨æ ‡è®° H3K27me3 è´Ÿç›¸å…³ã€‚ <code>ï¼Ÿ</code></li>
<li><code>ATAC-seq+RNA-seq</code>ï¼š ä¸€èˆ¬RNA-seqä¼šä¼˜å…ˆäºATAC-seqå…ˆæµ‹ï¼Œä½†<code>å·®å¼‚åŸºå› å¯Œé›†çš„åŸºå› é€šè·¯åªæ˜¯ä¸€ç§ç›¸å…³æ€§</code>ã€‚è¦åˆ†æå‡ºå…¶ä¸­è°è°ƒæ§ç›®çš„åŸºå› ï¼Œå¯é€šè¿‡<code>ATAC-seqåšmotifåˆ†æ</code>ï¼Œ<code>å¯»æ‰¾æ½œåœ¨çš„è°ƒæ§å› å­</code>ï¼Œç„¶åå†åç»­çš„<code>å®éªŒéªŒè¯</code>æˆ–è€…<code>chip-seqéªŒè¯</code>ã€‚/ çœ‹ATACä¸Šä¸°åº¦é«˜çš„DNAåºåˆ—åŒºåŸŸæ˜¯å¦å¯¹åº”è½¬å½•æœ¬è¡¨è¾¾é‡å¢åŠ ï¼Œæ‰¾åˆ°å¯¹åº”è½¬å½•æœ¬ç›¸å…³åŸºå› çš„ä¸Šæ¸¸è°ƒæ§åºåˆ—ï¼Œæ•´ä½“åˆ†æè½¬å½•ã€‚å¯¹åŸºå› åŠŸèƒ½åˆ†æï¼Œç»“åˆå®éªŒè¡¨å‹ï¼Œæ¨æµ‹è¡¨è¾¾è°ƒæ§-è¡¨è¾¾-åŠŸèƒ½-è¡¨å‹ã€‚<br><img src="https://img-blog.csdnimg.cn/4a3016bfa5c74598a5b7d660fe1cfe84.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li><code>ATAC-seq+HiC</code>ï¼š å¯¹äºä¸€äº›æƒ³äº†è§£<code>æŸ“è‰²è´¨é«˜çº§ç»“æ„å¯¹ç”Ÿå‘½è¡Œä¸ºçš„ä½œç”¨</code>çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šéœ€è¦ç”¨åˆ°ATAC-seqç­‰æŠ€æœ¯ï¼Œå› ä¸º<code>Hi-Cåˆ†æ</code>å¾—åˆ°é«˜çº§ç»“æ„compartmentA/Bã€TADsã€Loopsç­‰ä¿¡æ¯ï¼Œé€šå¸¸åªæ˜¯ç›¸å…³æ€§ï¼Œä½†é€šè¿‡ATAC-seqï¼Œå¯ä»¥<code>è·å¾—promoterã€enhancerç­‰ä¿¡æ¯</code>ï¼Œæ›´èƒ½çŸ¥é“é«˜çº§ç»“æ„æ˜¯å¦‚ä½•å½±å“å¯åŠ¨å­ã€å¢å¼ºå­ä»è€Œå½±å“åŸºå› è¡¨è¾¾çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/e38ba32597a14ca7a5d4d6b2f36c1b73.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li><code>ATAC-seq+ç»„è›‹ç™½ä¿®é¥°</code>ï¼š ATAC-seqé¢„æµ‹ä¸€ä¸ªä½ç‚¹çš„å¼€æ”¾ç¨‹åº¦ä»¥åŠå¯èƒ½æœ‰æŸç§è½¬å½•å› å­çš„ç»“åˆï¼Œä½†<code>ä¸çŸ¥é“</code>è¯¥å› å­æ˜¯<code>ä¿ƒè¿›</code>åŸºå› è¡¨è¾¾ï¼Œè¿˜æ˜¯<code>æŠ‘åˆ¶</code>ï¼Œåªé€šè¿‡<code>åŸºå› å±‚é¢é‰´å®š</code>æ¥åˆ¤æ–­è½¬å½•å› å­å¯¹åŸºå› çš„ä¿ƒè¿›æˆ–è€…æ˜¯ä¸å¤Ÿçš„ï¼Œå®ƒåªæ˜¯ä¸€ç§<code>ç›¸å…³æ€§</code>ã€‚è€Œè¿™æ—¶å€™å¦‚æœèƒ½æä¾›åƒ<code>H3K27acè¿™ç±»æ¿€æ´»å‹ç»„è›‹ç™½</code>ã€<code>H3K27me3è¿™ç±»æŠ‘åˆ¶å‹ç»„è›‹ç™½</code>å°†èƒ½ä½¿æ•°æ®ç»“æœå¯ä¿¡ã€‚å›½å†…è¾ƒæ—©ç ”ç©¶iPSCsçš„å­¦è€…å¦‚è£´ç«¯å¿çš„å·¥ä½œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨è§£æiPSCsé‡ç¼–ç¨‹ä¸­çš„æŸ“è‰²è´¨å¯åŠæ€§çš„æ—¶å€™ï¼Œä¸ä»…ç”¨åˆ°ATAC-seqæ¥æè¿°ç»†èƒçš„èº«ä»½è½¬å˜ï¼Œè¿˜<code>é€šè¿‡H3K27acæŒ‡å¾è¯¥åŒºåŸŸçš„æ¿€æ´»</code>ã€‚å…¶ä¸­ä¸€ç¯‡è¿˜é€šè¿‡<code>è°ƒæ§æˆçº¤ç»´ç»†èƒå…³é”®åŸºå› å¯åŠ¨å­åŒºå»ä¹™é…°åŒ–ä¿®é¥°</code>ï¼Œè¾¾åˆ°äº†ä¿ƒè¿›é‡ç¼–ç¨‹çš„è¿›ç¨‹ã€‚<br><img src="https://img-blog.csdnimg.cn/abb3dc6c3bb0476985a9f1b2e77c4fcc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li><code>scATAC-seq+scRNA-seq</code>ï¼š æ›´å‰æ²¿çš„æŠ€æœ¯ä¸€ä¸ªç»†èƒé‡ŒåŒæ—¶è¿›è¡ŒRNA-seqå’ŒATAC-seqï¼Œå¹¶ä¸”æ˜¯å•ç»†èƒæ°´å¹³çš„æ£€æµ‹ã€‚SHARE-seqï¼Œèƒ½å¤Ÿå®ç°åœ¨å•ç»†èƒä¸­åŒæ—¶é«˜è´¨é‡ï¼Œé«˜é€šé‡çš„æ£€æµ‹åŸºå› è¡¨è¾¾å’ŒæŸ“è‰²è´¨å¯åŠæ€§ã€‚è¯¥æŠ€æœ¯å¯ä»¥ä½¿ç”¨<code>æŸ“è‰²è´¨æ½œåŠ›ç®—æ³•</code>ï¼ˆchromatin potentialï¼‰ï¼Œ<code>ç”¨ATACå’ŒRNAçš„å·®å¼‚æ¥é¢„æµ‹ç»†èƒçš„å˜åŒ–æ–¹å‘</code>ã€‚<code>ç›¸å¯¹äºä»¥å¾€ä»…ä¾èµ–äºRNAçš„é¢„æµ‹æ‰‹æ®µï¼ŒæŸ“è‰²è´¨æ½œåŠ›èƒ½å¤Ÿå¤§å¤§æå‰é¢„æµ‹çš„æ—¶é—´</code>ã€‚<br><img src="https://img-blog.csdnimg.cn/df76c6e5f3184d58a00a1fa53a398cd5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_19,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
</ul>
<ul>
<li><a href="https://pubmed.ncbi.nlm.nih.gov/27374332/">ATAC-seqä¸ChIPè”åˆåˆ†æ</a><br>ç ”ç©¶è¯¾é¢˜ä¸ºäººå°ç»†èƒè‚ºç™Œä¿ƒè¿›ç™Œç—‡æ‰©æ•£è½¬ç§»çš„èƒŒæ™¯æœºåˆ¶ã€‚ä¸»è¦æ¯”è¾ƒåŸå‘æ€§å’Œè‚è½¬ç§»æ€§çš„å°ç»†èƒè‚ºç™Œç»†èƒä¹‹é—´çš„å·®å¼‚ã€‚åˆ©ç”¨ATAC-seqï¼Œå‘ç°NFIå®¶æ—è½¬å½•å› å­å¯Œé›†åœ¨å…·æœ‰å·®å¼‚çš„æŸ“è‰²è´¨å¼€æ”¾ä½ç‚¹ä¸­ï¼Œé¢„ç¤ºç€NFIå®¶æ—è½¬å½•å› å­åœ¨è°ƒæ§è‚¿ç˜¤ç»†èƒè½¬ç§»ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚åœ¨æŸ“è‰²è´¨é«˜å¼€æ”¾æ€§ä½ç‚¹åŒºåŸŸä¼´éšç€Nfibæ‹·è´æ•°é‡å¢å¤šï¼Œä¸”Nfibåœ¨ä¾µè¢­æ€§åŸå‘æ€§è‚¿ç˜¤å’Œè½¬ç§»æ€§è‚¿ç˜¤å†…é«˜è¡¨è¾¾ï¼ŒNfibè¡¨ç°å‡ºç»´æŒæŸ“è‰²è´¨åŠè¿œç«¯è°ƒæ§åŒºåŸŸå¼€æ”¾å’Œä¿ƒè¿›ç¥ç»åŸºå› è¡¨è¾¾çš„åŠŸèƒ½ï¼Œè¯´æ˜äº†Nfibå¯¹ä¿ƒè¿›ç™Œç»†èƒå¢æ®–å’Œè¿ç§»å…·æœ‰é‡è¦çš„ä½œç”¨ã€‚</li>
<li><a href="https://pubmed.ncbi.nlm.nih.gov/25679813/">motifåˆ†æè½¬å½•å› å­ç»“åˆè›‹ç™½</a>ã€‚å¯¹å¤„äºå‘è‚²è¿‡ç¨‹ä¸­çš„é»‘è…¹æœè‡çœ¼ç›åŠå…¶é€šè¿‡é—ä¼ è¯±å¯¼çš„è‚¿ç˜¤æ¨¡å‹ï¼Œåˆ©ç”¨ATAC-seqæŠ€æœ¯åˆ†ææŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸå·²åœ¨æ´»ä½“ä¸­å‘ç°é©±åŠ¨è‚¿ç˜¤å‘è‚²çš„è½¬å½•å› å­åŠè°ƒæ§åŒºåŸŸã€‚ç„¶åå¯¹æ‰¾åˆ°çš„æŸ“è‰²è´¨æ´»æ€§å¼€æ”¾åŒºåŸŸè¿›è¡Œè½¬å½•å› å­é¢„æµ‹åˆ†æï¼Œå‘ç°äº†ä¸¤ä¸ªå…³é”®çš„è½¬å½•å› å­ï¼ŒçŒœæµ‹å®ƒä»¬å¯èƒ½ä¸æŸ“è‰²è´¨å›¾è°±çš„å˜åŒ–æœ‰å…³ã€‚é€šè¿‡å¯¹å€™é€‰çš„ä¸€ä¸ªè½¬å½•å› å­è¿›è¡ŒåŠŸèƒ½éªŒè¯å’Œé¶æ ‡åˆ†æï¼Œå‘ç°å…¶ä¸ºè‚¿ç˜¤è½¬å½•ç»„ä¸­çš„ä¸€ä¸ªå…³é”®çš„è½¬å½•è°ƒæ§å› å­ã€‚</li>
</ul>
<hr>
<ul>
<li><strong>æ€è€ƒ</strong>ï¼š</li>
<li>ATAC-Seqä¸ChIP-Seqçš„å¼‚åŒåœ¨å“ªé‡Œï¼Ÿ</li>
<li>ç”¨å’ŒChIP-Seqä¸€æ ·çš„å‚æ•°Call peaksæ­£ç¡®å—ï¼Ÿ</li>
<li>å¾—åˆ°peaksåæ€ä¹ˆè¿›è¡Œè´¨é‡è¯„ä¼°ï¼Ÿ</li>
<li>æ ·æœ¬å†…çš„é‡å¤æ€ä¹ˆå¤„ç†ï¼Ÿ</li>
<li>æ ·æœ¬é—´çš„å·®å¼‚æ€ä¹ˆåˆ†æï¼Ÿ</li>
<li>æ€ä¹ˆå¯¹peaksè¿›è¡ŒåŠŸèƒ½æ³¨é‡Šåˆ†æï¼Ÿ</li>
<li>å¦‚ä½•æ‰¾motif?</li>
<li>ATAC-Seqå’ŒChIP-Seqå’ŒRNA-Seqçš„æ•´åˆåˆ†ææ€ä¹ˆåšï¼Ÿ<br><img src="https://img-blog.csdnimg.cn/0920f7a6c41148b2825b189e709a5fbc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAYmFubmVyRHI=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="ATAC-seq/CHIP-seqæµç¨‹"></li>
</ul>
<p>å¾…å­¦ä¹ å†…å®¹ï¼š</p>
<ol>
<li><p>ATAC-seq data analysis: from FASTQ to peaks</p>
</li>
<li><p>ATAC-seq Data Standards and Processing Pipeline in ENCODE</p>
</li>
<li><p>ATAC-seqæ•°æ®åˆ†æå®æˆ˜</p>
</li>
<li><p>Harvard FAS Informatics - ATAC-seq Guidelines</p>
</li>
<li><p>Harvard Chan Bioinformatics Core (HBC)æ·±åº¦NGSæ•°æ®åˆ†æè¯¾ç¨‹ï¼Œç¬¬5éƒ¨åˆ†å…³äºChIP-Seqï¼Œæ•´ä½“æ€è·¯å’Œç»å¤§éƒ¨åˆ†åˆ†ææ–¹æ³•é€‚åˆATAC-seqã€‚</p>
<p>HBCæ·±åº¦NGSæ•°æ®åˆ†æè¯¾ç¨‹ï¼š<br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course</a><br>ç¬¬äº”éƒ¨åˆ†ChIP-Seqè¯¾ç¨‹ï¼š</p>
<p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons</a></p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‚è€ƒæ–‡çŒ®ï¼š</span><br><span class="line">https://mp.weixin.qq.com/s?src=11&amp;timestamp=1633159169&amp;ver=3349&amp;signature=*MwqLr1J-qdZoNiKVxF32vEKh5-6TRystOXAJ3UOZ3Pl8XTBIB8Ly95IJM0L2EzGFVWOM-TdKnuhnb0gfMfsUTfahWJ5i3hcM2TcR9UDFSVWuyYw7CONzMjsMaYQG2Ca&amp;new=1</span><br><span class="line">https://mp.weixin.qq.com/s?src=11&amp;timestamp=1633159169&amp;ver=3349&amp;signature=rtYw5NsC62rUZvctQsUg3*w*NFFDdOHgSMu0pcp0HTQdCyqxpgril8yx7GWlJaID*lfd2HRLUWs59zuszSEFeean0jEwdRs4PzYy*T5b7nSpZRWqCs4SHcEQ2jyjDtwQ&amp;new=1</span><br></pre></td></tr></table></figure>

<hr>
<blockquote>
<p>1ï¼šATAC-seqçš„èƒŒæ™¯ä»‹ç»ä»¥åŠä¸ChIP-Seqçš„å¼‚åŒ<br>2ï¼šåŸå§‹æ•°æ®çš„è´¨æ§ã€æ¯”å¯¹å’Œè¿‡æ»¤<br>3ï¼šç”¨MACS2è½¯ä»¶call peaks<br>4ï¼šå¯¹ATAC-Seq/ChIP-seqçš„è´¨é‡è¯„ä¼°ï¼ˆä¸€ï¼‰â€”â€”phantompeakqualtools<br>5ï¼šå¯¹ATAC-Seq/ChIP-seqçš„è´¨é‡è¯„ä¼°ï¼ˆäºŒï¼‰â€”â€”ChIPQC<br>6ï¼šé‡å¤æ ·æœ¬çš„å¤„ç†â€”â€”IDR<br>7ï¼šç”¨Yå”çš„ChIPseekeråšåŠŸèƒ½æ³¨é‡Š<br>8ï¼šç”¨ç½‘é¡µç‰ˆå·¥å…·è¿›è¡Œmotifåˆ†æ<br>9ï¼šå·®å¼‚peaksåˆ†æâ€”â€”DiffBind<br>10ï¼šATAC-Seqã€ChIP-Seqã€RNA-Seqæ•´åˆåˆ†æ</p>
</blockquote>
<h3 id="ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹"><a href="#ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹" class="headerlink" title="ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹"></a>ç®€æ´ç‰ˆATACseqåˆ†ææµç¨‹</h3><ul>
<li>æ•°æ®é¢„å¤„ç†<ul>
<li>ï¼ˆ1ï¼‰æ¯”å¯¹å‰è´¨é‡æ§åˆ¶FastQC</li>
<li>ï¼ˆ2ï¼‰åŸå§‹åºåˆ—æ¯”å¯¹ </li>
<li>ï¼ˆ3ï¼‰æ¯”å¯¹åå¤„ç†å’Œè´¨é‡æ§åˆ¶ï¼šå»é™¤é‡å¤åºåˆ—ï¼Œç»†èƒå™¨åºåˆ—<ul>
<li>åºåˆ—æ¯”å¯¹åï¼ŒPicard/SAMtoolsæ”¶é›†unique mapping reads/rateï¼Œduplicated rateç™¾åˆ†æ¯”å’Œç‰‡æ®µå¤§å°åˆ†å¸ƒ</li>
<li>æˆåŠŸçš„ATACseqå®éªŒåº”ç”Ÿæˆ<code>ç‰‡æ®µå¤§å°åˆ†å¸ƒå›¾</code>ï¼ˆä»<code>bamæ–‡ä»¶</code>å¾—åˆ°ï¼‰ï¼Œå…·æœ‰é€’å‡æ€§å’Œå‘¨æœŸæ€§çš„å³°ï¼Œå¯¹åº”äº<code>æ— æ ¸å°ä½“åŒºåŸŸ</code>ï¼ˆNFRï¼‰ï¼ˆ&lt;100bpï¼‰å’Œ<code>å•æ ¸åŒæ ¸å’Œä¸‰æ ¸</code>å°ä½“ï¼ˆ200ï¼Œ400ï¼Œ600bpï¼‰ã€‚å¤§å¤šæ•°Linker DNAå¤§å°ä»‹äº10-80bpé—´ï¼Œæ•…å¤§å¤šæ•°ç‰‡æ®µéƒ½ä¼šæ˜¯<code>å°äº100bp</code>ã€‚æ¯ä¸ªNucleosomeçš„DNAå¤§å°ä¸º180bpï¼ŒåŠ ä¸Šä¸¤è¾¹æ’å…¥çš„å†—ä½™ï¼Œä¼šå¾—åˆ°å¤§çº¦<code>200bp</code>é•¿åº¦çš„mono-nucleosomeçš„DNAã€‚</li>
<li><code>æ— æ ¸å°ä½“åŒºåŸŸçš„ç‰‡æ®µåº”è¯¥åœ¨åŸºå› çš„è½¬å½•èµ·å§‹ä½ç‚¹ï¼ˆTSSï¼‰å‘¨å›´å¯Œé›†</code>ï¼Œè€Œ<code>æ ¸å°ä½“ç»“åˆåŒºåŸŸç‰‡æ®µTSSå¤„å½¢æˆä½è°·</code>ï¼ŒTSSå‘¨å›´<code>ä¾§ç¿¼åŒºåŸŸç¨å¾®å¯Œé›†</code>ã€‚<code>ATACseqQCè¯„ä¼°</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>Peak-callingï¼šä»æ¯”å¯¹å¾—åˆ°çš„bamæ–‡ä»¶æ‰¾å‡ºreadsè¦†ç›–åŒºï¼Œå°±æ˜¯å³°å‡ºç°çš„ä½ç½®ã€‚</li>
<li>é«˜çº§åˆ†æ<ul>
<li>ï¼ˆ1ï¼‰peak å·®å¼‚åˆ†æï¼šå¯»æ‰¾ä¸åŒåˆ†ç»„å·®å¼‚peaks</li>
<li>ï¼ˆ2ï¼‰peakæ³¨é‡Šï¼šå³°çš„æ³¨é‡Šå¯å°†æŸ“è‰²è´¨çš„å¯åŠæ€§ä¸åŸºå› è°ƒæ§è”ç³»ã€‚é€šå¸¸å³°ä¼šè¢«æ³¨é‡Šåˆ°æœ€æ¥è¿‘çš„åŸºå› æˆ–è°ƒæ§åŸä»¶ã€‚è·å¾—æœ€æ¥è¿‘çš„åŸºå› åˆ—è¡¨åï¼Œä½¿ç”¨GOKEGGReactomeç­‰æ•°æ®åº“åŠŸèƒ½å¯Œé›†åˆ†æ</li>
<li>ï¼ˆ3ï¼‰motifå¯Œé›†åˆ†æï¼šå¾—åˆ°æ¯ä¸ªpeak regioné‡Œmotifçš„ä½ç½®å’Œé¢‘ç‡ï¼Œå†å’ŒéšæœºèƒŒæ™¯æˆ–å…¶ä»–æ¡ä»¶æ¯”è¾ƒï¼Œå¯åšmotifå¯Œé›†åˆ†æ</li>
<li>ï¼ˆ4ï¼‰footprintåˆ†æ ï¼šATACseqä¸­footprintæŒ‡ä¸€ä¸ªTFç»“åˆåœ¨DNAä¸Šï¼Œç»„ç»‡Tn5åˆ‡å‰²ï¼Œåœ¨æŸ“è‰²è´¨å¼€æ”¾åŒºåŸŸç•™ä¸‹ä¸€ä¸ªç›¸å¯¹ç¼ºå¤±çš„ä½ç½®ã€‚è€ŒTFå‘¨å›´çš„ç»„è›‹ç™½å› ä¸ºTFé€ æˆç©ºé—´çš„æ¨æŒ¤åè€Œå½¢æˆå¼€æ”¾åº¦è¾ƒé«˜åŒºåŸŸã€‚</li>
</ul>
</li>
</ul>
<hr>
]]></content>
      <categories>
        <category>ATAC-seq</category>
      </categories>
      <tags>
        <tag>ATAC-seq</tag>
      </tags>
  </entry>
</search>
